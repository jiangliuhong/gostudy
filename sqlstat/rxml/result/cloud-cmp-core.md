# 复杂sql统计
 ## cloud-cmp-core
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/AliyunAckClusterMapper.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：NOW,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/AliyunEcsBillMapper.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：CJ_CMP_ALIYUN_BILL,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/AppEnvMapper.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：concat,now,CJ_CMP_APP_ENV,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/BizInstChangeRecordMapper.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CPG_BIZ_INST_CHANGE_RECORD,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_APPLICATION_CLUSTER.xml
> sql统计:复杂2个，简单6个
>
> 使用的关键字：COUNT,sum,FROM,and,now,ifnull,count,DATE,AND,NOW
#### querySoftAssignList
```

        SELECT
            temp.name,
            temp.version,
            ifnull(sum(temp.count), 0) assignNum
        FROM ( <foreach collection="appSofts" item="app" separator=" union all ">
            select #{app.name} as name,VERSION as version,SERVER_ID as serverId, SERVER_TYPE as serverType, count(*) as count
            from ${app.table}  where IS_DELETED=0 and MEMBER_ID =#{memberId} and DATE(CREATE_DATE) BETWEEN #{startTime} and #{endTime}  GROUP BY VERSION,SERVER_ID,SERVER_TYPE 
        </foreach>) temp
        JOIN cj_cmp_vm_view vm ON temp.serverId = vm.ID AND temp.serverType = vm.TYPE
        <where>
            <if test="isCatalog">
                and vm.SRV_NO IS NOT NULL
            </if>
        </where>
        GROUP BY temp.version, temp.name ORDER BY temp.name asc
    
```
#### statSoftAssignList
```

        SELECT
            temp.name,
            ifnull(sum(temp.count), 0) num
        FROM ( <foreach collection="appSofts" item="app" separator=" union all ">
            select #{app.name} as name,SERVER_ID as serverId, SERVER_TYPE as serverType, count(*) as count
            from ${app.table}  where IS_DELETED=0 and MEMBER_ID =#{memberId} and DATE(CREATE_DATE) BETWEEN #{startTime} and #{endTime}  GROUP BY SERVER_ID,SERVER_TYPE 
        </foreach>) temp
        JOIN cj_cmp_vm_view vm ON temp.serverId = vm.ID AND temp.serverType = vm.TYPE
        <where>
            <if test="isCatalog">
                and vm.SRV_NO IS NOT NULL
            </if>
        </where>
        GROUP BY temp.name ORDER BY temp.name asc
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_APP_SERVER_TOMCAT.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：count,DATE,NOW,and,AND,size

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_APP_SERVER_WEBLOGIC.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：and,AND,size,count,DATE,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_APP_SERVER_WEBSPHERE.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：and,AND,size,count,DATE,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_CABINET.xml
> sql统计:复杂0个，简单14个
>
> 使用的关键字：count,in,NOW,now,CJ_CMDB_CI_CABINET,values,concat

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_CLOUDBOOT_PM_RAW_DATA.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CMDB_CI_CLOUDBOOT_PM_RAW_DATA,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_CLOUD_BOOT_SUBNET.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：count,JOIN,NOW,IF,ISNULL,CONCAT

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_COGNOS.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：count,DATE,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_COMPUTER_ROOM.xml
> sql统计:复杂0个，简单13个
>
> 使用的关键字：count,CONCAT,NOW,CJ_CMDB_CI_COMPUTER_ROOM,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_CONNECT_DIRECT.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：AND,size,count,DATE,NOW,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_DATASTAGE.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_DB_DB2_INSTANCE.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：NOW,and,AND,size,count,DATE

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_DB_ELASTICSEARCH_INSTANCE.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_DB_GBASE_INSTANCE.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：NOW,CJ_CMDB_CI_DB_GBASE_INSTANCE,values,and,AND,size,count

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_DB_MONGODB_INSTANCE.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_DB_MYSQL_INSTANCE.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：and,AND,size,count,DATE,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_DB_ORA_INSTANCE.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：DATE,NOW,and,AND,size,count

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_DB_POSTGRESQL_INSTANCE.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_DB_REDIS_INSTANCE.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：DATE,NOW,and,AND,size,count

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_DB_SQLSERVER_INSTANCE.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：DATE,NOW,and,AND,size,count

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_FLUME.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_HADOOP.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：size,count,DATE,NOW,and,AND

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_HARDWARE_CONF_TEMPLATE.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：count,JOIN,concat,NOW,join,CONCAT,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_IBM_WMQ.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：and,AND,size,count,DATE,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_IHS_WEB_SERVER.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：AND,size,count,DATE,NOW,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_IMAGE_TEMPLATE.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：CONCAT,and,count,JOIN,split,NOW,join

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_KAFKA.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_LOGICAL_DISK.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_MYCAT.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_NAS_STORAGE.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：now,CJ_CMDB_CI_NAS_STORAGE,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_NAS_VOLUME.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：now,CJ_CMDB_CI_NAS_VOLUME,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_NAS_VOLUME_EXPORT.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：now,CJ_CMDB_CI_NAS_VOLUME_EXPORT,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_NGINX_WEB_SERVER.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：and,AND,size,count,DATE,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_OPENSHIFT_NODE.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：DATE,NOW,and,AND,size,count

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_PHYSICAL_DATACENTER.xml
> sql统计:复杂0个，简单12个
>
> 使用的关键字：values,CONCAT,count,NOW,CJ_CMDB_CI_PHYSICAL_DATACENTER

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_PHYSICAL_MACHINE.xml
> sql统计:复杂4个，简单33个
>
> 使用的关键字：CONCAT,from,ifnull,split,NOW,values,IFNULL,INSTR,sum,DATE,DATE_FORMAT,concat,if,and,count,WHERE,now,in,join
#### list
```

      select pm.ID,pm.MEMBER_ID,pm.NAME,pm.CPU_CORE_COUNT as cpus,pm.RAM as memory,pm.DISK_SPACE as disk, pm.SN, pm.ENTITY_ID, pm.OPERATIONAL_STATUS as `status`, pm.RUN_STATUS as runStatus, pm.OOB_IP as ip,pm.BIZ_IP,pm.BIZ_VLAN, 
        pm.label, concat(pm.OS_DOMAIN, IFNULL(pm.OS_VERSION,'')) as os,pm.IS_LOCKED,        pm.OWNED_BY,u.`NAME` as owner, depart.`NAME` as dept, sa.NAME AS serviceAccountName,sa.DATACENTER_TYPE AS datacenterType, cdc.CLOUD_ACCOUNT_ID,
        ca.NAME as CLOUD_ACCOUNT_NAME,app.NAME as appSystemName, du.NAME as appDuName , du.APP_DU_TYPE as appDuType, dc.NAME as dataCenter, room.NAME as serverRoom,pm.U_START as uStart, region.name as region, pm.USED_FOR as `usage`,
        concat(IFNULL(cabinet.PRE_NAME,''), if(cabinet.PRE_NAME is null,'','-'), cabinet.NAME) as serverCabinet
      from CJ_CMDB_CI_PHYSICAL_DATACENTER dc inner join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID=dc.SERVICE_ACCOUNT_ID and sa.IS_DELETED=0 and dc.IS_DELETED=0
      left outer join CJ_CMP_CLOUD_ACCOUNT_DC cdc on cdc.SERVICE_ACCOUNT_ID=dc.SERVICE_ACCOUNT_ID and cdc.LDC_ID=dc.ID and cdc.IS_DELETED=0
      left outer join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID=cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED=0
      inner join CJ_CMDB_CI_PHYSICAL_MACHINE pm on pm.LDC_ID=dc.ID and pm.IS_DELETED=0
      left outer join CJ_CMDB_CI_COMPUTER_ROOM room on pm.COMPUTER_ROOM_ID=room.ID
      left outer join CJ_CMDB_CI_CABINET cabinet on cabinet.ID=pm.CABINET_ID
      left outer join CJ_CMP_APP_SYSTEM app on app.ID=pm.APP_SYSTEM_ID
      left outer join CJ_CMDB_CI_SYS_REGION region on pm.REGION_ID = region.ID and region.IS_DELETED = 0
      left join CJ_CMP_APP_DU du on pm.APP_DU_ID = du.ID and du.IS_DELETED = 0
      left join ydduc.UC_USER u ON pm.OWNED_BY = u.ID
      left join ydduc.UC_DEPARTMENT depart ON u.DEPARTMENT = depart.ID
      where pm.ENTITY_ID is not null and pm.IS_DELETED=0
      <if test="queryParam.cloudAccountId != null and queryParam.cloudAccountId != ''"> and ca.ID=#{queryParam.cloudAccountId}</if>
      <if test="queryParam.serviceAccountId != null and queryParam.serviceAccountId != ''"> and sa.ID=#{queryParam.serviceAccountId}</if>
      <if test="queryParam.ldcId != null and queryParam.ldcId != ''"> and dc.ID=#{queryParam.ldcId}</if>
      <if test="queryParam.azId != null and queryParam.azId != ''"> and room.ID=#{queryParam.azId}</if>
    <if test="queryParam.memberId != 0">  and pm.MEMBER_ID = #{queryParam.memberId}</if>
    <if test="queryParam.appSystemName != null and queryParam.appSystemName != ''"> and app.NAME like CONCAT('%',#{queryParam.appSystemName},'%')</if>
    <if test="queryParam.name != null and queryParam.name != ''"> and pm.NAME like CONCAT('%',#{queryParam.name},'%')</if>
    <if test="queryParam.ip != null and queryParam.ip != ''"> and pm.OOB_IP like CONCAT('%',#{queryParam.ip},'%')</if>
    <if test="queryParam.userIds != null and queryParam.userIds.size >0 ">
     and ( pm.OWNED_BY in <foreach collection="queryParam.userIds" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
       <if test="queryParam.appUserId !=null ">
           or app.SYS_OPR_MANT_OWNER_ID= #{queryParam.appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{queryParam.appUserId} or app.BIZ_OWNER_ID=#{queryParam.appUserId}
           <if test="queryParam.appDepartmentList != null and queryParam.appDepartmentList.size != 0">
             or app.DEPT_ID in <foreach collection="queryParam.appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
             or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="queryParam.appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
           </if>
       </if>
     )
    </if>
    <if test="queryParam.ownedByList != null and queryParam.ownedByList.size != 0">
      and pm.OWNED_BY in <foreach collection="queryParam.ownedByList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
    </if>
    <if test="queryParam.sn != null and queryParam.sn != ''"> and pm.SN like CONCAT('%',#{queryParam.sn},'%')</if>
    <if test="queryParam.runStatus != null and queryParam.runStatus != ''"> and pm.RUN_STATUS = #{queryParam.runStatus}</if>
    <if test="queryParam.status != null and queryParam.status != ''"> and pm.OPERATIONAL_STATUS = #{queryParam.status}</if>
    <if test="queryParam.searchKey != null and queryParam.searchKey != ''">
      and (pm.NAME like CONCAT('%',#{queryParam.searchKey},'%') or pm.OOB_IP like CONCAT('%',#{queryParam.searchKey},'%') or pm.sn like CONCAT('%',#{queryParam.searchKey},'%') or pm.RUN_STATUS = #{queryParam.searchKey} or  pm.OPERATIONAL_STATUS = #{queryParam.searchKey} or pm.BIZ_IP like CONCAT('%', #{queryParam.searchKey}, '%') or app.NAME like CONCAT('%',#{queryParam.searchKey},'%')
      <if test="queryParam.searchKeyList != null and queryParam.searchKeyList.size != 0">
        or pm.OWNED_BY in <foreach collection="queryParam.searchKeyList" item="searchKey" open="(" close=")" separator=",">#{searchKey}</foreach>
      </if>
      )
    </if>
    <if test=" queryParam.bizIps != null and queryParam.bizIps.size >0 ">
      and <foreach collection="queryParam.bizIps" item="ip" open="(" close=")" separator="or">INSTR(pm.BIZ_IP, #{ip})</foreach>
    </if>

    order by pm.NAME
  
```
#### queryDetail
```

    select pm.ID,pm.SERVICE_ACCOUNT_ID,pm.MEMBER_ID,pm.NAME,pm.NAME as hostname,pm.CPU_CORE_COUNT as cpus,pm.RAM as memory,pm.DISK_SPACE as disk, pm.SN, pm.ENTITY_ID, pm.OPERATIONAL_STATUS as `status`,
      pm.RUN_STATUS as runStatus, pm.OOB_IP as ip, pm.BIZ_IP,pm.BIZ_VLAN, pm.label, concat(pm.OS_DOMAIN, IFNULL(pm.OS_VERSION,'')) as os,du.NAME as appDuName ,du.APP_DU_TYPE as appDuType,app.NAME as appSystemName,pm.IS_LOCKED,
      pm.USED_FOR as `usage`,u.`NAME` as owner, depart.`NAME` as dept, pm.BOOTOS_ACTIVE_TIME as bootOSActiveTime, pm.OPERATING_SYSTEM as osType, pm.OWNED_BY, pm.manufacturer, pm.MODEL_ID as model, pm.U_START,
      pm.CREATE_BY, pm.CREATE_DATE, pm.LAST_MODIFIED_BY, pm.LAST_MODIFIED_DATE, sa.NAME AS serviceAccountName, sa.DATACENTER_TYPE as serviceAccountType, cdc.CLOUD_ACCOUNT_ID, ca.NAME as CLOUD_ACCOUNT_NAME,
      concat(IFNULL(cabinet.PRE_NAME,''),if(cabinet.PRE_NAME is null,'','-'), cabinet.NAME) as SERVER_ROOM, room.ID as SERVER_ROOM_ID,cabinet.NAME as serverCabinet, cabinet.ID as serverCabinetId, dc.NAME as dataCenter, region.name as region
    from CJ_CMDB_CI_PHYSICAL_MACHINE pm left outer join CJ_CMDB_CI_CABINET cabinet on cabinet.ID=pm.CABINET_ID
    left outer join CJ_CMDB_CI_COMPUTER_ROOM room on room.ID=pm.COMPUTER_ROOM_ID
    left outer join CJ_CMDB_CI_PHYSICAL_DATACENTER dc on dc.ID=pm.LDC_ID
    left outer join CJ_CMP_CLOUD_ACCOUNT_DC cdc on cdc.SERVICE_ACCOUNT_ID=pm.SERVICE_ACCOUNT_ID and cdc.LDC_ID=pm.LDC_ID and cdc.IS_DELETED=0
    left outer join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID=cdc.CLOUD_ACCOUNT_ID
    left outer join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID=pm.SERVICE_ACCOUNT_ID
    left outer join CJ_CMDB_CI_SYS_REGION region on pm.REGION_ID = region.ID and region.IS_DELETED = 0
    left join CJ_CMP_APP_DU du on pm.APP_DU_ID = du.ID and du.IS_DELETED = 0
    left join  CJ_CMP_APP_SYSTEM app on pm.APP_SYSTEM_ID=app.ID and  app.IS_DELETED=0
    left join ydduc.UC_USER u ON pm.OWNED_BY = u.ID
    left join ydduc.UC_DEPARTMENT depart ON u.DEPARTMENT = depart.ID
    where pm.ID = #{id} and pm.IS_DELETED=0
    <if test="memberId != 0"> and pm.MEMBER_ID = #{memberId}</if>
  
```
#### countByRole
```

    select ifnull(count(*),0)
    from CJ_CMDB_CI_PHYSICAL_MACHINE pm
    left outer join CJ_CMP_APP_SYSTEM app on app.ID=pm.APP_SYSTEM_ID
    where pm.IS_DELETED=0 and pm.MEMBER_ID = #{memberId}
    <if test="userIds != null and userIds.size >0 ">
      and ( pm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
      <if test="appUserId !=null ">
        or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
        <if test="appDepartmentList != null and appDepartmentList.size != 0">
          or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
          or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
        </if>
      </if>
      )
    </if>
    <if test="startTime != null and endTime != null ">
      and (pm.CREATE_DATE &gt;= DATE(#{startTime}) AND pm.CREATE_DATE &lt;= DATE(#{endTime}))
    </if>
  
```
#### groupByTime
```

    SELECT
    ifnull( count( DISTINCT ENTITY_ID, SERVICE_ACCOUNT_ID ), 0 ) AS num,
    DATE_FORMAT(report.CREATE_DATE, #{dateFormat}) AS days
    FROM
    CJ_CMDB_CI_PHYSICAL_MACHINE report
    LEFT OUTER JOIN CJ_CMP_APP_SYSTEM app ON app.ID = report.APP_SYSTEM_ID
    inner join CJ_CMP_SERVICE_ACCOUNT sa on sa.id = report.SERVICE_ACCOUNT_ID and sa.IS_DELETED = 0
    WHERE
    (report.CREATE_DATE &gt;= DATE(#{startTime}) AND report.CREATE_DATE &lt;= DATE(#{endTime}))
    <if test="memberId != 0">
      and report.MEMBER_ID = #{memberId}
    </if>
    <if test="userIds != null and userIds.size >0">
      and ( report.OWNED_BY in
      <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
      <if test="appUserId !=null ">
        or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId}
        or app.BIZ_OWNER_ID=#{appUserId}
        <if test="appDepartmentList != null and appDepartmentList.size != 0">
          or app.DEPT_ID in
          <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">
            #{department}
          </foreach>
          or app.SYS_OPR_MANT_DEPT_ID in
          <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">
            #{department}
          </foreach>
        </if>
      </if>
      )
    </if>
    GROUP BY days
    ORDER BY days asc
  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_PHYSICAL_NIC.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_PHYSICAL_NIC_PORT.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_PXE_TEMPLATE.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：NOW,join,CONCAT,and,count,JOIN

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_QINGCLOUD_DATACENTER.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_QINGCLOUD_SUBNET.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：ISNULL,CONCAT,NOW,values,IF

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_QINGCLOUD_VM_INSTANCE.xml
> sql统计:复杂0个，简单18个
>
> 使用的关键字：and,now,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_QINGCLOUD_VPC.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：in,and,CONCAT,NOW,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_RABBITMQ.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_ROCKETMQ.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：AND,size,count,DATE,NOW,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_STORAGE_DISK.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_STORAGE_HBA.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：CJ_CMDB_CI_STORAGE_HBA,values,now,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_STORAGE_HBA_PORT.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_STORM.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_SYS_REGION.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_TKE_CLUSTER.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：and,now,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_TKE_NS.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：now,NOW,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_TKE_PROJECT.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：now,NOW,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_TKE_PROJECT_X_CLUSTER.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMDB_CI_ZOOKEEPER.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_ALIYUN_DC.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_ALIYUN_ECS.xml
> sql统计:复杂0个，简单21个
>
> 使用的关键字：now,NOW,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_APP_DU.xml
> sql统计:复杂0个，简单12个
>
> 使用的关键字：and,count,now,CJ_CMP_APP_DU,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_APP_DU_X_RESOURCE.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：now,CJ_CMP_APP_DU_X_RESOURCE,VALUES,count

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_APP_INSTANCE.xml
> sql统计:复杂0个，简单12个
>
> 使用的关键字：CJ_CMP_APP_INSTANCE,VALUES,and,or,count,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_APP_MGR_CONFIG.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：CJ_CMP_APP_MGR_CONFIG,VALUES,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_APP_RESOURCE.xml
> sql统计:复杂1个，简单0个
>
> 使用的关键字：ifnull,ceil,and,CONCAT
#### queryResourceList
```

        select vm.ID          id,
        vm.NAME               name,
        vm.IP                 ip,
        vm.OS,
        vm.TYPE               deviceType,
        vm.RUN_STATUS,
        vm.CLUSTER_NAME       clusterName,
        vm.ZONE_NAME          zoneName,
        vm.SERVICE_ACCOUNT_ID,
        vm.CLOUD_ACCOUNT_ID   cloudAccountId,
        vm.CLOUD_ACCOUNT_NAME cloudAccountName,
        vm.LDC_TYPE           ldcType,
        vm.LDC_ID             ldcId,
        vm.LDC_NAME           ldcName,
        vm.SN                 sn,
        app.NAME              appName,
        du.NAME               appDuName,
        du.ID                 appDuId,
        du.APP_DU_TYPE,dt.NAME as appDuTypeName,du.NAME_EN_ABBR,
        vm.APP_SYSTEM_ID      appSystemId,
        CONCAT(ifnull(vm.CPUS,''),'C',ifnull(ceil(vm.MEMORY/1024),''),'G') as spec
        from CJ_CMP_PHYSICAL_VIRTUAL_MACHINE_VIEW vm
        inner join CJ_CMP_APP_SYSTEM app on app.ID =vm.APP_SYSTEM_ID and app.IS_DELETED = 0
        left outer join CJ_CMP_APP_DU du on du.ID = vm.APP_DU_ID and du.IS_DELETED = 0
        left outer join CJ_SYS_DIC dt on dt.TYPE_CODE='APP_DU_TYPE' and dt.CODE=du.APP_DU_TYPE and dt.IS_DELETED=0
        where vm.MEMBER_ID = #{memberId}
        <if test="appSystemId!=null and appSystemId!=''"> and app.ID=#{appSystemId}</if>
        <if test="duId!=null and duId!=''"> and du.ID=#{duId}</if>
        <if test="searchKey != null and searchKey != ''">
            <if test="searchType=='' or searchType==null">
                and (du.NAME like #{searchKey} or dt.NAME like #{searchKey} or du.NAME_EN_ABBR like #{searchKey} or vm.NAME like #{searchKey} or vm.IP like #{searchKey})
            </if>
            <if test="searchType=='appDuName'">and du.NAME like #{searchKey} </if>
            <if test="searchType=='appDuType'">and dt.NAME like #{searchKey}</if>
            <if test="searchType=='appDuNameEnAbbr'">and du.NAME_EN_ABBR like #{searchKey}</if>
            <if test="searchType=='hostName'">and vm.NAME like #{searchKey}</if>
            <if test="searchType=='ip'">and vm.IP like #{searchKey}</if>
         </if>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_APP_SYSTEM.xml
> sql统计:复杂0个，简单28个
>
> 使用的关键字：and,or,CJ_CMP_APP_SYSTEM_X_USER,count,CONCAT,now,CJ_CMP_APP_SYSTEM,VALUES,CJ_CMP_APP_SYSTEM_X_ASSIGNER_USER

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_ASYNC_TASK.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：now,CJ_CMP_ASYNC_TASK,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_ASYNC_TASK_MESSAGE.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：CJ_CMP_ASYNC_TASK_MESSAGE,VALUES,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_BP.xml
> sql统计:复杂1个，简单8个
>
> 使用的关键字：VALUES,in,and,or,CONCAT,convert,NOW,CJ_CMP_BP
#### selectByCondition
```

    select *
    from CJ_CMP_BP
    where IS_DELETED = 0 and (MEMBER_ID = #{memberId} or (MEMBER_ID = 0 and status = 'published'))
    <if test="status != null and status != ''" >
      and `STATUS` = #{status}
    </if>
    <if test="name != null and name != ''" >
        and `NAME` like CONCAT('%',#{name},'%')
    </if>
    ORDER BY convert(${sortField} USING gbk) ${sortType}
  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_BP_OP.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：in,NOW,CJ_CMP_BP_OP,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_BP_OP_PARAM.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：VALUES,in,NOW,CJ_CMP_BP_OP_PARAM

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_BP_OP_STEP.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：in,NOW,CJ_CMP_BP_OP_STEP,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_BP_RB.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：in,NOW,CJ_CMP_BP_RB,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_CABINET_CONFIG.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：NOW,CJ_CMP_CABINET_CONFIG,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_CAPACITY.xml
> sql统计:复杂7个，简单7个
>
> 使用的关键字：ifnull,sum,round,count,JOIN,NOW,CJ_CMP_CAPACITY,values
#### queryAppSubsystemCapacityVmUsed
```

    SELECT sub.ID as capacityObjId,sub.NAME as capacityObjName ,ifnull(sum(ifnull(vm.CPUS,0)),0) as vcpuUsed,ifnull(round(sum(ifnull(vm.MEMORY,0))/1024),0) as memoryUsed,count(vm.ID) as vmInstanceUsed,
	ifnull(round(sum(ifnull(vmStorage.DISK_SPACE,0))),0) as storageUsed,ifnull(sum(ifnull(vmStorage.DISKS,0)),0) as diskUsed
	FROM CJ_CMP_APP_SYSTEM sub
	LEFT JOIN cj_cmp_vm_view vm on vm.APP_SYSTEM_ID=sub.ID and sub.IS_DELETED=0
	LEFT JOIN (select SERVICE_ACCOUNT_ID,VM_DEVICE_ID,sum(ifnull(DISK_SPACE,0)) as DISK_SPACE,count(*) as DISKS from CJ_CMP_VM_VOLUME v where v.IS_DELETED=0 group by SERVICE_ACCOUNT_ID,VM_DEVICE_ID) as vmStorage on vmStorage.SERVICE_ACCOUNT_ID=vm.SERVICE_ACCOUNT_ID and vmStorage.VM_DEVICE_ID=vm.ID
	where sub.MEMBER_ID=#{memberId}
	<if test="appSubIds != null and appSubIds.size != 0">
        and sub.ID in <foreach collection="appSubIds" item="objId" open="(" close=")" separator=",">#{objId}</foreach>
    </if>
	group by sub.ID,sub.NAME; 
  
```
#### queryAppSubsystemCapacityPmUsed
```

    SELECT sub.ID as capacityObjId,sub.NAME as capacityObjName,
	count(*) as pmInstanceUsed,
	ifnull(round(sum(ifnull(hdd.storageUsed,0))),0) as storageUsed,
	ifnull(sum(ifnull(hdd.diskUsed,0)),0) as diskUsed,
	ifnull(sum(ifnull(pm.CPU_CORE_COUNT,0)),0) as vcpuUsed,
	ifnull(sum(ifnull(pm.RAM,0)),0) as memoryUsed
	FROM CJ_CMP_APP_SYSTEM sub
	INNER JOIN CJ_CMDB_CI_PHYSICAL_MACHINE pm on pm.APP_SYSTEM_ID=sub.ID and pm.IS_DELETED=0 and sub.IS_DELETED=0
	LEFT JOIN (select SERVER_ID,count(*) as diskUsed,sum(ifnull(DISK_SPACE,0)) as storageUsed from CJ_CMDB_CI_STORAGE_DISK where IS_DELETED=0 group by SERVER_ID) as hdd on hdd.SERVER_ID=pm.ID
	where sub.MEMBER_ID=#{memberId}
	<if test="appSubIds != null and appSubIds.size != 0">
        and sub.ID in <foreach collection="appSubIds" item="objId" open="(" close=")" separator=",">#{objId}</foreach>
    </if>
	group by sub.ID,sub.NAME; 
  
```
#### queryDeptCapacityVmUsed
```

    SELECT ifnull(sum(ifnull(vm.CPUS,0)),0) as vcpuUsed,ifnull(round(sum(ifnull(vm.MEMORY,0))/1024),0) as memoryUsed,count(vm.ID) as vmInstanceUsed,ifnull(round(sum(ifnull(vmStorage.DISK_SPACE,0))),0) as storageUsed,ifnull(sum(ifnull(vmStorage.DISKS,0)),0) as diskUsed
	FROM cj_cmp_vm_view vm 
	LEFT JOIN (select SERVICE_ACCOUNT_ID,VM_DEVICE_ID,sum(ifnull(DISK_SPACE,0)) as DISK_SPACE,count(*) as DISKS from CJ_CMP_VM_VOLUME v where v.IS_DELETED=0 group by SERVICE_ACCOUNT_ID,VM_DEVICE_ID) as vmStorage on vmStorage.SERVICE_ACCOUNT_ID=vm.SERVICE_ACCOUNT_ID and vmStorage.VM_DEVICE_ID=vm.ID
    where vm.OWNED_BY in <foreach collection="userIds" item="objId" open="(" close=")" separator=",">#{objId}</foreach>
  
```
#### queryDeptCapacityPmUsed
```

    select count(*) as pmInstanceUsed,ifnull(round(sum(ifnull(hdd.storageUsed,0))),0) as storageUsed,count(hdd.diskUsed) as diskUsed,ifnull(sum(ifnull(pm.CPU_CORE_COUNT,0)),0) as vcpuUsed,ifnull(sum(ifnull(pm.RAM,0)),0) as memoryUsed
    from CJ_CMDB_CI_PHYSICAL_MACHINE pm LEFT JOIN (select SERVER_ID,count(*) as diskUsed,sum(ifnull(DISK_SPACE,0)) as storageUsed from CJ_CMDB_CI_STORAGE_DISK where IS_DELETED=0 group by SERVER_ID) as hdd on hdd.SERVER_ID=pm.ID
    where pm.IS_DELETED=0 and pm.OWNED_BY in <foreach collection="userIds" item="objId" open="(" close=")" separator=",">#{objId}</foreach>
  
```
#### queryProjectCapacityVmUsed
```

        SELECT ifnull(sum(ifnull(vm.CPUS,0)),0) as vcpuUsed,ifnull(round(sum(ifnull(vm.MEMORY,0))/1024),0) as
        memoryUsed,count(vm.ID) as vmInstanceUsed,
        ifnull(round(sum(ifnull(vmStorage.DISK_SPACE,0))),0) as storageUsed,ifnull(sum(ifnull(vmStorage.DISKS,0)),0) as
        diskUsed
        FROM cj_cmp_vm_view vm
        LEFT JOIN (select SERVICE_ACCOUNT_ID,VM_DEVICE_ID,sum(ifnull(DISK_SPACE,0)) as DISK_SPACE,count(*) as DISKS from
        CJ_CMP_VM_VOLUME v where v.IS_DELETED=0 group by SERVICE_ACCOUNT_ID,VM_DEVICE_ID) as vmStorage on
        vmStorage.SERVICE_ACCOUNT_ID=vm.SERVICE_ACCOUNT_ID and vmStorage.VM_DEVICE_ID=vm.ID
        where vm.PROJECT_ID in
        <foreach collection="projectIds" item="objId" open="(" close=")" separator=",">#{objId}</foreach>
    
```
#### queryProjectCapacityPmUsed
```

        select count(*) as pmInstanceUsed,ifnull(round(sum(ifnull(hdd.storageUsed,0))),0) as
        storageUsed,count(hdd.diskUsed) as diskUsed,ifnull(sum(ifnull(pm.CPU_CORE_COUNT,0)),0) as
        vcpuUsed,ifnull(sum(ifnull(pm.RAM,0)),0) as memoryUsed
        from CJ_CMDB_CI_PHYSICAL_MACHINE pm LEFT JOIN (select SERVER_ID,count(*) as diskUsed,sum(ifnull(DISK_SPACE,0))
        as storageUsed from CJ_CMDB_CI_STORAGE_DISK where IS_DELETED=0 group by SERVER_ID) as hdd on hdd.SERVER_ID=pm.ID
        where pm.IS_DELETED=0 and pm.PROJECT_ID in
        <foreach collection="projectIds" item="objId" open="(" close=")" separator=",">#{objId}</foreach>
    
```
#### queryCloudAccountCapacityVmUsed
```

        SELECT ca.ID as capacityObjId,ca.NAME as capacityObjName ,ifnull(sum(ifnull(vm.CPUS,0)),0) as vcpuUsed,ifnull(round(sum(ifnull(vm.MEMORY,0))/1024),0) as memoryUsed,count(vm.ID) as vmInstanceUsed,
        ifnull(round(sum(ifnull(vmStorage.DISK_SPACE,0))),0) as storageUsed,ifnull(sum(ifnull(vmStorage.DISKS,0)),0) as diskUsed
        FROM CJ_CMP_CLOUD_ACCOUNT ca
        LEFT JOIN cj_cmp_vm_view vm on vm.CLOUD_ACCOUNT_ID=ca.ID and ca.IS_DELETED=0
        LEFT JOIN (select SERVICE_ACCOUNT_ID,VM_DEVICE_ID,sum(ifnull(DISK_SPACE,0)) as DISK_SPACE,count(*) as DISKS from CJ_CMP_VM_VOLUME v where v.IS_DELETED=0 group by SERVICE_ACCOUNT_ID,VM_DEVICE_ID) as vmStorage on vmStorage.SERVICE_ACCOUNT_ID=vm.SERVICE_ACCOUNT_ID and vmStorage.VM_DEVICE_ID=vm.ID
        where ca.ID in <foreach collection="cloudAccountIds" item="objId" open="(" close=")" separator=",">#{objId}</foreach>
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>
        group by ca.ID,ca.NAME;
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_CAS_CLUSTER.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_CAS_DC.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_CAS_HOST.xml
> sql统计:复杂3个，简单7个
>
> 使用的关键字：and,count,round,if,group_concat,on,in,sum,NOW
#### queryHost
```

        select
        host.ID,
        host.NAME,
        host.IP,
        host.ENTITY_ID,
        host.CPU_COUNT as cpus,
        host.CPU_RATE,
        host.MEMORY as memorySum,
        host.MEMORY_RATE,
        host.STORAGE_CAPACITY,
        host.VM_NUM,
        host.VM_RUN_COUNT,
        host.VM_SHUTOFF,
        host.STATUS,
        cdc.LDC_TYPE,
        group_concat(distinct clu.NAME) as clusterName,
        group_concat(distinct dc.NAME) as ldcName,
        ca.ID as cloudAccountId,
        ca.NAME AS cloudAccountName,
        sa.NAME AS serviceAccountName,
        sa.ID AS serviceAccountId
        from
        CJ_CMP_CLOUD_ACCOUNT ca
        inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc on ca.ID = cdc.CLOUD_ACCOUNT_ID
        and ca.IS_DELETED = 0
        and cdc.LDC_TYPE = 'CAS'
        inner join CJ_CMP_CAS_DC dc on cdc.LDC_ID = dc.ID
        and cdc.IS_DELETED = 0
        and dc.IS_DELETED = 0
        INNER JOIN CJ_CMP_SERVICE_ACCOUNT sa ON cdc.SERVICE_ACCOUNT_ID = sa.ID
        AND sa.IS_DELETED = 0
        inner join CJ_CMP_CAS_HOST host on (
        host.SERVICE_ACCOUNT_ID = sa.ID
        or host.SERVICE_ACCOUNT_ID = sa.PARENT_ID
        )
        and host.IS_DELETED = 0
        INNER JOIN CJ_CMP_CAS_CLUSTER as clu ON host.CLUSTER_ENTITY_ID = clu.ENTITY_ID
        <where>
            <choose>
                <when test="memberId != 0">
                    and ca.MEMBER_ID = #{memberId}
                </when>
                <otherwise>
                    and ca.SCOPE = 'public'
                </otherwise>
            </choose>
            <if test="id != null and id != ''">and host.ID=#{id}</if>
            <if test="serviceAccountId != null and serviceAccountId != ''">and
                cdc.SERVICE_ACCOUNT_ID=#{serviceAccountId}
            </if>
            <if test="cloudAccountId != null and cloudAccountId != ''">and ca.ID=#{cloudAccountId}</if>
            <if test="ldcId != null and ldcId != ''">and dc.ID=#{ldcId}</if>
            <if test="name != null and name != ''">and host.NAME like #{name}</if>
            <if test="ip != null and ip != ''">and host.IP like #{ip}</if>
            <if test="searchKey != null and searchKey != ''">and (host.NAME like #{searchKey} or host.IP like
                #{searchKey} or host.ENTITY_ID like #{searchKey})
            </if>
        </where>
        group by
        host.ID,
        host.NAME,
        host.IP,
        host.ENTITY_ID,
        host.CPU_COUNT,
        host.CPU_RATE,
        host.MEMORY,
        host.MEMORY_RATE,
        host.STORAGE_CAPACITY,
        host.VM_NUM,
        host.VM_RUN_COUNT,
        host.VM_SHUTOFF,
        cdc.LDC_TYPE,
        ca.ID,
        ca.NAME,
        sa.NAME,
        sa.ID
    
```
#### statisticHostByServiceAccoutId
```

        select count(0)                                                                                 as hostSum,
               sum(host.CPUS)                                                                           as cpus,
               sum(host.CPU_USED)                                                                       as cpuUsed,
               round(if(sum(host.CPUS) = 0, 0, sum(host.CPU_USED) / sum(host.CPUS)), 2) * 100           as cpuUsage,
               sum(host.VIRTUAL_MEMORY_MB_USED)                                                         as memoryUsed,
               sum(host.VIRTUAL_MEMORY_MB_TOTAL)                                                        as memorySum,
               round(if(sum(host.VIRTUAL_MEMORY_MB_TOTAL) = 0, 0,
                        sum(host.VIRTUAL_MEMORY_MB_USED) / sum(host.VIRTUAL_MEMORY_MB_TOTAL)), 2) * 100 as memoryUsage
        from CJ_CMP_FUSION_CLOUD_HOST host
        where SERVICE_ACCOUNT_ID = #{serviceAccountId}
          AND IS_DELETED = 0;
    
```
#### statisticHostByCloudAccoutId
```

        select
        count(0) as hostSum,
        sum(host.CPUS) as cpus,
        sum(host.CPU_USED) as cpuUsed,
        round(if(sum(host.CPUS) = 0, 0, sum(host.CPU_USED) / sum(host.CPUS)), 2) * 100 as cpuUsage,
        sum(host.VIRTUAL_MEMORY_MB_USED) as memoryUsed,
        sum(host.VIRTUAL_MEMORY_MB_TOTAL) as memorySum,
        round(if(sum(host.VIRTUAL_MEMORY_MB_TOTAL) = 0, 0, sum(host.VIRTUAL_MEMORY_MB_USED) /
        sum(host.VIRTUAL_MEMORY_MB_TOTAL)), 2) * 100 as memoryUsage
        from CJ_CMP_FUSION_CLOUD_HOST host
        where SERVICE_ACCOUNT_ID in(select adc.SERVICE_ACCOUNT_ID
        from CJ_CMP_CLOUD_ACCOUNT_DC adc inner join CJ_CMP_CLOUD_ACCOUNT ca on adc.CLOUD_ACCOUNT_ID = ca.ID
        where adc.CLOUD_ACCOUNT_ID = #{cloudAccountId} AND adc.IS_DELETED = 0
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>
        ) AND IS_DELETED = 0;
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_CAS_RESOURCE.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_CAS_STORAGE.xml
> sql统计:复杂4个，简单7个
>
> 使用的关键字：round,if,and,NOW,in,sum
#### statisticDataStoreByServiceAccoutId
```

        SELECT
        sum(da.DISK_SUM)  as DISK_SUM,
        sum(da.DISK_SUM - da.DISK_FREE) as DISK_USED,
        round(if(sum(da.DISK_SUM) = 0, 0, sum(da.DISK_SUM - da.DISK_FREE) / sum(da.DISK_SUM)), 2) * 100 as DISK_USAGE
        FROM CJ_CMP_FUSION_CLOUD_STORAGE da
        where SERVICE_ACCOUNT_ID = #{serviceAccountId} AND IS_DELETED = 0;
    
```
#### statisticDataStoreByCloudAccoutId
```

        SELECT
        sum(da.DISK_SUM)  as DISK_SUM,
        sum(da.DISK_SUM - da.DISK_FREE) as DISK_USED,
        round(if(sum(da.DISK_SUM) = 0, 0, sum(da.DISK_SUM - da.DISK_FREE) / sum(da.DISK_SUM)), 2) * 100 as DISK_USAGE
        FROM CJ_CMP_FUSION_CLOUD_STORAGE da
        where SERVICE_ACCOUNT_ID in (select adc.SERVICE_ACCOUNT_ID
                                      from CJ_CMP_CLOUD_ACCOUNT_DC adc inner join CJ_CMP_CLOUD_ACCOUNT ca on adc.CLOUD_ACCOUNT_ID = ca.ID
                                      where adc.CLOUD_ACCOUNT_ID = #{cloudAccountId} AND adc.IS_DELETED = 0
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>) AND IS_DELETED = 0;
    
```
#### statisticDataStoreTypeBySaId
```

        select
        TYPE,
        SERVICE_ACCOUNT_ID,
        sum(DISK_SUM)             as DISK_SUM,
        sum(DISK_FREE)            as DISK_FREE,
        sum(DISK_SUM - DISK_FREE) as DISK_USED,
        sum(PROVISIONED)          as PROVISIONED,
        round(if(sum(DISK_SUM) = 0, 0, sum(DISK_SUM - DISK_FREE) / sum(DISK_SUM)), 2) * 100 as DISK_USAGE
        from CJ_CMP_FUSION_CLOUD_STORAGE
        where SERVICE_ACCOUNT_ID = #{serviceAccountId}
        group by TYPE, SERVICE_ACCOUNT_ID, MEMBER_ID
    
```
#### statisticDataStoreTypeByCaId
```

        select
            TYPE,
            SERVICE_ACCOUNT_ID,
            sum(DISK_SUM)                                                                       as DISK_SUM,
            sum(DISK_FREE)                                                                      as DISK_FREE,
            sum(DISK_SUM - DISK_FREE)                                                           as DISK_USED,
            sum(PROVISIONED)                                                                    as PROVISIONED,
            round(if(sum(DISK_SUM) = 0, 0, sum(DISK_SUM - DISK_FREE) / sum(DISK_SUM)), 2) * 100 as DISK_USAGE
        from CJ_CMP_FUSION_CLOUD_STORAGE
        where SERVICE_ACCOUNT_ID in (select adc.SERVICE_ACCOUNT_ID
                                      from CJ_CMP_CLOUD_ACCOUNT_DC adc inner join CJ_CMP_CLOUD_ACCOUNT ca on adc.CLOUD_ACCOUNT_ID = ca.ID
                                      where adc.CLOUD_ACCOUNT_ID = #{cloudAccountId} AND adc.IS_DELETED = 0
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>)
        group by TYPE, SERVICE_ACCOUNT_ID, MEMBER_ID
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_CAS_VDS.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：NOW,values,in,and,CONCAT

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_CAS_VM.xml
> sql统计:复杂1个，简单29个
>
> 使用的关键字：if,count,in,sum,now,NOW,and,GROUP_CONCAT
#### getAllByCondition
```

        select ecs.*,prj.CODE as projectCode,prj.NAME as projectName,prj.PROJECT_SOURCE_ID as projectSourceId,
        app.CODE as appSystemCode,app.NAME as appSystemName,app.SOURCE_ID as appSystemSourceId, GROUP_CONCAT(tag.NAME)
        as tags
        from CJ_CMP_CAS_VM ecs
        <if test="srvCompletionTimeStart!=null or srvCompletionTimeEnd!=null ">
        left outer join CJ_CMP_RITM_COMPLETED_VIEW req on ecs.SRV_NO=req.NUMBER
        </if>
        left outer join CJ_CMP_PROJECT prj on prj.ID=ecs.PROJECT_ID
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=ecs.APP_SYSTEM_ID
        left outer join CJ_CMP_APP_DU du on du.ID=ecs.APP_DU_ID
        left outer join CJ_CMP_TAG_X_OBJECT txo on ecs.ID = txo.OBJECT_ID and txo.OBJECT_TYPE = 'fusionCloud'
        left outer join CJ_CMP_TAG tag on tag.ID = txo.TAG_ID and tag.IS_DELETED = 0
        <where>
            <if test="memberId != 0">and ecs.MEMBER_ID = #{memberId}</if>
            <if test="startTime!=null and  endTime!=null ">
                and ecs.CREATE_DATE between #{startTime,jdbcType= TIMESTAMP} and #{endTime,jdbcType= TIMESTAMP}
            </if>
            <if test="startTime==null   and  endTime!=null ">
                and ecs.CREATE_DATE &lt;= #{endTime,jdbcType= TIMESTAMP}
            </if>
            <if test="startTime!=null  and  endTime==null ">
                and ecs.CREATE_DATE &gt;= #{startTime,jdbcType= TIMESTAMP}
            </if>
            <if test="srvCompletionTimeStart!=null and srvCompletionTimeEnd!=null ">
                and if(ecs.IS_DELETED=1,ecs.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) between
                #{srvCompletionTimeStart,jdbcType= TIMESTAMP} and #{srvCompletionTimeEnd,jdbcType= TIMESTAMP}
            </if>
            <if test="srvCompletionTimeStart==null and srvCompletionTimeEnd!=null ">
                and if(ecs.IS_DELETED=1,ecs.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) &lt;=
                #{srvCompletionTimeEnd,jdbcType= TIMESTAMP}
            </if>
            <if test="srvCompletionTimeStart!=null and srvCompletionTimeEnd==null ">
                and if(ecs.IS_DELETED=1,ecs.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) &gt;=
                #{srvCompletionTimeStart,jdbcType= TIMESTAMP}
            </if>
            <if test="isDeleted != null ">
                <choose>
                    <when test="isDeleted">
                        and ecs.IS_DELETED=1
                    </when>
                    <otherwise>
                        and ecs.IS_DELETED=0
                    </otherwise>
                </choose>
            </if>
        </where>
        GROUP BY ecs.ID
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_CIDR_BLOCK.xml
> sql统计:复杂3个，简单22个
>
> 使用的关键字：count,join,and,CJ_CMP_CIDR_BLOCK,concat,from,NOW,sum,size,CONCAT,ifnull,VALUES,round,convert,on
#### selectByCondition
```

     select distinct cidr.*, area.NAME as NETWORK_AREA_NAME,
                    (CASE WHEN cidr.IP_VERSION="IPv6" THEN null WHEN cidr.IP_VERSION="IPv4" THEN count(ip.CIDR_BLOCK_ID) END) as IP_SUM,
                    (CASE WHEN cidr.IP_VERSION="IPv6" THEN null WHEN cidr.IP_VERSION="IPv4" THEN sum(ip.STATUS != 'unused') END) as IP_USED,
                    (CASE WHEN cidr.IP_VERSION="IPv6" THEN null WHEN cidr.IP_VERSION="IPv4" THEN sum(ip.STATUS = 'unused') END) as IP_UNUSED,
                    (CASE WHEN cidr.IP_VERSION="IPv6" THEN null WHEN cidr.IP_VERSION="IPv4" THEN round((sum(ip.STATUS != 'unused')/count(ip.CIDR_BLOCK_ID) * 100), 2) END) as IP_USAGE
      from CJ_CMP_CIDR_BLOCK cidr
        left join
        (select CIDR_BLOCK_ID,`TYPE` from CJ_CMP_CIDR_BLOCK_X_NETWORK rel
        inner join CJ_CMP_SERVICE_ACCOUNT sa on rel.SERVICE_ACCOUNT_ID = sa.ID
        where sa.TYPE = 'aliyunPublic')
        as al on cidr.ID = al.CIDR_BLOCK_ID
        left join CJ_CMP_NETWORK_AREA area on cidr.NETWORK_AREA_ID = area.ID
        left join CJ_CMP_IP_POOL ip on cidr.ID = ip.CIDR_BLOCK_ID
        where cidr.MEMBER_ID = #{memberId} and al.TYPE is null
        <if test="ids != null and ids.size() > 0" >
          and cidr.ID in <foreach collection="ids" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
        <if test="name != null and name != ''" >
          and cidr.`NAME` like CONCAT('%',#{name},'%')
        </if>
        <if test="type != null and type != ''" >
          and cidr.TYPE = #{type}
        </if>
        <if test="ipVersion != null and ipVersion != ''" >
          and cidr.IP_VERSION = #{ipVersion}
        </if>
        <if test="networkAreaId != null" >
          and cidr.NETWORK_AREA_ID = #{networkAreaId}
        </if>
        <if test="networkAreaName != null and networkAreaName != '' " >
          and area.NAME LIKE concat('%', #{networkAreaName}, '%')
        </if>
        <if test="keyword != null and keyword!= '' ">
          and (cidr.`NAME` like CONCAT('%',#{keyword},'%') or cidr.TYPE like CONCAT('%',#{keyword},'%') or area.NAME LIKE concat('%', #{keyword}, '%') or cidr.IP_VERSION like CONCAT('%',#{keyword},'%') or cidr.CIDR_BLOCK like concat('%', #{keyword}, '%'))
        </if>
        <if test="cidrBlock !=null and cidrBlock !=''">
          and cidr.CIDR_BLOCK like concat('%', #{cidrBlock}, '%')
        </if>
        <if test="networkAreaIds != null and networkAreaIds.size()>0">
             and cidr.NETWORK_AREA_ID IN <foreach collection="networkAreaIds" item="naId" open="(" separator="," close=")"> #{naId} </foreach>
          </if>
        group by cidr.ID
        <if test="sortField != null and sortField!= '' and sortType != null and sortType!= '' ">
          <choose>
            <when test="sortField == 'NAME'">
              ORDER BY convert(cidr.${sortField} USING gbk) ${sortType}
            </when>
            <when test="sortField == 'NETWORK_AREA_NAME'">
              ORDER BY convert(${sortField} USING gbk) ${sortType}
            </when>
            <otherwise>
              ORDER BY ${sortField} ${sortType}
            </otherwise>
          </choose>
        </if>
  
```
#### pageByCondition
```

    select distinct cidr.*, area.NAME as NETWORK_AREA_NAME,
      (CASE WHEN cidr.IP_VERSION='IPv6' THEN null WHEN cidr.IP_VERSION='IPv4' THEN count(ip.CIDR_BLOCK_ID) END) as IP_SUM,
      (CASE WHEN cidr.IP_VERSION='IPv6' THEN null WHEN cidr.IP_VERSION='IPv4' THEN sum(ip.STATUS != 'unused') END) as IP_USED,
      (CASE WHEN cidr.IP_VERSION='IPv6' THEN null WHEN cidr.IP_VERSION='IPv4' THEN sum(ip.STATUS = 'unused') END) as IP_UNUSED,
      (CASE WHEN cidr.IP_VERSION='IPv6' THEN null WHEN cidr.IP_VERSION='IPv4' THEN round((sum(ip.STATUS != 'unused')/count(ip.CIDR_BLOCK_ID) * 100), 2) END) as IP_USAGE
    from (
      select cidrBlock.* from CJ_CMP_CIDR_BLOCK cidrBlock
      left join CJ_CMP_CIDR_BLOCK_X_NETWORK rel on cidrBlock.ID = rel.CIDR_BLOCK_ID
      left join CJ_CMP_SERVICE_ACCOUNT sa on rel.SERVICE_ACCOUNT_ID = sa.ID and sa.TYPE = 'aliyunPublic'
      <where>
        and cidrBlock.MEMBER_ID = #{memberId}
        and sa.TYPE is null
        <if test="ids != null" >
          and cidrBlock.ID in <foreach collection="ids" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
        <if test="name != null" >
          and cidrBlock.`NAME` like CONCAT('%',#{name},'%')
        </if>
        <if test="type != null" >
          and cidrBlock.TYPE = #{type}
        </if>
        <if test="ipVersion != null" >
          and cidrBlock.IP_VERSION = #{ipVersion}
        </if>
        <if test="networkAreaId != null" >
          and cidrBlock.NETWORK_AREA_ID = #{networkAreaId}
        </if>
        <if test="cidrBlock !=null">
          and cidrBlock.CIDR_BLOCK like concat('%', #{cidrBlock}, '%')
        </if>
        <if test="networkAreaIds != null">
          and cidrBlock.NETWORK_AREA_ID IN <foreach collection="networkAreaIds" item="naId" open="(" separator="," close=")"> #{naId} </foreach>
        </if>
      </where>
      group by cidrBlock.ID
      <if test="networkAreaName == null">
        <if test="sortField != null and sortField!= '' and sortType != null and sortType!= '' ">
          <choose>
            <when test="sortField == 'NAME'">
              ORDER BY convert(cidr.${sortField} USING gbk) ${sortType}
            </when>
            <when test="sortField == 'NETWORK_AREA_NAME'">
              ORDER BY convert(${sortField} USING gbk) ${sortType}
            </when>
            <otherwise>
              ORDER BY ${sortField} ${sortType}
            </otherwise>
          </choose>
        </if>
        limit #{offset}, #{limit}
      </if>
    ) cidr
    left join (
      select * from CJ_CMP_NETWORK_AREA
      <where>
        <if test="networkAreaName != null" >
          and `NAME` LIKE concat('%', #{networkAreaName}, '%')
        </if>
      </where>
    ) area on cidr.NETWORK_AREA_ID = area.ID
    left join CJ_CMP_IP_POOL ip on cidr.ID = ip.CIDR_BLOCK_ID
    <where>
      <if test="keyword != null">
        and (cidr.`NAME` like CONCAT('%',#{keyword},'%') or cidr.TYPE like CONCAT('%',#{keyword},'%') or area.NAME LIKE concat('%', #{keyword}, '%') or cidr.IP_VERSION like CONCAT('%',#{keyword},'%') or cidr.CIDR_BLOCK like concat('%', #{keyword}, '%'))
      </if>
    </where>
    group by cidr.ID
    <if test="networkAreaName != null">
      <if test="sortField != null and sortField!= '' and sortType != null and sortType!= '' ">
        <choose>
          <when test="sortField == 'NAME'">
            ORDER BY convert(cidr.${sortField} USING gbk) ${sortType}
          </when>
          <when test="sortField == 'NETWORK_AREA_NAME'">
            ORDER BY convert(${sortField} USING gbk) ${sortType}
          </when>
          <otherwise>
            ORDER BY ${sortField} ${sortType}
          </otherwise>
        </choose>
      </if>
      limit #{offset}, #{limit}
    </if>
  
```
#### countCidrBlockAllRelNetworks
```

    SELECT ifnull(count(DISTINCT rel.CIDR_BLOCK_ID), 0)
    FROM CJ_CMP_CIDR_BLOCK_X_NETWORK rel
           LEFT JOIN CJ_CMP_SERVICE_ACCOUNT sa ON rel.SERVICE_ACCOUNT_ID = sa.ID
           INNER JOIN CJ_CMP_SUBNET_VIEW subnet
                      ON rel.NETWORK_ID = subnet.ID AND rel.SERVICE_ACCOUNT_ID = subnet.SERVICE_ACCOUNT_ID
    WHERE rel.MEMBER_ID =#{memberId} and rel.CIDR_BLOCK_ID in <foreach collection="cidrBlockIds" item="cidrId" open="(" close=")" separator=",">#{cidrId}</foreach>
  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_CIDR_BLOCK_X_APP_INSTANCE.xml
> sql统计:复杂1个，简单9个
>
> 使用的关键字：count,ifnull,join,and,CONCAT,CJ_CMP_CIDR_BLOCK_X_APP_INSTANCE,values
#### countCidrBlockAllRelAppSystem
```

        SELECT ifnull(count(DISTINCT rel.CIDR_BLOCK_ID), 0)
        FROM CJ_CMP_CIDR_BLOCK_X_APP_INSTANCE rel
                 inner JOIN CJ_CMP_APP_SYSTEM instance ON rel.APP_INSTANCE_ID = instance.ID AND instance.IS_DELETED = 0
        WHERE rel.MEMBER_ID = #{memberId} and rel.CIDR_BLOCK_ID in <foreach collection="cidrBlockIds" item="cidrId" open="(" close=")" separator=",">#{cidrId}</foreach>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_CIDR_BLOCK_X_NETWORK.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：values,CJ_CMP_CIDR_BLOCK_X_NETWORK

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_CIDR_CHECK_IP_LOG.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：in,CJ_CMP_CIDR_CHECK_IP_LOG,VALUES,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_CIDR_LOGIC.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：in,CJ_CMP_CIDR_LOGIC,VALUES,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_CLOUDOS_DC.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：NOW,CJ_CMP_CLOUDOS_DC,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_CLOUDOS_HOST.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：and,now,NOW,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_CLOUDOS_NETWORK.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：and,CONCAT,NOW,count,in

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_CLOUDOS_SUBNET.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：CONCAT,NOW,IF,ISNULL

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_CLOUDOS_VM.xml
> sql统计:复杂0个，简单20个
>
> 使用的关键字：and,now,NOW,CJ_CMP_CLOUDOS_VM,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_CLOUDSINO_COMPUTER_ROOM.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：CONCAT,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_CLOUDSINO_FRAME.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：CONCAT,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_CLOUDSINO_PHYSICAL_MACHINE.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：CONCAT,and,now,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_CLOUDSINO_STRATEGY.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：CONCAT,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_CLOUD_ACCOUNT.xml
> sql统计:复杂7个，简单18个
>
> 使用的关键字：group_concat,ifnull,sum,now,NOW,CJ_CMP_CLOUD_ACCOUNT,AND,in,concat,VALUES,and,round
#### getByProvider
```

        select
        vm.LDC_TYPE as type,
        vm.CLOUD_ACCOUNT_ID as id,
        group_concat(distinct ca.NAME) as poolName,
        group_concat(distinct sa.NAME) as serviceAccountName
        from CJ_CMP_VM_DAY_REPORT vm
        left join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = vm.CLOUD_ACCOUNT_ID
        left join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID = vm.SERVICE_ACCOUNT_ID
        where STAT_TIME BETWEEN #{startTime} and #{endTime} and LDC_TYPE = #{provider} and
        vm.CLOUD_ACCOUNT_ID is not null
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>
        <if test="condition!=null">
            and ca.NAME = #{condition}
        </if>
        group BY vm.LDC_TYPE, vm.CLOUD_ACCOUNT_ID
        union
        select
        rel.TYPE as type,
        rel.CLOUD_ACCOUNT_ID as id,
        group_concat(distinct ca.NAME) as poolName,
        group_concat(distinct sa.NAME) as serviceAccountName
        from CJ_CMP_HOST_DAY_REPORT host
        left join CJ_CMP_HOST_REL_DAY_REPORT rel on host.ID = rel.HOST_ID and host.TYPE = rel.TYPE and host.STAT_TIME =
        rel.STAT_TIME
        left join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID = host.SERVICE_ACCOUNT_ID
        left join CJ_CMP_CLOUD_ACCOUNT ca on rel.CLOUD_ACCOUNT_ID = ca.ID
        where host.STAT_TIME BETWEEN #{startTime} and #{endTime} and host.TYPE = #{provider} and
        rel.CLOUD_ACCOUNT_ID is not null
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>
        <if test="condition!=null">
            and ca.NAME = #{condition}
        </if>
        group BY rel.TYPE, rel.CLOUD_ACCOUNT_ID
    
```
#### queryCloudAccountUsage
```

        select  ca.NAME,
                vm.ID as vmId,
                ca.DATACENTER_TYPE AS ldcType,
                ifnull( cap.VCPU_LIMIT, 0 ) AS vcpuLimit,
                ifnull( cap.MEMORY_LIMIT DIV 1024, 0 ) AS memoryLimit,
                ifnull( cap.STORAGE_LIMIT, 0 ) AS storageLimit,
                ifnull( vm.CPUS, 0 ) AS vcpu,
                ifnull( vm.MEMORY, 0 ) AS memory,
                ifnull( vol.DISK_SPACE, 0 ) DIV 1 AS STORAGE
        from CJ_CMP_CLOUD_ACCOUNT ca
            inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc ON ca.ID = cdc.CLOUD_ACCOUNT_ID AND cdc.IS_DELETED = 0
            inner join CJ_CMP_SERVICE_ACCOUNT sa on cdc.SERVICE_ACCOUNT_ID = sa.ID and sa.IS_DELETED = 0
            left join CJ_CMP_CLOUD_ACCOUNT_CAPACITY cap on cap.CLOUD_ACCOUNT_ID = ca.ID
            left join cj_cmp_vm_view vm
                   on vm.CLOUD_ACCOUNT_ID = ca.ID and vm.LDC_ID = cdc.LDC_ID
                   <if test="memberId != 0">and vm.MEMBER_ID = #{memberId}</if>
            left join CJ_CMP_VM_VOLUME vol on vol.SERVICE_ACCOUNT_ID = vm.SERVICE_ACCOUNT_ID and vol.VM_DEVICE_ID = vm.ID
                   and vol.IS_DELETED = 0
        where ca.IS_DELETED = 0
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>
        order by ca.NAME;
    
```
#### queryVMwareResUsageByCaId
```

        select sum(host.CPUS)                                                 as cpuSum,
               sum(host.CPU_USED)                                             as cpuUsed,
               sum(host.MEMORY_SUM) / 1024                                    as memorySum,
               sum(host.MEMORY_USED) / 1024                                   as memoryUsed,
               sum(host.DISK_SUM)                                             as localStorageSum,
               sum(host.DISK_USED)                                            as localStorageUsed,
               round((sum(host.CPU_USED) / sum(host.CPUS)) * 100, 2)          as cpuUsage,
               round((sum(host.MEMORY_USED) / sum(host.MEMORY_SUM)) * 100, 2) as memoryUsage,
               round((sum(host.DISK_USED) / sum(host.DISK_SUM)) * 100, 2)     as localStorageUsage
         FROM CJ_CMP_SERVICE_ACCOUNT sa
         INNER JOIN CJ_CMP_CLOUD_ACCOUNT_DC cdc
                    ON sa.ID = cdc.SERVICE_ACCOUNT_ID AND cdc.IS_DELETED = 0 AND sa.IS_DELETED = 0
         INNER JOIN CJ_CMP_CLOUD_ACCOUNT ca ON cdc.CLOUD_ACCOUNT_ID = ca.ID AND ca.IS_DELETED = 0
         inner join CJ_CMP_VMWARE_DC dc on dc.ID = cdc.LDC_ID and dc.SERVICE_ACCOUNT_ID = sa.ID
         inner join CJ_CMP_VMWARE_HOST host on host.LDC_ID = dc.ID
         where ca.ID = #{cloudAccountId} and ca.MEMBER_ID = #{memberId}
    
```
#### queryVMwareStorageUsageByCaId
```

        select sum(store.DISK_SUM)                                          as sharedStorageSum,
               sum(store.DISK_SUM - store.DISK_FREE)                        as sharedStorageUsed,
               sum(store.PROVISIONED)                                       as storageProvisioned,
               round((sum(store.DISK_SUM - store.DISK_FREE) / sum(store.DISK_SUM)) * 100, 2) as sharedStorageUsage
        FROM CJ_CMP_SERVICE_ACCOUNT sa
        INNER JOIN CJ_CMP_CLOUD_ACCOUNT_DC cdc
                    ON sa.ID = cdc.SERVICE_ACCOUNT_ID AND cdc.IS_DELETED = 0 AND sa.IS_DELETED = 0
        INNER JOIN CJ_CMP_CLOUD_ACCOUNT ca ON cdc.CLOUD_ACCOUNT_ID = ca.ID AND ca.IS_DELETED = 0
        inner join CJ_CMP_VMWARE_DC dc on dc.ID = cdc.LDC_ID and dc.SERVICE_ACCOUNT_ID = sa.ID
        inner join CJ_CMP_VMWARE_DATASTORE store on store.LDC_ID = dc.ID
        where ca.ID = #{cloudAccountId}
        and ca.MEMBER_ID = #{memberId}
    
```
#### queryFusionComputeResUsageByCaId
```

        select sum(clu.CPU_SUM)                                             as cpuSum,
               sum(clu.CPU_USED)                                            as cpuUsed,
               sum(clu.MEMORY_SUM) / 1024                                   as memorySum,
               sum(clu.MEMORY_USED) / 1024                                  as memoryUsed,
               round((sum(clu.CPU_USED) / sum(clu.CPU_SUM)) * 100, 2)       as cpuUsage,
               round((sum(clu.MEMORY_USED) / sum(clu.MEMORY_SUM)) * 100, 2) as memoryUsage
        FROM CJ_CMP_SERVICE_ACCOUNT sa
         INNER JOIN CJ_CMP_CLOUD_ACCOUNT_DC cdc
                    ON sa.ID = cdc.SERVICE_ACCOUNT_ID AND cdc.IS_DELETED = 0 AND sa.IS_DELETED = 0
         INNER JOIN CJ_CMP_CLOUD_ACCOUNT ca ON cdc.CLOUD_ACCOUNT_ID = ca.ID AND ca.IS_DELETED = 0
         inner join CJ_CMP_FUSION_COMPUTE_DC dc on dc.ID = cdc.LDC_ID and dc.SERVICE_ACCOUNT_ID = sa.ID
         inner join CJ_CMP_FUSION_COMPUTE_CLUSTER clu on clu.LDC_ID = dc.ID
         where ca.ID = #{cloudAccountId}
            and ca.MEMBER_ID = #{memberId}
    
```
#### queryFusionComputeStorageUsageByCaId
```

        select sum(store.CAPACITY_GB)                                             as sharedStorageSum,
               sum(store.USED_SIZE_GB)                                            as sharedStorageUsed,
               round((sum(store.USED_SIZE_GB) / sum(store.CAPACITY_GB)) * 100, 2) as sharedStorageUsage
        FROM CJ_CMP_SERVICE_ACCOUNT sa
                 INNER JOIN CJ_CMP_CLOUD_ACCOUNT_DC cdc
                            ON sa.ID = cdc.SERVICE_ACCOUNT_ID AND cdc.IS_DELETED = 0 AND sa.IS_DELETED = 0
                 INNER JOIN CJ_CMP_CLOUD_ACCOUNT ca ON cdc.CLOUD_ACCOUNT_ID = ca.ID AND ca.IS_DELETED = 0
                 inner join CJ_CMP_FUSION_COMPUTE_DC dc on dc.ID = cdc.LDC_ID and dc.SERVICE_ACCOUNT_ID = sa.ID
                 inner join CJ_CMP_FUSION_COMPUTE_DATASTORE store on store.LDC_ID = dc.ID
        where ca.ID = #{cloudAccountId}
        and ca.MEMBER_ID = #{memberId}
    
```
#### queryFusionCloudResUsageByCaId
```

        select sum(host.CPUS)                                                 as cpuSum,
               sum(host.CPU_USED)                                             as cpuUsed,
               sum(host.MEMORY_SUM) / 1024                                    as memorySum,
               sum(host.MEMORY_USED) / 1024                                   as memoryUsed,
               round((sum(host.CPU_USED) / sum(host.CPUS)) * 100, 2)          as cpuUsage,
               round((sum(host.MEMORY_USED) / sum(host.MEMORY_SUM)) * 100, 2) as memoryUsage
        FROM CJ_CMP_SERVICE_ACCOUNT sa
         inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc
                    ON sa.ID = cdc.SERVICE_ACCOUNT_ID AND cdc.IS_DELETED = 0 AND sa.IS_DELETED = 0
         inner join CJ_CMP_CLOUD_ACCOUNT ca ON cdc.CLOUD_ACCOUNT_ID = ca.ID AND ca.IS_DELETED = 0
         inner join CJ_CMP_FUSION_CLOUD_DC_X_AZ rel on rel.SERVICE_ACCOUNT_ID = sa.ID and rel.LDC_ID = cdc.LDC_ID
         left outer join CJ_CMP_FUSION_CLOUD_DC fdc on fdc.ID = rel.LDC_ID and fdc.IS_DELETED = 0 and
                                                       fdc.SERVICE_ACCOUNT_ID = rel.SERVICE_ACCOUNT_ID
         left outer join CJ_CMP_CLOUD_AZ az on rel.AZ_ID = az.ID and az.LDC_TYPE = cdc.LDC_TYPE and az.IS_DELETED = 0
         left outer join CJ_CMP_FUSION_CLOUD_HOST host on host.ZONE_ID = az.ID
        where ca.ID = #{cloudAccountId}
        and ca.MEMBER_ID = #{memberId}
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_CLOUD_ACCOUNT_CAPACITY.xml
> sql统计:复杂19个，简单33个
>
> 使用的关键字：ifnull,count,in,now,CJ_CMP_CLOUD_ACCOUNT_CAPACITY,VALUES,sum
#### sumAliyunCapacityByLdcIds
```

        select sum(ifnull(ecs.CPUS,0)) as vcpu,sum(ifnull(ecs.MEMORY,0)) as memory,count(*) as vmInstance
        from CJ_CMP_ALIYUN_DC dc inner join CJ_CMP_ALIYUN_ECS ecs on ecs.LDC_ID=dc.ID
        where ecs.IS_DELETED=0 and dc.IS_DELETED=0 and ecs.ENTITY_ID is not null
        <if test="memberId != 0">AND ecs.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
             and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumVmwareCapacityByLdcIds
```

        select sum(ifnull(vm.CPUS,0)) as vcpu,sum(ifnull(vm.MEMORY,0)) as memory,count(*) as vmInstance
        from CJ_CMP_VMWARE_DC dc inner join CJ_CMP_VMWARE_VM vm on vm.LDC_ID=dc.ID
        where vm.IS_DELETED=0 AND vm.IS_RECYCLED = 0 and vm.ENTITY_ID is not null
        <if test="memberId != 0">AND vm.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size != 0">
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumFusionCloudCapacityByLdcIds
```

        select sum(ifnull(ecs.CPUS,0)) as vcpu,sum(ifnull(ecs.MEMORY,0)) as memory,count(*) as vmInstance
        from CJ_CMP_FUSION_CLOUD_DC dc inner join CJ_CMP_FUSION_CLOUD_ECS ecs on ecs.LDC_ID=dc.ID
        where ecs.IS_DELETED=0 and ecs.IS_RECYCLED = 0 and dc.IS_DELETED=0 AND ecs.ENTITY_ID is not null
        <if test="memberId != 0">AND ecs.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumCloudosCapacityByLdcIds
```

        select sum(ifnull(ecs.CPUS,0)) as vcpu,sum(ifnull(ecs.MEMORY,0)) as memory,count(*) as vmInstance
        from CJ_CMP_CLOUDOS_DC dc inner join CJ_CMP_CLOUDOS_VM ecs on ecs.LDC_ID=dc.ID
        where ecs.IS_DELETED=0 and ecs.IS_RECYCLED = 0 and dc.IS_DELETED=0 and ecs.ENTITY_ID is not null
        <if test="memberId != 0">AND ecs.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumQingCloudCapacityByLdcIds
```

        select sum(ifnull(vm.CPUS,0)) as vcpu,sum(ifnull(vm.MEMORY,0)) as memory,count(*) as vmInstance
        from CJ_CMDB_CI_QINGCLOUD_DATACENTER dc inner join CJ_CMDB_CI_QINGCLOUD_VM_INSTANCE vm on vm.LDC_ID=dc.ID
        where vm.IS_DELETED=0 and vm.IS_RECYCLED = 0 and dc.IS_DELETED=0 and vm.ENTITY_ID is not null
        <if test="memberId != 0">AND vm.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumQingCloudEcsVolumeByLdcIds
```

        select sum(ifnull(vol.DISK_SPACE,0))
        from CJ_CMDB_CI_QINGCLOUD_DATACENTER dc inner join CJ_CMDB_CI_QINGCLOUD_VM_INSTANCE vm on vm.LDC_ID=dc.ID and vm.IS_DELETED=0
        inner join CJ_CMP_VM_VOLUME vol on vol.VM_DEVICE_ID=vm.ID and vol.SERVICE_ACCOUNT_ID=dc.SERVICE_ACCOUNT_ID
        where vol.IS_DELETED=0
          AND vm.IS_RECYCLED = 0
        <if test="memberId != 0">AND vol.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumFusionAccessCapacityByLdcIds
```

        select sum(ifnull(vm.CPUS,0)) as vcpu,sum(ifnull(vm.MEMORY,0)) as memory,count(*) as vmInstance
        from CJ_CMP_FUSION_ACCESS_DC dc inner join CJ_CMP_FUSION_ACCESS_VM_INSTANCE vm on vm.LDC_ID=dc.ID
        where vm.IS_DELETED=0 and dc.IS_DELETED=0 and vm.ENTITY_ID is not null
        <if test="memberId != 0">AND vm.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumFusionComputeCapacityByLdcIds
```

        select sum(ifnull(vm.CPUS,0)) as vcpu,sum(ifnull(vm.MEMORY,0)) as memory,count(*) as vmInstance
        from CJ_CMP_FUSION_COMPUTE_DC dc inner join CJ_CMP_FUSION_COMPUTE_VM vm on vm.LDC_ID=dc.ID
        where vm.IS_DELETED=0 and dc.IS_DELETED=0 and vm.ENTITY_ID is not null and vm.IS_RECYCLED = 0
        <if test="memberId != 0">AND vm.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumFusionAccessEcsVolumeByLdcIds
```

        select sum(ifnull(vol.DISK_SPACE,0))
        from CJ_CMP_FUSION_ACCESS_DC dc inner join CJ_CMP_FUSION_ACCESS_VM_INSTANCE vm on vm.LDC_ID=dc.ID and vm.IS_DELETED=0
        inner join CJ_CMP_VM_VOLUME vol on vol.VM_DEVICE_ID=vm.ID and vol.SERVICE_ACCOUNT_ID=dc.SERVICE_ACCOUNT_ID
        where vol.IS_DELETED=0
        <if test="memberId != 0">AND vol.MEMBER_ID =#{memberId}</if>
        <if test="memberId != 0">AND vm.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumFusionComputeEcsVolumeByLdcIds
```

        select sum(ifnull(vol.DISK_SPACE,0))
        from CJ_CMP_FUSION_COMPUTE_DC dc inner join CJ_CMP_FUSION_COMPUTE_VM vm on vm.LDC_ID=dc.ID and vm.IS_DELETED=0
        inner join CJ_CMP_VM_VOLUME vol on vol.VM_DEVICE_ID=vm.ID and vol.SERVICE_ACCOUNT_ID=dc.SERVICE_ACCOUNT_ID
        where vol.IS_DELETED=0 and vm.IS_RECYCLED = 0
        <if test="memberId != 0">AND vol.MEMBER_ID =#{memberId}</if>
        <if test="memberId != 0">AND vm.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumAliyunEcsVolumeByLdcIds
```

        select sum(ifnull(vol.DISK_SPACE,0))
        from CJ_CMP_ALIYUN_DC dc inner join CJ_CMP_ALIYUN_ECS ecs on ecs.LDC_ID=dc.ID and ecs.IS_DELETED=0
        inner join CJ_CMP_VM_VOLUME vol on vol.VM_DEVICE_ID=ecs.ID and vol.SERVICE_ACCOUNT_ID=dc.SERVICE_ACCOUNT_ID
        where vol.IS_DELETED=0
        <if test="memberId != 0">AND vol.MEMBER_ID =#{memberId}</if>
        <if test="memberId != 0">AND ecs.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
             and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumVmwareVmVolumeByLdcIds
```

        select sum(ifnull(vol.DISK_SPACE,0))
        from CJ_CMP_VMWARE_DC dc
        inner join CJ_CMP_VMWARE_VM vm on vm.LDC_ID=dc.ID and dc.IS_DELETED=0 and vm.IS_DELETED=0
        inner join CJ_CMP_VM_VOLUME vol on vol.VM_DEVICE_ID=vm.ID and vol.SERVICE_ACCOUNT_ID=dc.SERVICE_ACCOUNT_ID
        where vol.IS_DELETED=0
        AND vm.IS_RECYCLED = 0
        <if test="memberId != 0">AND vol.MEMBER_ID =#{memberId}</if>
        <if test="memberId != 0">AND vm.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size != 0">
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumFusionCloudEcsVolumeByLdcIds
```

        select sum(ifnull(vol.DISK_SPACE,0))
        from CJ_CMP_FUSION_CLOUD_DC dc inner join CJ_CMP_FUSION_CLOUD_ECS ecs on ecs.LDC_ID=dc.ID and ecs.IS_DELETED=0
        inner join CJ_CMP_VM_VOLUME vol on vol.VM_DEVICE_ID=ecs.ID and vol.SERVICE_ACCOUNT_ID=dc.SERVICE_ACCOUNT_ID
        where vol.IS_DELETED=0
          AND ecs.IS_RECYCLED = 0
        <if test="memberId != 0">AND vol.MEMBER_ID =#{memberId}</if>
        <if test="memberId != 0">AND ecs.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumCloudosEcsVolumeByLdcIds
```

        select sum(ifnull(vol.DISK_SPACE,0))
        from CJ_CMP_CLOUDOS_DC dc inner join CJ_CMP_CLOUDOS_VM ecs on ecs.LDC_ID=dc.ID and ecs.IS_DELETED=0
        inner join CJ_CMP_VM_VOLUME vol on vol.VM_DEVICE_ID=ecs.ID and vol.SERVICE_ACCOUNT_ID=dc.SERVICE_ACCOUNT_ID
        where vol.IS_DELETED=0
          AND ecs.IS_RECYCLED = 0
        <if test="memberId != 0">AND vol.MEMBER_ID =#{memberId}</if>
        <if test="memberId != 0">AND ecs.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumOracleOvmCapacityByLdcIds
```

        select sum(ifnull(vm.CPUS,0)) as vcpu,sum(ifnull(vm.MEMORY,0)) as memory,count(*) as vmInstance
        from CJ_CMP_ORACLE_OVM_DC dc inner join CJ_CMP_ORACLE_OVM_VM vm on vm.LDC_ID=dc.ID
        where vm.IS_DELETED=0 and dc.IS_DELETED=0 and vm.ENTITY_ID is not null
        <if test="memberId != 0">AND vm.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumTencentCapacityByLdcIds
```

        select sum(ifnull(cvm.CPU,0)) as vcpu,sum(ifnull(cvm.MEMORY_MB,0)) as memory,count(*) as vmInstance
        from CJ_CMP_TENCENT_DC dc inner join CJ_CMP_TENCENT_CVM cvm on cvm.LDC_ID=dc.ID
        where cvm.IS_DELETED=0 and dc.IS_DELETED=0 and cvm.ENTITY_ID is not null
        <if test="memberId != 0">AND cvm.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumTencentCvmVolumeByLdcIds
```

        select sum(ifnull(vol.DISK_SPACE,0))
        from CJ_CMP_TENCENT_DC dc inner join CJ_CMP_TENCENT_CVM cvm on cvm.LDC_ID=dc.ID and cvm.IS_DELETED=0
        inner join CJ_CMP_VM_VOLUME vol on vol.VM_DEVICE_ID=cvm.ID and vol.SERVICE_ACCOUNT_ID=dc.SERVICE_ACCOUNT_ID
        where vol.IS_DELETED=0
        <if test="memberId != 0">AND vol.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumCASCapacityByLdcIds
```

        select
            sum(ifnull(vm.CPU, 0)) as vcpu,
            sum(ifnull(vm.MEMORY, 0)) as memory,
            count(*) as vmInstance
        from
            CJ_CMP_CAS_VM vm
            left join CJ_CMP_CAS_DC ldc ON ldc.ID = vm.LDC_ID
            left join CJ_CMP_CLOUD_ACCOUNT_DC cdc ON cdc.LDC_ID = ldc.ID
            left join CJ_CMP_CLOUD_ACCOUNT ca ON ca.ID = cdc.CLOUD_ACCOUNT_ID
        where
            vm.IS_DELETED = 0
            and ldc.IS_DELETED = 0
            and cdc.SERVICE_ACCOUNT_ID = ldc.SERVICE_ACCOUNT_ID
            and cdc.IS_DELETED = 0
            and ca.IS_DELETED = 0
            and vm.IS_RECYCLED = 0
            AND vm.ENTITY_ID is not null
            <if test="memberId != 0">AND ca.MEMBER_ID =#{memberId}</if>
            <if test="ldcIds != null and ldcIds.size >0" >
                and ldc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
            </if>
    
```
#### sumCASEcsVolumeByLdcIds
```

        select
               sum(ifnull(vol.DISK_SPACE,0))
        from CJ_CMP_CAS_DC dc inner join CJ_CMP_CAS_VM ecs on ecs.LDC_ID=dc.ID
                                                                  and ecs.IS_DELETED=0
        inner join CJ_CMP_VM_VOLUME vol on vol.VM_DEVICE_ID=ecs.ID
                                               and vol.SERVICE_ACCOUNT_ID=dc.SERVICE_ACCOUNT_ID
        where vol.IS_DELETED=0
          AND ecs.IS_RECYCLED = 0
        <if test="memberId != 0">AND vol.MEMBER_ID =#{memberId}</if>
        <if test="memberId != 0">AND ecs.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_CLOUD_ACCOUNT_DC.xml
> sql统计:复杂1个，简单31个
>
> 使用的关键字：if,concat,and,now,CJ_CMP_CLOUD_ACCOUNT_DC,VALUES,on
#### getDcList
```

        <choose>
            <when test="ldcType != null and ldcType == 'fusionCloud'">
                select if(sa.PARENT_ID is null, sa.ID, sa.PARENT_ID) AS serviceAccountId, if(parentSa.NAME is not null, parentSa.NAME, sa.NAME) AS serviceAccountName, ca.ID as cloudAccountId,ca.NAME as cloudAccountName,
                dc.ID as ldcId, if(vdc.NAME is null, dc.NAME, concat(dc.NAME, '(', vdc.NAME, ')')) as ldcName, dc.ENTITY_ID as ldcEntityId,dc.LAST_DISCOVERED as lastDiscovered
                from CJ_CMP_SERVICE_ACCOUNT sa
                left join CJ_CMP_SERVICE_ACCOUNT parentSa on parentSa.ID = sa.PARENT_ID and parentSa.IS_DELETED = 0
                inner join CJ_CMP_DC_VIEW dc on dc.SERVICE_ACCOUNT_ID = sa.ID
                left join CJ_CMP_CLOUD_ACCOUNT_DC cdc on cdc.LDC_ID = dc.ID and cdc.LDC_TYPE = dc.LDC_TYPE and cdc.IS_DELETED=0
                left join CJ_CMP_FUSION_CLOUD_VDC vdc on dc.VDC_ID = vdc.ID and vdc.IS_DELETED = 0
                left join CJ_CMP_CLOUD_ACCOUNT ca on cdc.CLOUD_ACCOUNT_ID=ca.ID and ca.IS_DELETED=0
            </when>
            <when test="ldcType != null and ldcType == 'huaweiObs'">
                select sa.ID AS serviceAccountId, sa.NAME AS serviceAccountName, ca.ID as cloudAccountId,ca.NAME as cloudAccountName,
                cdc.LDC_ID as ldcId,'-' as ldcName, '-' as ldcEntityId,cdc.CREATE_DATE as lastDiscovered
                from CJ_CMP_SERVICE_ACCOUNT sa
                inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc on cdc.SERVICE_ACCOUNT_ID=sa.ID and cdc.IS_DELETED=0 and sa.DATACENTER_TYPE='huaweiObs'
                left outer join CJ_CMP_CLOUD_ACCOUNT ca on cdc.CLOUD_ACCOUNT_ID=ca.ID and ca.IS_DELETED=0
            </when>
            <otherwise>
                select sa.ID AS serviceAccountId, sa.NAME AS serviceAccountName, ca.ID as cloudAccountId,ca.NAME as cloudAccountName,
                dc.ID as ldcId,dc.NAME as ldcName, dc.ENTITY_ID as ldcEntityId,dc.LAST_DISCOVERED as lastDiscovered
                from CJ_CMP_SERVICE_ACCOUNT sa
                inner join CJ_CMP_DC_VIEW dc on dc.SERVICE_ACCOUNT_ID=sa.ID and sa.IS_DELETED=0
                left outer join CJ_CMP_CLOUD_ACCOUNT_DC cdc on cdc.SERVICE_ACCOUNT_ID=sa.ID and cdc.IS_DELETED=0 and cdc.LDC_ID=dc.ID
                left outer join CJ_CMP_CLOUD_ACCOUNT ca on cdc.CLOUD_ACCOUNT_ID=ca.ID and ca.IS_DELETED=0
            </otherwise>
        </choose>
        <where>
        <if test="ids != null and ids.size > 0 ">
            and (sa.ID in <foreach collection="ids" item="id" open="(" close=")" separator=",">#{id}</foreach>
            or sa.PARENT_ID in <foreach collection="ids" item="id" open="(" close=")" separator=",">#{id}</foreach>)
        </if>
        <if test="cloudAccountId != null and cloudAccountId != ''"> and ca.ID=#{cloudAccountId}</if>
        <if test="vdcId != null and vdcId != ''"> and dc.VDC_ID=#{vdcId}</if>
        </where>
        order by serviceAccountName, ldcName
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_CLOUD_ACCOUNT_DISCOVERY.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：now,CJ_CMP_CLOUD_ACCOUNT_DISCOVERY,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_CLOUD_AZ.xml
> sql统计:复杂2个，简单13个
>
> 使用的关键字：round,if,in,concat,now,NOW,COALESCE,and,size,GROUP_CONCAT,sum,CJ_CMP_CLOUD_AZ,VALUES
#### queryAz
```

        select distinct az.ID, az.NAME, az.ENTITY_ID, az.SHORT_DESCRIPTION,
        null,
        cdc.LDC_TYPE,
        COALESCE(alidc.ENTITY_ID, sdc.ENTITY_ID, qdc.ENTITY_ID, tdc.ENTITY_ID) as ldcEntityId,
        COALESCE(alidc.NAME, sdc.NAME, qdc.NAME,tdc.NAME) as ldcName,
        sa.NAME      as serviceAccountName,
        sa.ID        as serviceAccountId,
        null as cpuSum,
        null as cpuUsed,
        null as memorySum,
        null as memoryUsed,
        null as cpuUsage,
        null as memoryUsage
        from CJ_CMP_SERVICE_ACCOUNT sa
        inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc on sa.ID = cdc.SERVICE_ACCOUNT_ID and sa.IS_DELETED = 0 and cdc.IS_DELETED = 0 and sa.DATACENTER_TYPE != 'fusionCloud'
        inner join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED = 0
        left outer join CJ_CMP_ALIYUN_DC alidc on cdc.LDC_ID = alidc.ID and alidc.IS_DELETED = 0 and alidc.SERVICE_ACCOUNT_ID=sa.ID
        left outer join CJ_CMP_TENCENT_DC tdc on cdc.LDC_ID = tdc.ID and tdc.IS_DELETED = 0 and tdc.SERVICE_ACCOUNT_ID=sa.ID
        left outer join CJ_CMP_CLOUDOS_DC sdc on sdc.ID = cdc.LDC_ID and sdc.IS_DELETED = 0 and sdc.SERVICE_ACCOUNT_ID=sa.ID
        left outer join CJ_CMDB_CI_QINGCLOUD_DATACENTER qdc on qdc.ID = cdc.LDC_ID and qdc.IS_DELETED = 0 and qdc.SERVICE_ACCOUNT_ID=sa.ID
        inner join CJ_CMP_CLOUD_AZ az on cdc.LDC_ID = az.LDC_ID and az.LDC_TYPE = cdc.LDC_TYPE and az.IS_DELETED = 0
        where az.IS_DELETED=0
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>
        <if test="azId != null and azId != ''"> and az.ID=#{azId}</if>
        <if test="serviceAccountId != null and serviceAccountId != ''"> and sa.ID=#{serviceAccountId}</if>
        <if test="cloudAccountId != null and cloudAccountId != ''"> and ca.ID=#{cloudAccountId}</if>
        <if test="ldcId != null and ldcId != ''"> and cdc.LDC_ID=#{ldcId}</if>
        <if test="ldcType != null and ldcType != ''"> and cdc.LDC_TYPE=#{ldcType}</if>
        <if test="searchKey != null and searchKey != ''"> and (az.NAME like #{searchKey} or az.ENTITY_ID like #{searchKey})</if>
        <if test="name != null and name != ''"> and az.NAME like #{name}</if>
        <if test="ldcIds != null and ldcIds.size()>0">
           and cdc.LDC_ID IN <foreach collection="ldcIds" item="ldc" open="(" separator="," close=")"> #{ldc} </foreach>
        </if>
        union all
        select az.ID, az.NAME, az.ENTITY_ID, az.SHORT_DESCRIPTION,
        null,
        cdc.LDC_TYPE,
        GROUP_CONCAT(distinct fdc.ENTITY_ID) as ldcEntityId,
        GROUP_CONCAT(distinct fdc.NAME) as ldcName,
        sa.NAME      as serviceAccountName,
        sa.ID        as serviceAccountId,
        sum(host.CPUS)                                as cpuSum,
        sum(host.CPU_USED)                            as cpuUsed,
        sum(host.MEMORY_SUM) / 1024                   as memorySum,
        sum(host.MEMORY_USED) / 1024                  as memoryUsed,
        round((sum(host.CPU_USED) / sum(host.CPUS)) * 100 , 2) as cpuUsage,
        round((sum(host.MEMORY_USED) / sum(host.MEMORY_SUM)) * 100, 2)  as memoryUsage
        from CJ_CMP_SERVICE_ACCOUNT sa
        inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc on sa.ID = cdc.SERVICE_ACCOUNT_ID and sa.IS_DELETED = 0 and cdc.IS_DELETED = 0
        inner join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED = 0 and cdc.LDC_TYPE='fusionCloud'
        inner join CJ_CMP_FUSION_CLOUD_DC fdc on fdc.ID = cdc.LDC_ID and fdc.IS_DELETED = 0
        inner join CJ_CMP_FUSION_CLOUD_DC_X_AZ rel on rel.LDC_ID = fdc.ID
        left outer join CJ_CMP_CLOUD_AZ az on rel.AZ_ID = az.ID and az.LDC_TYPE ='fusionCloud' and az.IS_DELETED = 0
        left outer join CJ_CMP_FUSION_CLOUD_HOST host on host.ZONE_ID = az.ID
        where az.IS_DELETED=0
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>
        <if test="azId != null and azId != ''"> and az.ID=#{azId}</if>
        <if test="serviceAccountId != null and serviceAccountId != ''"> and sa.ID=#{serviceAccountId}</if>
        <if test="cloudAccountId != null and cloudAccountId != ''"> and ca.ID=#{cloudAccountId}</if>
        <if test="ldcId != null and ldcId != ''"> and cdc.LDC_ID=#{ldcId}</if>
        <if test="ldcType != null and ldcType != ''"> and cdc.LDC_TYPE=#{ldcType}</if>
        <if test="searchKey != null and searchKey != ''"> and (az.NAME like #{searchKey} or az.ENTITY_ID like #{searchKey})</if>
        <if test="name != null and name != ''"> and az.NAME like #{name}</if>
        <if test="ldcIds != null and ldcIds.size()>0">
           and cdc.LDC_ID IN <foreach collection="ldcIds" item="ldc" open="(" separator="," close=")"> #{ldc} </foreach>
        </if>
        group by az.ID, sa.ID
        <if test="sortField != null and sortField!= '' and sortType != null and sortType!= '' ">
            <choose>
                <when test="sortField == 'cpuUsage' or sortField == 'memoryUsage' or sortField == 'localStorageUsage'">
                    ORDER BY ${sortField} ${sortType}
                </when>
                <otherwise>
                    order by NAME
                </otherwise>
            </choose>
        </if>
        <if test="sortField == null or sortType == null ">
            order by NAME
        </if>
    
```
#### queryFusionCloudRegionAz
```

        select az.ID,
        az.NAME,
        az.ENTITY_ID,az.CPU_ARCH,az.TYPE,
        cdc.LDC_ID,
        cdc.LDC_TYPE,
        dc.ENTITY_ID as ldcEntityId,
        if(vdc.NAME is null, dc.NAME, concat(dc.NAME, '(', vdc.NAME, ')')) as ldcName,
        sa.NAME      as serviceAccountName,
        sa.ID        as serviceAccountId
        from CJ_CMP_SERVICE_ACCOUNT sa
        inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc on sa.ID = cdc.SERVICE_ACCOUNT_ID and sa.IS_DELETED = 0 and cdc.IS_DELETED = 0
        inner join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED = 0 and cdc.LDC_TYPE='fusionCLoud'
        left join CJ_CMP_FUSION_CLOUD_DC dc on cdc.LDC_ID = dc.ID and dc.IS_DELETED = 0
        left join CJ_CMP_FUSION_CLOUD_VDC vdc on dc.VDC_ID = vdc.ID and vdc.IS_DELETED = 0
        inner join CJ_CMP_FUSION_CLOUD_DC_X_AZ rel on rel.LDC_ID = cdc.LDC_ID
        inner join CJ_CMP_CLOUD_AZ az on rel.AZ_ID=az.ID
        where dc.IS_DELETED=0 and cdc.CLOUD_ACCOUNT_ID=#{cloudAccountId} and az.NAME != 'manage-az'
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>
        <if test="azNotNull != null and azNotNull"> and az.ID is not null</if>
        order by dc.NAME,az.NAME
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_CLOUD_AZ_GROUP.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：CONCAT,NOW,CJ_CMP_CLOUD_AZ_GROUP,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_CLOUD_AZ_GROUP_MANAGE.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：NOW,CJ_CMP_CLOUD_AZ_GROUP_MANAGE,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_CLUSTER_AZ_VIEW.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_DATASTORE_DAY_REPORT.xml
> sql统计:复杂2个，简单2个
>
> 使用的关键字：DATE_FORMAT,FROM,and,ifnull,sum,in,DATE,CJ_CMP_DATASTORE_DAY_REPORT,values
#### groupBySaAndTime
```

        SELECT
        ifnull(sum(store.DISK_SUM), 0)           AS num,
        DATE_FORMAT(store.STAT_TIME, #{dateFormat}) AS days
        FROM (SELECT
        report.DISK_SUM,
        report.STAT_TIME,
        report.PROVIDER,
        report.ID,
        report.SERVICE_ACCOUNT_ID
        FROM CJ_CMP_DATASTORE_DAY_REPORT report
        inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc on report.LDC_ID = cdc.LDC_ID and report.SERVICE_ACCOUNT_ID = cdc.SERVICE_ACCOUNT_ID and cdc.IS_DELETED = 0
        inner join CJ_CMP_CLOUD_ACCOUNT ca on cdc.CLOUD_ACCOUNT_ID = ca.ID and ca.IS_DELETED = 0
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>
        WHERE report.SERVICE_ACCOUNT_ID in (select ID from CJ_CMP_SERVICE_ACCOUNT where IS_DELETED = 0)
        GROUP BY STAT_TIME, PROVIDER, ID, SERVICE_ACCOUNT_ID) store
        <where>
            <if test="serviceAccountId != null and serviceAccountId != ''">
               and store.SERVICE_ACCOUNT_ID = #{serviceAccountId}
            </if>
            <if test="provider != null and provider != ''">
                and store.PROVIDER=#{provider}
            </if>
            <if test="startTime != null and endTime != null ">
                and (store.STAT_TIME &gt;= DATE(#{startTime}) AND store.STAT_TIME &lt;= DATE(#{endTime}))
            </if>
        </where>
        GROUP BY days
        ORDER BY days asc
    
```
#### getTotalBySaAndTime
```

        SELECT
            ifnull(sum( DISK_SUM ),0) as num
        FROM
        CJ_CMP_DATASTORE_DAY_REPORT report
        INNER JOIN CJ_CMP_SERVICE_ACCOUNT sa ON sa.ID = report.SERVICE_ACCOUNT_ID
        INNER JOIN CJ_CMP_CLOUD_ACCOUNT_DC cdc on report.LDC_ID = cdc.LDC_ID and report.SERVICE_ACCOUNT_ID = cdc.SERVICE_ACCOUNT_ID and cdc.IS_DELETED = 0
        INNER JOIN CJ_CMP_CLOUD_ACCOUNT ca on cdc.CLOUD_ACCOUNT_ID = ca.ID and ca.IS_DELETED = 0
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>
        AND sa.IS_DELETED = 0
        WHERE
        STAT_TIME = DATE(#{statTime})
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_DAY_REPORT.xml
> sql统计:复杂1个，简单15个
>
> 使用的关键字：CJ_CMP_FUSION_CLOUD_DC_X_AZ_DAY_REPORT,CJ_CMP_PROJECT_DAY_REPORT,CJ_CMP_CLOUD_ACCOUNT_DAY_REPORT,CJ_CMP_APP_SYSTEM_DAY_REPORT,CJ_CMDB_CI_TKE_CLUSTER_DAY_REPORT,CJ_CMP_KUBERNETES_NODE_DAY_REPORT,CJ_CMP_KUBERNETES_DEPLOYMENT_DAY_REPORT,CJ_CMP_KUBERNETES_DAEMON_SET_DAY_REPORT,ifnull,CJ_CMP_CLOUD_AZ_DAY_REPORT,sum,CJ_CMP_LDC_DAY_REPORT,CJ_CMP_VM_DAY_REPORT,join,in,CJ_CMP_FUSION_CCE_CLUSTER_DAY_REPORT,CJ_CMP_KUBERNETES_STATEFUL_SET_DAY_REPORT,CJ_CMP_SERVICE_ACCOUNT_DAY_REPORT,CJ_CMP_PM_DAY_REPORT
#### batchInsertVmDayReport
```

        INSERT INTO CJ_CMP_VM_DAY_REPORT (STAT_TIME, VM_ID, MEMBER_ID, CPUS, DUE, IP, SPEC_ID, MANAGED_BY, MEMORY, DISK_SUM, NAME, PROJECT_ID, APP_SYSTEM_ID, APP_SUB_SYSTEM_ID, APP_DU_ID, SERVICE_ACCOUNT_ID, OWNED_BY, SN, INSTALL_STATUS, ENTITY_ID, OS, OS_FAMILY, HOST_ID, RUN_STATUS, HOSTNAME, CLOUD_ACCOUNT_ID, CLOUD_ACCOUNT_NAME, LDC_TYPE, LDC_ID, LDC_NAME, LDC_ENTITY_ID, CLUSTER_NAME, CLUSTER_ENTITY_ID, ZONE_NAME, ZONE_ENTITY_ID, IMAGE_NAME, IMAGE_ENTITY_ID, HOST_ENTITY_NAME, HOST_ENTITY_ID, HOST_IP, SPEC_ENTITY_ID, SPEC_NAME, TYPE, CREATE_BY, CREATE_DATE, LAST_MODIFIED_BY, LAST_MODIFIED_DATE)
          select #{statTime},ID, MEMBER_ID, CPUS, DUE, IP, SPEC_ID, MANAGED_BY, MEMORY,vol.DISK_SUM ,NAME, PROJECT_ID, APP_SYSTEM_ID, APP_SUB_SYSTEM_ID, APP_DU_ID, SERVICE_ACCOUNT_ID, OWNED_BY, SN, INSTALL_STATUS, ENTITY_ID, OS, OS_FAMILY, HOST_ID, RUN_STATUS, HOSTNAME, CLOUD_ACCOUNT_ID, CLOUD_ACCOUNT_NAME, LDC_TYPE, LDC_ID, LDC_NAME, LDC_ENTITY_ID, CLUSTER_NAME, CLUSTER_ENTITY_ID, ZONE_NAME, ZONE_ENTITY_ID, IMAGE_NAME, IMAGE_ENTITY_ID, HOST_ENTITY_NAME, HOST_ENTITY_ID, HOST_IP, SPEC_ENTITY_ID, SPEC_NAME, TYPE, null, CREATE_DATE, null, LAST_MODIFIED_DATE from cj_cmp_vm_view vm left outer join (select SERVICE_ACCOUNT_ID as saId,VM_DEVICE_ID as vmId,sum(ifnull(DISK_SPACE,0)) DISK_SUM from CJ_CMP_VM_VOLUME where IS_DELETED=0 group by SERVICE_ACCOUNT_ID,VM_DEVICE_ID) vol on vol.saId=SERVICE_ACCOUNT_ID and vol.vmId=vm.ID;
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_DC_VIEW.xml
> sql统计:复杂1个，简单4个
>
> 使用的关键字：if,concat,AND
#### getDataCenterByServiceAccountId
```

        select dc.ID, if(vdc.NAME is null, dc.NAME, concat(dc.NAME, '(', vdc.NAME, ')')) as NAME, dc.SERVICE_ACCOUNT_ID, dc.ENTITY_ID,
               account.ID AS CLOUD_ACCOUNT_DC_ID, account.CLOUD_ACCOUNT_ID,dc.ID as LDC_ID, sa.DATACENTER_TYPE as LDC_TYPE
        from CJ_CMP_DC_VIEW dc inner join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID=dc.SERVICE_ACCOUNT_ID and sa.IS_DELETED=0
        left join CJ_CMP_FUSION_CLOUD_VDC vdc on dc.VDC_ID = vdc.ID and vdc.IS_DELETED = 0
        left outer join CJ_CMP_CLOUD_ACCOUNT_DC account ON dc.ID = account.LDC_ID and sa.ID=account.SERVICE_ACCOUNT_ID and account.IS_DELETED=0
        WHERE sa.DATACENTER_TYPE  =#{dcType} AND (sa.ID =#{serviceAccountId} or sa.PARENT_ID = #{serviceAccountId})
        <if test="cloudAccountId!='' and cloudAccountId != null">
            AND account.CLOUD_ACCOUNT_ID = #{cloudAccountId}
        </if>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_DEV_X_NETWORK.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_ENV_BACKUP_INFO.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：now,CJ_CMP_ENV_BACKUP_INFO,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_ENV_BACKUP_RECORD.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：values,now,CJ_CMP_ENV_BACKUP_RECORD

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_F5_DEVICE.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：values,CONCAT,now,NOW,CJ_CMP_F5_DEVICE

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_F5_DEVICE_GROUP.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：NOW,CJ_CMP_F5_DEVICE_GROUP,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_F5_MONITOR.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：CJ_CMP_F5_MONITOR,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_F5_NODE.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：now,NOW,CJ_CMP_F5_NODE,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_F5_PARTITION.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CMP_F5_PARTITION,values,now,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_F5_POOL.xml
> sql统计:复杂1个，简单6个
>
> 使用的关键字：values,where,in,group_concat,now,NOW,CJ_CMP_F5_POOL
#### queryList
```

        select pool.*, sa.DATACENTER_TYPE as serviceAccountType ,part.NAME as partitionName, device.NAME as deviceName, group_concat(deviceGroup.NAME) as deviceGroupName
        from CJ_CMP_F5_POOL pool LEFT JOIN CJ_CMP_F5_PARTITION part on pool.PARTITION_ID = part.ID AND pool.SERVICE_ACCOUNT_ID = part.SERVICE_ACCOUNT_ID and part.IS_DELETED = 0
        and pool.MEMBER_ID = part.MEMBER_ID
        inner join CJ_CMP_F5_DEVICE device on pool.DEVICE_ID = device.ID
        inner join CJ_CMP_SERVICE_ACCOUNT sa on pool.SERVICE_ACCOUNT_ID = sa.ID
        left join CJ_CMP_F5_DEVICE_GROUP_X_DEVICE rel on pool.DEVICE_ID = rel.DEVICE_ID
        left join CJ_CMP_F5_DEVICE_GROUP deviceGroup on rel.DEVICE_GROUP_ID = deviceGroup.ID
        WHERE pool.IS_DELETED = 0
        <if test="id != null and id !=''">
            and  pool.ID =#{id}
        </if>
        <if test="serviceAccountId != null and serviceAccountId !=''">
            and  pool.SERVICE_ACCOUNT_ID =#{serviceAccountId}
        </if>
        <if test="deviceId != null and deviceId !=''">
            and  pool.DEVICE_ID =#{deviceId}
        </if>
        <if test="partitionId != null and partitionId !=''">
            and  pool.PARTITION_ID =#{partitionId}
        </if>
        group by pool.ID, part.NAME, device.NAME
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_F5_POOL_MEMBER.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CMP_F5_POOL_MEMBER,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_F5_PROFILE.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：CJ_CMP_F5_PROFILE,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_F5_SNAT_POOL.xml
> sql统计:复杂1个，简单6个
>
> 使用的关键字：group_concat,now,CJ_CMP_F5_SNAT_POOL,values
#### list
```

    select pool.*, part.NAME as partitionName, device.NAME as deviceName, group_concat(deviceGroup.NAME) as deviceGroupName from CJ_CMP_F5_SNAT_POOL pool
      left join CJ_CMP_F5_PARTITION part on pool.PARTITION_ID = part.ID
      inner join CJ_CMP_F5_DEVICE device on pool.DEVICE_ID = device.ID
      left join CJ_CMP_F5_DEVICE_GROUP_X_DEVICE rel on pool.DEVICE_ID = rel.DEVICE_ID
      left join CJ_CMP_F5_DEVICE_GROUP deviceGroup on rel.DEVICE_GROUP_ID = deviceGroup.ID
    where pool.IS_DELETED = 0
    <if test="serviceAccountId != null and serviceAccountId !=''">
      and  pool.SERVICE_ACCOUNT_ID =#{serviceAccountId}
    </if>
    <if test="deviceId != null and deviceId !=''">
      and  pool.DEVICE_ID =#{deviceId}
    </if>
    group by pool.ID, part.NAME, device.NAME
  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_F5_SNAT_POOL_MEMBER.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：CJ_CMP_F5_SNAT_POOL_MEMBER,values,in,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_F5_VS.xml
> sql统计:复杂1个，简单11个
>
> 使用的关键字：group_concat,CJ_CMP_F5_VS,values,where,in,count,DATE,now,NOW
#### queryList
```

        select vs.*, ip.IP as ip, part.NAME as partitionName, device.NAME as deviceName, group_concat(deviceGroup.NAME) as deviceGroupName
        from CJ_CMP_F5_VS vs INNER JOIN CJ_CMP_F5_VS_IP ip ON vs.ID = ip.VIRTUAL_SERVER_ID LEFT JOIN CJ_CMP_F5_PARTITION part on part.ID = vs.PARTITION_ID
        inner join CJ_CMP_F5_DEVICE device on vs.DEVICE_ID = device.ID
        left join CJ_CMP_F5_DEVICE_GROUP_X_DEVICE rel on vs.DEVICE_ID = rel.DEVICE_ID
        left join CJ_CMP_F5_DEVICE_GROUP deviceGroup on rel.DEVICE_GROUP_ID = deviceGroup.ID
        WHERE  vs.IS_DELETED = 0
        <if test="serviceAccountId != null and serviceAccountId !=''">
          and  vs.SERVICE_ACCOUNT_ID =#{serviceAccountId}
        </if>
        <if test="deviceId != null and deviceId !=''">
          and  vs.DEVICE_ID =#{deviceId}
        </if>
        <if test="snatPoolId != null and snatPoolId !=''">
            and  vs.SNAT_POOL_ID =#{snatPoolId}
        </if>
        group by vs.ID, ip.ip, part.NAME, device.NAME
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_FROZEN_RESOURCE_MAPPER.xml
> sql统计:复杂1个，简单4个
>
> 使用的关键字：ifnull,sum,now,CJ_CMP_FROZEN_RESOURCE,values
#### selectByFrozenResourceByType
```

    select
    ifnull(sum(ifnull(frozen.CPU,0)),0) as cpu,
    ifnull(sum(ifnull(frozen.MEMORY,0)),0) as memory,
    ifnull(sum(ifnull(frozen.STORAGE,0)),0) as storage,
    ifnull(sum(ifnull(frozen.VM_INSTANCE,0)),0) as vmInstance,
    ifnull(sum(ifnull(frozen.PM_INSTANCE,0)),0) as pmInstance
    from CJ_CMP_FROZEN_RESOURCE frozen where FROZEN_RESOURCE_ID = #{frozenResourceId} and FROZEN_RESOURCE_TYPE = #{frozenResourceType} and MEMBER_ID = #{memberId} and IS_DELETED = 0
  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_FUSIONCLOUD_DC.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_ACCESS_CLUSTER.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：values,and,size,now,CJ_CMP_FUSION_ACCESS_CLUSTER

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_ACCESS_DATASTORE.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：now,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_ACCESS_DC.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：now,CJ_CMP_FUSION_ACCESS_DC,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_ACCESS_DESKTOP.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：now,CJ_CMP_FUSION_ACCESS_DESKTOP,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_ACCESS_DESKTOP_GROUP.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：now,CJ_CMP_FUSION_ACCESS_DESKTOP_GROUP,values,count,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_ACCESS_DOMAIN.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：and,count,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_ACCESS_DOMAIN_OU.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：now,CJ_CMP_FUSION_ACCESS_DOMAIN_OU,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_ACCESS_PORT_GROUP.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：and,now,CJ_CMP_FUSION_ACCESS_PORT_GROUP,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_ACCESS_RESOURCE_GROUP.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：and,now,CJ_CMP_FUSION_ACCESS_RESOURCE_GROUP,values,count

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_ACCESS_SECURITY_GROUP.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：CJ_CMP_FUSION_ACCESS_SECURITY_GROUP,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_ACCESS_VMNAME_POLICY.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：now,CJ_CMP_FUSION_ACCESS_VMNAME_POLICY,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_ACCESS_VM_INSTANCE.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：from,count,NOW,CJ_CMP_FUSION_ACCESS_VM_INSTANCE,and,in,JOIN,sum,now,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_ACCESS_VM_USER.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：now,CJ_CMP_FUSION_ACCESS_VM_USER,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CCE_CLUSTER.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：values,and,now,NOW,CJ_CMP_FUSION_CCE_CLUSTER

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CCE_DC.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：NOW,CJ_CMP_FUSION_CCE_DC,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CLOUD_BMS_FLAVOR.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：VALUES,now,CJ_CMP_FUSION_CLOUD_BMS_FLAVOR

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CLOUD_BMS_INSTANCE.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：now,CJ_CMP_FUSION_CLOUD_BMS_INSTANCE,VALUES,on,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CLOUD_ECS.xml
> sql统计:复杂1个，简单30个
>
> 使用的关键字：sum,now,NOW,and,GROUP_CONCAT,if,count,in
#### getAllByCondition
```

        select ecs.*,prj.CODE as projectCode,prj.NAME as projectName,prj.PROJECT_SOURCE_ID as projectSourceId,
        app.CODE as appSystemCode,app.NAME as appSystemName,app.SOURCE_ID as appSystemSourceId, GROUP_CONCAT(tag.NAME) as tags
        from CJ_CMP_FUSION_CLOUD_ECS ecs
          <if test="srvCompletionTimeStart!=null or srvCompletionTimeEnd!=null ">
          left outer join CJ_CMP_RITM_COMPLETED_VIEW req on ecs.SRV_NO=req.NUMBER
          </if>
          left outer join CJ_CMP_PROJECT prj on prj.ID=ecs.PROJECT_ID
          left outer join CJ_CMP_APP_SYSTEM app on app.ID=ecs.APP_SYSTEM_ID
          left outer join CJ_CMP_APP_DU du on du.ID=ecs.APP_DU_ID
          left outer join CJ_CMP_TAG_X_OBJECT txo on ecs.ID = txo.OBJECT_ID and txo.OBJECT_TYPE = 'fusionCloud'
          left outer join CJ_CMP_TAG tag on tag.ID = txo.TAG_ID and tag.IS_DELETED = 0
        <where>
            <if test="memberId != 0"> and ecs.MEMBER_ID = #{memberId}</if>
            <if test="startTime!=null and  endTime!=null ">
                and ecs.CREATE_DATE between #{startTime,jdbcType= TIMESTAMP} and  #{endTime,jdbcType= TIMESTAMP}
            </if>
            <if test="startTime==null   and  endTime!=null ">
                and ecs.CREATE_DATE &lt;=  #{endTime,jdbcType= TIMESTAMP}
            </if>
            <if test="startTime!=null  and  endTime==null ">
                and ecs.CREATE_DATE &gt;=  #{startTime,jdbcType= TIMESTAMP}
            </if>
            <if test="srvCompletionTimeStart!=null and srvCompletionTimeEnd!=null ">
                and if(ecs.IS_DELETED=1,ecs.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) between #{srvCompletionTimeStart,jdbcType= TIMESTAMP} and  #{srvCompletionTimeEnd,jdbcType= TIMESTAMP}
            </if>
            <if test="srvCompletionTimeStart==null and srvCompletionTimeEnd!=null ">
                and if(ecs.IS_DELETED=1,ecs.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) &lt;=  #{srvCompletionTimeEnd,jdbcType= TIMESTAMP}
            </if>
            <if test="srvCompletionTimeStart!=null and srvCompletionTimeEnd==null ">
                and if(ecs.IS_DELETED=1,ecs.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) &gt;=  #{srvCompletionTimeStart,jdbcType= TIMESTAMP}
            </if>
            <if  test="isDeleted != null ">
                <choose>
                    <when test="isDeleted">
                        and ecs.IS_DELETED=1
                    </when>
                    <otherwise>
                        and ecs.IS_DELETED=0
                    </otherwise>
                </choose>
            </if>
        </where>
        GROUP BY ecs.ID
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CLOUD_HOST.xml
> sql统计:复杂3个，简单7个
>
> 使用的关键字：sum,round,if,NOW,group_concat,and,in,count
#### queryHost
```

        select host.ID,host.NAME ,host.IP,host.ENTITY_ID,host.CPUS,host.CPU_USED,host.SN,host.VIRTUAL_CPU_TOTAL,host.VIRTUAL_MEMORY_MB_TOTAL,host.MEMORY_SUM, host.MEMORY_USED,host.VIRTUAL_MEMORY_MB_USED, host.MEMORY_PROVISIONED, host.DISK_PROVISIONED,host.DISK_SUM,host.DISK_USED,host.STATUS,host.RUN_STATUS , group_concat(distinct az.NAME) as zoneName, cdc.LDC_TYPE, group_concat(distinct dc.NAME) as ldcName, ca.ID as cloudAccountId,ca.NAME AS cloudAccountName,sa.NAME AS serviceAccountName, sa.ID AS serviceAccountId
        from CJ_CMP_CLOUD_ACCOUNT ca
        inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc on ca.ID=cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED=0 and cdc.LDC_TYPE='fusionCloud'
        inner join CJ_CMP_FUSION_CLOUD_DC dc on cdc.LDC_ID=dc.ID and cdc.IS_DELETED=0 and dc.IS_DELETED=0
        INNER JOIN CJ_CMP_SERVICE_ACCOUNT sa ON cdc.SERVICE_ACCOUNT_ID = sa.ID AND sa.IS_DELETED=0
        inner join CJ_CMP_FUSION_CLOUD_DC_X_AZ rel on rel.LDC_ID = cdc.LDC_ID 
        inner join CJ_CMP_CLOUD_AZ az on az.ID=rel.AZ_ID and az.IS_DELETED = 0 and az.NAME != 'manage-az'
        inner join CJ_CMP_FUSION_CLOUD_HOST host on host.ZONE_ID=az.ID and host.IS_DELETED=0
        <where>
            <choose>
                <when test="memberId != 0">
                    and ca.MEMBER_ID = #{memberId}
                </when>
                <otherwise>
                    and ca.SCOPE = 'public'
                </otherwise>
            </choose>
            <if test="id != null and id != ''"> and host.ID=#{id}</if>
            <if test="serviceAccountId != null and serviceAccountId != ''"> and cdc.SERVICE_ACCOUNT_ID=#{serviceAccountId}</if>
            <if test="cloudAccountId != null and cloudAccountId != ''"> and ca.ID=#{cloudAccountId}</if>
            <if test="ldcId != null and ldcId != ''"> and dc.ID=#{ldcId}</if>
            <if test="name != null and name != ''"> and host.NAME like #{name}</if>
            <if test="ip != null and ip != ''"> and host.IP like #{ip}</if>
            <if test="searchKey != null and searchKey != ''"> and (host.NAME like #{searchKey} or host.IP like #{searchKey} or host.ENTITY_ID like #{searchKey})</if>
        </where>
        group by host.ID,host.NAME,host.IP,host.ENTITY_ID,host.CPUS,host.CPU_USED,host.VIRTUAL_MEMORY_MB_TOTAL,host.MEMORY_SUM, host.MEMORY_USED,host.VIRTUAL_MEMORY_MB_USED,host.DISK_SUM,host.DISK_USED,host.STATUS,host.RUN_STATUS, cdc.LDC_TYPE,ca.ID,ca.NAME,sa.NAME, sa.ID
    
```
#### statisticHostByServiceAccoutId
```

        select
            count(0)                                                                                      as hostSum,
            sum(host.CPUS)                                                                                as cpus,
            sum(host.CPU_USED)                                                                            as cpuUsed,
            round(if(sum(host.CPUS) = 0, 0, sum(host.CPU_USED) / sum(host.CPUS)), 2) * 100                as cpuUsage,
            sum(host.VIRTUAL_MEMORY_MB_USED)                                                                         as memoryUsed,
            sum(host.VIRTUAL_MEMORY_MB_TOTAL)                                                                          as memorySum,
            round(if(sum(host.VIRTUAL_MEMORY_MB_TOTAL) = 0, 0, sum(host.VIRTUAL_MEMORY_MB_USED) / sum(host.VIRTUAL_MEMORY_MB_TOTAL)), 2) * 100 as memoryUsage
        from CJ_CMP_FUSION_CLOUD_HOST host
        where SERVICE_ACCOUNT_ID = #{serviceAccountId} AND IS_DELETED = 0;
    
```
#### statisticHostByCloudAccoutId
```

        select
            count(0)                                                                                      as hostSum,
            sum(host.CPUS)                                                                                as cpus,
            sum(host.CPU_USED)                                                                            as cpuUsed,
            round(if(sum(host.CPUS) = 0, 0, sum(host.CPU_USED) / sum(host.CPUS)), 2) * 100                as cpuUsage,
            sum(host.VIRTUAL_MEMORY_MB_USED)                                                                         as memoryUsed,
            sum(host.VIRTUAL_MEMORY_MB_TOTAL)                                                                          as memorySum,
            round(if(sum(host.VIRTUAL_MEMORY_MB_TOTAL) = 0, 0, sum(host.VIRTUAL_MEMORY_MB_USED) / sum(host.VIRTUAL_MEMORY_MB_TOTAL)), 2) * 100 as memoryUsage
        from CJ_CMP_FUSION_CLOUD_HOST host
        where SERVICE_ACCOUNT_ID in(select adc.SERVICE_ACCOUNT_ID
                                    from CJ_CMP_CLOUD_ACCOUNT_DC adc inner join CJ_CMP_CLOUD_ACCOUNT ca on adc.CLOUD_ACCOUNT_ID = ca.ID
                                    where adc.CLOUD_ACCOUNT_ID = #{cloudAccountId} AND adc.IS_DELETED = 0
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>) AND IS_DELETED = 0;
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CLOUD_NETWORK.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：in,CONCAT,NOW,where,values,count,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CLOUD_NETWORK_PORT.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：NOW,where

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CLOUD_NETWORK_SUBNET.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：NOW,where,values,IF,ISNULL,CONCAT

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CLOUD_OBS_BUCKET.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：on,and,now,CJ_CMP_FUSION_CLOUD_OBS_BUCKET,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CLOUD_SECURITY_GROUP.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CLOUD_SFS_SHARE.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：now,CJ_CMP_FUSION_CLOUD_SFS_SHARE,VALUES,on,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CLOUD_SFS_SHARE_ACL.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：now,CJ_CMP_FUSION_CLOUD_SFS_SHARE_ACL,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CLOUD_STORAGE.xml
> sql统计:复杂4个，简单7个
>
> 使用的关键字：and,NOW,in,sum,round,if
#### statisticDataStoreByServiceAccoutId
```

        SELECT
        sum(da.DISK_SUM)  as DISK_SUM,
        sum(da.DISK_SUM - da.DISK_FREE) as DISK_USED,
        round(if(sum(da.DISK_SUM) = 0, 0, sum(da.DISK_SUM - da.DISK_FREE) / sum(da.DISK_SUM)), 2) * 100 as DISK_USAGE
        FROM CJ_CMP_FUSION_CLOUD_STORAGE da
        where SERVICE_ACCOUNT_ID = #{serviceAccountId} AND IS_DELETED = 0;
    
```
#### statisticDataStoreByCloudAccoutId
```

        SELECT
        sum(da.DISK_SUM)  as DISK_SUM,
        sum(da.DISK_SUM - da.DISK_FREE) as DISK_USED,
        round(if(sum(da.DISK_SUM) = 0, 0, sum(da.DISK_SUM - da.DISK_FREE) / sum(da.DISK_SUM)), 2) * 100 as DISK_USAGE
        FROM CJ_CMP_FUSION_CLOUD_STORAGE da
        where SERVICE_ACCOUNT_ID in (select adc.SERVICE_ACCOUNT_ID
                                      from CJ_CMP_CLOUD_ACCOUNT_DC adc inner join CJ_CMP_CLOUD_ACCOUNT ca on adc.CLOUD_ACCOUNT_ID = ca.ID
                                      where adc.CLOUD_ACCOUNT_ID = #{cloudAccountId} AND adc.IS_DELETED = 0
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>) AND IS_DELETED = 0;
    
```
#### statisticDataStoreTypeBySaId
```

        select
        TYPE,
        SERVICE_ACCOUNT_ID,
        sum(DISK_SUM)             as DISK_SUM,
        sum(DISK_FREE)            as DISK_FREE,
        sum(DISK_SUM - DISK_FREE) as DISK_USED,
        sum(PROVISIONED)          as PROVISIONED,
        round(if(sum(DISK_SUM) = 0, 0, sum(DISK_SUM - DISK_FREE) / sum(DISK_SUM)), 2) * 100 as DISK_USAGE
        from CJ_CMP_FUSION_CLOUD_STORAGE
        where SERVICE_ACCOUNT_ID = #{serviceAccountId}
        group by TYPE, SERVICE_ACCOUNT_ID, MEMBER_ID
    
```
#### statisticDataStoreTypeByCaId
```

        select
            TYPE,
            SERVICE_ACCOUNT_ID,
            sum(DISK_SUM)                                                                       as DISK_SUM,
            sum(DISK_FREE)                                                                      as DISK_FREE,
            sum(DISK_SUM - DISK_FREE)                                                           as DISK_USED,
            sum(PROVISIONED)                                                                    as PROVISIONED,
            round(if(sum(DISK_SUM) = 0, 0, sum(DISK_SUM - DISK_FREE) / sum(DISK_SUM)), 2) * 100 as DISK_USAGE
        from CJ_CMP_FUSION_CLOUD_STORAGE
        where SERVICE_ACCOUNT_ID in (select adc.SERVICE_ACCOUNT_ID
                                      from CJ_CMP_CLOUD_ACCOUNT_DC adc inner join CJ_CMP_CLOUD_ACCOUNT ca on adc.CLOUD_ACCOUNT_ID = ca.ID
                                      where adc.CLOUD_ACCOUNT_ID = #{cloudAccountId} AND adc.IS_DELETED = 0
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>)
        group by TYPE, SERVICE_ACCOUNT_ID, MEMBER_ID
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CLOUD_VDC.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CLOUD_VPC.xml
> sql统计:复杂1个，简单4个
>
> 使用的关键字：CONCAT,NOW,where,in,if,group_concat,on,and
#### selectDetailById
```

     select fvpc.ID,fvpc.MEMBER_ID,fvpc.ENTITY_ID,fvpc.SERVICE_ACCOUNT_ID,fvpc.NAME,fvpc.LDC_ID,fcdc.LDC_TYPE,fvpc.CIDR as CIDR_BLOCK,'可用' as statusName,
     fsa.TYPE as sAccountType,fvpc.CREATE_BY,fvpc.CREATE_DATE,fvpc.LAST_MODIFIED_BY,fvpc.LAST_MODIFIED_DATE,
     fsa.NAME as sAccountName,fdc.NAME as ldcName,if(EXTERNAL_GATEWAY_NETWORK_ENTITY_ID is null,0,1) as isExternal,
     (select group_concat(az.NAME) from CJ_CMP_FUSION_CLOUD_VPC_X_AZ x,CJ_CMP_CLOUD_AZ az where x.AZ_ID=az.ID and az.IS_DELETED=0 and x.VPC_ID=#{id}) as azNames
     from CJ_CMP_SERVICE_ACCOUNT fsa
     inner join CJ_CMP_FUSION_CLOUD_DC fdc on fdc.SERVICE_ACCOUNT_ID=fsa.ID and fsa.IS_DELETED=0 and fdc.IS_DELETED=0
     inner join CJ_CMP_CLOUD_ACCOUNT_DC fcdc on fcdc.LDC_TYPE = 'fusionCloud' and fcdc.LDC_ID=fdc.ID and fcdc.IS_DELETED=0
     inner join CJ_CMP_CLOUD_ACCOUNT fca on fcdc.CLOUD_ACCOUNT_ID=fca.ID and fca.IS_DELETED=0
     inner join CJ_CMP_FUSION_CLOUD_VPC fvpc on fvpc.LDC_ID=fdc.ID and fvpc.IS_DELETED=0
     where fvpc.ID=#{id}
      <choose>
          <when test="memberId != 0">
              and fca.MEMBER_ID = #{memberId}
          </when>
          <otherwise>
              and fca.SCOPE = 'public'
          </otherwise>
      </choose>
  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_COMPUTE_CLUSTER.xml
> sql统计:复杂1个，简单6个
>
> 使用的关键字：CJ_CMP_FUSION_COMPUTE_CLUSTER,values,round,ceil,ifnull,and,size,NOW
#### queryCluster
```

    select clu.ID,
    clu.NAME,
    clu.ENTITY_ID,
    clu.CPU_SUM,
    clu.CPU_USED,
    round((clu.CPU_USED / clu.CPU_SUM) * 100, 2)                                                       as cpuUsage,
    ceil(ifnull(clu.MEMORY_SUM, 0) / 1024)                                                             as memorySum,
    ceil(ifnull(clu.MEMORY_USED, 0) / 1024)                                                            as memoryUsed,
    round((ceil(ifnull(clu.MEMORY_USED, 0) / 1024) / ceil(ifnull(clu.MEMORY_SUM, 0) / 1024)) * 100,
    2)                                                                                           as memoryUsage,
    cdc.LDC_ID,
    cdc.LDC_TYPE,
    dc.ENTITY_ID                                                                                       as ldcEntityId,
    dc.NAME                                                                                            as ldcName,
    sa.NAME                                                                                            as serviceAccountName,
    sa.ID                                                                                              as serviceAccountId
    from CJ_CMP_SERVICE_ACCOUNT sa
    inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc on sa.ID = cdc.SERVICE_ACCOUNT_ID and sa.IS_DELETED = 0 AND cdc.IS_DELETED=0
    inner join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED = 0
    inner join CJ_CMP_FUSION_COMPUTE_DC dc on cdc.LDC_ID = dc.ID and dc.IS_DELETED = 0 and dc.SERVICE_ACCOUNT_ID=sa.ID
    left outer join CJ_CMP_FUSION_COMPUTE_CLUSTER clu on dc.ID = clu.LDC_ID
    left outer join CJ_CMP_FUSION_COMPUTE_HOST host on host.CLUSTER_ID = clu.ID
    where dc.IS_DELETED=0 and clu.IS_DELETED = 0
    <choose>
      <when test="memberId != 0">
        and ca.MEMBER_ID = #{memberId}
      </when>
      <otherwise>
        and ca.SCOPE = 'public'
      </otherwise>
    </choose>
    <if test="clusterId != null and clusterId != ''"> and clu.ID=#{clusterId}</if>
    <if test="serviceAccountId != null and serviceAccountId != ''"> and sa.ID=#{serviceAccountId}</if>
    <if test="cloudAccountId != null and cloudAccountId != ''"> and ca.ID=#{cloudAccountId}</if>
    <if test="ldcId != null and ldcId != ''"> and cdc.LDC_ID=#{ldcId}</if>
    <if test="ldcType != null and ldcType != ''"> and cdc.LDC_TYPE=#{ldcType}</if>
    <if test="searchKey != null and searchKey != ''"> and (clu.NAME like #{searchKey} or clu.ENTITY_ID like #{searchKey})</if>
    <if test="name != null and name != ''"> and clu.NAME like #{name} </if>
    <if test="ldcIds != null and ldcIds.size()>0">
      and cdc.LDC_ID IN <foreach collection="ldcIds" item="ldc" open="(" separator="," close=")"> #{ldc} </foreach>
    </if>
    group by clu.ID, clu.NAME, clu.ENTITY_ID, clu.CPU_SUM, clu.CPU_USED, round((clu.CPU_USED / clu.CPU_SUM) * 100, 2), ceil(ifnull(clu.MEMORY_SUM, 0) / 1024), ceil(ifnull(clu.MEMORY_USED, 0) / 1024), round((ceil(ifnull(clu.MEMORY_USED, 0) / 1024) / ceil(ifnull(clu.MEMORY_SUM, 0) / 1024)) * 100,
    2), cdc.LDC_ID, cdc.LDC_TYPE, dc.ENTITY_ID, dc.NAME, sa.NAME, sa.ID
    <if test="sortField != null and sortField!= '' and sortType != null and sortType!= '' ">
      <choose>
        <when test="sortField == 'cpuUsage' or sortField == 'memoryUsage' or sortField == 'localStorageUsage'">
          ORDER BY ${sortField} ${sortType}
        </when>
        <otherwise>
          order by clu.NAME
        </otherwise>
      </choose>
    </if>
    <if test="sortField == null or sortType == null ">
      order by clu.NAME
    </if>

  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_COMPUTE_DATASTORE.xml
> sql统计:复杂1个，简单6个
>
> 使用的关键字：group_concat,and,NOW,CJ_CMP_FUSION_COMPUTE_DATASTORE,values,join
#### queryDatastore
```

        SELECT ds.ID,ds.SERVICE_ACCOUNT_ID,ds.STATUS,ds.NAME,ds.ENTITY_ID,ds.CAPACITY_GB as DISK_SUM,ds.USED_SIZE_GB as
        DISK_USED,ds.FREE_SIZE_GB as DISK_FREE,ds.STORAGE_TYPE,cdc.LDC_TYPE,cdc.LDC_ID,dc.NAME as ldcName,dc.ENTITY_ID
        as ldcEntityId, sa.NAME as serviceAccountName, store.*
        FROM CJ_CMP_CLOUD_ACCOUNT ca
        inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc on ca.ID=cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED=0 and
        cdc.LDC_TYPE='fusionCompute' AND cdc.IS_DELETED=0
        inner join CJ_CMP_FUSION_COMPUTE_DC dc on cdc.LDC_ID=dc.ID and cdc.IS_DELETED=0 and dc.IS_DELETED=0
        inner join CJ_CMP_SERVICE_ACCOUNT sa on dc.SERVICE_ACCOUNT_ID = sa.ID and sa.IS_DELETED=0
        inner join CJ_CMP_FUSION_COMPUTE_DATASTORE ds ON ds.LDC_ID= dc.ID and
        ds.SERVICE_ACCOUNT_ID=dc.SERVICE_ACCOUNT_ID
        left join
        (
        SELECT group_concat(clu.ID) as CLUSTER_ID, group_concat(host.ID) as HOST_ID, group_concat(clu.NAME) AS
        clusterName , group_concat(clu.ENTITY_ID) clusterEntityId, group_concat(host.NAME) as hostName,
        group_concat(host.ENTITY_ID) as hostEntityId, group_concat(host.IP)as hostIp,dt.ID AS dsId
        FROM CJ_CMP_FUSION_COMPUTE_HOST host LEFT JOIN CJ_CMP_FUSION_COMPUTE_CLUSTER clu ON host.CLUSTER_ID = clu.ID
        inner join CJ_CMP_FUSION_COMPUTE_DATASTORE_X_HOST mou on mou.HOST_ID=host.ID
        inner join CJ_CMP_FUSION_COMPUTE_DATASTORE dt on dt.ID=mou.DATASTORE_ID
        GROUP BY dsId
        ) store ON dsId= ds.ID
        <where>
            <choose>
                <when test="memberId != 0">
                    and ca.MEMBER_ID = #{memberId}
                </when>
                <otherwise>
                    and ca.SCOPE = 'public'
                </otherwise>
            </choose>
            <if test="id != null and id != ''">and ds.ID=#{id}</if>
            <if test="serviceAccountId != null and serviceAccountId != ''">and
                cdc.SERVICE_ACCOUNT_ID=#{serviceAccountId}
            </if>
            <if test="cloudAccountId != null and cloudAccountId != ''">and ca.ID=#{cloudAccountId}</if>
            <if test="ldcId != null and ldcId != ''">and dc.ID=#{ldcId}</if>
            <if test="name != null and name != ''">and ds.NAME like #{name}</if>
            <if test="clusterId != null and clusterId != ''">and store.CLUSTER_ID=#{clusterId}</if>
            <if test="hostId != null and hostId != ''">and store.HOST_ID=#{hostId}</if>
            <if test="entityId != null and entityId != ''">and ds.ENTITY_ID like #{entityId}</if>
            <if test="searchKey != null and searchKey != ''">and (ds.NAME like #{searchKey} or ds.ENTITY_ID like
                #{searchKey} or hostIp like #{searchKey})
            </if>
            <if test="hostIp != null and hostIp != ''">and hostIp like #{hostIp}</if>
        </where>

    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_COMPUTE_DC.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：values,NOW,CJ_CMP_FUSION_COMPUTE_DC

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_COMPUTE_HOST.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：NOW,CJ_CMP_FUSION_COMPUTE_HOST,values,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_COMPUTE_PORT_GROUP.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：and,CONCAT,IF,ISNULL,NOW,CJ_CMP_FUSION_COMPUTE_PORT_GROUP,values,count

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_COMPUTE_VDS.xml
> sql统计:复杂1个，简单7个
>
> 使用的关键字：if,concat,count,and,CJ_CMP_FUSION_COMPUTE_VDS,values,from,group_concat,in,CONCAT,NOW
#### selectByKeyValueAndServiceAccount
```

    select * from (select  vds.ID,vds.MEMBER_ID,vds.ENTITY_ID,vds.SERVICE_ACCOUNT_ID,
    if(vds.TYPE = 'VSS',concat(vds.NAME, if(group_concat(vmHost.IP) is null, '', concat('[', group_concat(vmHost.IP), ']'))),vds.NAME) as NAME,
           vds.TYPE, vds.LDC_ID,saccount.DATACENTER_TYPE as LDC_TYPE,vds.SHORT_DESCRIPTION as DESCRIPTION, group_concat(vmHost.NAME) as hostName,
    (select count(0) from CJ_CMP_FUSION_COMPUTE_PORT_GROUP vpg where vds.ID = vpg.VDS_ID and vpg.IS_DELETED=0)  as PORT_GROUP_NUM,
    dc.name as ldcName, saccount.NAME as sAccountName
    from CJ_CMP_FUSION_COMPUTE_VDS vds
    inner join CJ_CMP_FUSION_COMPUTE_DC dc on vds.LDC_ID = dc.ID
    inner join CJ_CMP_SERVICE_ACCOUNT saccount on vds.SERVICE_ACCOUNT_ID = saccount.ID
    inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc on cdc.SERVICE_ACCOUNT_ID=saccount.ID and cdc.IS_DELETED=0 and dc.ID = cdc.LDC_ID
    inner join CJ_CMP_CLOUD_ACCOUNT ca on cdc.CLOUD_ACCOUNT_ID = ca.ID and ca.IS_DELETED = 0
    left join CJ_CMP_FUSION_COMPUTE_VDS_X_HOST vdsRel on vds.ID = vdsRel.VDS_ID
    left join CJ_CMP_FUSION_COMPUTE_HOST vmHost on vdsRel.HOST_ID = vmHost.ID
    where vds.IS_DELETED=0
    <choose>
      <when test="memberId != 0">
        and ca.MEMBER_ID = #{memberId}
      </when>
      <otherwise>
        and ca.SCOPE = 'public'
      </otherwise>
    </choose>
    <if test="id != null" >
      and vds.ID = #{id}
    </if>
    <if test="serviceAccountId!=null and serviceAccountId != 'ALL'" >
      and vds.SERVICE_ACCOUNT_ID = #{serviceAccountId}
    </if>
    <if test="cloudAccountId !=null and cloudAccountId != 'ALL'" >
      and vds.LDC_ID in (
      select cadc.LDC_ID from  CJ_CMP_CLOUD_ACCOUNT_DC cadc where cadc.CLOUD_ACCOUNT_ID = #{cloudAccountId}
      )
    </if>
    <if test="ldcId != '' and ldcId != null" >
      and vds.LDC_ID = #{ldcId}
    </if>
    group by vds.ID) t where 1 = 1
    <if test="queryValue != null" >
      <if test="queryValue != ''" >
      <choose>
          <when test="queryKey == 'ALL'" >
              and (
              t.NAME like CONCAT('%',#{queryValue},'%')
              OR t.ENTITY_ID like CONCAT('%',#{queryValue},'%')
              )
          </when>
          <otherwise>
              <if test="queryKey == 'ENTITY_ID'" >
                  and t.ENTITY_ID like CONCAT('%',#{queryValue},'%')
              </if>
              <if test="queryKey == 'NAME'" >
                  and t.NAME like CONCAT('%',#{queryValue},'%')
              </if>
          </otherwise>
      </choose>
      </if>
    </if>

  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_COMPUTE_VM.xml
> sql统计:复杂1个，简单19个
>
> 使用的关键字：sum,GROUP_CONCAT,if,now,NOW,CJ_CMP_FUSION_COMPUTE_VM,values,and
#### getAllByCondition
```

      select vm.*,prj.CODE as projectCode,prj.NAME as projectName,prj.PROJECT_SOURCE_ID as projectSourceId,
      app.CODE as appSystemCode,app.NAME as appSystemName,app.SOURCE_ID as appSystemSourceId, GROUP_CONCAT(tag.NAME) as tags
      from CJ_CMP_FUSION_COMPUTE_VM vm
      <if test="srvCompletionTimeStart!=null or srvCompletionTimeEnd!=null ">
      left outer join CJ_CMP_RITM_COMPLETED_VIEW req on vm.SRV_NO=req.NUMBER
      </if>
      left outer join CJ_CMP_PROJECT prj on prj.ID=vm.PROJECT_ID
      left outer join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
      left outer join CJ_CMP_APP_DU du on du.ID=vm.APP_DU_ID
      left outer join CJ_CMP_TAG_X_OBJECT txo on vm.ID = txo.OBJECT_ID and txo.OBJECT_TYPE = 'fusionCompute'
      left outer join CJ_CMP_TAG tag on tag.ID = txo.TAG_ID and tag.IS_DELETED = 0
      <where>
        <if test="memberId != 0"> and vm.MEMBER_ID = #{memberId}</if>
        <if test="startTime!=null and endTime!=null ">
          and vm.CREATE_DATE between #{startTime,jdbcType= TIMESTAMP} and  #{endTime,jdbcType= TIMESTAMP}
        </if>
        <if test="startTime==null and endTime!=null ">
          and vm.CREATE_DATE &lt;=  #{endTime,jdbcType= TIMESTAMP}
        </if>
        <if test="startTime!=null and endTime==null ">
          and vm.CREATE_DATE &gt;=  #{startTime,jdbcType= TIMESTAMP}
        </if>

        <if test="srvCompletionTimeStart!=null and srvCompletionTimeEnd!=null ">
          and if(vm.IS_DELETED=1,vm.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) between #{srvCompletionTimeStart,jdbcType= TIMESTAMP} and  #{srvCompletionTimeEnd,jdbcType= TIMESTAMP}
        </if>
        <if test="srvCompletionTimeStart==null and srvCompletionTimeEnd!=null ">
          and if(vm.IS_DELETED=1,vm.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) &lt;=  #{srvCompletionTimeEnd,jdbcType= TIMESTAMP}
        </if>
        <if test="srvCompletionTimeStart!=null and srvCompletionTimeEnd==null ">
          and if(vm.IS_DELETED=1,vm.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) &gt;=  #{srvCompletionTimeStart,jdbcType= TIMESTAMP}
        </if>

        <if  test="isDeleted != null ">
          <choose>
            <when test="isDeleted">
              and vm.IS_DELETED=1
            </when>
            <otherwise>
              and vm.IS_DELETED=0
            </otherwise>
          </choose>
        </if>
      </where>
      GROUP BY vm.ID
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_IP_OPER_LOG.xml
> sql统计:复杂1个，简单4个
>
> 使用的关键字：CJ_CMP_IP_OPER_LOG,values,now,CONCAT,from,if,and,or
#### queryMemberIpLog
```

    select * from (select ipLog.ID, ipLog.IP_ID, ipLog.IP, ipLog.STATUS, ipLog.USAGE_INFO, ipLog.REMARK, ipLog.DEV_INFO,
    ipLog.OPER_TYPE, ipLog.CREATE_DATE, `member`.NAME as memberName, if(user.name is not null, user.name,
    ipLog.CREATE_BY) as operator, cidr.CIDR_BLOCK, cidr.NAME as cidrBlockName,
    null as devId, null as devType, null as devName, null as appSystemName
    from CJ_CMP_IP_OPER_LOG ipLog
    inner join CJ_CMP_CIDR_BLOCK cidr on ipLog.CIDR_BLOCK_ID = cidr.ID
    inner join ydduc.UC_MEMBER `member` on ipLog.MEMBER_ID = `member`.ID
    left join ydduc.UC_USER user on ipLog.CREATE_BY = user.ID
    <where>
      and `member`.STATUS = 'ENABLED'
      <if test="memberId !=null and memberId !=0">and ipLog.MEMBER_ID = #{memberId}</if>
      <if test="ip != null and ip != ''">and ipLog.IP = #{ip}</if>
      <if test="status != null and status != ''">and ipLog.STATUS = #{status}</if>
      <if test="operator != null and operator != ''">and (user.NAME like CONCAT('%',#{operator},'%') or (ipLog.CREATE_BY = 'sys' and #{showSysLog} = true))</if>
      <if test="startTime != null and startTime != ''">and ipLog.CREATE_DATE &gt;= #{startTime}</if>
      <if test="endTime != null and endTime != ''">and ipLog.CREATE_DATE &lt;= #{endTime}</if>
    </where>
    <if test="sortField != '' and sortField != null">
      order by ipLog.${sortField} ${sortType}
    </if>
    <if test="sortField == '' or sortField == null">
      order by ipLog.ID desc
    </if>) operLog
    <if test="(status == null or status == '') and (operator == null or operator == '')">
      union all
      select devIp.ID, null, devIp.IP, 'unmanage', null, null, null, null, devIp.CREATE_DATE, `member`.NAME as memberName, if(user.name is not null, user.name, devIp.CREATE_BY) as operator, null, null,
      devIp.ID as devId, devIp.TYPE as devType, devIp.NAME as devName, appSystem.NAME as appSystemName
      from CJ_CMP_DEV_IP_VIEW devIp
      left join CJ_CMP_APP_SYSTEM appSystem on devIp.APP_SYSTEM_ID = appSystem.ID and appSystem.IS_DELETED = 0
      inner join ydduc.UC_MEMBER `member` on devIp.MEMBER_ID = `member`.ID
      left join ydduc.UC_USER user on devIp.CREATE_BY = user.ID
      left join CJ_CMP_IP_X_DEV rel on devIp.ID = rel.DEV_ID and devIp.TYPE = rel.DEV_TYPE and devIp.SERVICE_ACCOUNT_ID = rel.SERVICE_ACCOUNT_ID
      where rel.ID is null
      <if test="memberId !=null and memberId !=0">and devIp.MEMBER_ID = #{memberId}</if>
      <if test="ip != '' and ip != null" > and devIp.IP like CONCAT('%',#{ip},'%')</if>
      <if test="startTime != null and startTime != ''">and devIp.CREATE_DATE &gt;= #{startTime}</if>
      <if test="endTime != null and endTime != ''">and devIp.CREATE_DATE &lt;= #{endTime}</if>
    </if>

  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_IP_POOL.xml
> sql统计:复杂12个，简单32个
>
> 使用的关键字：IF,now,INET6_ATON,CONCAT,JOIN,select,join,INET_ATON,and,FROM,group_concat,from,sum,HEX,count,round,CJ_CMP_IP_POOL,values,inet_aton
#### selectInCidrBlock
```

    select * from CJ_CMP_IP_POOL where CIDR_BLOCK_ID = #{cidrBlockId} and MEMBER_ID = #{memberId}
    <if test="ip != '' and ip != null" >
      and IP like CONCAT('%',#{ip},'%')
    </if>
    <if test="status != '' and status != null" >
      and `STATUS` = #{status}
    </if>
    <if test="ipVersion != null and ipVersion == 'IPv6'">order by IP</if>
    <if test="ipVersion != null and ipVersion == 'IPv4'">order by inet_aton(IP)</if>
  
```
#### selectByCidrBlockAndStatus
```

    select ipPool.*,cidr.CIDR_BLOCK as cidrBlock,cidr.DNS as dns,
    cidr.NETMASK as netmask,cidr.GATEWAY as gateway from CJ_CMP_IP_POOL ipPool
    INNER join CJ_CMP_CIDR_BLOCK cidr on ipPool.CIDR_BLOCK_ID = cidr.ID  where ipPool.CIDR_BLOCK_ID = #{cidrBlockId} and ipPool.MEMBER_ID = #{memberId} and ipPool.STATUS = #{status}
    <if test="startIp != null and startIp != ''">
       and inet_aton(ipPool.IP) > inet_aton(#{startIp})
    </if>
    order by inet_aton(ipPool.IP)
    <if test="num != null and num != 0">
      limit #{num}
    </if>
  
```
#### selectByCidrBlockAndStatusFromAvaliableLogicSegment
```

    select ipPool.*,
           cidr.CIDR_BLOCK as cidrBlock,
           cidr.DNS as dns,
           cidr.NETMASK as netmask,
           cidr.GATEWAY as gateway
    from CJ_CMP_IP_POOL ipPool
    inner join CJ_CMP_CIDR_BLOCK cidr on ipPool.CIDR_BLOCK_ID = cidr.ID
    where ipPool.CIDR_BLOCK_ID = #{cidrBlockId}
      and ipPool.MEMBER_ID = #{memberId}
      and ipPool.STATUS = #{status}
      and ipPool.LOGIC_SEGMENT_ID is not null
    <if test="startIp != null and startIp != ''">
      and inet_aton(ipPool.IP) > inet_aton(#{startIp})
    </if>
    order by inet_aton(ipPool.IP)
    <if test="num != null and num != 0">
      limit #{num}
    </if>
  
```
#### selectByLogicSegmentAndStatus
```

    select ipPool.*,cidr.CIDR_BLOCK as cidrBlock,cidr.DNS as dns,
    cidr.NETMASK as netmask,cidr.GATEWAY as gateway from CJ_CMP_IP_POOL ipPool
    INNER join CJ_CMP_CIDR_BLOCK cidr on ipPool.CIDR_BLOCK_ID = cidr.ID
    INNER join CJ_CMP_LOGIC_SEGMENT ls on ipPool.LOGIC_SEGMENT_ID = ls.ID
    where ipPool.LOGIC_SEGMENT_ID = #{logicSegmentId} and ipPool.MEMBER_ID = #{memberId} and ipPool.STATUS = #{status}
    <if test="startIp != null and startIp != ''">
      and inet_aton(ipPool.IP) > inet_aton(#{startIp})
    </if>
    order by inet_aton(ipPool.IP)
    <if test="num != null and num != 0">
      limit #{num}
    </if>
  
```
#### selectIpByCidrBlockId
```

    select * from CJ_CMP_IP_POOL where CIDR_BLOCK_ID = #{cidrBlockId} and MEMBER_ID = #{memberId}
    <if test="ipVersion == 'IPv4'">
      <if test="startIp != null"> and inet_aton(IP) &gt;= inet_aton(#{startIp})</if>
      <if test="endIp != null"> and inet_aton(IP) &lt;= inet_aton(#{endIp})</if>
      order by ID
    </if>
    <if test="ipVersion == 'IPv6'">
      <if test="startIp != null"> and IP &gt;= #{startIp}</if>
      <if test="endIp != null"> and IP &lt;= #{endIp}</if>
      order by IP
    </if>

  
```
#### listIps
```

    SELECT* FROM  (
      SELECT
      ip.ID,
      ip.IP,
      ip.CIDR_BLOCK_ID,
      ip.USAGE_INFO,
      ip.REMARK,
      cidr.CIDR_BLOCK,
      ip.STATUS,
      group_concat( ip.IP_TYPE )as ipType,
      group_concat( rel.DEV_ID ) AS devId,
      group_concat( rel.DEV_TYPE ) AS devType,
      group_concat( dev.NAME ) AS devName,
      group_concat( appSystem.NAME ) AS appSystemName,
      ip.CREATE_BY,
      ip.CREATE_DATE,
      ip.LAST_MODIFIED_BY,
      ip.LAST_MODIFIED_DATE,
      ip.FROZEN_DATE,
      ip.LOGIC_SEGMENT_ID
    FROM CJ_CMP_CIDR_BLOCK cidr
      INNER JOIN CJ_CMP_IP_POOL ip ON ip.CIDR_BLOCK_ID = cidr.ID
      LEFT JOIN CJ_CMP_IP_X_DEV rel ON ip.ID = rel.IP_ID
      LEFT JOIN CJ_CMP_DEV_VIEW dev ON rel.DEV_ID = dev.ID
      AND rel.SERVICE_ACCOUNT_ID = dev.SERVICE_ACCOUNT_ID
      LEFT JOIN CJ_CMP_APP_SYSTEM appSystem ON dev.APP_SYSTEM_ID = appSystem.ID  AND appSystem.IS_DELETED = 0
    <where>
      and ip.MEMBER_ID = #{memberId}
      <if test="ip != '' and ip != null" >
        and ip.IP like CONCAT('%',#{ip},'%')
      </if>
      <if test="cidrBlockId != null" >
        and ip.CIDR_BLOCK_ID = #{cidrBlockId}
      </if>
      <if test="logicSegmentId != null" >
        and ip.LOGIC_SEGMENT_ID = #{logicSegmentId}
      </if>
      <if test="status != '' and status != null" >
        and ip.STATUS = #{status}
      </if>
      <if test="devType != '' and devType != null" >
        and rel.DEV_TYPE = #{devType}
      </if>
      <if test="devName != '' and devName != null" >
        and dev.NAME like CONCAT('%',#{dev.NAME},'%')
      </if>
      <if test="usageInfo != '' and usageInfo != null" >
        and ip.USAGE_INFO like CONCAT('%',#{usageInfo},'%')
      </if>
    </where>
    group by ip.ID order by
    <if test="sortField != '' and sortField != null">
      ip.${sortField} ${sortType},
    </if>
    <if test="orderByIp != null and orderByIp == true">
      inet_aton(ip.IP),
    </if>
    ip.ID) ipPool
    <if test="(status == null or status == '') and (usageInfo == null or usageInfo == '') and cidrBlockId == null and logicSegmentId == null">
      union all
      select devIp.ID, devIp.IP, null, null, null, null, 'unmanage',null, devIp.ID as devId, devIp.TYPE as devType, devIp.NAME as devName, appSystem.NAME as appSystemName,
      devIp.CREATE_BY, devIp.CREATE_DATE, devIp.LAST_MODIFIED_BY, devIp.LAST_MODIFIED_DATE, null,null
      from CJ_CMP_DEV_IP_VIEW devIp
      left join CJ_CMP_APP_SYSTEM appSystem on devIp.APP_SYSTEM_ID = appSystem.ID and appSystem.IS_DELETED = 0
      left join CJ_CMP_IP_X_DEV rel on devIp.ID = rel.DEV_ID and devIp.TYPE = rel.DEV_TYPE and devIp.SERVICE_ACCOUNT_ID = rel.SERVICE_ACCOUNT_ID
      where rel.ID is null and devIp.MEMBER_ID = #{memberId}
      <if test="ip != '' and ip != null" >
        and devIp.IP like CONCAT('%',#{ip},'%')
      </if>
      <if test="devName != '' and devName != null" >
        and devIp.NAME like CONCAT('%',#{dev.NAME},'%')
      </if>
    </if>
  
```
#### pagePoolIps
```

    SELECT
      ip.ID,
      ip.IP,
      ip.CIDR_BLOCK_ID,
      ip.USAGE_INFO,
      ip.REMARK,
      cidr.CIDR_BLOCK,
      ip.STATUS,
      group_concat( ip.IP_TYPE )as ipType,
      group_concat( rel.DEV_ID ) AS devId,
      group_concat( rel.DEV_TYPE ) AS devType,
      group_concat( dev.NAME ) AS devName,
      group_concat( appSystem.NAME ) AS appSystemName,
      ip.CREATE_BY,
      ip.CREATE_DATE,
      ip.LAST_MODIFIED_BY,
      ip.LAST_MODIFIED_DATE,
      ip.FROZEN_DATE,
      ip.LOGIC_SEGMENT_ID,
      CONCAT('poolIP-', ip.ID) uniqueIndex,
      'poolIP' AS ipSource
    FROM (select * from CJ_CMP_IP_POOL ipPool
          <where>
            <if test="ip != null" >
              and ipPool.IP like CONCAT('%',#{ip},'%')
            </if>
            <if test="cidrBlockId != null" >
              and ipPool.CIDR_BLOCK_ID = #{cidrBlockId}
            </if>
            <if test="logicSegmentId != null" >
              and ipPool.LOGIC_SEGMENT_ID = #{logicSegmentId}
            </if>
            <if test="status != null" >
              and ipPool.STATUS = #{status}
            </if>
            <if test="ipType != null" >
              and ipPool.IP_TYPE = #{ipType}
            </if>
            <if test="usageInfo != null" >
              and ipPool.USAGE_INFO like CONCAT('%',#{usageInfo},'%')
            </if>
            and ipPool.MEMBER_ID = #{memberId}
          </where>
          <if test="ip == null and cidrBlockId == null and logicSegmentId == null and status == null and usageInfo == null and devType == null and devName == null" >
            order by
            <if test="sortField != '' and sortField != null">
              ipPool.${sortField} ${sortType},
            </if>
            <if test="orderByIp != null and orderByIp == true">
              inet_aton(ipPool.IP),
            </if>
            ipPool.ID
            <if test="offset != 0 or limit != 0">
                limit #{offset}, #{limit}
            </if>
          </if>
    ) ip
    LEFT JOIN CJ_CMP_CIDR_BLOCK cidr ON ip.CIDR_BLOCK_ID = cidr.ID
    LEFT JOIN (select * from CJ_CMP_IP_X_DEV ipDev
                <where>
                  <if test="devType != null" >
                    and ipDev.DEV_TYPE = #{devType}
                  </if>
                </where>
    ) rel ON ip.ID = rel.IP_ID
    LEFT JOIN (select * from CJ_CMP_DEV_VIEW devView
                <where>
                  <if test="devName != '' and devName != null" >
                    and devView.NAME like CONCAT('%',#{dev.NAME},'%')
                  </if>
                </where>
    ) dev ON rel.DEV_ID = dev.ID AND rel.SERVICE_ACCOUNT_ID = dev.SERVICE_ACCOUNT_ID
    LEFT JOIN CJ_CMP_APP_SYSTEM appSystem ON dev.APP_SYSTEM_ID = appSystem.ID AND appSystem.IS_DELETED = 0
    group by ip.ID
    <if test="ip != null or cidrBlockId != null or logicSegmentId != null or status != null or usageInfo != null or devType != null or devName != null" >
      order by
      <if test="sortField != '' and sortField != null">
        ip.${sortField} ${sortType},
      </if>
      <if test="orderByIp != null and orderByIp == true">
        inet_aton(ip.IP),
      </if>
      ip.ID
      <if test="offset != 0 or limit != 0">
        limit #{offset}, #{limit}
      </if>
    </if>
  
```
#### pageDevIps
```

      select devIp.ID, devIp.IP, null, null, null, null, 'unmanage',null, devIp.ID as devId, devIp.TYPE as devType,
      devIp.NAME as devName, appSystem.NAME as appSystemName,
      devIp.CREATE_BY, devIp.CREATE_DATE, devIp.LAST_MODIFIED_BY, devIp.LAST_MODIFIED_DATE, null, null, CONCAT('devIP-', devIp.uniqueIndex) uniqueIndex, 'devIP' as ipSource
      from (
        select @index := @index + 1 as `uniqueIndex`, devView.* from
        (select * from CJ_CMP_DEV_IP_VIEW) devView,
        (select @index := 0) indexId
      ) devIp
      left join CJ_CMP_APP_SYSTEM appSystem on devIp.APP_SYSTEM_ID = appSystem.ID and appSystem.IS_DELETED = 0
      left join CJ_CMP_IP_X_DEV rel on devIp.ID = rel.DEV_ID and devIp.TYPE = rel.DEV_TYPE and devIp.SERVICE_ACCOUNT_ID = rel.SERVICE_ACCOUNT_ID
      where rel.ID is null and devIp.MEMBER_ID = #{memberId}
      <if test="ip != '' and ip != null">
        and devIp.IP like CONCAT('%',#{ip},'%')
      </if>
      <if test="devName != '' and devName != null">
        and devIp.NAME like CONCAT('%',#{dev.NAME},'%')
      </if>
      order by
      <if test="sortField != '' and sortField != null">
        devIp.${sortField} ${sortType},
      </if>
      <if test="orderByIp != null and orderByIp == true">
        inet_aton(devIp.IP),
      </if>
      devIp.ID
      <if test="offset != 0 or limit != 0">
        limit #{offset}, #{limit}
      </if>
  
```
#### pageIpCount
```

    SELECT * FROM (
        SELECT count(ip1.ID) FROM (SELECT ip.ID
        FROM (select * from CJ_CMP_IP_POOL ipPool
              <where>and ipPool.MEMBER_ID = #{memberId}
                <if test="ip != null" >
                and ipPool.IP like CONCAT('%',#{ip},'%')
                </if>
                <if test="cidrBlockId != null" >
                  and ipPool.CIDR_BLOCK_ID = #{cidrBlockId}
                </if>
                <if test="logicSegmentId != null" >
                  and ipPool.LOGIC_SEGMENT_ID = #{logicSegmentId}
                </if>
                <if test="status != null" >
                  and ipPool.STATUS = #{status}
                </if>
                <if test="ipType != null" >
                  and ipPool.IP_TYPE = #{ipType}
                </if>
                <if test="usageInfo != null" >
                  and ipPool.USAGE_INFO like CONCAT('%',#{usageInfo},'%')
                </if>
              </where>
              order by ipPool.ID
        ) ip
        LEFT JOIN CJ_CMP_CIDR_BLOCK cidr ON ip.CIDR_BLOCK_ID = cidr.ID
        <if test="devType != null" >
          LEFT JOIN (select * from CJ_CMP_IP_X_DEV ipDev
                    <where>
                      <if test="devType != null" >
                        and ipDev.DEV_TYPE = #{devType}
                      </if>
                    </where>
          ) rel ON ip.ID = rel.IP_ID
        </if>
        <if test="devName != '' and devName != null" >
          LEFT JOIN (select * from CJ_CMP_DEV_VIEW devView
                    <where>
                      <if test="devName != '' and devName != null" >
                        and devView.NAME like CONCAT('%',#{dev.NAME},'%')
                      </if>
                    </where>
          ) dev ON rel.DEV_ID = dev.ID AND rel.SERVICE_ACCOUNT_ID = dev.SERVICE_ACCOUNT_ID
        </if>
        group by ip.ID order by
        <if test="sortField != '' and sortField != null">
          ip.${sortField} ${sortType},
        </if>
        <if test="orderByIp != null and orderByIp == true">
          inet_aton(ip.IP),
        </if>
        ip.ID) ip1
      <if test="(status == null or status == '') and (ipType == null or ipType == '') and (usageInfo == null or usageInfo == '') and cidrBlockId == null and logicSegmentId == null">
        union all
        SELECT count(ip2.ID) FROM (select devIp.ID
        from CJ_CMP_DEV_IP_VIEW devIp
        left join CJ_CMP_APP_SYSTEM appSystem on devIp.APP_SYSTEM_ID = appSystem.ID and appSystem.IS_DELETED = 0
        left join CJ_CMP_IP_X_DEV rel on devIp.ID = rel.DEV_ID and devIp.TYPE = rel.DEV_TYPE and devIp.SERVICE_ACCOUNT_ID = rel.SERVICE_ACCOUNT_ID
        where rel.ID is null and devIp.MEMBER_ID = #{memberId}
        <if test="ip != '' and ip != null">
          and devIp.IP like CONCAT('%',#{ip},'%')
        </if>
        <if test="devName != '' and devName != null">
          and devIp.NAME like CONCAT('%',#{dev.NAME},'%')
        </if>
        ) ip2
      </if>
    ) ipPool
  
```
#### listIpInfo
```

    select ip.ID, ip.IP, ip.CIDR_BLOCK_ID, ip.USAGE_INFO, ip.REMARK, cidr.CIDR_BLOCK, ip.STATUS, group_concat(rel.DEV_ID) as devId, group_concat(rel.DEV_TYPE) as devType, group_concat(dev.NAME) as devName, group_concat(appSystem.NAME) as appSystemName,
    ip.CREATE_BY, ip.CREATE_DATE, ip.LAST_MODIFIED_BY, ip.LAST_MODIFIED_DATE, ip.FROZEN_DATE
    from CJ_CMP_CIDR_BLOCK cidr
    inner join CJ_CMP_IP_POOL ip on ip.CIDR_BLOCK_ID = cidr.ID
    left join CJ_CMP_IP_X_DEV rel on ip.ID = rel.IP_ID
    left join CJ_CMP_DEV_VIEW dev on rel.DEV_ID = dev.ID and  rel.SERVICE_ACCOUNT_ID = dev.SERVICE_ACCOUNT_ID
    left join CJ_CMP_APP_SYSTEM appSystem on dev.APP_SYSTEM_ID = appSystem.ID and appSystem.IS_DELETED = 0
    <where>
      and ip.MEMBER_ID = #{memberId}
      <if test="id != '' and id != null" >
        and ip.ID = #{id}
      </if>
    </where>
    group by ip.ID order by ip.ID
  
```
#### queryAllIpUsage
```

    select (CASE
            WHEN cidr.IP_VERSION = 'IPv6' THEN null
            WHEN cidr.IP_VERSION = 'IPv4' THEN count(ip.CIDR_BLOCK_ID) END)    as ipSum,
       (CASE
            WHEN cidr.IP_VERSION = 'IPv6' THEN null
            WHEN cidr.IP_VERSION = 'IPv4' THEN sum(ip.STATUS != 'unused') END) as ipUsed,
       (CASE
            WHEN cidr.IP_VERSION = 'IPv6' THEN null
            WHEN cidr.IP_VERSION = 'IPv4' THEN sum(ip.STATUS = 'unused') END)  as ipUnused,
       (CASE
            WHEN cidr.IP_VERSION = 'IPv6' THEN null
            WHEN cidr.IP_VERSION = 'IPv4' THEN round((sum(ip.STATUS != 'unused') / count(ip.CIDR_BLOCK_ID) * 100),
                                                     2) END)                   as ipUsage,cidr.IP_VERSION
from CJ_CMP_CIDR_BLOCK cidr
         left join
     (select CIDR_BLOCK_ID, `TYPE`
      from CJ_CMP_CIDR_BLOCK_X_NETWORK rel
               inner join CJ_CMP_SERVICE_ACCOUNT sa on rel.SERVICE_ACCOUNT_ID = sa.ID
      where sa.TYPE = 'aliyunPublic')
         as al on cidr.ID = al.CIDR_BLOCK_ID
         left join CJ_CMP_IP_POOL ip on cidr.ID = ip.CIDR_BLOCK_ID
      where al.TYPE is  null and cidr.IP_VERSION = 'IPV4' and cidr.MEMBER_ID = #{memberId}
      group by cidr.IP_VERSION

  
```
#### deleteBatchByIpAndCidr
```

    delete from CJ_CMP_IP_POOL
    where MEMBER_ID = #{memberId}
    and CIDR_BLOCK_ID = #{cidrBlockId}
    and inet_aton(IP) &gt;= inet_aton(#{startIp})
    and inet_aton(ip) &lt;= inet_aton(#{endIp})
  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_IP_X_DEV.xml
> sql统计:复杂0个，简单14个
>
> 使用的关键字：CJ_CMP_IP_X_DEV,values,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_KUBESPHERE_CLUSTER.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：and,now,CJ_CMP_KUBESPHERE_CLUSTER,values,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_MAIN_MEMBER_GRANT.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：now,CJ_CMP_MAIN_MEMBER_GRANT,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_MID_SERVER_JOB.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：max,CJ_CMP_MID_SERVER_JOB,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_NETWORK_AREA.xml
> sql统计:复杂1个，简单7个
>
> 使用的关键字：count,join,NOW,CONCAT,CJ_CMP_NETWORK_AREA,values,sum,IF,round
#### selectAllPage
```

    select  area.ID,
            area.NAME,
            area.CODE,
            area.create_by,
            area.description,
            area.NODE_AREA,
            area.DATACENTER_ID,
            area.create_date,
            area.last_modified_by,
            area.last_modified_date,
    count(case when cidr.IP_VERSION = 'IPv6' then 0 when cidr.IP_VERSION = 'IPv4' then ip.IP end)  as IP_SUM,
    sum(case when cidr.IP_VERSION = 'IPv6' then 0 when cidr.IP_VERSION = 'IPv4' then IF(ip.STATUS = 'used', 1, 0) end)   as IP_USED,
    sum(case when cidr.IP_VERSION = 'IPv6' then 0 when cidr.IP_VERSION = 'IPv4' then IF(ip.STATUS = 'unused', 1, 0) end)   as IP_UNUSED,
    round(sum(case when cidr.IP_VERSION = 'IPv6' then 0 when cidr.IP_VERSION = 'IPv4' then IF(ip.STATUS = 'used', 1, 0) end)/ sum(case when cidr.IP_VERSION = 'IPv6' then 0 when cidr.IP_VERSION = 'IPv4' then ip.IP end)* 100,2) as IP_USAGE
    from CJ_CMP_NETWORK_AREA area
    left join CJ_CMP_CIDR_BLOCK cidr on cidr.NETWORK_AREA_ID = area.ID
    left join
    (select CIDR_BLOCK_ID, `TYPE`
    from CJ_CMP_CIDR_BLOCK_X_NETWORK rel
    inner join CJ_CMP_SERVICE_ACCOUNT sa on rel.SERVICE_ACCOUNT_ID = sa.ID
    where sa.TYPE = 'aliyunPublic')
    as al on cidr.ID = al.CIDR_BLOCK_ID
    left join CJ_CMP_IP_POOL ip on cidr.ID = ip.CIDR_BLOCK_ID
    WHERE area.MEMBER_ID = #{memberId} and area.IS_DELETED = 0
    <if test="name != null and name != ''" >
      and area.`NAME` like CONCAT('%',#{name},'%')
    </if>
    <if test="searchKey != null and searchKey != ''" >
      and area.`NAME` like CONCAT('%',#{searchKey},'%')
    </if>
    group by area.ID, area.NAME, area.CODE
    <if test="sortField != null and sortField!= '' and sortType != null and sortType!= '' ">
      ORDER BY ${sortField} ${sortType}
    </if>

  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_OBSERVABILITY_REPORT.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：count,date_add,COUNT,and,in

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_OS.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：values,NOW,in,and,now,CJ_CMP_OS

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_OS_X_IMAGE.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：values,NOW,count,from,join,CJ_CMP_OS_X_IMAGE

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_PHYSICAL_VIRTUAL_MACHINE_VIEW.xml
> sql统计:复杂1个，简单1个
>
> 使用的关键字：SUM,ceil,COUNT,DISTINCT,ifnull,concat,and,from
#### queryCloudComputerList
```

        select v.ID,v.SERVICE_ACCOUNT_ID,v.CLOUD_ACCOUNT_ID,v.LDC_ID,v.LDC_TYPE,v.TYPE,v.ENTITY_ID, v.NAME,sa.NAME as serviceAccountName,v.MEMBER_ID as memberId, um.`NAME` AS memberName,v.CLOUD_ACCOUNT_NAME,v.LDC_NAME,
        ifnull(v.CLUSTER_NAME,v.ZONE_NAME) as clusterName,v.RUN_STATUS,v.IP,concat(v.CPUS,'C/',ceil(v.MEMORY/1024),'G') as spec,v.HOST_ENTITY_NAME,v.HOST_SN,v.HOST_IP,app.NAME as appSystemName,
        v.OWNED_BY,uu.USER_NAME as ownedByName,project.NAME AS projectName,depart.NAME as dept,uaas.USER_NAME as assigner,v.ASSIGNED_TO
        from cj_cmp_vm_view v
        inner join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID=v.SERVICE_ACCOUNT_ID and sa.IS_DELETED=0
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=v.APP_SYSTEM_ID
        left outer join CJ_CMP_PROJECT project on project.ID=v.PROJECT_ID
        left join ydduc.UC_MEMBER um on um.ID = v.MEMBER_ID
        left join ydduc.UC_USER uu on uu.ID = v.OWNED_BY
        LEFT JOIN ydduc.UC_USER uaas ON v.ASSIGNED_TO = uaas.ID
        LEFT JOIN ydduc.UC_DEPARTMENT depart ON uu.DEPARTMENT = depart.ID
        <where>
        <if test="memberId != 0">and v.MEMBER_ID = #{memberId}</if>
        <if test="searchKey != null ">
            <choose>
                <when test="searchType == 'name'">
                    and v.NAME like #{searchKey}
                </when>
                <when test="searchType == 'serviceAccount'">
                    and sa.NAME like #{searchKey}
                </when>
                <when test="searchType == 'cloudAccount'">
                    and v.CLOUD_ACCOUNT_NAME like #{searchKey}
                </when>
                <when test="searchType == 'ldc'">
                    and v.LDC_NAME like #{searchKey}
                </when>
                <when test="searchType == 'cluster'">
                    and ifnull(v.CLUSTER_NAME,v.ZONE_NAME) like #{searchKey}
                </when>
                <when test="searchType == 'ip'">
                    and v.IP like #{searchKey}
                </when>
                <when test="searchType == 'app'">
                    and app.NAME like #{searchKey}
                </when>
                <when test="searchType == 'owner'">
                    and v.OWNED_BY in<foreach collection="ownerIds" item="id" open="(" close=")" separator=","> #{id} </foreach>
                </when>
                <otherwise>
                and ( v.NAME like #{searchKey}
                    or sa.NAME like #{searchKey}
                    or v.CLOUD_ACCOUNT_NAME like #{searchKey}
                    or v.LDC_NAME like #{searchKey}
                    or ifnull(v.CLUSTER_NAME,v.ZONE_NAME) like #{searchKey}
                    or v.IP like #{searchKey}
                    or app.NAME like #{searchKey}
                    or v.HOST_ENTITY_NAME like #{searchKey}
                    or concat(v.CPUS,'C/',ceil(v.MEMORY/1024),'G') like #{searchKey}
                    or v.OWNED_BY in<foreach collection="ownerIds" item="id" open="(" close=")" separator=","> #{id} </foreach>
                )
                </otherwise>
            </choose>
        </if>
        </where>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_PM_HARDWARE_TEMPLATE.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：and,CONCAT,now,CJ_CMP_PM_HARDWARE_TEMPLATE,values,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_PM_INSTANCE.xml
> sql统计:复杂1个，简单0个
>
> 使用的关键字：IFNULL,REPLACE,ifnull,LOWER,join,concat,CONCAT,and,INSTR,SUBSTRING_INDEX
#### list
```

    select pm.ID,pm.MEMBER_ID,pm.NAME,pm.CPU_CORE_COUNT as cpus,pm.RAM as memory,pm.DISK_SPACE as disk, pm.SN, pm.ENTITY_ID, pm.OPERATIONAL_STATUS as `status`, pm.RUN_STATUS as runStatus, pm.OOB_IP as ip,pm.BIZ_IP, pm.label, concat(pm.OS_DOMAIN, IFNULL(pm.OS_VERSION,'')) as os,pm.IS_LOCKED,
    pm.OWNED_BY, depart.`NAME` as dept, sa.NAME AS serviceAccountName, cdc.CLOUD_ACCOUNT_ID, ca.NAME asCLOUD_ACCOUNT_NAME,app.NAME as appSystemName, du.NAME as appDuName , du.APP_DU_TYPE as appDuType, dc.NAME as dataCenter,room.NAME as serverRoom,cabinet.NAME as serverCabinet,
    pm.U_START as uStart, region.NAME as region, pm.USED_FOR as `usage`,sa.DATACENTER_TYPE, pm.MANUFACTURER, pm.MODEL_ID as model
    from CJ_CMDB_CI_PHYSICAL_DATACENTER dc inner join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID=dc.SERVICE_ACCOUNT_ID and sa.IS_DELETED=0 and dc.IS_DELETED=0
    left outer join CJ_CMP_CLOUD_ACCOUNT_DC cdc on cdc.SERVICE_ACCOUNT_ID=dc.SERVICE_ACCOUNT_ID and cdc.LDC_ID=dc.ID and cdc.IS_DELETED=0
    left outer join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID=cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED=0
    inner join CJ_CMDB_CI_PHYSICAL_MACHINE pm on pm.LDC_ID=dc.ID and pm.IS_DELETED=0
    left outer join CJ_CMDB_CI_COMPUTER_ROOM room on pm.COMPUTER_ROOM_ID=room.ID
    left outer join CJ_CMDB_CI_CABINET cabinet on cabinet.ID=pm.CABINET_ID
     left outer join CJ_CMP_APP_SYSTEM app on app.ID=pm.APP_SYSTEM_ID
     left outer join CJ_CMDB_CI_SYS_REGION region on pm.REGION_ID = region.ID and region.IS_DELETED = 0
     left join CJ_CMP_APP_DU du on pm.APP_DU_ID = du.ID and du.IS_DELETED = 0
     LEFT JOIN ydduc.UC_USER u ON pm.OWNED_BY = u.ID
     LEFT JOIN ydduc.UC_DEPARTMENT depart ON u.DEPARTMENT = depart.ID
     where pm.ENTITY_ID is not null and pm.IS_DELETED=0
      <if test="queryParam.cloudAccountId != null and queryParam.cloudAccountId != ''"> and ca.ID=#{queryParam.cloudAccountId}</if>
      <if test="queryParam.serviceAccountId != null and queryParam.serviceAccountId != ''"> and sa.ID=#{queryParam.serviceAccountId}</if>
      <if test="queryParam.ldcId != null and queryParam.ldcId != ''"> and dc.ID=#{queryParam.ldcId}</if>
      <if test="queryParam.azId != null and queryParam.azId != ''"> and room.ID=#{queryParam.azId}</if>
    <if test="queryParam.memberId != 0">  and pm.MEMBER_ID = #{queryParam.memberId}</if>
    <if test="queryParam.appSystemName != null and queryParam.appSystemName != ''"> and app.NAME like CONCAT('%',#{queryParam.appSystemName},'%')</if>
    <if test="queryParam.name != null and queryParam.name != ''"> and pm.NAME like CONCAT('%',#{queryParam.name},'%')</if>
    <if test="queryParam.ip != null and queryParam.ip != ''"> and pm.OOB_IP like CONCAT('%',#{queryParam.ip},'%')</if>
    <if test="queryParam.userIds != null and queryParam.userIds.size >0 ">
     and ( pm.OWNED_BY in <foreach collection="queryParam.userIds" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
       <if test="queryParam.appUserId !=null ">
           or app.SYS_OPR_MANT_OWNER_ID= #{queryParam.appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{queryParam.appUserId} or app.BIZ_OWNER_ID=#{queryParam.appUserId}
           <if test="queryParam.appDepartmentList != null and queryParam.appDepartmentList.size != 0">
             or app.DEPT_ID in <foreach collection="queryParam.appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
             or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="queryParam.appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
           </if>
       </if>
     )
    </if>
    <if test="queryParam.ownedByList != null and queryParam.ownedByList.size != 0">
      and pm.OWNED_BY in <foreach collection="queryParam.ownedByList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
    </if>
    <if test="queryParam.sn != null and queryParam.sn != ''"> and pm.SN like CONCAT('%',#{queryParam.sn},'%')</if>
    <if test="queryParam.runStatus != null and queryParam.runStatus != ''"> and pm.RUN_STATUS = #{queryParam.runStatus}</if>
    <if test="queryParam.status != null and queryParam.status != ''"> and pm.OPERATIONAL_STATUS = #{queryParam.status}</if>
    <if test="queryParam.searchKey != null and queryParam.searchKey != ''">
      and (pm.NAME like CONCAT('%',#{queryParam.searchKey},'%') or pm.OOB_IP like CONCAT('%',#{queryParam.searchKey},'%') or pm.sn like CONCAT('%',#{queryParam.searchKey},'%') or pm.RUN_STATUS = #{queryParam.searchKey} 
           or pm.OPERATIONAL_STATUS = #{queryParam.searchKey} or pm.BIZ_IP like CONCAT('%', #{queryParam.searchKey}, '%') or app.NAME like CONCAT('%',#{queryParam.searchKey},'%')
           or dc.NAME like CONCAT('%',#{queryParam.searchKey},'%') or room.NAME like CONCAT('%',#{queryParam.searchKey},'%') or cabinet.NAME like CONCAT('%',#{queryParam.searchKey},'%')
      <if test="queryParam.searchKeyList != null and queryParam.searchKeyList.size != 0">
        or pm.OWNED_BY in <foreach collection="queryParam.searchKeyList" item="searchKey" open="(" close=")" separator=",">#{searchKey}</foreach>
      </if>
      )
    </if>
    <if test=" queryParam.bizIps != null and queryParam.bizIps.size >0 ">
      and <foreach collection="queryParam.bizIps" item="ip" open="(" close=")" separator="or">INSTR(pm.BIZ_IP, #{ip})</foreach>
    </if>
    union all
    select  cpm.ID,cpm.MEMBER_ID,cpm.DEVICE_NAME as NAME,SUBSTRING_INDEX(LOWER(cpm.SPEC),'c',1) as cpus, REPLACE(SUBSTRING_INDEX(LOWER(cpm.SPEC),'c',-1),'g','')*1024 as memory,'' as disk ,cpm.SERVICE_TAG as SN, cpm.ENTITY_ID, cpm.OPERATIONAL_STATUS as `status`, cpm.RUN_STATUS as runStatus, cpm.IP as ip,'' as BIZ_IP,cpm.MANUFACTURER as label,cpm.OS as os,cpm.IS_LOCKED,
        cpm.OWNED_BY, depart.`NAME` as dept, sbTable.NAME AS serviceAccountName, sbTable.CLOUD_ACCOUNT_ID, sbTable.CLOUD_ACCOUNT_NAME,app.NAME as appSystemName, du.NAME as appDuName , du.APP_DU_TYPE as appDuType, sbTable.DATACENTER as dataCenter, cpm.ROOM_NAME as serverRoom,cpm.FRAME_CODE as serverCabinet,
        cpm.START_U as uStart,'' as region, cpm.DESCRIPTION as `usage`,sbTable.DATACENTER_TYPE, cpm.MANUFACTURER, cpm.MODEL
        from CJ_CMP_CLOUDSINO_PHYSICAL_MACHINE cpm inner join
        ( select distinct
        `sa`.ID as SERVICE_ACCOUNT_ID,
        `sa`.NAME,
        `sa`.DATACENTER_TYPE,
        '' as DATACENTER,
        `ca`.ID as CLOUD_ACCOUNT_ID,
        `ca`.NAME as CLOUD_ACCOUNT_NAME
        from
        `CJ_CMP_SERVICE_ACCOUNT` `sa`
        INNER JOIN `CJ_CMP_CLOUD_ACCOUNT_DC` `cdc` ON `cdc`.SERVICE_ACCOUNT_ID = `sa`.ID and `cdc`.IS_DELETED = 0
        INNER JOIN `CJ_CMP_CLOUD_ACCOUNT` `ca` ON `ca`.ID = `cdc`.CLOUD_ACCOUNT_ID and `ca`.IS_DELETED = 0
        inner join `CJ_CMP_CLOUDSINO_PHYSICAL_MACHINE` `dc` on `dc`.SERVICE_ACCOUNT_ID = `sa`.ID and `dc`.IS_DELETED = 0
        <where>
          <if test="queryParam.memberId != null and queryParam.memberId != ''">  and `dc`.MEMBER_ID = #{queryParam.memberId}</if>
        </where>
        ) sbTable on cpm.SERVICE_ACCOUNT_ID = sbTable.SERVICE_ACCOUNT_ID
        left outer join CJ_CMP_APP_SYSTEM app on app.ID = cpm.APP_SYSTEM_ID
        LEFT JOIN ydduc.UC_USER u ON cpm.OWNED_BY = u.ID
        LEFT JOIN ydduc.UC_DEPARTMENT depart ON u.DEPARTMENT = depart.ID
        left join CJ_CMP_APP_DU du on cpm.APP_DU_ID = du.ID
        and du.IS_DELETED = 0
        where  cpm.IS_DELETED = 0
        <if test="queryParam.memberId != null and queryParam.memberId != ''">  and cpm.MEMBER_ID = #{queryParam.memberId}</if>
        <if test="queryParam.appSystemName != null and queryParam.appSystemName != ''"> and app.NAME like CONCAT('%',#{queryParam.appSystemName},'%')</if>
        <if test="queryParam.name != null and queryParam.name != ''"> and cpm.DEVICE_NAME like CONCAT('%',#{queryParam.name},'%')</if>
        <if test="queryParam.ip != null and queryParam.ip != ''"> and cpm.IP like CONCAT('%',#{queryParam.ip},'%')</if>
        <if test="queryParam.userIds != null and queryParam.userIds.size >0 ">
            and ( cpm.OWNED_BY in <foreach collection="queryParam.userIds" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
            <if test="queryParam.appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{queryParam.appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{queryParam.appUserId} or app.BIZ_OWNER_ID=#{queryParam.appUserId}
                <if test="queryParam.appDepartmentList != null and queryParam.appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="queryParam.appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="queryParam.appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
            )
        </if>
        <if test="queryParam.ownedByList != null and queryParam.ownedByList.size != 0">
            and cpm.OWNED_BY in <foreach collection="queryParam.ownedByList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
        </if>
        <if test="queryParam.sn != null and queryParam.sn != ''"> and cpm.SERVICE_TAG like CONCAT('%',#{queryParam.sn},'%')</if>
        <if test="queryParam.runStatus != null and queryParam.runStatus != ''"> and cpm.RUN_STATUS = #{queryParam.runStatus}</if>
        <if test="queryParam.status != null and queryParam.status != ''"> and cpm.OPERATIONAL_STATUS = #{queryParam.status}</if>
        <if test="queryParam.searchKey != null and queryParam.searchKey != ''">
            and (cpm.DEVICE_NAME like CONCAT('%',#{queryParam.searchKey},'%') or cpm.IP like CONCAT('%',#{queryParam.searchKey},'%') or cpm.SERVICE_TAG like CONCAT('%',#{queryParam.searchKey},'%') 
                  or cpm.RUN_STATUS = #{queryParam.searchKey} or  cpm.OPERATIONAL_STATUS = #{queryParam.searchKey} or app.NAME like CONCAT('%',#{queryParam.searchKey},'%')
                  or sbTable.DATACENTER like CONCAT('%',#{queryParam.searchKey},'%') or cpm.ROOM_NAME like CONCAT('%',#{queryParam.searchKey},'%') or cpm.FRAME_CODE like CONCAT('%',#{queryParam.searchKey},'%')
            <if test="queryParam.searchKeyList != null and queryParam.searchKeyList.size != 0">
                or cpm.OWNED_BY in <foreach collection="queryParam.searchKeyList" item="searchKey" open="(" close=")" separator=",">#{searchKey}</foreach>
            </if>
            )
        </if>
    union all
    select pm.ID,pm.MEMBER_ID,pm.NAME,pm.CPU_CORE_COUNT as cpus,pm.RAM as memory,
    pm.DISK_SPACE as disk, pm.SN, pm.ENTITY_ID, pm.OPERATIONAL_STATUS as `status`,
    pm.RUN_STATUS as runStatus, pm.OOB_IP as ip,pm.BIZ_IP, pm.label,
    concat(pm.OS_DOMAIN, IFNULL(pm.OS_VERSION,'')) as os,pm.IS_LOCKED,
    pm.OWNED_BY, depart.`NAME` as dept, sa.NAME AS serviceAccountName,
    ca.ID as CLOUD_ACCOUNT_ID, ca.NAME as CLOUD_ACCOUNT_NAME,null,
    null , null as appDuType, dc.NAME as dataCenter,
    az.NAME as serverRoom,cabinet.NAME as serverCabinet,
    pm.U_START as uStart,null, pm.USED_FOR as `usage`,
    sa.DATACENTER_TYPE, pm.MANUFACTURER, pm.MODEL_ID as model
    from CJ_CMDB_CI_PHYSICAL_MACHINE pm
    inner join CJ_PAM_ASSET ass on pm.ID = ass.PM_ID
    LEFT JOIN CJ_CMDB_CI_CABINET cabinet on cabinet.ID=pm.CABINET_ID and cabinet.IS_DELETED=0
    LEFT JOIN CJ_CMDB_CI_COMPUTER_ROOM az on az.ID = cabinet.COMPUTER_ROOM_ID and az.IS_DELETED = 0
    LEFT JOIN CJ_CMDB_CI_PHYSICAL_DATACENTER dc on dc.ID = az.DATACENTER_ID and dc.IS_DELETED = 0
    LEFT JOIN CJ_CMP_SERVICE_ACCOUNT sa on sa.ID = pm.SERVICE_ACCOUNT_ID
    LEFT JOIN CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = ass.CLOUD_ACCOUNT_ID and ca.id
    LEFT JOIN ydduc.UC_USER u ON pm.OWNED_BY = u.ID
    LEFT JOIN ydduc.UC_DEPARTMENT depart ON u.DEPARTMENT = depart.ID
    where pm.ENTITY_ID is not null and pm.IS_DELETED=0
    <if test="queryParam.sn != null and queryParam.sn != ''">  and pm.SN like CONCAT('%',#{queryParam.sn},'%')</if>
    union all
    select bms.ID,bms.MEMBER_ID,bms.SERVICE_ACCOUNT_ID,spec.VCPUS,spec.RAM,spec.DISK,bms.SN,bms.ENTITY_ID,bms.STATUS,null,null,ifnull(bms.IPV4,bms.IPV6),null,img.NAME,0,bms.OWNED_BY,depart.`NAME` as dept, sa.NAME,cdc.CLOUD_ACCOUNT_ID,ca.NAME,app.NAME,null,null,null,null,null,null,dc.NAME,bms.USED_FOR,sa.DATACENTER_TYPE,null,null
    from CJ_CMP_FUSION_CLOUD_BMS_INSTANCE bms inner join CJ_CMP_FUSION_CLOUD_DC dc on bms.LDC_ID=dc.ID
    inner join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID=bms.SERVICE_ACCOUNT_ID
    inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc on cdc.LDC_ID=dc.ID and bms.SERVICE_ACCOUNT_ID=cdc.SERVICE_ACCOUNT_ID and cdc.IS_DELETED=0
    inner join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID=cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED=0
    <choose> <when test="queryParam.mainMemberId != 0"> and ca.MEMBER_ID = #{queryParam.mainMemberId} </when> <otherwise> and ca.SCOPE = 'public' </otherwise> </choose>
    left outer join CJ_CMP_FUSION_CLOUD_BMS_FLAVOR spec on spec.ID=bms.SPEC_ID
    left outer join CJ_CMP_VM_IMAGE img on img.ID=bms.IMAGE_ID
    LEFT JOIN ydduc.UC_USER u ON bms.OWNED_BY = u.ID
    LEFT JOIN ydduc.UC_DEPARTMENT depart ON u.DEPARTMENT = depart.ID
    left outer join CJ_CMP_APP_SYSTEM app on app.ID=bms.APP_SYSTEM_ID
    where bms.IS_DELETED=0 and bms.ENTITY_ID is not null
    <if test="queryParam.cloudAccountId != null and queryParam.cloudAccountId != ''"> and ca.ID=#{queryParam.cloudAccountId}</if>
    <if test="queryParam.serviceAccountId != null and queryParam.serviceAccountId != ''"> and sa.ID=#{queryParam.serviceAccountId}</if>
    <if test="queryParam.ldcId != null and queryParam.ldcId != ''"> and dc.ID=#{queryParam.ldcId}</if>
    <if test="queryParam.azId != null and queryParam.azId != ''"> and bms.ZONE_ID=#{queryParam.azId}</if>

    <if test="queryParam.memberId != 0">  and bms.MEMBER_ID = #{queryParam.memberId}</if>
    <if test="queryParam.appSystemName != null and queryParam.appSystemName != ''"> and app.NAME like CONCAT('%',#{queryParam.appSystemName},'%')</if>
    <if test="queryParam.name != null and queryParam.name != ''"> and bms.NAME like CONCAT('%',#{queryParam.name},'%')</if>
    <if test="queryParam.ip != null and queryParam.ip != ''"> and (bms.IPV4 like CONCAT('%',#{queryParam.ip},'%') or bms.IPV6 like CONCAT('%',#{queryParam.ip},'%'))</if>
    <if test="queryParam.userIds != null and queryParam.userIds.size >0 ">
     and ( bms.OWNED_BY in <foreach collection="queryParam.userIds" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
       <if test="queryParam.appUserId !=null ">
           or app.SYS_OPR_MANT_OWNER_ID= #{queryParam.appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{queryParam.appUserId} or app.BIZ_OWNER_ID=#{queryParam.appUserId}
           <if test="queryParam.appDepartmentList != null and queryParam.appDepartmentList.size != 0">
             or app.DEPT_ID in <foreach collection="queryParam.appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
             or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="queryParam.appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
           </if>
       </if>
     )
    </if>
    <if test="queryParam.ownedByList != null and queryParam.ownedByList.size != 0">
      and bms.OWNED_BY in <foreach collection="queryParam.ownedByList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
    </if>
    <if test="queryParam.sn != null and queryParam.sn != ''"> and bms.SN like CONCAT('%',#{queryParam.sn},'%')</if>
    <if test="queryParam.status != null and queryParam.status != ''"> and bms.STATUS = #{queryParam.status}</if>
    <if test="queryParam.searchKey != null and queryParam.searchKey != ''">
      and (bms.NAME like CONCAT('%',#{queryParam.searchKey},'%') or bms.IPV4 like CONCAT('%',#{queryParam.searchKey},'%') or bms.IPV6 like CONCAT('%',#{queryParam.searchKey},'%') or bms.SN like CONCAT('%',#{queryParam.searchKey},'%') 
          or bms.STATUS = #{queryParam.searchKey} or app.NAME like CONCAT('%',#{queryParam.searchKey},'%')
      <if test="queryParam.searchKeyList != null and queryParam.searchKeyList.size != 0">
        or bms.OWNED_BY in <foreach collection="queryParam.searchKeyList" item="searchKey" open="(" close=")" separator=",">#{searchKey}</foreach>
      </if>
      )
    </if>
    <if test=" queryParam.bizIps != null and queryParam.bizIps.size >0 ">
      and <foreach collection="queryParam.bizIps" item="ip" open="(" close=")" separator="or">INSTR(bms.IPV4, #{ip})</foreach>
    </if>
    order by 3
  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_PM_OR_HOST_VIEW.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：IN,exists,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_PM_TYPE.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：count,concat,NOW,now,CJ_CMP_PM_TYPE,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_PM_TYPE_X_PM.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：NOW,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_POLICY.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：in,now,CJ_CMP_POLICY,values,and,or

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_POLICY_RULE.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：values,now,CJ_CMP_POLICY_RULE

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_POLICY_SCRIPT.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：AND,OR,now,CJ_CMP_POLICY_SCRIPT,VALUES,WHERE,concat

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_POLICY_X_CATALOG_ITEM.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：now,CJ_CMP_POLICY_X_CATALOG_ITEM,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_PROJECT.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：NOW,CJ_CMP_PROJECT,VALUES,and,concat,or,AND,IN

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_PROJECT_X_APP_SYSTEM.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：VALUES,NOW,CJ_CMP_PROJECT_X_APP_SYSTEM

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_PROJECT_X_USER.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：NOW,CJ_CMP_PROJECT_X_USER,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_QUOTA.xml
> sql统计:复杂0个，简单38个
>
> 使用的关键字：CJ_CMP_QUOTA_RESOURCE_CODE,CJ_CMP_QUOTA_RESOURCE_TYPE,substring,isEmpty,startsWith,CJ_CMP_QUOTA_CONFIGURATION,CJ_CMP_QUOTA_RESOURCE_ATTR,VALUES,and,split,from,CJ_CMP_QUOTA_DEFINITION,indexOf,concat,toUpperCase,contains,values,CJ_CMP_QUOTA_CONSUMPTION

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_RB.xml
> sql统计:复杂1个，简单10个
>
> 使用的关键字：CJ_CMP_RB,VALUES,and,or,CONCAT,convert,concat,NOW
#### selectByCondition
```

    select *
    from CJ_CMP_RB
    where IS_DELETED = 0 and (MEMBER_ID = #{memberId} or (MEMBER_ID = 0 and status = 'published'))
      <if test="status != null and status != ''" >
          and `STATUS` = #{status}
      </if>
      <if test="keyword != null and keyword != ''" >
          <choose>
              <when test="queryType != null and queryType == 'name'" >
                  and `NAME` like CONCAT('%',#{keyword},'%')
              </when>
              <when test="queryType != null and queryType == 'layer'" >
                  and (LAYER like CONCAT('%',#{keyword},'%') OR LAYER_NAME like CONCAT('%',#{keyword},'%'))
              </when>
              <otherwise>
                  and (
                  `NAME` like CONCAT('%',#{keyword},'%')
                  OR LAYER like CONCAT('%',#{keyword},'%')
                  OR LAYER_NAME like CONCAT('%',#{keyword},'%')
                  )
              </otherwise>
          </choose>
      </if>
      ORDER BY convert(${sortField} USING gbk) ${sortType}
  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_RB_CAPI_PROVIDER.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_RB_OP.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：where,NOW,CJ_CMP_RB_OP,VALUES,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_RB_OP_PARAM.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：VALUES,and,NOW,CJ_CMP_RB_OP_PARAM

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_RB_OP_STEP.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：and,NOW,CJ_CMP_RB_OP_STEP,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_RECYCLE_RESOURCE.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：now,CJ_CMP_RECYCLE_RESOURCE,values,CONCAT,concat,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_RESOURCE_ATTRIBUTE.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_RESOURCE_AUTHORIZATION.xml
> sql统计:复杂2个，简单6个
>
> 使用的关键字：values,size,NOW,ifnull,and,now,CJ_CMP_RESOURCE_AUTHORIZATION
#### findList
```

        select * from CJ_CMP_RESOURCE_AUTHORIZATION where MEMBER_ID = #{memberId} and IS_DELETED = 0 and BIZ_FUNCTION=#{bizFunction}
        <if test="authObjType!=null">
            and AUTH_OBJ_TYPE=#{authObjType}
            <if test="authObjIds == null || authObjIds.size() == 0">and false</if>
            <if test="authObjIds != null and authObjIds.size() > 0">
                and AUTH_OBJ_ID in <foreach collection="authObjIds" item="authObjId" open="(" separator="," close=")">#{authObjId}</foreach>
            </if>
            and NOW() between ifnull(START_TIME,NOW()) and ifnull(END_TIME,NOW())
        </if>
    
```
#### updateExpireNotify
```

        update CJ_CMP_RESOURCE_AUTHORIZATION set EXPIRE_NOTIFY=ifnull(EXPIRE_NOTIFY,0)|#{notifyTimeType} where ID in <foreach collection="ids" item="id" open="(" close=")" separator=",">#{id}</foreach>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_RESOURCE_AUTH_ENV_CONDITION.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：VALUES,now,CJ_CMP_RESOURCE_AUTH_ENV_CONDITION

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_RESOURCE_AUTH_OBJECT.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：CJ_CMP_RESOURCE_AUTH_OBJECT,VALUES,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_RESOURCE_AUTH_RECORD.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：FIND_IN_SET,CJ_CMP_RESOURCE_AUTH_RECORD,VALUES,now,FROM,concat,WHERE,isEmpty

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_RESOURCE_AUTH_SUBJECT.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CMP_RESOURCE_AUTH_SUBJECT,VALUES,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_RESOURCE_OPERATION.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：isEmpty,now,CJ_CMP_RESOURCE_OPERATION,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_RESOURCE_OPERATION_APPLICABLE_PAGE.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：NOW,CJ_CMP_RESOURCE_OPERATION_APPLICABLE_PAGE,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_RESOURCE_OPERATION_CONTROL.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：now,CJ_CMP_RESOURCE_OPERATION_CONTROL,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_RESOURCE_OPERATION_METHOD.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：NOW,CJ_CMP_RESOURCE_OPERATION_METHOD,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_RESOURCE_OPER_LOG.xml
> sql统计:复杂2个，简单5个
>
> 使用的关键字：now,min,if,max,group_concat,ifnull,CJ_CMP_RESOURCE_OPER_LOG,CONCAT,and,join,GROUP_CONCAT,values
#### queryResourceOperLog
```

      select min(log.ID) as ID, log.MEMBER_ID, if(log.MEMBER_ID=0, '平台租户', `member`.NAME) as memberName, log.SERVICE_ACCOUNT_ID, log.RESOURCE_ID,
      log.RESOURCE_TYPE, log.RESOURCE_ENTITY_ID, log.RESOURCE_NAME, log.RESOURCE_IP, log.ACTION, log.SOURCE, log.CREATE_BY, max(log.CREATE_DATE) as CREATE_DATE,
      group_concat(CHANGE_TYPE, '####', CHANGE_FIELD, '####', ifnull(OLD_VALUE, '-'), '####', ifnull(NEW_VALUE, '-') SEPARATOR '######') as changeContext
      from CJ_CMP_RESOURCE_OPER_LOG log
      left join ydduc.UC_MEMBER `member` on log.MEMBER_ID = `member`.ID
     <where>
        log.RESOURCE_TYPE = 'vm'
       <if test="queryType != null and queryType != '' and keyword != null and keyword != ''">
         <if test="queryType == 'resourceName'"> and log.RESOURCE_NAME like CONCAT('%',#{keyword},'%')</if>
         <if test="queryType == 'resourceIp'"> and log.RESOURCE_IP like CONCAT('%',#{keyword},'%')</if>
         <if test="queryType == 'resourceEntityId'"> and RESOURCE_ENTITY_ID like CONCAT('%',#{keyword},'%')</if>
         <if test="queryType == 'all'">
          and (log.RESOURCE_NAME like CONCAT('%',#{keyword},'%')
          or log.RESOURCE_IP like CONCAT('%',#{keyword},'%')
          or log.RESOURCE_ENTITY_ID like CONCAT('%',#{keyword},'%')
          or `member`.name like CONCAT('%',#{keyword},'%')
         )
         </if>
       </if>
       <if test="startTime != null and startTime != ''"> and log.CREATE_DATE &gt;= #{startTime}</if>
       <if test="endTime != null and endTime != ''"> and log.CREATE_DATE &lt;= #{endTime}</if>
     </where>
      group by log.TRACE_ID, log.RESOURCE_ID, log.MEMBER_ID, log.SERVICE_ACCOUNT_ID,
      log.RESOURCE_TYPE, log.RESOURCE_ENTITY_ID, log.RESOURCE_NAME, log.RESOURCE_IP, log.ACTION,  log.SOURCE, log.CREATE_BY
      order by min(log.ID) desc
  
```
#### getChangedVm
```

        select distinct vm.*,prj.CODE as projectCode,prj.NAME as projectName,prj.PROJECT_SOURCE_ID as projectSourceId,
        app.CODE as appSystemCode,app.NAME as appSystemName,app.SOURCE_ID as appSystemSourceId, vmtag.tags
        from CJ_CMP_RESOURCE_OPER_LOG op
        inner join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID = op.SERVICE_ACCOUNT_ID and sa.IS_DELETED = 0
        <if test="ldcType != null">
            <choose>
                <when test="ldcType == 'vmware'">
                    inner join CJ_CMP_VMWARE_VM vm on vm.SERVICE_ACCOUNT_ID = sa.ID and vm.ENTITY_ID = op.RESOURCE_ENTITY_ID
                    and vm.MEMBER_ID = op.MEMBER_ID
                </when>
                <when test="ldcType == 'fusionCloud'">
                    inner join CJ_CMP_FUSION_CLOUD_ECS vm on vm.SERVICE_ACCOUNT_ID = sa.ID and vm.ENTITY_ID = op.RESOURCE_ENTITY_ID
                    and vm.MEMBER_ID = op.MEMBER_ID
                </when>
            </choose>
        </if>
        <if test="srvCompletionTimeStart!=null or srvCompletionTimeEnd!=null ">
        left outer join CJ_CMP_RITM_COMPLETED_VIEW req on vm.SRV_NO=req.NUMBER
        </if>
        left outer join CJ_CMP_PROJECT prj on prj.ID = vm.PROJECT_ID
        left outer join CJ_CMP_APP_SYSTEM app on app.ID = vm.APP_SYSTEM_ID
        left outer join CJ_CMP_APP_DU du on du.ID = vm.APP_DU_ID
        left outer join (SELECT rel.OBJECT_ID, rel.OBJECT_TYPE, GROUP_CONCAT(tag.`NAME`) as tags
        from CJ_CMP_TAG tag
        INNER JOIN CJ_CMP_TAG_X_OBJECT rel on tag.ID = rel.TAG_ID
        GROUP BY rel.OBJECT_ID, rel.OBJECT_TYPE) as vmtag
        on vm.ID = vmtag.OBJECT_ID and vmtag.OBJECT_TYPE = #{ldcType}
        where vm.MEMBER_ID = #{memberId}
        and sa.DATACENTER_TYPE = #{ldcType}
        and RESOURCE_TYPE = 'vm'
        <if test="updateDateStart != null and updateDateEnd != null">
            and op.CREATE_DATE between #{updateDateStart,jdbcType= TIMESTAMP} and #{updateDateEnd,jdbcType= TIMESTAMP}
        </if>
        <if test="updateDateStart==null   and  updateDateEnd!=null ">
            and op.CREATE_DATE &lt;=  #{updateDateEnd,jdbcType= TIMESTAMP}
        </if>
        <if test="updateDateStart!=null  and  updateDateEnd==null ">
            and op.CREATE_DATE &gt;=  #{updateDateStart,jdbcType= TIMESTAMP}
        </if>
        <if test="startTime!=null and  endTime!=null ">
            and vm.CREATE_DATE between #{startTime,jdbcType= TIMESTAMP} and  #{endTime,jdbcType= TIMESTAMP}
        </if>
        <if test="startTime==null   and  endTime!=null ">
            and vm.CREATE_DATE &lt;=  #{endTime,jdbcType= TIMESTAMP}
        </if>
        <if test="startTime!=null  and  endTime==null ">
            and vm.CREATE_DATE &gt;=  #{startTime,jdbcType= TIMESTAMP}
        </if>
        <if test="srvCompletionTimeStart!=null and srvCompletionTimeEnd!=null ">
            and if(vm.IS_DELETED=1,vm.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) between #{srvCompletionTimeStart,jdbcType= TIMESTAMP} and  #{srvCompletionTimeEnd,jdbcType= TIMESTAMP}
        </if>
        <if test="srvCompletionTimeStart==null and srvCompletionTimeEnd!=null ">
            and if(vm.IS_DELETED=1,vm.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) &lt;=  #{srvCompletionTimeEnd,jdbcType= TIMESTAMP}
        </if>
        <if test="srvCompletionTimeStart!=null and srvCompletionTimeEnd==null ">
            and if(vm.IS_DELETED=1,vm.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) &gt;=  #{srvCompletionTimeStart,jdbcType= TIMESTAMP}
        </if>
        <if test="deleted != null ">
            <choose>
                <when test="deleted">
                    and vm.IS_DELETED=1
                </when>
                <otherwise>
                    and vm.IS_DELETED=0
                </otherwise>
            </choose>
        </if>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_RESOURCE_POOL.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：CJ_CMP_RESOURCE_POOL,VALUES,IN,concat,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_RESOURCE_TYPE.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：CJ_CMP_RESOURCE_TYPE,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_SCRIPT.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：values,count,in,CONCAT,NOW,CJ_CMP_SCRIPT

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_SCRIPT_CATEGORY.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：in,NOW,CJ_CMP_SCRIPT_CATEGORY,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_SERVICE_ACCOUNT.xml
> sql统计:复杂0个，简单17个
>
> 使用的关键字：concat,size,and,count,in,now,CONCAT,NOW,CJ_CMP_SERVICE_ACCOUNT,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_SERVICE_INSTANCE_CHANGE.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：VALUES,on,AND,OR,in,NOW,CJ_CMP_SERVICE_INSTANCE_CHANGE

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_SERVICE_INSTANCE_OPERATE.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：NOW,CJ_CMP_SERVICE_INSTANCE_OPERATE,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_SERVICE_POOL.xml
> sql统计:复杂6个，简单8个
>
> 使用的关键字：exists,count,sum,join,now,CJ_CMP_SERVICE_POOL,size,and,VALUES,select,round
#### queryIpStatisticsBySpId
```

        select (CASE
            WHEN cidr.IP_VERSION = 'IPv6' THEN null
            WHEN cidr.IP_VERSION = 'IPv4' THEN count(ip.CIDR_BLOCK_ID) END)    as ipSum,
       (CASE
            WHEN cidr.IP_VERSION = 'IPv6' THEN null
            WHEN cidr.IP_VERSION = 'IPv4' THEN sum(ip.STATUS != 'unused') END) as ipUsed,
       (CASE
            WHEN cidr.IP_VERSION = 'IPv6' THEN null
            WHEN cidr.IP_VERSION = 'IPv4' THEN sum(ip.STATUS = 'unused') END)  as ipUnused,
       (CASE
            WHEN cidr.IP_VERSION = 'IPv6' THEN null
            WHEN cidr.IP_VERSION = 'IPv4' THEN round((sum(ip.STATUS != 'unused') / count(ip.CIDR_BLOCK_ID) * 100),
                                                     2) END)                   as ipUsage
        from CJ_CMP_CIDR_BLOCK cidr
         inner join CJ_CMP_SERVICE_POOL_X_GRANT_RES res
                    on res.GRANT_RESOURCE_TYPE = 'CIDR' and res.GRANT_RESOURCE_ID = cidr.ID and
                       res.SERVICE_POOL_ID = #{servicePoolId}
         left join
         (select CIDR_BLOCK_ID, `TYPE`
          from CJ_CMP_CIDR_BLOCK_X_NETWORK rel
                   inner join CJ_CMP_SERVICE_ACCOUNT sa on rel.SERVICE_ACCOUNT_ID = sa.ID
          where sa.TYPE = 'aliyunPublic')
         as al on cidr.ID = al.CIDR_BLOCK_ID
         left join CJ_CMP_NETWORK_AREA area on cidr.NETWORK_AREA_ID = area.ID
         left join CJ_CMP_IP_POOL ip on cidr.ID = ip.CIDR_BLOCK_ID
        where cidr.MEMBER_ID = #{memberId}
          and al.TYPE is null
          and cidr.IP_VERSION = 'IPv4'
        group by cidr.IP_VERSION
    
```
#### queryVMwareClusterResBySpId
```

        select sum(host.CPUS)                                                 as cpuSum,
               sum(host.CPU_USED)                                             as cpuUsed,
               sum(host.MEMORY_SUM) / 1024                                    as memorySum,
               sum(host.MEMORY_USED) / 1024                                   as memoryUsed,
               sum(host.DISK_SUM)                                             as localStorageSum,
               sum(host.DISK_USED)                                            as localStorageUsed,
               round((sum(host.CPU_USED) / sum(host.CPUS)) * 100, 2)          as cpuUsage,
               round((sum(host.MEMORY_USED) / sum(host.MEMORY_SUM)) * 100, 2) as memoryUsage,
               round((sum(host.DISK_USED) / sum(host.DISK_SUM)) * 100, 2)     as localStorageUsage
        from CJ_CMP_SERVICE_POOL_X_GRANT_RES res
                 left join CJ_CMP_VMWARE_CLUSTER clu
                           on res.GRANT_RESOURCE_TYPE = 'CLUSTER' and res.GRANT_RESOURCE_ID = clu.ID and
                              res.SERVICE_POOL_ID = #{servicePoolId} and res.MEMBER_ID = #{memberId}
                 left join CJ_CMP_VMWARE_HOST host on host.CLUSTER_ID = clu.ID
    
```
#### queryVMwareStorageBySpId
```

        select sum(store.DISK_SUM)                                          as sharedStorageSum,
       sum(store.DISK_SUM - store.DISK_FREE)                        as sharedStorageUsed,
       sum(store.PROVISIONED)                                       as storageProvisioned,
       round((sum(store.DISK_SUM - store.DISK_FREE) / sum(store.DISK_SUM)) * 100, 2) as sharedStorageUsage
        from CJ_CMP_SERVICE_POOL_X_GRANT_RES res
         left join CJ_CMP_VMWARE_DATASTORE store
                   on res.GRANT_RESOURCE_TYPE = 'STORAGE' and res.GRANT_RESOURCE_ID = store.ID and
                      res.SERVICE_POOL_ID = #{servicePoolId} and res.MEMBER_ID = #{memberId}

    
```
#### queryFusionCloudAzResBySpId
```

        select sum(host.CPUS)                                                 as cpuSum,
               sum(host.CPU_USED)                                             as cpuUsed,
               sum(host.MEMORY_SUM) / 1024                                    as memorySum,
               sum(host.MEMORY_USED) / 1024                                   as memoryUsed,
               sum(host.DISK_SUM)                                             as localStorageSum,
               sum(host.DISK_USED)                                            as localStorageUsed,
               round((sum(host.CPU_USED) / sum(host.CPUS)) * 100, 2)          as cpuUsage,
               round((sum(host.MEMORY_USED) / sum(host.MEMORY_SUM)) * 100, 2) as memoryUsage,
               round((sum(host.DISK_USED) / sum(host.DISK_SUM)) * 100, 2)     as localStorageUsage
        from CJ_CMP_SERVICE_POOL_X_GRANT_RES res
                 left join CJ_CMP_CLOUD_AZ az
                           on res.GRANT_RESOURCE_TYPE = 'AZ' and res.GRANT_RESOURCE_ID = az.ID and
                              res.SERVICE_POOL_ID = #{servicePoolId} and res.MEMBER_ID = #{memberId}
                 left join CJ_CMP_FUSION_CLOUD_HOST host on host.ZONE_ID = az.ID
    
```
#### queryFusionComputeClusterResBySpId
```

        select sum(clu.CPU_SUM)                                       as cpuSum,
               sum(clu.CPU_USED)                                       as cpuUsed,
               sum(clu.MEMORY_SUM / 1024)                              as memorySum,
               sum(clu.MEMORY_USED / 1024)                             as memoryUsed,
               round((sum(clu.CPU_USED) / sum(clu.CPU_SUM)) * 100, 2)       as cpuUsage,
               round((sum(clu.MEMORY_USED) / sum(clu.MEMORY_SUM)) * 100, 2) as memoryUsage
         from CJ_CMP_SERVICE_POOL_X_GRANT_RES res
         left join CJ_CMP_FUSION_COMPUTE_CLUSTER clu
                   on res.GRANT_RESOURCE_TYPE = 'CLUSTER' and res.GRANT_RESOURCE_ID = clu.ID and
                      res.SERVICE_POOL_ID = #{servicePoolId} and res.MEMBER_ID = #{memberId}
    
```
#### queryFusionComputeStorageBySpId
```

        select sum(store.CAPACITY_GB)                                          as sharedStorageSum,
               sum(store.USED_SIZE_GB)                        as sharedStorageUsed,
               round((sum(store.USED_SIZE_GB) / sum(store.CAPACITY_GB)) * 100, 2) as sharedStorageUsage
        from CJ_CMP_SERVICE_POOL_X_GRANT_RES res
        left join CJ_CMP_FUSION_COMPUTE_DATASTORE store
                   on res.GRANT_RESOURCE_TYPE = 'STORAGE' and res.GRANT_RESOURCE_ID = store.ID and
                      res.SERVICE_POOL_ID = #{servicePoolId} and res.MEMBER_ID = #{memberId}
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_SERVICE_POOL_X_GRANT_RES.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：size,CJ_CMP_SERVICE_POOL_X_GRANT_RES,VALUES,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_SOFTWARE_ASSIGN.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：DATE,count

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_SOFTWARE_INSTANCE.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：count

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_SOFTWARE_RESOURCE.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：values,concat,and,CONCAT,NOW,now,CJ_CMP_SOFTWARE_RESOURCE

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_SPEC.xml
> sql统计:复杂1个，简单13个
>
> 使用的关键字：values,and,in,CONCAT,group_concat,now,CJ_CMP_SPEC
#### queryWithPmType
```

        select spec.*, group_concat(pmType.NAME) pmType from CJ_CMP_SPEC spec
        left join CJ_CMP_SPEC_X_PM_TYPE rel on spec.ID = rel.SPEC_ID
        left join CJ_CMP_PM_TYPE pmType on rel.PM_TYPE_ID = pmType.ID and pmType.IS_DELETED=0
        where spec.IS_DELETED = 0
        <if test="name != null and name != ''">
            and spec.NAME like CONCAT('%',#{name},'%')
        </if>
        <if test="needCustom != null and needCustom == false">
            and spec.NAME != '自定义规格'
        </if>
        group by spec.ID
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_SPEC_CATAGORY.xml
> sql统计:复杂1个，简单8个
>
> 使用的关键字：ifnull,JOIN,count,in,now,CJ_CMP_SPEC_CATAGORY,values
#### queryAll
```

        SELECT catagory.ID AS id,catagory.NAME AS name,ifnull(spec.num,0) num 
        FROM CJ_CMP_SPEC_CATAGORY catagory 
        LEFT JOIN (
            select SPEC_CATAGORY_ID,count(distinct s.ID) as num from CJ_CMP_SPEC s
            <if test="memberId != null and memberId != 0">
                inner join CJ_CMP_SPEC_X_MEMBER xm on xm.SPEC_ID=s.ID and xm.IS_DELETED=0 and xm.MEMBER_ID=#{memberId}
            </if>
            where s.IS_DELETED = 0 group by SPEC_CATAGORY_ID
        ) spec ON catagory.ID = spec.SPEC_CATAGORY_ID
        WHERE  catagory.IS_DELETED = 0;
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_SPEC_X_MEMBER.xml
> sql统计:复杂1个，简单7个
>
> 使用的关键字：ceil,concat,and,ifnull,exists,CJ_CMP_SPEC_X_MEMBER,now,values,NOW
#### queryUnRelList
```

        select distinct sat.CODE as SERVICE_ACCOUNT_TYPE,sat.NAME as SERVICE_ACCOUNT_TYPE_NAME,s.ID as specId,s.NAME,s.CPU,s.MEMORY,sc.NAME as CATAGORY
        from CJ_CMP_SPEC s
        INNER JOIN CJ_SYS_DIC sat on sat.TYPE_CODE='SERVICE_ACCOUNT_TYPE'
        LEFT JOIN CJ_CMP_SPEC_CATAGORY sc on sc.ID=s.SPEC_CATAGORY_ID
        LEFT JOIN CJ_CMP_SPEC_X_PM_TYPE xp on xp.SPEC_ID=s.ID
        LEFT JOIN CJ_CMP_SPEC_X_MEMBER x on s.ID=x.SPEC_ID and x.IS_DELETED=0 and x.MEMBER_ID=#{memberId} and x.SERVICE_ACCOUNT_TYPE=sat.CODE and ifnull(x.PM_TYPE_ID,0) =ifnull(xp.PM_TYPE_ID,0)
        where s.IS_DELETED=0 and x.ID is null
        and exists (select xs.SPEC_ID from CJ_CMP_SPEC_X_VM_SPEC xs, CJ_CMP_SERVICE_ACCOUNT sa where xs.SERVICE_ACCOUNT_ID=sa.ID and xs.SPEC_ID=s.ID and sa.TYPE=sat.CODE)
        <if test="searchKey!='' and searchKey != null">
            <choose>
                <when test="searchType=='serviceAccountType'">
                    and sat.NAME like concat('%',#{searchKey},'%')
                </when>
                <when test="searchType=='spec'">
                    and s.NAME like concat('%',#{searchKey},'%')
                </when>
                <when test="searchType=='catagory'">
                    and sc.NAME like concat('%',#{searchKey},'%')
                </when>
                <otherwise>
                    and (sat.NAME like concat('%',#{searchKey},'%') or s.NAME like concat('%',#{searchKey},'%') or sc.NAME like concat('%',#{searchKey},'%'))
                </otherwise>
            </choose>
        </if>
        order by sat.NAME,CPU,MEMORY
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_SPEC_X_PM_TYPE.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：values,join,IN,now,CJ_CMP_SPEC_X_PM_TYPE

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_SPEC_X_VM_SPEC.xml
> sql统计:复杂1个，简单10个
>
> 使用的关键字：coalesce,and,in,CJ_CMP_SPEC_X_VM_SPEC,values,now
#### queryBySpecId
```

      SELECT xSpec.ID as id,sa.ID as serviceAccountId,sa.NAME,sa.DATACENTER_TYPE, vmSpec.ENTITY_ID,vmSpec.NAME AS entityName,
		  dc.ID as ldcId,dc.NAME as datacenter,coalesce(az.NAME,clu.NAME,fcClu.NAME) as azName,xSpec.AZ_ID as azId
		FROM CJ_CMP_SPEC_X_VM_SPEC xSpec
		join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID=xSpec.SERVICE_ACCOUNT_ID
		LEFT JOIN CJ_CMP_VM_SPEC vmSpec ON xSpec.VM_SPEC_ID = vmSpec.ID
		left outer join CJ_CMP_VMWARE_CLUSTER clu on clu.SERVICE_ACCOUNT_ID=sa.ID and clu.ID=xSpec.AZ_ID
        left outer join CJ_CMP_FUSION_COMPUTE_CLUSTER fcClu on fcClu.SERVICE_ACCOUNT_ID=sa.ID and fcClu.ID=xSpec.AZ_ID
		left outer join CJ_CMP_CLOUD_AZ az on az.SERVICE_ACCOUNT_ID=sa.ID and az.ID=xSpec.AZ_ID
		JOIN CJ_CMP_DC_VIEW dc on dc.LDC_TYPE=sa.DATACENTER_TYPE and dc.ID=xSpec.LDC_ID
        WHERE xSpec.SPEC_ID = #{id} 
        <if test="serviceAccountId != null">
            and xSpec.SERVICE_ACCOUNT_ID=#{serviceAccountId}
        </if>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_STORAGE_ARRAY.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：concat,and,from,count,now,CJ_CMP_STORAGE_ARRAY,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_STORAGE_ARRAY_X_DATASTORE.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：CONCAT,in,CJ_CMP_STORAGE_ARRAY_X_DATASTORE,values,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_STORAGE_VIEW.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_TASK_OPERATION_HISTORY.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：CJ_CMP_TASK_OPERATION_HISTORY,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_USER_PROFILE.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：VALUES,now,CJ_CMP_USER_PROFILE

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_VDS.xml
> sql统计:复杂2个，简单7个
>
> 使用的关键字：count,from,if,concat,CONCAT,group_concat,and,values,in
#### selectById
```

    select
      vds.ID,vds.MEMBER_ID,vds.ENTITY_ID,vds.SERVICE_ACCOUNT_ID,vds.NAME,vds.LDC_ID,vds.LDC_TYPE,vds.STATUS,vds.DESCRIPTION, vds.TYPE as cloudWebType, group_concat(vmHost.NAME) as hostName,
      dc.name  as ldcName,
       saccount.DATACENTER_TYPE as sAccountType,
      saccount.ACCOUNT_ID as sAccountEntityId,
      saccount.NAME as sAccountName,
      (select count(0) from CJ_CMP_VDS_PORTGROUP where VDS_ID = #{id} )  as PORT_GROUP_NUM
    from CJ_CMP_VDS vds
    inner join CJ_CMP_VMWARE_DC dc on vds.LDC_ID = dc.ID
    inner join CJ_CMP_SERVICE_ACCOUNT saccount on vds.SERVICE_ACCOUNT_ID = saccount.ID
    left join CJ_CMP_CLOUD_ACCOUNT_DC cdc on dc.SERVICE_ACCOUNT_ID = cdc.SERVICE_ACCOUNT_ID and dc.ID = cdc.LDC_ID and cdc.IS_DELETED = 0
    left join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED = 0
    left join CJ_CMP_VDS_X_HOST vdsRel on vds.ID = vdsRel.VDS_ID
    left join CJ_CMP_VMWARE_HOST vmHost on vdsRel.HOST_ID = vmHost.ID
    where vds.ID = #{id,jdbcType=BIGINT}
    <choose>
      <when test="memberId != 0">
        and ca.MEMBER_ID = #{memberId}
      </when>
      <otherwise>
        and ca.SCOPE = 'public'
      </otherwise>
    </choose>
    group by vds.ID
  
```
#### selectByKeyValueAndServiceAccount
```

    select * from (select  vds.ID,vds.MEMBER_ID,vds.ENTITY_ID,vds.SERVICE_ACCOUNT_ID,
    if(vds.TYPE = 'VSS',concat(vds.NAME, if(group_concat(vmHost.IP) is null, '', concat('[', group_concat(vmHost.IP), ']'))),vds.NAME) as NAME,
           vds.TYPE, vds.LDC_ID,vds.LDC_TYPE,vds.STATUS,vds.DESCRIPTION, group_concat(vmHost.NAME) as hostName,
    (select count(0) from CJ_CMP_VDS_PORTGROUP vpg where vds.ID = vpg.VDS_ID )  as PORT_GROUP_NUM,
    dc.name as ldcName, saccount.NAME as sAccountName
    from CJ_CMP_VDS vds
    inner join CJ_CMP_VMWARE_DC dc on vds.LDC_ID = dc.ID
    inner join CJ_CMP_SERVICE_ACCOUNT saccount on vds.SERVICE_ACCOUNT_ID = saccount.ID
    left join CJ_CMP_CLOUD_ACCOUNT_DC cdc on dc.SERVICE_ACCOUNT_ID = cdc.SERVICE_ACCOUNT_ID and dc.ID = cdc.LDC_ID and cdc.IS_DELETED = 0
    left join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED = 0
    left join CJ_CMP_VDS_X_HOST vdsRel on vds.ID = vdsRel.VDS_ID
    left join CJ_CMP_VMWARE_HOST vmHost on vdsRel.HOST_ID = vmHost.ID
    <where>
      <choose>
        <when test="memberId != 0">
          and ca.MEMBER_ID = #{memberId}
        </when>
        <otherwise>
          and ca.SCOPE = 'public'
        </otherwise>
      </choose>
    <if test="serviceAccountId != 'ALL'" >
      and vds.SERVICE_ACCOUNT_ID = #{serviceAccountId}
    </if>
    <if test="cloudAccountId != 'ALL'" >
      and vds.LDC_ID in (
      select cadc.LDC_ID from  CJ_CMP_CLOUD_ACCOUNT_DC cadc where cadc.CLOUD_ACCOUNT_ID = #{cloudAccountId}
      )
    </if>
    <if test="ldcId != '' and ldcId != null" >
      and vds.LDC_ID = #{ldcId}
    </if>
    </where>
    group by vds.ID) t where 1 = 1
    <if test="queryValue != null" >
      <if test="queryValue != ''" >
      <choose>
          <when test="queryKey == 'ALL'" >
              and (
              t.NAME like CONCAT('%',#{queryValue},'%')
              OR t.ENTITY_ID like CONCAT('%',#{queryValue},'%')
              )
          </when>
          <otherwise>
              <if test="queryKey == 'ENTITY_ID'" >
                  and t.ENTITY_ID like CONCAT('%',#{queryValue},'%')
              </if>
              <if test="queryKey == 'NAME'" >
                  and t.NAME like CONCAT('%',#{queryValue},'%')
              </if>
          </otherwise>
      </choose>
      </if>
    </if>

  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_VDS_PORTGROUP.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：CONCAT,count,values,IF,ISNULL,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_VMWARE_CLUSTER.xml
> sql统计:复杂1个，简单6个
>
> 使用的关键字：sum,round,and,size,in
#### queryCluster
```

        select clu.ID,
        clu.NAME,
        clu.ENTITY_ID,
        cdc.LDC_ID,
        cdc.LDC_TYPE,
        dc.ENTITY_ID                                  as ldcEntityId,
        dc.NAME                                       as ldcName,
        sa.NAME                                       as serviceAccountName,
        sa.ID                                         as serviceAccountId,
        sum(host.CPUS)                                as cpuSum,
        sum(host.CPU_USED)                            as cpuUsed,
        sum(host.MEMORY_SUM) / 1024                   as memorySum,
        sum(host.MEMORY_USED) / 1024                  as memoryUsed,
        sum(host.DISK_SUM)                            as localStorageSum,
        sum(host.DISK_USED)                           as localStorageUsed,
        round((sum(host.CPU_USED) / sum(host.CPUS)) * 100 , 2) as cpuUsage,
        round((sum(host.MEMORY_USED) / sum(host.MEMORY_SUM)) * 100, 2)  as memoryUsage,
        round((sum(host.DISK_USED) / sum(host.DISK_SUM)) * 100, 2) as localStorageUsage
        from CJ_CMP_SERVICE_ACCOUNT sa
        inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc
        on sa.ID = cdc.SERVICE_ACCOUNT_ID and sa.IS_DELETED = 0 AND cdc.IS_DELETED = 0
        inner join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED = 0
        inner join CJ_CMP_VMWARE_DC dc on cdc.LDC_ID = dc.ID and dc.IS_DELETED = 0 and dc.SERVICE_ACCOUNT_ID = sa.ID
        inner join CJ_CMP_VMWARE_CLUSTER clu on dc.ID = clu.LDC_ID
        left join CJ_CMP_VMWARE_HOST host on host.CLUSTER_ID = clu.ID
        where dc.IS_DELETED=0
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>
        <if test="clusterId != null and clusterId != ''"> and clu.ID=#{clusterId}</if>
        <if test="serviceAccountId != null and serviceAccountId != ''"> and sa.ID=#{serviceAccountId}</if>
        <if test="cloudAccountId != null and cloudAccountId != ''"> and ca.ID=#{cloudAccountId}</if>
        <if test="ldcId != null and ldcId != ''"> and cdc.LDC_ID=#{ldcId}</if>
        <if test="ldcType != null and ldcType != ''"> and cdc.LDC_TYPE=#{ldcType}</if>
        <if test="searchKey != null and searchKey != ''"> and (clu.NAME like #{searchKey} or clu.ENTITY_ID like #{searchKey})</if>
        <if test="name != null and name != ''"> and clu.NAME like #{name} </if>
        <if test="ldcIds != null and ldcIds.size()>0">
           and cdc.LDC_ID IN <foreach collection="ldcIds" item="ldc" open="(" separator="," close=")"> #{ldc} </foreach>
        </if>
        group by clu.ID, clu.NAME, clu.ENTITY_ID, cdc.LDC_ID, cdc.LDC_TYPE, dc.ENTITY_ID, dc.NAME, sa.NAME, sa.ID
        <if test="sortField != null and sortField!= '' and sortType != null and sortType!= '' ">
            <choose>
                <when test="sortField == 'cpuUsage' or sortField == 'memoryUsage' or sortField == 'localStorageUsage'">
                    ORDER BY ${sortField} ${sortType}
                </when>
                <otherwise>
                    order by clu.NAME
                </otherwise>
            </choose>
        </if>
        <if test="sortField == null or sortType == null ">
            order by clu.NAME
        </if>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_VMWARE_DATASTORE.xml
> sql统计:复杂5个，简单10个
>
> 使用的关键字：group_concat,size,and,round,if,join,in,sum,IN
#### queryDatastore
```

        SELECT ds.ID,ds.SERVICE_ACCOUNT_ID,ds.NAME,ds.ENTITY_ID,ds.IS_DISABLED,ds.DISK_SUM,ds.DISK_FREE,ds.PROVISIONED,ds.TYPE,ds.IS_CLUSTERED,cdc.LDC_TYPE,cdc.LDC_ID,dc.NAME as ldcName,dc.ENTITY_ID as ldcEntityId, store.*,
        ((ds.DISK_SUM - DISK_FREE) / DISK_SUM) as diskUsage,  ((ds.PROVISIONED) / DISK_SUM) as provisionUsage
        FROM CJ_CMP_CLOUD_ACCOUNT ca
        inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc on ca.ID=cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED=0 and cdc.LDC_TYPE='vmware' AND cdc.IS_DELETED=0
        inner join CJ_CMP_VMWARE_DC dc on cdc.LDC_ID=dc.ID and cdc.IS_DELETED=0 and dc.IS_DELETED=0
        inner join CJ_CMP_VMWARE_DATASTORE ds ON ds.LDC_ID= dc.ID and ds.SERVICE_ACCOUNT_ID=dc.SERVICE_ACCOUNT_ID
        left join
        (
        SELECT group_concat(clu.ID) as CLUSTER_ID, group_concat(host.ID) as HOST_ID, group_concat(clu.NAME) AS clusterName , group_concat(clu.ENTITY_ID) clusterEntityId, group_concat(host.NAME) as hostName, group_concat(host.ENTITY_ID) as hostEntityId, group_concat(host.IP)as hostIp,dt.ID AS dsId
        FROM CJ_CMP_VMWARE_HOST host LEFT JOIN CJ_CMP_VMWARE_CLUSTER clu ON host.CLUSTER_ID = clu.ID
        inner join CJ_CMP_VMWARE_DATASTORE_HOSTMOUNT mou on mou.VMWARE_HOST_ID=host.ID
        inner join CJ_CMP_VMWARE_DATASTORE dt on dt.ID=mou.VMWARE_DATASTORE_ID
        <where>
            <if test="clusterIds != null and clusterIds.size()>0">
                and clu.ID IN <foreach collection="clusterIds" item="clu" open="(" separator="," close=")"> #{clu} </foreach>
            </if>
            <if test="hostId != null and hostId != ''"> and host.ID=#{hostId}</if>
        </where>
        GROUP BY dsId
        ) store ON dsId= ds.ID
        <where>
            <choose>
                <when test="memberId != 0">
                    and ca.MEMBER_ID = #{memberId}
                </when>
                <otherwise>
                    and ca.SCOPE = 'public'
                </otherwise>
            </choose>
            <if test="id != null and id != ''"> and ds.ID=#{id}</if>
            <if test="serviceAccountId != null and serviceAccountId != ''"> and cdc.SERVICE_ACCOUNT_ID=#{serviceAccountId}</if>
            <if test="cloudAccountId != null and cloudAccountId != ''"> and ca.ID=#{cloudAccountId}</if>
            <if test="ldcId != null and ldcId != ''"> and dc.ID=#{ldcId}</if>
            <if test="name != null and name != ''"> and ds.NAME like #{name}</if>
            <if test="clusterId != null and clusterId != ''"> and store.CLUSTER_ID=#{clusterId}</if>
            <if test="hostId != null and hostId != ''"> and store.HOST_ID=#{hostId}</if>
            <if test="entityId != null and entityId != ''"> and ds.ENTITY_ID like #{entityId}</if>
            <if test="searchKey != null and searchKey != ''"> and (ds.NAME like #{searchKey} or ds.ENTITY_ID like #{searchKey} or hostIp like #{searchKey})</if>
            <if test="hostIp != null and hostIp != ''"> and hostIp like #{hostIp}</if>
            <if test="ldcIds != null and ldcIds.size()>0">
                and dc.ID IN <foreach collection="ldcIds" item="ldc" open="(" separator="," close=")"> #{ldc} </foreach>
            </if>
            <if test="clusterIds != null and clusterIds.size()>0">
                and store.CLUSTER_ID IN <foreach collection="clusterIds" item="clu" open="(" separator="," close=")"> #{clu} </foreach>
            </if>
        </where>
        <if test="sortField != null and sortField!= '' and sortType != null and sortType!= '' ">
            ORDER BY ${sortField} ${sortType}
        </if>
                   
    
```
#### statisticDataStoreByServiceAccoutId
```

        SELECT
            sum(da.DISK_SUM)  as DISK_SUM,
            sum(da.DISK_SUM - da.DISK_FREE) as DISK_USED,
            round(if(sum(da.DISK_SUM) = 0, 0, sum(da.DISK_SUM - da.DISK_FREE) / sum(da.DISK_SUM)), 2) * 100 as DISK_USAGE
        FROM CJ_CMP_VMWARE_DATASTORE da
        where SERVICE_ACCOUNT_ID = #{serviceAccountId};
    
```
#### statisticDataStoreByCloudAccoutId
```

        SELECT
        sum(da.DISK_SUM)  as DISK_SUM,
        sum(da.DISK_SUM - da.DISK_FREE) as DISK_USED,
        round(if(sum(da.DISK_SUM) = 0, 0, sum(da.DISK_SUM - da.DISK_FREE) / sum(da.DISK_SUM)), 2) * 100 as DISK_USAGE
        FROM CJ_CMP_VMWARE_DATASTORE da
        where LDC_ID IN (select adc.LDC_ID
                                    from CJ_CMP_CLOUD_ACCOUNT_DC adc inner join CJ_CMP_CLOUD_ACCOUNT ca on adc.CLOUD_ACCOUNT_ID = ca.ID
                                    where adc.CLOUD_ACCOUNT_ID = #{cloudAccountId} AND adc.IS_DELETED = 0
                                    <choose>
                                        <when test="memberId != 0">
                                            and ca.MEMBER_ID = #{memberId}
                                        </when>
                                        <otherwise>
                                            and ca.SCOPE = 'public'
                                        </otherwise>
                                    </choose>);
    
```
#### statisticDataStoreTypeBySaId
```

        select
            TYPE,
            SERVICE_ACCOUNT_ID,
            sum(DISK_SUM)             as DISK_SUM,
            sum(DISK_FREE)            as DISK_FREE,
            sum(DISK_SUM - DISK_FREE) as DISK_USED,
            sum(PROVISIONED)          as PROVISIONED,
            round(if(sum(DISK_SUM) = 0, 0, sum(DISK_SUM - DISK_FREE) / sum(DISK_SUM)), 2) * 100 as DISK_USAGE
        from CJ_CMP_VMWARE_DATASTORE where SERVICE_ACCOUNT_ID = #{serviceAccountId}
        group by TYPE, SERVICE_ACCOUNT_ID, MEMBER_ID
    
```
#### statisticDataStoreTypeByCaId
```

        select
            TYPE,
            LDC_ID,
            sum(DISK_SUM)                                                                       as DISK_SUM,
            sum(DISK_FREE)                                                                      as DISK_FREE,
            sum(DISK_SUM - DISK_FREE)                                                           as DISK_USED,
            sum(PROVISIONED)                                                                    as PROVISIONED,
            round(if(sum(DISK_SUM) = 0, 0, sum(DISK_SUM - DISK_FREE) / sum(DISK_SUM)), 2) * 100 as DISK_USAGE
        from CJ_CMP_VMWARE_DATASTORE where LDC_ID in (select adc.LDC_ID from CJ_CMP_CLOUD_ACCOUNT_DC adc inner join CJ_CMP_CLOUD_ACCOUNT ca on adc.CLOUD_ACCOUNT_ID = ca.ID
                                                            where adc.CLOUD_ACCOUNT_ID = #{cloudAccountId} AND adc.IS_DELETED = 0
                                                            <choose>
                                                                <when test="memberId != 0">
                                                                    and ca.MEMBER_ID = #{memberId}
                                                                </when>
                                                                <otherwise>
                                                                    and ca.SCOPE = 'public'
                                                                </otherwise>
                                                            </choose>)
        group by TYPE, LDC_ID, MEMBER_ID
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_VMWARE_DC.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：NOW,CJ_CMP_VMWARE_DC,VALUES,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_VMWARE_FOLDER.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_VMWARE_HOST.xml
> sql统计:复杂3个，简单11个
>
> 使用的关键字：round,if,in,sum,size,and,count,select,group_concat
#### queryByServiceAccountId
```

        select
        host.ID,
        host.NAME,
        host.CPUS,
        host.CPU_USED,
        round(if(host.MEMORY_SUM is not null ,host.MEMORY_SUM/1024,0),2)                              as MEMORY_SUM,
        round(if(host.MEMORY_USED is not null ,host.MEMORY_USED/1024,0),2)                              as MEMORY_USED,
        host.DISK_SUM,
        host.DISK_USED,
        host.SERVICE_ACCOUNT_ID
        from CJ_CMP_VMWARE_HOST host
        <where>
            <if test="serviceAccountId != null and serviceAccountId != ''"> and host.SERVICE_ACCOUNT_ID=#{serviceAccountId}</if>
        </where>
    
```
#### queryByCloudAccountId
```

        select
            host.ID,
            host.NAME,
            host.CPUS,
            host.CPU_USED,
            round(if(host.MEMORY_SUM is not null ,host.MEMORY_SUM/1024,0),2)                              as MEMORY_SUM,
            round(if(host.MEMORY_USED is not null ,host.MEMORY_USED/1024,0),2)                              as MEMORY_USED,
            host.DISK_SUM,
            host.DISK_USED,
            host.SERVICE_ACCOUNT_ID
        from CJ_CMP_VMWARE_HOST host
        where host.LDC_ID in (select adc.LDC_ID
        from CJ_CMP_CLOUD_ACCOUNT_DC adc inner join CJ_CMP_CLOUD_ACCOUNT ca on adc.CLOUD_ACCOUNT_ID = ca.ID
        where adc.CLOUD_ACCOUNT_ID = #{cloudAccountId} AND adc.IS_DELETED = 0
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>)
    
```
#### queryHostAndDataStoreIDByHostIdList
```

        select (select group_concat(VMWARE_DATASTORE_ID) from CJ_CMP_VMWARE_DATASTORE_HOSTMOUNT where VMWARE_HOST_ID=host.ID) as datastoreIds,host.* from CJ_CMP_VMWARE_HOST host
        where  host.ID in
         <foreach collection="list" open="(" close=")" item="id">
             #{id}
         </foreach>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_VMWARE_VC.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：in,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_VMWARE_VM.xml
> sql统计:复杂3个，简单42个
>
> 使用的关键字：size,JOIN,count,in,round,GROUP_CONCAT,sum,FROM,now,and,ifnull,AND,NOW,VALUES,if,ON,CJ_CMP_VMWARE_VM
#### getAllByCondition
```

        select vm.*,prj.CODE as projectCode,prj.NAME as projectName,prj.PROJECT_SOURCE_ID as projectSourceId,
        app.CODE as appSystemCode,app.NAME as appSystemName,app.SOURCE_ID as appSystemSourceId, vmtag.tags
        from CJ_CMP_VMWARE_VM vm
          <if test="srvCompletionTimeStart!=null or srvCompletionTimeEnd!=null ">
          left outer join CJ_CMP_RITM_COMPLETED_VIEW req on vm.SRV_NO=req.NUMBER
          </if>
          left outer join CJ_CMP_PROJECT prj on prj.ID=vm.PROJECT_ID
          left outer join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
          left outer join CJ_CMP_APP_DU du on du.ID=vm.APP_DU_ID
          LEFT JOIN (SELECT rel.OBJECT_ID, rel.OBJECT_TYPE, GROUP_CONCAT(tag.`NAME`) as tags from CJ_CMP_TAG tag INNER JOIN CJ_CMP_TAG_X_OBJECT rel on tag.ID = rel.TAG_ID GROUP BY rel.OBJECT_ID, rel.OBJECT_TYPE) as vmtag
          on vm.ID = vmtag.OBJECT_ID and vmtag.OBJECT_TYPE = 'vmware'
        <where>
            <if test="memberId != 0"> and vm.MEMBER_ID = #{memberId}</if>
            <if test="startTime!=null and endTime!=null ">
                and vm.CREATE_DATE between #{startTime,jdbcType= TIMESTAMP} and  #{endTime,jdbcType= TIMESTAMP}
            </if>
            <if test="startTime==null and endTime!=null ">
                and vm.CREATE_DATE &lt;=  #{endTime,jdbcType= TIMESTAMP}
            </if>
            <if test="startTime!=null and endTime==null ">
                and vm.CREATE_DATE &gt;=  #{startTime,jdbcType= TIMESTAMP}
            </if>

            <if test="srvCompletionTimeStart!=null and srvCompletionTimeEnd!=null ">
                and if(vm.IS_DELETED=1,vm.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) between #{srvCompletionTimeStart,jdbcType= TIMESTAMP} and  #{srvCompletionTimeEnd,jdbcType= TIMESTAMP}
            </if>
            <if test="srvCompletionTimeStart==null and srvCompletionTimeEnd!=null ">
                and if(vm.IS_DELETED=1,vm.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) &lt;=  #{srvCompletionTimeEnd,jdbcType= TIMESTAMP}
            </if>
            <if test="srvCompletionTimeStart!=null and srvCompletionTimeEnd==null ">
                and if(vm.IS_DELETED=1,vm.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) &gt;=  #{srvCompletionTimeStart,jdbcType= TIMESTAMP}
            </if>

            <if  test="isDeleted != null ">
                <choose>
                    <when test="isDeleted">
                        and vm.IS_DELETED=1
                    </when>
                    <otherwise>
                        and vm.IS_DELETED=0
                    </otherwise>
                </choose>
            </if>
        </where>
    
```
#### getAppSystemVmPmStatistics
```

        SELECT app.NAME AS name,app.MEMBER_ID AS memberId,info.* FROM (SELECT  vmPm.appSystemId,
        round(ifnull(sum(vmPm.cpu),0),0) AS cpu,
        round(ifnull(sum(vmPm.memory),0),0) AS memory,
        round(ifnull(sum(vmPm.disk),0),0) AS disk,
        sum(vmPm.pmNum) AS pmNum,
        sum(vmPm.vmNum) AS vmNum
        FROM
        (SELECT
        vm.APP_SYSTEM_ID AS appSystemId,
        ifnull(sum(vm.CPUS),0) AS cpu,
        ifnull(sum(vm.MEMORY),0)/1024 AS memory,
        ifnull(sum(vmDisk.DISK_SPACE),0) AS disk,
        0 AS pmNum,
        count(DISTINCT vm.ID) AS vmNum
        FROM cj_cmp_vm_view vm LEFT JOIN(
        SELECT vol.SERVICE_ACCOUNT_ID,vol.VM_DEVICE_ID,sum(vol.DISK_SPACE) DISK_SPACE from CJ_CMP_VM_VOLUME vol where vol.IS_DELETED = 0 group BY vol.SERVICE_ACCOUNT_ID,vol.VM_DEVICE_ID
        )vmDisk ON vmDisk.SERVICE_ACCOUNT_ID = vm.SERVICE_ACCOUNT_ID AND vmDisk.VM_DEVICE_ID=vm.ID
        <if test="memberId!=null and memberId!= 0 ">
            WHERE vm.MEMBER_ID = #{memberId}
        </if>
        GROUP BY vm.APP_SYSTEM_ID
        UNION ALL
        SELECT
        pm.APP_SYSTEM_ID AS appSystemId,
        ifnull(sum(pm.CPU_CORE_COUNT),0) AS cpu,
        ifnull(sum(pm.RAM),0) AS memory,
        ifnull(sum(pm.DISK_SPACE),0) AS disk,
        count(DISTINCT pm.ID) AS pmNum,
        0 AS vmNum
        FROM CJ_CMDB_CI_PHYSICAL_MACHINE pm
        WHERE pm.IS_DELETED = 0
        <if test="memberId!=null and memberId!= 0 ">
            AND pm.MEMBER_ID = #{memberId}
        </if>
        GROUP BY pm.APP_SYSTEM_ID) AS vmPm group by vmPm.appSystemId) AS info
        INNER JOIN CJ_CMP_APP_SYSTEM app ON info.appSystemId = app.ID
        <if test="appSystemId!=null and appSystemId!= '' ">
            WHERE app.ID =  #{appSystemId}
        </if>
    
```
#### getProjectVmPmStatistics
```

        SELECT info.*, project.NAME as name, project.MEMBER_ID AS memberId
        FROM
        (SELECT  vmPm.projectId,
        round(ifnull(sum(vmPm.cpu),0),0) AS cpu,
        round(ifnull(sum(vmPm.memory),0),0) AS memory,
        round(ifnull(sum(vmPm.disk),0),0) AS disk,
        sum(vmPm.pmNum) AS pmNum,
        sum(vmPm.vmNum) AS vmNum
        FROM
        (SELECT
        vm.PROJECT_ID AS projectId,
        ifnull(sum(vm.CPUS),0) AS cpu,
        ifnull(sum(vm.MEMORY),0)/1024 AS memory,
        ifnull(sum(vmDisk.DISK_SPACE),0) AS disk,
        0 AS pmNum,
        count(DISTINCT vm.ID) AS vmNum
        FROM cj_cmp_vm_view vm  LEFT JOIN(
        SELECT vol.SERVICE_ACCOUNT_ID,vol.VM_DEVICE_ID,sum(vol.DISK_SPACE) DISK_SPACE from CJ_CMP_VM_VOLUME vol where vol.IS_DELETED = 0 group BY vol.SERVICE_ACCOUNT_ID,vol.VM_DEVICE_ID
        )vmDisk ON vmDisk.SERVICE_ACCOUNT_ID = vm.SERVICE_ACCOUNT_ID AND vmDisk.VM_DEVICE_ID=vm.ID
        <if test="memberId != null and memberId != 0 ">
            WHERE vm.MEMBER_ID = #{memberId}
        </if>
        GROUP BY vm.PROJECT_ID
        UNION ALL
        SELECT
        pm.PROJECT_ID AS projectId,
        ifnull(sum(pm.CPU_CORE_COUNT),0) AS cpu,
        ifnull(sum(pm.RAM),0) AS memory,
        ifnull(sum(pm.DISK_SPACE),0) AS disk,
        count(DISTINCT pm.ID) AS pmNum,
        0 AS vmNum
        FROM CJ_CMDB_CI_PHYSICAL_MACHINE pm
        WHERE pm.IS_DELETED = 0
        <if test="memberId != null and memberId != 0 ">
            AND pm.MEMBER_ID = #{memberId}
        </if>
        GROUP BY pm.PROJECT_ID) AS vmPm group by vmPm.projectId) as info
        INNER JOIN CJ_CMP_PROJECT project ON info.projectId = project.ID AND project.IS_DELETED=0
        <if test="projectId != null and projectId != '' ">
            and project.ID = #{projectId}
        </if>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_VM_APP_SYSTEM_DAY_REPORT.xml
> sql统计:复杂1个，简单1个
>
> 使用的关键字：count,DATE,and,CJ_CMP_VM_APP_SYSTEM_DAY_REPORT,VALUES,ifnull
#### getTotalBySaAndTime
```

        SELECT
        ifnull(count( DISTINCT report.`NAME`),0) as num
        FROM CJ_CMP_VM_APP_SYSTEM_DAY_REPORT report
        left join CJ_CMP_APP_SYSTEM app on app.ID = report.APP_SYSTEM_ID
        WHERE
        STAT_TIME = DATE(#{statTime})
        <if test="memberId != 0">
            and report.MEMBER_ID = #{memberId}
            <if test="userIds != null and userIds.size >0 ">
                and (app.SYS_OPR_MANT_OWNER_ID in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
                or app.SYS_OPR_MANT_OWNER2_ID in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
                <if test="departmentList != null and departmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="departmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="departmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>)
            </if>
        </if>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_VM_DAY_REPORT.xml
> sql统计:复杂7个，简单10个
>
> 使用的关键字：SUM,min,CJ_CMP_VM_DAY_REPORT,sum,from,DATE,if,size,max,round,VALUES,count,DATE_FORMAT,in,and,ifnull,WHERE,concat,FROM
#### groupBySaAndTime
```

        SELECT
        ifnull(count(DISTINCT ENTITY_ID, SERVICE_ACCOUNT_ID), 0)                   AS num,
        DATE_FORMAT(vm.STAT_TIME, #{dateFormat}) AS days
        FROM (SELECT
        STAT_TIME,
        TYPE,
        ENTITY_ID,
        SERVICE_ACCOUNT_ID
        FROM CJ_CMP_VM_DAY_REPORT
        WHERE SERVICE_ACCOUNT_ID in (select ID from CJ_CMP_SERVICE_ACCOUNT where IS_DELETED = 0)
        <if test="memberId != 0">
            and MEMBER_ID = #{memberId}
        </if>
        AND LDC_TYPE in <foreach collection="ldcTypeList" item="ldcType" open="(" close=")" separator=",">#{ldcType}</foreach>
        GROUP BY STAT_TIME, TYPE, ENTITY_ID, SERVICE_ACCOUNT_ID) vm
        <where>
            <if test="serviceAccountId != null and serviceAccountId != ''">
                and vm.SERVICE_ACCOUNT_ID = #{serviceAccountId}
            </if>
            <if test="type != null and type != ''">
                and vm.TYPE=#{type}
            </if>
            <if test="startTime != null and endTime != null ">
                and (vm.STAT_TIME &gt;= DATE(#{startTime}) AND vm.STAT_TIME &lt;= DATE(#{endTime}))
            </if>
        </where>
        GROUP BY days
        ORDER BY days asc
    
```
#### getTotalBySaAndTime
```

        SELECT
            ifnull(count( DISTINCT ENTITY_ID, SERVICE_ACCOUNT_ID ),0) as num
        FROM
            CJ_CMP_VM_DAY_REPORT report
        INNER JOIN CJ_CMP_SERVICE_ACCOUNT sa ON sa.ID = report.SERVICE_ACCOUNT_ID
        AND sa.IS_DELETED = 0
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=report.APP_SYSTEM_ID  AND app.IS_DELETED = 0
        WHERE
            STAT_TIME = DATE(#{statTime})
            <if test="memberId != 0">
                and report.MEMBER_ID = #{memberId}
                <if test="userIds != null and userIds.size >0 ">
                    and  (
                    report.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
                    <if test="appUserId !=null ">
                        or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                        <if test="departmentList != null and departmentList.size != 0">
                            or app.DEPT_ID in <foreach collection="departmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                            or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="departmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                        </if>
                    </if>
                    )
                </if>
            </if>
    
```
#### getTotalDiskSumBySaAndTime
```

        select sum(if(DISK_SUM is null ,0,DISK_SUM)) as num
        from (SELECT DISTINCT report.ENTITY_ID, report.SERVICE_ACCOUNT_ID,report.DISK_SUM DISK_SUM
        FROM
        CJ_CMP_VM_DAY_REPORT report
        INNER JOIN CJ_CMP_SERVICE_ACCOUNT sa ON sa.ID = report.SERVICE_ACCOUNT_ID AND sa.IS_DELETED = 0
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=report.APP_SYSTEM_ID  AND app.IS_DELETED = 0
        WHERE
        STAT_TIME = DATE(#{statTime})
        <if test="memberId != 0">
            and report.MEMBER_ID = #{memberId}
            <if test="userIds != null and userIds.size >0 ">
                and  (
                report.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
                <if test="appUserId !=null ">
                    or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                    <if test="departmentList != null and departmentList.size != 0">
                        or app.DEPT_ID in <foreach collection="departmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                        or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="departmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    </if>
                </if>
                )
            </if>
        </if>) a
    
```
#### statPowerOnVmMemByHostId
```

        select
            count(*)    as powerOnVmSum,
            sum(MEMORY) as powerOnVmProvisionedMem
        from (select
                  round(max(MEMORY / 1024)) MEMORY
              from CJ_CMP_VM_DAY_REPORT
              where HOST_ID = #{hostId} and STAT_TIME = #{endTime} and RUN_STATUS = 'running' and MEMBER_ID = #{memberId}
              group by ENTITY_ID,SERVICE_ACCOUNT_ID) vm;
    
```
#### statAllocateMemByHostId
```

        select sum(MEMORY) as provisionedMem
        from (select round(max(MEMORY / 1024)) MEMORY
              from CJ_CMP_VM_DAY_REPORT
              where HOST_ID = #{hostId} and STAT_TIME = #{endTime} and MEMBER_ID = #{memberId}
              group by ENTITY_ID,SERVICE_ACCOUNT_ID) vm;
    
```
#### countCloudVm
```

        select count(*) as num, SUM(ifnull(vm.DISK_SUM,0)) as diskSum
        from CJ_CMP_VM_DAY_REPORT vm
        left outer join CJ_CMP_APP_SYSTEM app on app.ID = vm.APP_SYSTEM_ID
        where vm.MEMBER_ID = #{memberId}
        <if test="userIds != null and userIds.size >0">
            and ( vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
            )
        </if>
        <if test="startTime != null and endTime != null ">
            and (vm.CREATE_DATE &gt;= DATE(#{startTime}) AND vm.CREATE_DATE &lt;= DATE(#{endTime}))
        </if>
    
```
#### groupByTime
```

        SELECT
        ifnull( count( DISTINCT ENTITY_ID, SERVICE_ACCOUNT_ID ), 0 ) AS num,
        DATE_FORMAT(report.STAT_TIME, #{dateFormat}) AS days
        FROM
        CJ_CMP_VM_DAY_REPORT report
        LEFT OUTER JOIN CJ_CMP_APP_SYSTEM app ON app.ID = report.APP_SYSTEM_ID
        inner join CJ_CMP_SERVICE_ACCOUNT sa on sa.id = report.SERVICE_ACCOUNT_ID and sa.IS_DELETED = 0
        WHERE
        (report.STAT_TIME &gt;= DATE(#{startTime}) AND report.STAT_TIME &lt;= DATE(#{endTime}))
        <if test="memberId != 0">
            and report.MEMBER_ID = #{memberId}
        </if>
        <if test="userIds != null and userIds.size >0">
            and ( report.OWNED_BY in
            <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId}
                or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in
                    <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">
                        #{department}
                    </foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in
                    <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">
                        #{department}
                    </foreach>
                </if>
            </if>
            )
        </if>
        GROUP BY days
        ORDER BY days asc
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_VM_DEPT_DAY_REPORT.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：CJ_CMP_VM_DEPT_DAY_REPORT,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_VM_IMAGE.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：and,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_VM_ISSUE_VIEW.xml
> sql统计:复杂1个，简单0个
>
> 使用的关键字：FROM,count,DATE_SUB,CURDATE,date
#### queryAppTopByIssue
```

    SELECT vmInfo.appName, vmInfo.num
        FROM (SELECT
        app.NAME AS appName,
        count(1) AS num
        FROM cj_cmp_vm_issue_view vm
        inner join CJ_CMP_APP_SYSTEM app on app.ID = vm.APP_SYSTEM_ID
        where vm.MEMBER_ID = #{memberId} and DATE_SUB(CURDATE(), INTERVAL #{intervalTime} MONTH ) &lt;= date(vm.CREATE_DATE)
        group by app.NAME
        order by app.NAME) AS vmInfo
    order by vmInfo.num desc
    limit 10;
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_VM_PERFORMANCE_METRIC_DAY_REPORT.xml
> sql统计:复杂3个，简单3个
>
> 使用的关键字：decimal,now,SUM,sum,avg,and,concat,round,curdate,CEILING,max,DATE_SUB,values,AVG,ifnull,MAX,cast,DATE,CJ_CMP_VM_PERFORMANCE_METRIC_DAY_REPORT,ROUND,JOIN
#### queryEcsPerformanceList
```

    SELECT
    vm.`NAME`           vmName,
    vm.MEMBER_ID        memberId,
    vm.ID               vmId,
    vm.APP_DU_ID        appUnitId,
    app.ID              appSystemId,
    app.NAME            appSystemName,
    vm.IP               ip,
    vm.LDC_ID           ldcId,
    vm.OWNED_BY         ownedBy,
    table_total.*
    FROM CJ_CMP_VMWARE_VM vm LEFT JOIN CJ_CMP_APP_SYSTEM app ON vm.APP_SYSTEM_ID=app.ID AND app.IS_DELETED=0
    , (SELECT
    CEILING(max(day_report.CPUS))                                                           cpus,
    ROUND(avg(day_report.CPU_UTILIZATION), 2)                                               cpuUtilisation,
    ROUND(avg(day_report.CPU_USED), 2)                                                      cpuUsed,
    ROUND(avg(day_report.MEMORY_UTILIZATION), 2)                                            memoryUtilisation,
    ROUND(avg(day_report.DISK_UTILIZATION), 2)                                              diskUtilisation,
    CEILING(max(day_report.MEMORY_SUM) / 1024)                                              memorySum,
    ROUND(AVG((1 - day_report.MEMORY_UTILIZATION / 100) * day_report.MEMORY_SUM / 1024), 2) memoryFree,
    CEILING(max(day_report.DISK_SUM))                                                       diskSum,
    ROUND(avg(day_report.MAX_CPU_USED), 2)                                                  maxCpuUsed,
    ROUND(max(day_report.MAX_CPU_UTILIZATION), 2)                                           maxCpuUtilisation,
    ROUND(max(day_report.MAX_MEMORY_UTILIZATION), 2)                                        maxMemoryUtilisation,
    day_report.SERVICE_ACCOUNT_ID                                                           serviceAccountId,
    day_report.VM_ENTITY_ID                                                                 vmEntityId
    FROM CJ_CMP_VM_PERFORMANCE_METRIC_DAY_REPORT day_report
    WHERE day_report.TIME &gt;= #{startDate} AND day_report.TIME &lt;= #{endDate}
    GROUP BY day_report.SERVICE_ACCOUNT_ID, day_report.VM_ENTITY_ID) table_total
    WHERE table_total.vmEntityId = vm.ENTITY_ID AND vm.ENTITY_ID is NOT NULL AND vm.SERVICE_ACCOUNT_ID = table_total.serviceAccountId and vm.MEMBER_ID = #{memberId}
    <if test="appSystemId != null and appSystemId !='' " >
      and app.ID = #{appSystemId}
    </if>
    <if test="userIds != null and userIds.size>0 " >
      and vm.OWNED_BY in <foreach item="userId" index="index" collection="userIds" open="(" separator="," close=")"> #{userId} </foreach>
    </if>
    <if test="ids != null and ids.size>0 " >
      and vm.ID in <foreach item="id" index="index" collection="ids" open="(" separator="," close=")"> #{id} </foreach>
    </if>
    <if test="searchKey != null and searchKey !='' " >
      and ( vm.NAME like concat('%', #{searchKey}, '%') or vm.IP like concat('%', #{searchKey}, '%') )
    </if>
    UNION ALL
    SELECT
    vm.`NAME`           vmName,
    vm.MEMBER_ID        memberId,
    vm.ID               vmId,
    vm.APP_DU_ID        appUnitId,
    app.ID              appSystemId,
    app.NAME            appSystemName,
    vm.IP               ip,
    vm.LDC_ID           ldcId,
    ''                  ownedBy,
    table_total.*
    FROM CJ_CMDB_CI_QINGCLOUD_VM_INSTANCE vm LEFT JOIN CJ_CMP_APP_SYSTEM app ON vm.APP_SYSTEM_ID=app.ID AND app.IS_DELETED=0
    , (SELECT
    CEILING(max(day_report.CPUS))                                                           cpus,
    ROUND(avg(ifnull(day_report.CPU_UTILIZATION,0.00)), 2)                                  cpuUtilisation,
    ROUND(avg(day_report.CPU_USED), 2)                                                      cpuUsed,
    ROUND(avg(ifnull(day_report.MEMORY_UTILIZATION,0.00)), 2)                               memoryUtilisation,
    ROUND(avg(day_report.DISK_UTILIZATION), 2)                                              diskUtilisation,
    CEILING(max(day_report.MEMORY_SUM) / 1024)                                              memorySum,
    ROUND(AVG((1 - day_report.MEMORY_UTILIZATION / 100) * day_report.MEMORY_SUM / 1024), 2) memoryFree,
    CEILING(max(day_report.DISK_SUM))                                                       diskSum,
    ROUND(max(day_report.CPU_USED), 2)                                                      maxCpuUsed,
    ROUND(max(day_report.CPU_UTILIZATION), 2)                                               maxCpuUtilisation,
    ROUND(max(day_report.MEMORY_UTILIZATION), 2)                                            maxMemoryUtilisation,
    day_report.SERVICE_ACCOUNT_ID                                                           serviceAccountId,
    day_report.VM_ENTITY_ID                                                                 vmEntityId
    FROM CJ_CMP_VM_PERFORMANCE_METRIC_DAY_REPORT day_report
    WHERE day_report.TIME &gt;= #{startDate} AND day_report.TIME &lt;= #{endDate}
    GROUP BY day_report.SERVICE_ACCOUNT_ID, day_report.VM_ENTITY_ID) table_total
    WHERE table_total.vmEntityId = vm.ENTITY_ID AND vm.ENTITY_ID is NOT NULL AND vm.SERVICE_ACCOUNT_ID = table_total.serviceAccountId and vm.MEMBER_ID = #{memberId}
    <if test="appSystemId != null and appSystemId !='' " >
      and app.ID = #{appSystemId}
    </if>
    <if test="ids != null and ids.size>0 " >
      and vm.ID in <foreach item="id" index="index" collection="ids" open="(" separator="," close=")"> #{id} </foreach>
    </if>
    <if test="searchKey != null and searchKey !='' " >
      and ( vm.NAME like concat('%', #{searchKey}, '%') or vm.IP like concat('%', #{searchKey}, '%') )
    </if>
    UNION ALL
    SELECT
    vm.`NAME`           vmName,
    vm.MEMBER_ID        memberId,
    vm.ID               vmId,
    vm.APP_DU_ID        appUnitId,
    app.ID              appSystemId,
    app.NAME            appSystemName,
    vm.IP               ip,
    vm.LDC_ID           ldcId,
    ''                  ownedBy,
    table_total.*
    FROM CJ_CMP_CLOUDOS_VM vm LEFT JOIN CJ_CMP_APP_SYSTEM app ON vm.APP_SYSTEM_ID=app.ID AND app.IS_DELETED=0
    , (SELECT
    CEILING(max(day_report.CPUS))                                                           cpus,
    ROUND(avg(ifnull(day_report.CPU_UTILIZATION,0.00)), 2)                                  cpuUtilisation,
    ROUND(avg(day_report.CPU_USED), 2)                                                      cpuUsed,
    ROUND(avg(ifnull(day_report.MEMORY_UTILIZATION,0.00)), 2)                               memoryUtilisation,
    ROUND(avg(day_report.DISK_UTILIZATION), 2)                                              diskUtilisation,
    CEILING(max(day_report.MEMORY_SUM) / 1024)                                              memorySum,
    ROUND(AVG((1 - day_report.MEMORY_UTILIZATION / 100) * day_report.MEMORY_SUM / 1024), 2) memoryFree,
    CEILING(max(day_report.DISK_SUM))                                                       diskSum,
    ROUND(max(day_report.CPU_USED), 2)                                                      maxCpuUsed,
    ROUND(max(day_report.CPU_UTILIZATION), 2)                                               maxCpuUtilisation,
    ROUND(max(day_report.MEMORY_UTILIZATION), 2)                                            maxMemoryUtilisation,
    day_report.SERVICE_ACCOUNT_ID                                                           serviceAccountId,
    day_report.VM_ENTITY_ID                                                                 vmEntityId
    FROM CJ_CMP_VM_PERFORMANCE_METRIC_DAY_REPORT day_report
    WHERE day_report.TIME &gt;= #{startDate} AND day_report.TIME &lt;= #{endDate}
    GROUP BY day_report.SERVICE_ACCOUNT_ID, day_report.VM_ENTITY_ID) table_total
    WHERE table_total.vmEntityId = vm.ENTITY_ID AND vm.ENTITY_ID is NOT NULL AND vm.SERVICE_ACCOUNT_ID = table_total.serviceAccountId and vm.MEMBER_ID = #{memberId}
    <if test="appSystemId != null and appSystemId !='' " >
      and app.ID = #{appSystemId}
    </if>
    <if test="ids != null and ids.size>0 " >
      and vm.ID in <foreach item="id" index="index" collection="ids" open="(" separator="," close=")"> #{id} </foreach>
    </if>
    <if test="searchKey != null and searchKey !='' " >
      and ( vm.NAME like concat('%', #{searchKey}, '%') or vm.IP like concat('%', #{searchKey}, '%') )
    </if>
  
```
#### querySubSystemPerformanceList
```

    SELECT
    app.ID        appSystemId,
    app.NAME      appSystemName,
    app.CODE      appSystemCode,
    app.DEPT_ID   deptId,
    app.DEPT_NAME deptName,
    app.MEMBER_ID memberId,
    vmApp.*
    FROM CJ_CMP_APP_SYSTEM app INNER JOIN (SELECT
    tempApp.ID                                appId,
    SUM(total.cpus)                           cpus,
    SUM(total.memorySum)                      memorySum,
    SUM(total.diskSum)                        diskSum,
    round(AVG(total.cpuUtilisation), 2)       cpuUtilisation,
    round(AVG(total.cpuUsed), 2)              cpuUsed,
    round(AVG(total.memoryUtilisation), 2)    memoryUtilisation,
    round(AVG(total.diskUtilisation), 2)      diskUtilisation,
    ROUND(SUM(total.memoryFree), 2)           memoryFree,
    ROUND(AVG(total.maxCpuUtilisation), 2)    maxCpuUtilisation,
    ROUND(AVG(total.maxMemoryUtilisation), 2) maxMemoryUtilisation
    FROM CJ_CMP_APP_SYSTEM tempApp
    INNER JOIN CJ_CMP_VMWARE_VM vm ON tempApp.ID = vm.APP_SYSTEM_ID
    , (SELECT
    MAX(dayReport.CPUS)                   cpus,
    CEILING(MAX(dayReport.MEMORY_SUM) /
    1024)                         memorySum,
    MAX(
    dayReport.DISK_SUM)               diskSum,
    sum(dayReport.CPU_UTILIZATION * dayReport.CPUS) / sum(
    dayReport.CPUS)                   cpuUtilisation,
    sum(dayReport.CPU_USED * dayReport.CPUS) / sum(
    dayReport.CPUS)                   cpuUsed,
    sum(dayReport.MEMORY_UTILIZATION * (dayReport.MEMORY_SUM) / 1024) /
    sum(
    dayReport.MEMORY_SUM /
    1024)                             memoryUtilisation,
    avg((1 - dayReport.MEMORY_UTILIZATION / 100) * dayReport.MEMORY_SUM /
    1024)                             memoryFree,
    sum(dayReport.DISK_NUMBER * dayReport.DISK_UTILIZATION) / sum(
    dayReport.DISK_NUMBER)            diskUtilisation,
    avg(dayReport.MAX_CPU_UTILIZATION)    maxCpuUtilisation,
    avg(dayReport.MAX_MEMORY_UTILIZATION) maxMemoryUtilisation,
    dayReport.SERVICE_ACCOUNT_ID,
    dayReport.VM_ENTITY_ID
    FROM CJ_CMP_VM_PERFORMANCE_METRIC_DAY_REPORT dayReport
    WHERE dayReport.TIME &gt;= #{startDate} AND dayReport.TIME &lt;= #{endDate}
    GROUP BY dayReport.SERVICE_ACCOUNT_ID, dayReport.VM_ENTITY_ID) total
    WHERE vm.ENTITY_ID = total.VM_ENTITY_ID AND
    vm.SERVICE_ACCOUNT_ID = total.SERVICE_ACCOUNT_ID
    GROUP BY tempApp.ID) vmApp ON vmApp.appId = app.ID
    WHERE app.MEMBER_ID = #{memberId}
    <if test="deptId != null and deptId !='' " >
      and app.DEPT_ID = #{deptId}
    </if>
    <if test="searchKey != null and searchKey !='' " >
      and ( app.NAME like concat('%', #{searchKey}, '%') or app.CODE like concat('%', #{searchKey}, '%') )
    </if>
  
```
#### selectWeekRecords
```

    select cast(avg(CPU_UTILIZATION) as decimal(10,2)) as CPU_UTILIZATION,cast(avg(MEMORY_UTILIZATION) as decimal(10,2)) as MEMORY_UTILIZATION
    from CJ_CMP_VM_PERFORMANCE_METRIC_DAY_REPORT
    where VM_ENTITY_ID = #{vmEntityId} and SERVICE_ACCOUNT_ID =  #{serviceAccountId} and TIME <![CDATA[>]]> DATE_SUB(curdate(), INTERVAL 8 DAY) and TIME <![CDATA[<=]]>  DATE_SUB(curdate(), INTERVAL 1 DAY);
  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_VM_PERFORMANCE_METRIC_HOT.xml
> sql统计:复杂1个，简单3个
>
> 使用的关键字：cast,avg,decimal,date,DATE,values,now,DATE_SUB,curdate,CJ_CMP_VM_PERFORMANCE_METRIC_HOT
#### selectWeekRecords
```

        select cast(avg(CPU_UTILIZATION) as decimal(10,2)) as CPU_UTILIZATION,cast(avg(MEMORY_UTILIZATION) as decimal(10,2)) as MEMORY_UTILIZATION
        from CJ_CMP_VM_PERFORMANCE_METRIC_HOT
        where VM_ENTITY_ID = #{vmEntityId} and SERVICE_ACCOUNT_ID = #{serviceAccountId} and DATE_SUB(curdate(), INTERVAL 7 DAY) <![CDATA[<]]> date(TIME);
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_VM_SNAPSHOT.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：CONCAT,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_VM_SPEC.xml
> sql统计:复杂1个，简单7个
>
> 使用的关键字：and,group_concat,NOW
#### queryFusionCloudSpec
```

        select spec.*, group_concat(distinct az.NAME) as zoneName, sa.NAME AS serviceAccountName, sa.ID AS serviceAccountId
        FROM CJ_CMP_SERVICE_ACCOUNT sa
        INNER JOIN CJ_CMP_CLOUD_ACCOUNT_DC cdc ON sa.ID = cdc.SERVICE_ACCOUNT_ID AND cdc.IS_DELETED = 0 AND sa.IS_DELETED = 0
        INNER JOIN CJ_CMP_CLOUD_ACCOUNT ca ON cdc.CLOUD_ACCOUNT_ID = ca.ID AND ca.IS_DELETED = 0
        inner join CJ_CMP_FUSION_CLOUD_DC_X_AZ dcx on dcx.LDC_ID=cdc.LDC_ID and cdc.LDC_TYPE='fusionCloud'
        LEFT JOIN CJ_CMP_CLOUD_AZ az on az.ID=dcx.AZ_ID
        inner join CJ_CMP_CLOUD_DC_X_SPEC dxs on dxs.LDC_ID=cdc.LDC_ID and dxs.SERVICE_ACCOUNT_ID=sa.ID
        INNER JOIN CJ_CMP_VM_SPEC spec ON spec.ID=dxs.SPEC_ID
        where spec.IS_DELETED=0
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>
        <if test="id != null and id != ''"> and spec.ID=#{id}</if>
        <if test="serviceAccountId != null and serviceAccountId != ''"> and sa.ID=#{serviceAccountId}</if>
        <if test="cloudAccountId != null and cloudAccountId != ''"> and ca.ID=#{cloudAccountId}</if>
        <if test="ldcId != null and ldcId != ''"> and cdc.LDC_ID=#{ldcId}</if>
        <if test="ldcType != null and ldcType != ''"> and cdc.LDC_TYPE=#{ldcType}</if>
        <if test="azId != null and azId != ''"> and az.ID=#{azId}</if>
        <if test="searchKey != null and searchKey != ''"> and (spec.NAME like #{searchKey} or spec.ENTITY_ID like #{searchKey})</if>
        group by spec.ID, spec.NAME, sa.ID
        order by spec.NAME
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_VM_VIEW.xml
> sql统计:复杂17个，简单22个
>
> 使用的关键字：count,date,join,and,CONCAT,FROM,CURDATE,ifnull,sum,substring_index,from,date_sub,exists,concat,inet_aton,when,round,CJ_CMP_TAG_X_OBJECT,JOIN,GROUP_CONCAT,now,DATE,values,SUM,to_days,DATE_SUB,convert,where,WHEN
#### queryList
```

        select vm.*,app.ID as appSystemId,app.NAME as appSystemName,vl.diskSum ,vl.diskNumber ,vmtag.tag,du.NAME as appDuName,vm.APP_DU_ID as appDuId,iac.SERVICE_INSTANCE_ID as serviceInstanceId,project.NAME AS projectName,project.ID AS projectId,
        case when ifnull(u.ACTIVE,0)=0 then concat(u.NAME,' (已删除)') when ifnull(u.LOCKED_OUT,0)=0 then u.NAME else concat(u.NAME,' (已冻结)') end as owner, depart.`NAME` as dept,
        case when ifnull(uaas.ACTIVE,0)=0 then concat(uaas.NAME,' (已删除)') when ifnull(uaas.LOCKED_OUT,0)=0 then uaas.NAME else concat(uaas.NAME,' (已冻结)') end as assigner 
        from cj_cmp_vm_view vm
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
        left outer join CJ_CMP_PROJECT project on project.ID=vm.PROJECT_ID
        left join (SELECT VM_DEVICE_ID,SERVICE_ACCOUNT_ID, sum( DISK_SPACE ) AS diskSum, count( DISK_SPACE ) AS diskNumber FROM CJ_CMP_VM_VOLUME WHERE IS_DELETED=0 GROUP BY VM_DEVICE_ID, SERVICE_ACCOUNT_ID ) AS vl
        on vl.VM_DEVICE_ID = vm.ID and vl.SERVICE_ACCOUNT_ID = vm.SERVICE_ACCOUNT_ID
        LEFT JOIN (SELECT rel.OBJECT_ID, rel.OBJECT_TYPE, GROUP_CONCAT(tag.`NAME`) as tag from CJ_CMP_TAG tag INNER JOIN CJ_CMP_TAG_X_OBJECT rel on tag.ID = rel.TAG_ID GROUP BY rel.OBJECT_ID, rel.OBJECT_TYPE) as vmtag
        on vm.ID = vmtag.OBJECT_ID and vm.LDC_TYPE = vmtag.OBJECT_TYPE
        LEFT JOIN ydduc.UC_USER u ON vm.OWNED_BY = u.ID
        LEFT JOIN ydduc.UC_USER uaas ON vm.ASSIGNED_TO = uaas.ID
        LEFT JOIN ydduc.UC_DEPARTMENT depart ON u.DEPARTMENT = depart.ID
        left outer join CJ_CMP_SERVICE_INSTANCE_X_RESOURCE iac on iac.SERVICE_ACCOUNT_ID=vm.SERVICE_ACCOUNT_ID and iac.RESOURCE_ID=vm.ID
        LEFT JOIN CJ_CMP_APP_DU du ON vm.APP_DU_ID = du.ID
        where
            vm.MEMBER_ID = #{memberId} and ( 1=1
            <if test="userIds != null and userIds.size >0 ">
                and  vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
                or  vm.ASSIGNED_TO in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
                <if test="appUserId !=null ">
                    or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                    <if test="appDepartmentList != null and appDepartmentList.size != 0">
                        or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                        or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    </if>
                </if>

            </if>
            <if test="appSystemIds != null and appSystemIds.size>0">
                or vm.APP_SYSTEM_ID in
                <foreach collection="appSystemIds" item="appSystemId" open="(" close=")" separator=",">#{appSystemId}</foreach>
            </if>
            )
            <if test="cloudAccountId != null and cloudAccountId != ''">
                and vm.CLOUD_ACCOUNT_ID = #{cloudAccountId}
            </if>
            <if test="ldcId != null and ldcId != ''">
                and vm.LDC_ID = #{ldcId}
            </if>
            <if test="appSystemId != null">
                and vm.APP_SYSTEM_ID = #{appSystemId}
            </if>

            <if test="keywordList != null and keywordList.size==1" >
                <choose>
                    <when test="queryType != null and queryType == 'name'" >
                        and vm.NAME like CONCAT('%',#{keyword},'%')
                    </when>
                    <when test="queryType != null and queryType == 'manageBy'" >
                        <if test="searchUserList != null and searchUserList.size != 0">
                            and ( vm.OWNED_BY in <foreach collection="searchUserList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
                            or u.NAME like concat('%', #{keyword}, '%') )
                        </if>
                        <if test="searchUserList == null or searchUserList.size == 0">
                            and u.NAME like concat('%', #{keyword}, '%')
                        </if>
                    </when>
                    <when test="queryType != null and queryType == 'assigner'" >
                        <if test="searchUserList != null and searchUserList.size != 0">
                            and ( vm.ASSIGNED_TO in <foreach collection="searchUserList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
                            or uaas.NAME like concat('%', #{keyword}, '%') )
                        </if>
                        <if test="searchUserList == null or searchUserList.size == 0">
                            and uaas.NAME like concat('%', #{keyword}, '%')
                        </if>
                    </when>
                    <when test="queryType != null and queryType == 'entityId'" >
                        and vm.ENTITY_ID like concat('%', #{keyword}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'ip'" >
                        and vm.IP like concat('%', #{keyword}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'appSystemName'" >
                        and app.NAME like concat('%', #{keyword}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'projectName'" >
                        and (project.NAME like concat('%', #{keyword}, '%') or project.CODE like concat('%', #{keyword}, '%'))
                    </when>
                    <when test="queryType != null and queryType == 'tag'" >
                        and exists (select rel.ID
                        from CJ_CMP_TAG_X_OBJECT rel
                        where vm.MEMBER_ID = #{memberId}
                        and rel.TAG_ID = #{keyword}
                        and rel.OBJECT_TYPE = vm.LDC_TYPE and rel.OBJECT_ID = vm.ID
                        )
                    </when>
                    <when test="queryType != null and queryType == 'department'" >
                        and depart.`NAME` like concat('%', #{keyword}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'runStatus'" >
                        and vm.RUN_STATUS like concat('%', #{keyword}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'ldcType'" >
                        and vm.LDC_TYPE like concat('%', #{keyword}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'srvNumber'" >
                        and vm.SRV_NO like concat('%', #{keyword}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'os'" >
                        and vm.OS like concat('%', #{keyword}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'userdFor'" >
                        and vm.USED_FOR like concat('%', #{keyword}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'remark'" >
                        and vm.REMARK like concat('%', #{keyword}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'appSystemName'" >
                        and app.NAME like concat('%', #{keyword}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'cloudAccountName'" >
                        and vm.CLOUD_ACCOUNT_NAME like concat('%', #{keyword}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'appDuName'" >
                        and du.NAME like concat('%', #{keyword}, '%')
                    </when>
                    <otherwise>
                        and (
                        vm.NAME like CONCAT('%',#{keyword},'%')
                        <if test="searchUserList != null and searchUserList.size != 0">
                        OR vm.OWNED_BY in <foreach collection="searchUserList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
                        OR vm.ASSIGNED_TO in <foreach collection="searchUserList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
                       </if>
                        OR vm.ENTITY_ID like concat('%', #{keyword}, '%')
                        OR vm.IP like concat('%', #{keyword}, '%')
                        OR app.NAME like concat('%', #{keyword}, '%')
                        OR project.NAME like concat('%', #{keyword}, '%') or project.CODE like concat('%', #{keyword}, '%')
                        OR depart.`NAME` like concat('%', #{keyword}, '%')
                        OR vm.OWNED_BY like concat('%', #{keyword}, '%')
                        OR vm.RUN_STATUS like concat('%', #{keyword}, '%')
                        OR vm.LDC_TYPE like concat('%', #{keyword}, '%')
                        OR vm.SRV_NO like concat('%', #{keyword}, '%')
                        OR vm.OS like concat('%', #{keyword}, '%')
                        OR vm.USED_FOR like concat('%', #{keyword}, '%')
                        OR vm.REMARK like concat('%', #{keyword}, '%')
                        OR vm.CLOUD_ACCOUNT_NAME like concat('%', #{keyword}, '%')
                        OR u.NAME like concat('%', #{keyword}, '%')
                        OR uaas.NAME like concat('%', #{keyword}, '%')
                        )
                    </otherwise>
                </choose>
            </if>
            <if test="keywordList != null and keywordList.size>1" >
                <choose>
                    <when test="queryType != null and queryType == 'name'" >
                        and vm.NAME in <foreach collection="keywordList" item="name" open="(" close=")" separator=",">#{name}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'manageBy'" >
                        <if test="searchUserList != null and searchUserList.size != 0">
                            and ( vm.OWNED_BY in <foreach collection="searchUserList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
                            or u.NAME in <foreach collection="keywordList" item="manageName" open="(" close=")" separator=",">#{manageName}</foreach> )
                        </if>
                        <if test="searchUserList == null or searchUserList.size == 0">
                            and u.NAME in <foreach collection="keywordList" item="manageName" open="(" close=")" separator=",">#{manageName}</foreach>
                        </if>
                    </when>
                    <when test="queryType != null and queryType == 'entityId'" >
                        and vm.ENTITY_ID in <foreach collection="keywordList" item="entityId" open="(" close=")" separator=",">#{entityId}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'ip'" >
                        and vm.IP in <foreach collection="keywordList" item="IP" open="(" close=")" separator=",">#{IP}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'appSystemName'" >
                        and app.NAME in <foreach collection="keywordList" item="appName" open="(" close=")" separator=",">#{appName}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'department'" >
                        and depart.`NAME` in <foreach collection="keywordList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'runStatus'" >
                        and vm.RUN_STATUS in <foreach collection="keywordList" item="runStatus" open="(" close=")" separator=",">#{runStatus}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'ldcType'" >
                        and vm.LDC_TYPE in <foreach collection="keywordList" item="ldcType" open="(" close=")" separator=",">#{ldcType}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'srvNumber'" >
                        and vm.SRV_NO in <foreach collection="keywordList" item="srvNumber" open="(" close=")" separator=",">#{srvNumber}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'os'" >
                        and vm.OS in <foreach collection="keywordList" item="os" open="(" close=")" separator=",">#{os}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'userdFor'" >
                        and vm.USED in <foreach collection="keywordList" item="userdFor" open="(" close=")" separator=",">#{userdFor}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'remark'" >
                        and vm.REMARK in <foreach collection="keywordList" item="remark" open="(" close=")" separator=",">#{remark}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'cloudAccountName'" >
                        and vm.CLOUD_ACCOUNT_NAME in <foreach collection="keywordList" item="cloudAccountName" open="(" close=")" separator=",">#{cloudAccountName}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'appDuName'" >
                        and du.NAME in <foreach collection="keywordList" item="appDuName" open="(" close=")" separator=",">#{appDuName}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'tag'" >
                        and exists (select rel.OBJECT_ID
                        from CJ_CMP_TAG_X_OBJECT rel
                        where vm.MEMBER_ID = #{memberId}
                        and rel.TAG_ID in <foreach collection="keywordList" item="tag" open="(" close=")" separator=",">#{tag}</foreach>
                        and rel.OBJECT_TYPE = vm.LDC_TYPE and rel.OBJECT_ID = vm.ID
                        group by rel.OBJECT_ID
                        having count(1) = ${keywordList.size}
                        )
                    </when>
                    <otherwise>
                        and (
                        vm.NAME in <foreach collection="keywordList" item="name" open="(" close=")" separator=",">#{name}</foreach>
                        <if test="searchUserList != null and searchUserList.size != 0">
                            OR vm.OWNED_BY in <foreach collection="searchUserList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
                        </if>
                        OR vm.ENTITY_ID in <foreach collection="keywordList" item="entityId" open="(" close=")" separator=",">#{entityId}</foreach>
                        OR app.NAME in <foreach collection="keywordList" item="appSystemName" open="(" close=")" separator=",">#{appSystemName}</foreach>
                        OR vm.IP in <foreach collection="keywordList" item="IP" open="(" close=")" separator=",">#{IP}</foreach>
                        OR app.NAME in <foreach collection="keywordList" item="appName" open="(" close=")" separator=",">#{appName}</foreach>
                        OR depart.`NAME` in <foreach collection="keywordList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                        OR vm.RUN_STATUS in <foreach collection="keywordList" item="runStatus" open="(" close=")" separator=",">#{runStatus}</foreach>
                        OR vm.LDC_TYPE in <foreach collection="keywordList" item="ldcType" open="(" close=")" separator=",">#{ldcType}</foreach>
                        OR vm.SRV_NO in <foreach collection="keywordList" item="srvNumber" open="(" close=")" separator=",">#{srvNumber}</foreach>
                        OR vm.OS in <foreach collection="keywordList" item="os" open="(" close=")" separator=",">#{os}</foreach>
                        OR vm.USED_FOR in <foreach collection="keywordList" item="userdFor" open="(" close=")" separator=",">#{userdFor}</foreach>
                        OR vm.REMARK in <foreach collection="keywordList" item="remark" open="(" close=")" separator=",">#{remark}</foreach>
                        OR vm.CLOUD_ACCOUNT_NAME in <foreach collection="keywordList" item="cloudAccountName" open="(" close=")" separator=",">#{cloudAccountName}</foreach>
                        OR u.NAME in <foreach collection="keywordList" item="manageName" open="(" close=")" separator=",">#{manageName}</foreach>
                        )
                    </otherwise>
                </choose>
            </if>
        <choose>
            <when test="sortFieldList != null and sortFieldList.size >= 1 and sortType != ''" >
                ORDER BY  <foreach collection="sortFieldList" item="sortField" separator=",">
                            <if test="sortField =='vm.IP'">inet_aton(substring_index(IP,',',1)) ${sortType},IP</if>
                            <if test="sortField !='vm.IP'">convert(${sortField} USING gbk) ${sortType}</if>
                         </foreach>
            </when>
            <otherwise> ORDER BY vm.CREATE_DATE desc</otherwise>
        </choose>
    
```
#### queryListByExpression
```

        select vm.*,app.ID as appSystemId,app.NAME as appSystemName,vl.diskSum ,vl.diskNumber ,vmtag.tag,du.NAME as appDuName,vm.APP_DU_ID as appDuId,iac.SERVICE_INSTANCE_ID as serviceInstanceId,project.NAME AS projectName,project.ID AS projectId,
        case when ifnull(u.ACTIVE,0)=0 then concat(u.NAME,' (已删除)') when ifnull(u.LOCKED_OUT,0)=0 then u.NAME else concat(u.NAME,' (已冻结)') end as owner, depart.`NAME` as dept,
        case when ifnull(uaas.ACTIVE,0)=0 then concat(uaas.NAME,' (已删除)') when ifnull(uaas.LOCKED_OUT,0)=0 then uaas.NAME else concat(uaas.NAME,' (已冻结)') end as assigner
        from cj_cmp_vm_view vm
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
        left outer join CJ_CMP_PROJECT project on project.ID=vm.PROJECT_ID
        left join (SELECT VM_DEVICE_ID,SERVICE_ACCOUNT_ID, sum( DISK_SPACE ) AS diskSum, count( DISK_SPACE ) AS diskNumber FROM CJ_CMP_VM_VOLUME WHERE IS_DELETED=0 GROUP BY VM_DEVICE_ID, SERVICE_ACCOUNT_ID ) AS vl
        on vl.VM_DEVICE_ID = vm.ID and vl.SERVICE_ACCOUNT_ID = vm.SERVICE_ACCOUNT_ID
        LEFT JOIN (SELECT rel.OBJECT_ID, rel.OBJECT_TYPE, GROUP_CONCAT(tag.`NAME`) as tag from CJ_CMP_TAG tag INNER JOIN CJ_CMP_TAG_X_OBJECT rel on tag.ID = rel.TAG_ID GROUP BY rel.OBJECT_ID, rel.OBJECT_TYPE) as vmtag
        on vm.ID = vmtag.OBJECT_ID and vm.LDC_TYPE = vmtag.OBJECT_TYPE
        LEFT JOIN ydduc.UC_USER u ON vm.OWNED_BY = u.ID
        LEFT JOIN ydduc.UC_USER uaas ON vm.ASSIGNED_TO = uaas.ID
        LEFT JOIN ydduc.UC_DEPARTMENT depart ON u.DEPARTMENT = depart.ID
        left outer join CJ_CMP_SERVICE_INSTANCE_X_RESOURCE iac on  iac.SERVICE_ACCOUNT_ID=vm.SERVICE_ACCOUNT_ID and iac.RESOURCE_ID=vm.ID
        LEFT JOIN CJ_CMP_APP_DU du ON vm.APP_DU_ID = du.ID
        where
        vm.MEMBER_ID = #{memberId} and ( 1=1
        <if test="userIds != null and userIds.size >0 ">
            and  vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            or  vm.ASSIGNED_TO in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
        </if>
        <if test="appSystemIds != null and appSystemIds.size>0">
            or vm.APP_SYSTEM_ID in
            <foreach collection="appSystemIds" item="appSystemId" open="(" close=")" separator=",">#{appSystemId}</foreach>
        </if>
        )
        <if test="cloudAccountId != null and cloudAccountId != ''">
            and vm.CLOUD_ACCOUNT_ID = #{cloudAccountId}
        </if>
        <if test="ldcId != null and ldcId != ''">
            and vm.LDC_ID = #{ldcId}
        </if>
        <if test="appSystemId != null">
            and vm.APP_SYSTEM_ID = #{appSystemId}
        </if>

        <foreach collection="queryExpressionMap" index="queryType" item="keywordList">
            <if test="keywordList != null and keywordList.size == 1" >
                <choose>
                    <when test="queryType != null and queryType == 'name'" >
                        and vm.NAME like CONCAT('%',#{queryExpressionMap.name[0]},'%')
                    </when>
                    <when test="queryType != null and queryType == 'manageBy'" >
                        <if test="searchUserList != null and searchUserList.size != 0">
                            and ( vm.OWNED_BY in <foreach collection="searchUserList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
                            or u.NAME like concat('%', #{queryExpressionMap.manageBy[0]}, '%') )
                        </if>
                        <if test="searchUserList == null or searchUserList.size == 0">
                            and u.NAME like concat('%', #{queryExpressionMap.manageBy[0]}, '%')
                        </if>
                    </when>
                    <when test="queryType != null and queryType == 'assigner'" >
                        <if test="searchUserList != null and searchUserList.size != 0">
                            and ( vm.ASSIGNED_TO in <foreach collection="searchUserList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
                            or uaas.NAME like concat('%', #{queryExpressionMap.assigner[0]}, '%') )
                        </if>
                        <if test="searchUserList == null or searchUserList.size == 0">
                            and uaas.NAME like concat('%', #{queryExpressionMap.assigner[0]}, '%')
                        </if>
                    </when>
                    <when test="queryType != null and queryType == 'entityId'" >
                        and vm.ENTITY_ID like concat('%', #{queryExpressionMap.entityId[0]}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'ip'" >
                        and vm.IP like concat('%', #{queryExpressionMap.ip[0]}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'appSystemName'" >
                        and app.NAME like concat('%', #{queryExpressionMap.appSystemName[0]}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'projectName'" >
                        and (project.NAME like concat('%', #{queryExpressionMap.projectName[0]}, '%') or project.CODE like concat('%', #{queryExpressionMap.projectName[0]}, '%'))
                    </when>
                    <when test="queryType != null and queryType == 'tag'" >
                        and exists (select rel.ID
                        from CJ_CMP_TAG_X_OBJECT rel
                        where vm.MEMBER_ID = #{memberId}
                        and rel.TAG_ID = #{queryExpressionMap.tag[0]}
                        and rel.OBJECT_TYPE = vm.LDC_TYPE and rel.OBJECT_ID = vm.ID
                        )
                    </when>
                    <when test="queryType != null and queryType == 'department'" >
                        and depart.`NAME` like concat('%', #{queryExpressionMap.department[0]}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'runStatus'" >
                        and vm.RUN_STATUS like concat('%', #{queryExpressionMap.runStatus[0]}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'ldcType'" >
                        and vm.LDC_TYPE like concat('%', #{queryExpressionMap.ldcType[0]}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'srvNumber'" >
                        and vm.SRV_NO like concat('%', #{queryExpressionMap.srvNumber[0]}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'os'" >
                        and vm.OS like concat('%', #{queryExpressionMap.os[0]}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'userdFor'" >
                        and vm.USED_FOR like concat('%', #{queryExpressionMap.userdFor[0]}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'remark'" >
                        and vm.REMARK like concat('%', #{queryExpressionMap.remark[0]}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'appSystemName'" >
                        and app.NAME like concat('%', #{queryExpressionMap.appSystemName[0]}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'cloudAccountName'" >
                        and vm.CLOUD_ACCOUNT_NAME like concat('%', #{queryExpressionMap.cloudAccountName[0]}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'appDuName'" >
                        and du.NAME like concat('%', #{queryExpressionMap.appDuName[0]}, '%')
                    </when>
                    <otherwise>
                        and (
                        vm.NAME like CONCAT('%',#{queryExpressionMap.keyword[0]},'%')
                        <if test="searchUserList != null and searchUserList.size != 0">
                            OR vm.OWNED_BY in <foreach collection="searchUserList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
                            OR vm.ASSIGNED_TO in <foreach collection="searchUserList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
                        </if>
                        OR vm.ENTITY_ID like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        OR vm.IP like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        OR app.NAME like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        OR project.NAME like concat('%', #{queryExpressionMap.keyword[0]}, '%') or project.CODE like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        OR depart.`NAME` like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        OR vm.OWNED_BY like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        OR vm.RUN_STATUS like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        OR vm.LDC_TYPE like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        OR vm.SRV_NO like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        OR vm.OS like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        OR vm.USED_FOR like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        OR vm.REMARK like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        OR vm.CLOUD_ACCOUNT_NAME like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        OR u.NAME like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        OR uaas.NAME like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        )
                    </otherwise>
                </choose>
            </if>
            <if test="keywordList != null and keywordList.size > 1" >
                <choose>
                    <when test="queryType != null and queryType == 'name'" >
                        and vm.NAME in <foreach collection="keywordList" item="name" open="(" close=")" separator=",">#{name}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'manageBy'" >
                        <if test="searchUserList != null and searchUserList.size != 0">
                            and ( vm.OWNED_BY in <foreach collection="searchUserList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
                            or u.NAME in <foreach collection="keywordList" item="manageName" open="(" close=")" separator=",">#{manageName}</foreach> )
                        </if>
                        <if test="searchUserList == null or searchUserList.size == 0">
                            and u.NAME in <foreach collection="keywordList" item="manageName" open="(" close=")" separator=",">#{manageName}</foreach>
                        </if>
                    </when>
                    <when test="queryType != null and queryType == 'entityId'" >
                        and vm.ENTITY_ID in <foreach collection="keywordList" item="entityId" open="(" close=")" separator=",">#{entityId}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'ip'" >
                        and vm.IP in <foreach collection="keywordList" item="IP" open="(" close=")" separator=",">#{IP}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'appSystemName'" >
                        and app.NAME in <foreach collection="keywordList" item="appName" open="(" close=")" separator=",">#{appName}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'department'" >
                        and depart.`NAME` in <foreach collection="keywordList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'runStatus'" >
                        and vm.RUN_STATUS in <foreach collection="keywordList" item="runStatus" open="(" close=")" separator=",">#{runStatus}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'ldcType'" >
                        and vm.LDC_TYPE in <foreach collection="keywordList" item="ldcType" open="(" close=")" separator=",">#{ldcType}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'srvNumber'" >
                        and vm.SRV_NO in <foreach collection="keywordList" item="srvNumber" open="(" close=")" separator=",">#{srvNumber}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'os'" >
                        and vm.OS in <foreach collection="keywordList" item="os" open="(" close=")" separator=",">#{os}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'userdFor'" >
                        and vm.USED in <foreach collection="keywordList" item="userdFor" open="(" close=")" separator=",">#{userdFor}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'remark'" >
                        and vm.REMARK in <foreach collection="keywordList" item="remark" open="(" close=")" separator=",">#{remark}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'cloudAccountName'" >
                        and vm.CLOUD_ACCOUNT_NAME in <foreach collection="keywordList" item="cloudAccountName" open="(" close=")" separator=",">#{cloudAccountName}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'appDuName'" >
                        and du.NAME in <foreach collection="keywordList" item="appDuName" open="(" close=")" separator=",">#{appDuName}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'tag'" >
                        and exists (select rel.OBJECT_ID
                        from CJ_CMP_TAG_X_OBJECT rel
                        where vm.MEMBER_ID = #{memberId}
                        and rel.TAG_ID in <foreach collection="keywordList" item="tag" open="(" close=")" separator=",">#{tag}</foreach>
                        and rel.OBJECT_TYPE = vm.LDC_TYPE and rel.OBJECT_ID = vm.ID
                        group by rel.OBJECT_ID
                        having count(1) = ${keywordList.size}
                        )
                    </when>
                    <otherwise>
                        and (
                        vm.NAME in <foreach collection="keywordList" item="name" open="(" close=")" separator=",">#{name}</foreach>
                        <if test="searchUserList != null and searchUserList.size != 0">
                            OR vm.OWNED_BY in <foreach collection="searchUserList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
                        </if>
                        OR vm.ENTITY_ID in <foreach collection="keywordList" item="entityId" open="(" close=")" separator=",">#{entityId}</foreach>
                        OR app.NAME in <foreach collection="keywordList" item="appSystemName" open="(" close=")" separator=",">#{appSystemName}</foreach>
                        OR vm.IP in <foreach collection="keywordList" item="IP" open="(" close=")" separator=",">#{IP}</foreach>
                        OR app.NAME in <foreach collection="keywordList" item="appName" open="(" close=")" separator=",">#{appName}</foreach>
                        OR depart.`NAME` in <foreach collection="keywordList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                        OR vm.RUN_STATUS in <foreach collection="keywordList" item="runStatus" open="(" close=")" separator=",">#{runStatus}</foreach>
                        OR vm.LDC_TYPE in <foreach collection="keywordList" item="ldcType" open="(" close=")" separator=",">#{ldcType}</foreach>
                        OR vm.SRV_NO in <foreach collection="keywordList" item="srvNumber" open="(" close=")" separator=",">#{srvNumber}</foreach>
                        OR vm.OS in <foreach collection="keywordList" item="os" open="(" close=")" separator=",">#{os}</foreach>
                        OR vm.USED_FOR in <foreach collection="keywordList" item="userdFor" open="(" close=")" separator=",">#{userdFor}</foreach>
                        OR vm.REMARK in <foreach collection="keywordList" item="remark" open="(" close=")" separator=",">#{remark}</foreach>
                        OR vm.CLOUD_ACCOUNT_NAME in <foreach collection="keywordList" item="cloudAccountName" open="(" close=")" separator=",">#{cloudAccountName}</foreach>
                        OR u.NAME in <foreach collection="keywordList" item="manageName" open="(" close=")" separator=",">#{manageName}</foreach>
                        )
                    </otherwise>
                </choose>
            </if>
        </foreach>
        <choose>
            <when test="sortFieldList != null and sortFieldList.size >= 1 and sortType != ''" >
                ORDER BY  <foreach collection="sortFieldList" item="sortField" separator=",">
                            <if test="sortField =='vm.IP'">inet_aton(substring_index(IP,',',1)) ${sortType},IP</if>
                            <if test="sortField !='vm.IP'">convert(${sortField} USING gbk) ${sortType}</if>
                         </foreach>
            </when>
            <otherwise> ORDER BY vm.CREATE_DATE desc</otherwise>
        </choose>
    
```
#### queryExpireVmListReport
```

        select distinct vm.*,vm.CREATE_DATE AS createDate,app.ID as appSystemId,app.NAME as appSystemName,project.NAME AS projectName,host.SN AS hostSn,vl.diskSum ,vl.diskNumber ,vmtag.tag
        from (select * from (select * from cj_cmp_vm_view vm
        where vm.due is not null
        and vm.due &gt; now()
        and date_sub(vm.due, interval 30 day) &lt; now()
        order by due desc) as tab1
        union all
        select * from (select * from cj_cmp_vm_view vm
        where vm.due is not null and vm.due &lt;= now()
        order by due) as tab2
        union all
        select * from (select * from cj_cmp_vm_view vm
        where (vm.due is not null and vm.due &gt;= now() and date_sub(vm.due, interval 30 day) &gt;=now())
        order by due desc) as tab3
        union all
        select * from (select * from cj_cmp_vm_view vm
        where vm.due is null) as tab4) vm
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
        left outer join CJ_CMP_PROJECT project on project.ID=vm.PROJECT_ID
        left outer join CJ_CMP_VMWARE_HOST host on host.ID=vm.HOST_ID
        left join (SELECT distinct VM_DEVICE_ID,SERVICE_ACCOUNT_ID, sum( DISK_SPACE ) AS diskSum, count( DISK_SPACE ) AS diskNumber FROM CJ_CMP_VM_VOLUME where IS_DELETED = 0 GROUP BY VM_DEVICE_ID, SERVICE_ACCOUNT_ID ) AS vl
        on vl.VM_DEVICE_ID = vm.ID and vl.SERVICE_ACCOUNT_ID = vm.SERVICE_ACCOUNT_ID
        LEFT JOIN (SELECT rel.OBJECT_ID, rel.OBJECT_TYPE, GROUP_CONCAT(tag.`NAME`) as tag from CJ_CMP_TAG tag INNER JOIN CJ_CMP_TAG_X_OBJECT rel on tag.ID = rel.TAG_ID GROUP BY rel.OBJECT_ID, rel.OBJECT_TYPE) as vmtag
        on vm.ID = vmtag.OBJECT_ID and vm.LDC_TYPE = vmtag.OBJECT_TYPE
        where
        vm.MEMBER_ID = #{memberId}
        <if test="userIds != null and userIds.size >0 ">
            and ( vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
            )
        </if>
        <if test="searchKey != null and searchKey != ''">
            and (vm.IP like concat('%', #{searchKey}, '%') or vm.NAME like concat('%', #{searchKey}, '%') or host.NAME like concat('%', #{searchKey}, '%'))
        </if>

        <if test="startTime != null and startTime != ''">
            and vm.CREATE_DATE between #{startTime} and #{endTime}
        </if>

        <if test="sortField != null and sortField != ''">
            ORDER BY ${sortField} ${sortType}
        </if>
    
```
#### queryExpireVmCountReport
```

        SELECT a.exipreType,ifnull(b.num,0) AS num FROM
        (SELECT '即将过期' AS exipreType
        union all
        SELECT '已过期' AS exipreType
        union all
        SELECT '未过期' AS exipreType) AS a left join  (SELECT tab.exipreType,count(NAME) AS num FROM
        (select
        case
        when ((vm.due is not null and vm.due &gt;= now() and date_sub(vm.due, interval 30 day) &gt;=now()) or vm.due is null) then '未过期'
        when vm.due is not null and vm.due &gt; now() and date_sub(vm.due, interval 30 day) &lt;now() then '即将过期'
        when vm.due is not null and vm.due &lt;= now() then '已过期'
        else '其它' end AS exipreType,vm.NAME
        from cj_cmp_vm_view vm
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
        left outer join CJ_CMP_VMWARE_HOST host on host.ID=vm.HOST_ID
        where
        vm.MEMBER_ID = #{memberId}
        <if test="userIds != null and userIds.size >0 ">
            and ( vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
            )
        </if>
        <if test="searchKey != null and searchKey != ''">
            and (vm.IP like concat('%', #{searchKey}, '%') or vm.NAME like concat('%', #{searchKey}, '%') or host.NAME like concat('%', #{searchKey}, '%'))
        </if>

        <if test="startTime != null and startTime != ''">
            and vm.CREATE_DATE between #{startTime} and #{endTime}
        </if>
        ) AS tab group by tab.exipreType) AS b on a.exipreType = b.exipreType;
    
```
#### queryVmSpecReport
```

        SELECT vmInfo.SPEC AS spec,count(vmInfo.`NAME`) AS num FROM
        (SELECT CASE WHEN (vm.CPUS is null or vm.CPUS = '') and (vm.MEMORY is null or vm.MEMORY = '')
        THEN '其它'
        ELSE concat(vm.CPUS,"C",round(ifnull(vm.MEMORY/1024,0),0),"G") END AS SPEC,vm.`NAME`
        from cj_cmp_vm_view vm
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
        where
        vm.MEMBER_ID = #{memberId}
        <if test="userIds != null and userIds.size >0 ">
            and ( vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
            )
        </if>
        <if test="searchKey != null and searchKey != ''">
            and (vm.IP like concat('%', #{searchKey}, '%') or vm.NAME like concat('%', #{searchKey}, '%'))
        </if>

        <if test="startTime != null and startTime != ''">
            and vm.CREATE_DATE between #{startTime} and #{endTime}
        </if>
        ) AS vmInfo group by vmInfo.SPEC
    
```
#### querySpecGroupByAppTopReport
```

        SELECT vmInfo.name,vmInfo.spec FROM
        (SELECT app.NAME AS name,concat(sum(CPUS),"C",round(ifnull(sum(MEMORY)/1024,0),0),"G") AS spec,sum(CPUS) AS vmCpus,sum(MEMORY) AS vmMemory
        FROM cj_cmp_vm_view vm
        inner join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
        where
        vm.MEMBER_ID = #{memberId} and vm.CPUS is not null and vm.MEMORY is not null
        <if test="userIds != null and userIds.size >0 ">
            and ( vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
            )
        </if>
        <if test="startTime != null and startTime != ''">
            and vm.CREATE_DATE between #{startTime} and #{endTime}
        </if>
        group by app.NAME order by app.NAME) AS vmInfo
        <if test="isList != null and isList != '' ">
            order by vmInfo.vmCpus desc,vmInfo.vmMemory desc limit 10
        </if>
        <if test="sortField != null and sortField != ''">
            ORDER BY vmInfo.vmCpus ${sortType},vmInfo.vmMemory ${sortType}
        </if>

    
```
#### querySpecGroupByDeptTopReport
```

        SELECT vmInfo.name,vmInfo.spec FROM
        (SELECT CASE WHEN (app.DEPT_NAME is null or app.DEPT_NAME = '') THEN '其它' ELSE app.DEPT_NAME END AS name,concat(sum(CPUS),"C",round(ifnull(sum(MEMORY)/1024,0),0),"G") AS spec,sum(CPUS) AS vmCpus,sum(MEMORY) AS vmMemory
        FROM cj_cmp_vm_view vm
        inner join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
        where
        vm.MEMBER_ID = #{memberId} and vm.CPUS is not null and vm.MEMORY is not null
        <if test="userIds != null and userIds.size >0 ">
            and ( vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
            )
        </if>
        <if test="startTime != null and startTime != ''">
            and vm.CREATE_DATE between #{startTime} and #{endTime}
        </if>
        group by app.DEPT_NAME order by app.DEPT_NAME) AS vmInfo
        <if test="isList != null and isList != '' ">
            order by vmInfo.vmCpus desc,vmInfo.vmMemory desc limit 10
        </if>
        <if test="sortField != null and sortField != ''">
            ORDER BY vmInfo.vmCpus ${sortType},vmInfo.vmMemory ${sortType}
        </if>
    
```
#### querySpecGroupByMemberTopReport
```

        SELECT vmInfo.name,vmInfo.spec FROM
        (SELECT vm.MEMBER_ID AS name,concat(sum(CPUS),"C",round(ifnull(sum(MEMORY)/1024,0),0),"G") AS spec,sum(CPUS) AS vmCpus,sum(MEMORY) AS vmMemory
        FROM cj_cmp_vm_view vm
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
        where
        vm.MEMBER_ID = #{memberId} and vm.CPUS is not null and vm.MEMORY is not null
        <if test="userIds != null and userIds.size >0 ">
            and ( vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
            )
        </if>
        <if test="startTime != null and startTime != ''">
            and vm.CREATE_DATE between #{startTime} and #{endTime}
        </if>
        group by vm.MEMBER_ID order by vm.MEMBER_ID) AS vmInfo
        <if test="isList != null and isList != '' ">
            order by vmInfo.vmCpus desc,vmInfo.vmMemory desc limit 10
        </if>
        <if test="sortField != null and sortField != ''">
            ORDER BY vmInfo.vmCpus ${sortType},vmInfo.vmMemory ${sortType}
        </if>

    
```
#### querySpecGroupByAppReport
```

        SELECT CASE WHEN app.NAME is null THEN '其它' ELSE app.NAME END AS name,
        concat(CPUS,"C",round(ifnull(MEMORY/1024,0),0),"G") AS spec,count(1) AS num
        FROM cj_cmp_vm_view vm
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
        where
        vm.MEMBER_ID = #{memberId} and vm.CPUS is not null and vm.MEMORY is not null
        <if test="userIds != null and userIds.size >0 ">
            and ( vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
            )
        </if>
        <if test="startTime != null and startTime != ''">
            and vm.CREATE_DATE between #{startTime} and #{endTime}
        </if>
        group by app.NAME,concat(CPUS,"C",round(ifnull(MEMORY/1024,0),0),"G");
    
```
#### querySpecGroupByDeptReport
```

        SELECT CASE WHEN (app.DEPT_NAME is null or app.DEPT_NAME = '') THEN '其它' ELSE app.DEPT_NAME END AS name,
        concat(CPUS,"C",round(ifnull(MEMORY/1024,0),0),"G") AS spec,count(1) AS num
        FROM cj_cmp_vm_view vm
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
        where
        vm.MEMBER_ID = #{memberId} and vm.CPUS is not null and vm.MEMORY is not null
        <if test="userIds != null and userIds.size >0 ">
            and ( vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
            )
        </if>
        <if test="startTime != null and startTime != ''">
            and vm.CREATE_DATE between #{startTime} and #{endTime}
        </if>
        group by app.DEPT_NAME,concat(CPUS,"C",round(ifnull(MEMORY/1024,0),0),"G");
    
```
#### querySpecGroupByMemberReport
```

        SELECT vm.MEMBER_ID AS name,concat(CPUS,"C",round(ifnull(MEMORY/1024,0),0),"G") AS spec,count(1) AS num
        FROM cj_cmp_vm_view vm
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
        where
        vm.MEMBER_ID = #{memberId} and vm.CPUS is not null and vm.MEMORY is not null
        <if test="userIds != null and userIds.size >0 ">
            and ( vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
            )
        </if>
        <if test="startTime != null and startTime != ''">
            and vm.CREATE_DATE between #{startTime} and #{endTime}
        </if>
        group by vm.MEMBER_ID,concat(CPUS,"C",round(ifnull(MEMORY/1024,0),0),"G");
    
```
#### queryVmGroupByDpetReport
```

        SELECT vmInfo.name,vmInfo.spec FROM
        (SELECT vm.MEMBER_ID AS name,concat(sum(CPUS),"C",round(ifnull(sum(MEMORY)/1024,0),0),"G") AS spec
        FROM cj_cmp_vm_view vm
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
        where
        vm.MEMBER_ID = #{memberId} and vm.CPUS is not null and vm.MEMORY is not null
        <if test="userIds != null and userIds.size >0 ">
            and ( vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
            )
        </if>
        <if test="startTime != null and startTime != ''">
            and vm.CREATE_DATE between #{startTime} and #{endTime}
        </if>
        group by vm.MEMBER_ID order by vm.MEMBER_ID) AS vmInfo order by vmInfo.spec desc limit 10;
    
```
#### countCloudVm
```

        select count(distinct vm.SERVICE_ACCOUNT_ID, vm.ID) as num, SUM(ifnull(vol.DISK_SUM,0)) as diskSum
        from cj_cmp_vm_view vm
            left outer join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
        left outer join (
            select SERVICE_ACCOUNT_ID as saId,VM_DEVICE_ID as vmId,sum(ifnull(DISK_SPACE,0)) DISK_SUM
            from CJ_CMP_VM_VOLUME
            where IS_DELETED=0
            group by SERVICE_ACCOUNT_ID,VM_DEVICE_ID) vol on vol.saId=vm.SERVICE_ACCOUNT_ID and vol.vmId=vm.ID
        where vm.MEMBER_ID = #{memberId}
        <if test="userIds != null and userIds.size >0 ">
            and ( vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
            )
        </if>
        <if test="startTime != null and endTime != null ">
            and (vm.CREATE_DATE &gt;= DATE(#{startTime}) AND vm.CREATE_DATE &lt;= DATE(#{endTime}))
        </if>
    
```
#### queryCapacityUsageOfUser
```

        select sum(ifnull(vm.CPUS,0)) as cpu,sum(ifnull(vm.MEMORY,0)) as memory,SUM(ifnull(vol.DISK_SUM,0)) as diskSum
        from cj_cmp_vm_view vm
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
        left outer join (
        select SERVICE_ACCOUNT_ID as saId,VM_DEVICE_ID as vmId,sum(ifnull(DISK_SPACE,0)) DISK_SUM
        from CJ_CMP_VM_VOLUME
        where IS_DELETED=0
        group by SERVICE_ACCOUNT_ID,VM_DEVICE_ID) vol on vol.saId=vm.SERVICE_ACCOUNT_ID and vol.vmId=vm.ID
        where vm.MEMBER_ID = #{memberId}
        <if test="userIds != null and userIds.size >0 ">
            and ( vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
            )
        </if>
    
```
#### queryCapacityUsage
```

        select sum(ifnull(vm.CPUS, 0))      as cpu,
               sum(ifnull(vm.MEMORY, 0))    as memory,
               SUM(ifnull(vol.DISK_SUM, 0)) as diskSum
        from cj_cmp_vm_view vm
                 left outer join (
            select SERVICE_ACCOUNT_ID as saId, VM_DEVICE_ID as vmId, sum(ifnull(DISK_SPACE, 0)) as DISK_SUM
            from CJ_CMP_VM_VOLUME
            where IS_DELETED = 0 and MEMBER_ID = #{memberId}
            group by SERVICE_ACCOUNT_ID, VM_DEVICE_ID) vol on vol.saId = vm.SERVICE_ACCOUNT_ID and vol.vmId = vm.ID
        <where>
            <if test="memberId != 0 ">
                and vm.MEMBER_ID = #{memberId}
            </if>
        </where>

    
```
#### queryCapacityByCloudAccountId
```

        select sum(vm.CPUS)      as vcpu,
               sum(vm.MEMORY)    as memory,
               sum(vol.DISK_SUM) as storage
        from cj_cmp_vm_view vm
                 left outer join (
            select SERVICE_ACCOUNT_ID as saId, VM_DEVICE_ID as vmId, sum(ifnull(DISK_SPACE, 0)) as DISK_SUM
            from CJ_CMP_VM_VOLUME
            where IS_DELETED = 0
                <if test="memberId != 0 ">
                    and MEMBER_ID = #{memberId}
                </if>
            group by SERVICE_ACCOUNT_ID, VM_DEVICE_ID) vol on vol.saId = vm.SERVICE_ACCOUNT_ID and vol.vmId = vm.ID
        where vm.CLOUD_ACCOUNT_ID = #{cloudAccountId}
            <if test="memberId != 0 ">
                and vm.MEMBER_ID = #{memberId}
            </if>
    
```
#### queryAppTopByColumnSum
```

        SELECT 
            vmInfo.appName,
        <choose>
            <when test="column!=null and column=='cpu'">
                vmInfo.cpus
            </when>
            <when test="column!=null and column=='memory'">
                vmInfo.memoryTotal
            </when>
        </choose>
        FROM (SELECT
                  app.NAME AS appName,
                <choose>
                    <when test="column!=null and column=='cpu'">
                        sum(vm.CPUS) AS cpus
                    </when>
                    <when test="column!=null and column=='memory'">
                        sum(vm.MEMORY) AS memoryTotal
                    </when>
                </choose>
              FROM cj_cmp_vm_view vm
                       inner join CJ_CMP_APP_SYSTEM app on app.ID = vm.APP_SYSTEM_ID
              where vm.MEMBER_ID = #{memberId}
                and DATE_SUB(CURDATE(), INTERVAL #{intervalTime} MONTH ) &lt;= date(vm.CREATE_DATE)
              group by app.NAME
              order by app.NAME) AS vmInfo
              order by
                <choose>
                    <when test="column!=null and column=='cpu'">
                        vmInfo.cpus
                    </when>
                    <when test="column!=null and column=='memory'">
                        vmInfo.memoryTotal
                    </when>
                </choose>
              desc
            limit 10
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_VM_VOLUME.xml
> sql统计:复杂0个，简单12个
>
> 使用的关键字：concat,ceil,sum,count,NOW,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_VPC.xml
> sql统计:复杂1个，简单11个
>
> 使用的关键字：and,CONCAT,from,on,join,count,in,if,concat,group_concat,values
#### selectVpcAndVds
```

    select * from (
    select
        vpc.ID,vpc.MEMBER_ID,vpc.ENTITY_ID,
        vpc.SERVICE_ACCOUNT_ID,
        vpc.NAME,vpc.LDC_ID,vpc.LDC_TYPE,vpc.CIDR_BLOCK,
        vpc.STATUS,vpc.DESCRIPTION,
        "VPC" as cloudWebType, saccount1.TYPE as sAccountType,
        vpc.CREATE_BY,vpc.CREATE_DATE,vpc.LAST_MODIFIED_BY,vpc.LAST_MODIFIED_DATE,
        saccount1.NAME as sAccountName,adc.NAME as ldcName
    from CJ_CMP_VPC vpc
    inner join CJ_CMP_SERVICE_ACCOUNT saccount1 on
    vpc.SERVICE_ACCOUNT_ID = saccount1.ID and saccount1.IS_DELETED=0
    left join CJ_CMP_ALIYUN_DC adc on adc.ID = vpc.LDC_ID and adc.IS_DELETED=0
    left join CJ_CMP_CLOUD_ACCOUNT_DC cdc on cdc.SERVICE_ACCOUNT_ID = vpc.SERVICE_ACCOUNT_ID and cdc.LDC_ID = vpc.LDC_ID and cdc.IS_DELETED = 0
    left join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED = 0
    <where>
      <choose>
        <when test="memberId != 0">
          and ca.MEMBER_ID = #{memberId}
        </when>
        <otherwise>
          and ca.SCOPE = 'public'
        </otherwise>
      </choose>
      <if test="serviceAccountId != 'ALL'">
        and vpc.SERVICE_ACCOUNT_ID = #{serviceAccountId}
      </if>
      <if test="ldcType != 'ALL' and ldcType != '' and ldcType != null">
        and saccount1.DATACENTER_TYPE = #{ldcType}
      </if>
      <if test="cloudAccountId != 'ALL'">
        and vpc.LDC_ID in (
        select cadc.LDC_ID from  CJ_CMP_CLOUD_ACCOUNT_DC cadc where cadc.CLOUD_ACCOUNT_ID = #{cloudAccountId} and cadc.IS_DELETED=0
        )
      </if>
      <if test="ldcId != 'ALL'" >
        and vpc.LDC_ID = #{ldcId}
      </if>
      <if test="queryValue != null" >
        <if test="queryValue != ''" >
          <choose>
            <when test="queryKey == 'ALL'" >
              and (
              vpc.NAME like CONCAT('%',#{queryValue},'%')
              OR vpc.CIDR_BLOCK like CONCAT('%',#{queryValue},'%')
              OR vpc.ENTITY_ID like CONCAT('%',#{queryValue},'%')
              )
            </when>
            <otherwise>
              <if test="queryKey == 'ENTITY_ID'" >
                and vpc.ENTITY_ID like CONCAT('%',#{queryValue},'%')
              </if>
              <if test="queryKey == 'NAME'" >
                and vpc.NAME like CONCAT('%',#{queryValue},'%')
              </if>
              <if test="queryKey == 'CIDR_BLOCK'" >
                and vpc.CIDR_BLOCK like CONCAT('%',#{queryValue},'%')
              </if>
            </otherwise>
          </choose>
        </if>
      </if>
    </where>
    union all
      select * from (select
      vds.ID,vds.MEMBER_ID,vds.ENTITY_ID,
      vds.SERVICE_ACCOUNT_ID,
      if(vds.TYPE = 'VSS',concat(vds.NAME, if(group_concat(vmHost.IP) is null, '', concat('[', group_concat(vmHost.IP), ']'))),vds.NAME) as NAME,
      vds.LDC_ID,vds.LDC_TYPE, "" as CIDR_BLOCK,
      vds.STATUS,vds.DESCRIPTION,
      vds.TYPE as cloudWebType, saccount2.TYPE as sAccountType,
      vds.CREATE_BY,vds.CREATE_DATE,vds.LAST_MODIFIED_BY,vds.LAST_MODIFIED_DATE,
      saccount2.NAME as sAccountName,vdc.NAME as ldcName
    from CJ_CMP_VDS vds
    inner join CJ_CMP_SERVICE_ACCOUNT saccount2 on vds.SERVICE_ACCOUNT_ID = saccount2.ID and saccount2.IS_DELETED=0
    left join CJ_CMP_VMWARE_DC vdc on vdc.ID = vds.LDC_ID  and vdc.IS_DELETED=0
    left join CJ_CMP_VDS_X_HOST vdsRel on vds.ID = vdsRel.VDS_ID
    left join CJ_CMP_VMWARE_HOST vmHost on vdsRel.HOST_ID = vmHost.ID
    left join CJ_CMP_CLOUD_ACCOUNT_DC cdc on cdc.SERVICE_ACCOUNT_ID = vds.SERVICE_ACCOUNT_ID and cdc.LDC_ID = vds.LDC_ID and cdc.IS_DELETED = 0
    left join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED = 0
    <where>
      <choose>
        <when test="memberId != 0">
          and ca.MEMBER_ID = #{memberId}
        </when>
        <otherwise>
          and ca.SCOPE = 'public'
        </otherwise>
      </choose>
      <if test="serviceAccountId != 'ALL'" >
        and vds.SERVICE_ACCOUNT_ID = #{serviceAccountId}
      </if>
    <if test="ldcType != 'ALL' and ldcType != '' and ldcType != null">
      and saccount2.DATACENTER_TYPE = #{ldcType}
    </if>
      <if test="cloudAccountId != 'ALL'" >
        and vds.LDC_ID in (
        select cadc.LDC_ID from  CJ_CMP_CLOUD_ACCOUNT_DC cadc where cadc.CLOUD_ACCOUNT_ID = #{cloudAccountId} and cadc.IS_DELETED=0
        )
      </if>
      <if test="ldcId != 'ALL'" >
        and vds.LDC_ID = #{ldcId}
      </if>
      </where>
      group by vds.ID
      ) t where 1 = 1
      <if test="queryValue != null" >
        <if test="queryValue != ''" >
          <choose>
            <when test="queryKey == 'ALL'" >
              and (
              t.NAME like CONCAT('%',#{queryValue},'%')
              OR t.ENTITY_ID like CONCAT('%',#{queryValue},'%')
              )
            </when>
            <otherwise>
              <if test="queryKey == 'ENTITY_ID'" >
                and t.ENTITY_ID like CONCAT('%',#{queryValue},'%')
              </if>
              <if test="queryKey == 'NAME'" >
                and t.NAME like CONCAT('%',#{queryValue},'%')
              </if>
            </otherwise>
          </choose>
        </if>
      </if>
    union all
      select * from (select
      vds.ID,vds.MEMBER_ID,vds.ENTITY_ID,
      vds.SERVICE_ACCOUNT_ID,
      if(vds.TYPE = 'VSS',concat(vds.NAME, if(group_concat(vmHost.IP) is null, '', concat('[', group_concat(vmHost.IP), ']'))),vds.NAME) as NAME,
      vds.LDC_ID,fcsa.DATACENTER_TYPE, '' as CIDR_BLOCK,
      '',vds.SHORT_DESCRIPTION,
      vds.TYPE as cloudWebType, fcsa.TYPE as sAccountType,
      vds.CREATE_BY,vds.CREATE_DATE,vds.LAST_MODIFIED_BY,vds.LAST_MODIFIED_DATE,
      fcsa.NAME as sAccountName,vdc.NAME as ldcName
    from CJ_CMP_FUSION_COMPUTE_VDS vds
    inner join CJ_CMP_SERVICE_ACCOUNT fcsa on vds.SERVICE_ACCOUNT_ID = fcsa.ID and fcsa.IS_DELETED=0 and vds.IS_DELETED=0
    left join CJ_CMP_FUSION_COMPUTE_DC vdc on vdc.ID = vds.LDC_ID  and vdc.IS_DELETED=0
    left join CJ_CMP_FUSION_COMPUTE_VDS_X_HOST vdsRel on vds.ID = vdsRel.VDS_ID
    left join CJ_CMP_FUSION_COMPUTE_HOST vmHost on vdsRel.HOST_ID = vmHost.ID
    left join CJ_CMP_CLOUD_ACCOUNT_DC cdc on cdc.SERVICE_ACCOUNT_ID = vds.SERVICE_ACCOUNT_ID and cdc.LDC_ID = vds.LDC_ID and cdc.IS_DELETED = 0
    left join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED = 0
    where 1 = 1
    <choose>
      <when test="memberId != 0">
        and ca.MEMBER_ID = #{memberId}
      </when>
      <otherwise>
        and ca.SCOPE = 'public'
      </otherwise>
    </choose>
      <if test="serviceAccountId != 'ALL'" >
        and vds.SERVICE_ACCOUNT_ID = #{serviceAccountId}
      </if>
    <if test="ldcType != 'ALL' and ldcType != '' and ldcType != null">
      and fcsa.DATACENTER_TYPE = #{ldcType}
    </if>
      <if test="cloudAccountId != 'ALL'" >
        and vds.LDC_ID in (
        select cadc.LDC_ID from  CJ_CMP_CLOUD_ACCOUNT_DC cadc where cadc.CLOUD_ACCOUNT_ID = #{cloudAccountId} and cadc.IS_DELETED=0
        )
      </if>
      <if test="ldcId != 'ALL'" >
        and vds.LDC_ID = #{ldcId}
      </if>
      group by vds.ID) t where 1 = 1
      <if test="queryValue != null" >
        <if test="queryValue != ''" >
          <choose>
            <when test="queryKey == 'ALL'" >
              and (
              t.NAME like CONCAT('%',#{queryValue},'%')
              OR t.ENTITY_ID like CONCAT('%',#{queryValue},'%')
              )
            </when>
            <otherwise>
              <if test="queryKey == 'ENTITY_ID'" >
                and t.ENTITY_ID like CONCAT('%',#{queryValue},'%')
              </if>
              <if test="queryKey == 'NAME'" >
                and t.NAME like CONCAT('%',#{queryValue},'%')
              </if>
            </otherwise>
          </choose>
        </if>
      </if>
      union all
        select fvpc.ID,fvpc.MEMBER_ID,fvpc.ENTITY_ID,fvpc.SERVICE_ACCOUNT_ID,fvpc.NAME,fvpc.LDC_ID,fcdc.LDC_TYPE as ldcType,fvpc.CIDR as CIDR_BLOCK,null as STATUS,
          null as DESCRIPTION,'VPC' as cloudWebType,fsa.TYPE as sAccountType,fvpc.CREATE_BY,fvpc.CREATE_DATE,fvpc.LAST_MODIFIED_BY,fvpc.LAST_MODIFIED_DATE,
          fsa.NAME as sAccountName,fdc.NAME as ldcName
        from CJ_CMP_SERVICE_ACCOUNT fsa
        inner join CJ_CMP_FUSION_CLOUD_DC fdc on fdc.SERVICE_ACCOUNT_ID=fsa.ID and fsa.IS_DELETED=0 and fdc.IS_DELETED=0
        left join CJ_CMP_CLOUD_ACCOUNT_DC fcdc on (fcdc.SERVICE_ACCOUNT_ID=fsa.ID or fcdc.SERVICE_ACCOUNT_ID = fsa.PARENT_ID) and fcdc.LDC_ID=fdc.ID and fcdc.IS_DELETED=0
        inner join CJ_CMP_CLOUD_ACCOUNT fca on fcdc.CLOUD_ACCOUNT_ID=fca.ID and fca.IS_DELETED=0
        inner join CJ_CMP_FUSION_CLOUD_VPC fvpc on fvpc.LDC_ID=fdc.ID and fvpc.IS_DELETED=0
        <where>
          <choose>
            <when test="memberId != 0">
              and fca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
              and fca.SCOPE = 'public'
            </otherwise>
          </choose>
        <if test="serviceAccountId != 'ALL'" >
          and (fsa.ID = #{serviceAccountId} or fsa.PARENT_ID = #{serviceAccountId})
        </if>
        <if test="ldcType != 'ALL' and ldcType != '' and ldcType != null">
          and fsa.DATACENTER_TYPE = #{ldcType}
        </if>
        <if test="cloudAccountId != 'ALL'" >
          and fca.ID= #{cloudAccountId}
        </if>
        <if test="ldcId != 'ALL'" >
          and fvpc.LDC_ID = #{ldcId}
        </if>
        <if test="queryValue != null and queryValue != ''" >
            <if test="queryKey == 'ALL'" >
              and ( fvpc.NAME like CONCAT('%',#{queryValue},'%') OR fvpc.ENTITY_ID like CONCAT('%',#{queryValue},'%') )
            </if>
            <if test="queryKey == 'ENTITY_ID'" >
              and fvpc.ENTITY_ID like CONCAT('%',#{queryValue},'%')
            </if>
            <if test="queryKey == 'NAME'" >
              and fvpc.NAME like CONCAT('%',#{queryValue},'%')
            </if>
        </if>
        </where>
    union all
    select
    con.ID,con.MEMBER_ID,con.ENTITY_ID,
    con.SERVICE_ACCOUNT_ID,
    con.NAME,con.LDC_ID, cadc1.LDC_TYPE ldcType, "" as CIDR_BLOCK,
    con.STATUS,con.DESCRIPTION,
    "VPC" as cloudWebType, saccount2.TYPE as sAccountType,
    con.CREATE_BY,con.CREATE_DATE,con.LAST_MODIFIED_BY,con.LAST_MODIFIED_DATE,
    saccount2.NAME as sAccountName, cod.NAME as ldcName
    from CJ_CMP_CLOUDOS_NETWORK con
    inner join CJ_CMP_SERVICE_ACCOUNT saccount2 on con.SERVICE_ACCOUNT_ID = saccount2.ID and saccount2.IS_DELETED=0
    left join CJ_CMP_CLOUD_ACCOUNT_DC cadc1 on cadc1.SERVICE_ACCOUNT_ID = saccount2.ID and cadc1.LDC_ID = con.LDC_ID and cadc1.IS_DELETED=0
    left join CJ_CMP_CLOUDOS_DC cod on cod.ID = con.LDC_ID and cod.IS_DELETED=0
    left join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = cadc1.CLOUD_ACCOUNT_ID and ca.IS_DELETED = 0
    where con.IS_DELETED=0
    <choose>
      <when test="memberId != 0">
        and ca.MEMBER_ID = #{memberId}
      </when>
      <otherwise>
        and ca.SCOPE = 'public'
      </otherwise>
    </choose>
    <if test="serviceAccountId != 'ALL'" >
      and con.SERVICE_ACCOUNT_ID = #{serviceAccountId}
    </if>
    <if test="ldcType != 'ALL' and ldcType != '' and ldcType != null">
      and saccount2.DATACENTER_TYPE = #{ldcType}
    </if>
    <if test="cloudAccountId != 'ALL'" >
      and con.LDC_ID in (
      select cadc.LDC_ID from  CJ_CMP_CLOUD_ACCOUNT_DC cadc where cadc.CLOUD_ACCOUNT_ID = #{cloudAccountId} and cadc.IS_DELETED=0
      )
    </if>
    <if test="ldcId != 'ALL'" >
      and con.LDC_ID = #{ldcId}
    </if>
    <if test="queryValue != null" >
      <if test="queryValue != ''" >
        <choose>
          <when test="queryKey == 'ALL'" >
            and (
            con.NAME like CONCAT('%',#{queryValue},'%')
            OR con.ENTITY_ID like CONCAT('%',#{queryValue},'%')
            )
          </when>
          <otherwise>
            <if test="queryKey == 'ENTITY_ID'" >
              and con.ENTITY_ID like CONCAT('%',#{queryValue},'%')
            </if>
            <if test="queryKey == 'NAME'" >
              and con.NAME like CONCAT('%',#{queryValue},'%')
            </if>
          </otherwise>
        </choose>
      </if>

    </if>
    union all
    select
    region.ID,region.MEMBER_ID,region.ENTITY_ID,
    region.SERVICE_ACCOUNT_ID,
    region.NAME, null as ldcId, "cloudboot" as ldcType, "" as cidrBlock, "available" as status,
    region.DESCRIPTION, "boot交换机" as cloudWebType, saTable.TYPE as sAccountType,
    region.CREATE_BY,region.CREATE_DATE,region.LAST_MODIFIED_BY,region.LAST_MODIFIED_DATE,
    saTable.NAME as sAccountName, null as ldcName
    from CJ_CMDB_CI_SYS_REGION region
    inner join
    (
    SELECT DISTINCT
    sa.ID, sa.TYPE, sa.NAME
    FROM
    CJ_CMP_CLOUD_ACCOUNT ca
    INNER JOIN CJ_CMP_CLOUD_ACCOUNT_DC cdc ON ca.ID = cdc.CLOUD_ACCOUNT_ID
    AND ca.IS_DELETED = 0
    AND cdc.IS_DELETED = 0
    INNER JOIN CJ_CMDB_CI_PHYSICAL_DATACENTER dc ON cdc.LDC_ID = dc.ID
    AND dc.SERVICE_ACCOUNT_ID = cdc.SERVICE_ACCOUNT_ID
    AND dc.IS_DELETED = 0
    INNER JOIN CJ_CMP_SERVICE_ACCOUNT sa ON dc.SERVICE_ACCOUNT_ID = sa.ID
    AND sa.IS_DELETED = 0
    <where>
      <choose>
        <when test="memberId != 0">
          and ca.MEMBER_ID = #{memberId}
        </when>
        <otherwise>
          and ca.SCOPE = 'public'
        </otherwise>
      </choose>
      <if test="cloudAccountId != 'ALL'"> and ca.ID=#{cloudAccountId}</if>
      <if test="serviceAccountId != 'ALL'"> and cdc.SERVICE_ACCOUNT_ID=#{serviceAccountId}</if>
      <if test="ldcType != 'ALL' and ldcType != '' and ldcType != null">
        and sa.DATACENTER_TYPE = #{ldcType}
      </if>
    </where>
    ) saTable ON region.SERVICE_ACCOUNT_ID = saTable.ID
    <where>
    region.IS_DELETED = 0
    <if test="queryValue != null" >
      <if test="queryValue != ''" >
        <choose>
          <when test="queryKey == 'ALL'" >
            and (
            region.NAME like CONCAT('%',#{queryValue},'%')
            OR region.ENTITY_ID like CONCAT('%',#{queryValue},'%')
            )
          </when>
          <otherwise>
            <if test="queryKey == 'ENTITY_ID'" >
              and region.ENTITY_ID like CONCAT('%',#{queryValue},'%')
            </if>
            <if test="queryKey == 'NAME'" >
              and region.NAME like CONCAT('%',#{queryValue},'%')
            </if>
          </otherwise>
        </choose>
      </if>
    </if>
    </where>
    union all
    select
    qvpc.ID,qvpc.MEMBER_ID,qvpc.ENTITY_ID,
    qvpc.SERVICE_ACCOUNT_ID,
    qvpc.NAME,qvpc.LDC_ID, cadc1.LDC_TYPE ldcType, "" as CIDR_BLOCK,
    qvpc.RUN_STATUS as STATUS,qvpc.DESCRIPTION,
    "VPC" as cloudWebType, saccount2.TYPE as sAccountType,
    qvpc.CREATE_BY,qvpc.CREATE_DATE,qvpc.LAST_MODIFIED_BY,qvpc.LAST_MODIFIED_DATE,
    saccount2.NAME as sAccountName, qdc.NAME as ldcName
    from CJ_CMDB_CI_QINGCLOUD_VPC qvpc
    inner join CJ_CMP_SERVICE_ACCOUNT saccount2 on qvpc.SERVICE_ACCOUNT_ID = saccount2.ID and qvpc.IS_DELETED=0
    left join CJ_CMP_CLOUD_ACCOUNT_DC cadc1 on cadc1.SERVICE_ACCOUNT_ID = saccount2.ID and cadc1.LDC_ID = qvpc.LDC_ID  and cadc1.IS_DELETED=0
    left join CJ_CMDB_CI_QINGCLOUD_DATACENTER qdc on qdc.ID = qvpc.LDC_ID and qdc.IS_DELETED=0
    left join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = cadc1.CLOUD_ACCOUNT_ID and ca.IS_DELETED = 0
    where 1 = 1
    and qvpc.IS_DELETED=0
    <choose>
      <when test="memberId != 0">
        and ca.MEMBER_ID = #{memberId}
      </when>
      <otherwise>
        and ca.SCOPE = 'public'
      </otherwise>
    </choose>
    <if test="serviceAccountId != 'ALL'" >
      and qvpc.SERVICE_ACCOUNT_ID = #{serviceAccountId}
    </if>
    <if test="ldcType != 'ALL' and ldcType != '' and ldcType != null">
      and saccount2.DATACENTER_TYPE = #{ldcType}
    </if>
    <if test="cloudAccountId != 'ALL'" >
      and qvpc.LDC_ID in (
      select cadc.LDC_ID from  CJ_CMP_CLOUD_ACCOUNT_DC cadc where cadc.CLOUD_ACCOUNT_ID = #{cloudAccountId}  and cadc.IS_DELETED=0
      )
    </if>
    <if test="ldcId != 'ALL'" >
      and qvpc.LDC_ID = #{ldcId}
    </if>
    <if test="queryValue != null" >
      <if test="queryValue != ''" >
        <choose>
          <when test="queryKey == 'ALL'" >
            and (
            qvpc.NAME like CONCAT('%',#{queryValue},'%')
            OR qvpc.ENTITY_ID like CONCAT('%',#{queryValue},'%')
            )
          </when>
          <otherwise>
            <if test="queryKey == 'ENTITY_ID'" >
              and qvpc.ENTITY_ID like CONCAT('%',#{queryValue},'%')
            </if>
            <if test="queryKey == 'NAME'" >
              and qvpc.NAME like CONCAT('%',#{queryValue},'%')
            </if>
          </otherwise>
        </choose>
      </if>

    </if>
    ) as vpc_vds_network
  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_VPC_SUBNET.xml
> sql统计:复杂0个，简单14个
>
> 使用的关键字：count,and,from,in,values,IF,ISNULL,CONCAT

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_WEB_ACCESS_CONFIG.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：now,NOW,CJ_CMP_WEB_ACCESS_CONFIG,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_WEB_ACCESS_LOG.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：NOW,CJ_CMP_WEB_ACCESS_LOG,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CMP_WEB_ACCESS_URL.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：CJ_CMP_WEB_ACCESS_URL,values,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CPG_BIZ_API.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CPG_BIZ_API,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CPG_BIZ_INST.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：now,CJ_CPG_BIZ_INST,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CPG_BIZ_MODEL.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：count,concat,CJ_CPG_BIZ_MODEL,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CPG_BIZ_STAGE.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CPG_BIZ_STAGE,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CPG_BIZ_STATE.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CPG_BIZ_STATE,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CPG_RELATION_LIST.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：CJ_CPG_RELATION_LIST,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_CPG_TASK.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CPG_TASK,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_IMPORT_LOG.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：CJ_IMPORT_LOG,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_IMPORT_LOG_RECORD.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：values,now,count,and,CJ_IMPORT_LOG_RECORD

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_INCIDENT.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：NOW,CJ_INCIDENT,values,concat,and,in

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_INCIDENT_X_USER.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：now,CJ_INCIDENT_X_USER,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_ASSET.xml
> sql统计:复杂0个，简单38个
>
> 使用的关键字：exists,CJ_PAM_ASSET,values,count

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_ASSET_OFFLINE.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：concat,size,CJ_PAM_ASSET_OFFLINE,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_ASSET_OFFLINE_UNIT.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：NOW,CJ_PAM_ASSET_OFFLINE_UNIT,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_ASSET_SHIFT.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：values,NOW,CONCAT,CJ_PAM_ASSET_SHIFT

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_ASSET_SHIFT_UNIT.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：NOW,CJ_PAM_ASSET_SHIFT_UNIT,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_ASSET_STAGE_RESULT.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：from,CJ_PAM_ASSET_STAGE_RESULT,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_BATCH.xml
> sql统计:复杂0个，简单12个
>
> 使用的关键字：size,AND,concat,CJ_PAM_BATCH,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_BATCH_X_ASSET.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：CJ_PAM_BATCH_X_ASSET,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_CATEGORY.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：concat,CJ_PAM_CATEGORY,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_CLOUD_ACCOUNT_X_PM_MODEL.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：CJ_PAM_CLOUD_ACCOUNT_X_PM_MODEL,values,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_EXPANSION_ENTRY.xml
> sql统计:复杂0个，简单13个
>
> 使用的关键字：concat,from,sum,NOW,CJ_PAM_EXPANSION_ENTRY,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_EXPANSION_ENTRY_X_ASSET.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：CJ_PAM_EXPANSION_ENTRY_X_ASSET,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_HARDWARE_TEMPLATE.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：concat,CJ_PAM_HARDWARE_TEMPLATE,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_MODEL_CONFIGURATION.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：concat,CJ_PAM_MODEL_CONFIGURATION,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_NETWORK_WIRING.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：CJ_PAM_NETWORK_WIRING,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_OS_TEMPLATE.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：concat,CJ_PAM_OS_TEMPLATE,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_PARTS_CPU.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：CJ_PAM_PARTS_CPU,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_PARTS_DISK.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：CJ_PAM_PARTS_DISK,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_PARTS_FAN.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：CJ_PAM_PARTS_FAN,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_PARTS_HBA.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：values,CJ_PAM_PARTS_HBA

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_PARTS_MEMORY.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：CJ_PAM_PARTS_MEMORY,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_PARTS_NIC.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：CJ_PAM_PARTS_NIC,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_PARTS_POWER.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：CJ_PAM_PARTS_POWER,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_PARTS_RAID.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：CJ_PAM_PARTS_RAID,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_PM_MODEL_X_SPEC_CPU.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：now,CJ_PAM_PM_MODEL_X_SPEC_CPU,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_PM_MODEL_X_SPEC_DISK.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：now,CJ_PAM_PM_MODEL_X_SPEC_DISK,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_PM_MODEL_X_SPEC_GPU.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：now,CJ_PAM_PM_MODEL_X_SPEC_GPU,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_PM_MODEL_X_SPEC_MEMORY.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：now,CJ_PAM_PM_MODEL_X_SPEC_MEMORY,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_PRODUCT.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：concat,CJ_PAM_PRODUCT,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_PRODUCTION_BATCH.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：concat,size,now,CJ_PAM_PRODUCTION_BATCH,values,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_PRODUCTION_SUB_BATCH.xml
> sql统计:复杂0个，简单16个
>
> 使用的关键字：from,count,sum,now,CJ_PAM_PRODUCTION_SUB_BATCH,values,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_PRODUCTION_SUB_X_ASSET.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：now,CJ_PAM_PRODUCTION_SUB_X_ASSET,values,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_PRODUCT_COMPONENT.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：CJ_PAM_PRODUCT_COMPONENT,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_PURCHASE.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：CJ_PAM_PURCHASE,values,concat,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_PURCHASE_CONFIGURATION.xml
> sql统计:复杂0个，简单12个
>
> 使用的关键字：now,CJ_PAM_PURCHASE_CONFIGURATION,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_PURCHASE_CONFIGURATION_X_SPEC_CPU.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：CJ_PAM_PURCHASE_CONFIGURATION_X_SPEC_CPU,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_PURCHASE_CONFIGURATION_X_SPEC_DISK.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：now,CJ_PAM_PURCHASE_CONFIGURATION_X_SPEC_DISK,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_PURCHASE_CONFIGURATION_X_SPEC_GPU.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：now,CJ_PAM_PURCHASE_CONFIGURATION_X_SPEC_GPU,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_PURCHASE_CONFIGURATION_X_SPEC_HBA.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：now,CJ_PAM_PURCHASE_CONFIGURATION_X_SPEC_HBA,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_PURCHASE_CONFIGURATION_X_SPEC_MEMORY.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：now,CJ_PAM_PURCHASE_CONFIGURATION_X_SPEC_MEMORY,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_PURCHASE_CONFIGURATION_X_SPEC_NIC.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：CJ_PAM_PURCHASE_CONFIGURATION_X_SPEC_NIC,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_PURCHASE_CONFIGURATION_X_SPEC_RAID.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：now,CJ_PAM_PURCHASE_CONFIGURATION_X_SPEC_RAID,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_PURCHASE_ENTRY_X_ASSET.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：CJ_PAM_PURCHASE_ENTRY_X_ASSET

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_PURCHASE_X_PM_MODEL.xml
> sql统计:复杂0个，简单12个
>
> 使用的关键字：in,now,CJ_PAM_PURCHASE_X_PM_MODEL,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_RACK_UNIT.xml
> sql统计:复杂0个，简单14个
>
> 使用的关键字：concat,now,IN,CJ_PAM_RACK_UNIT,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_RESOURCE_POOL_EXPANSION.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_PAM_RESOURCE_POOL_EXPANSION,values,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_RESOURCE_POOL_NODE_CONFIG.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：values,CJ_PAM_RESOURCE_POOL_NODE_CONFIG

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_RESOURCE_POOL_PLAN.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：now,CJ_PAM_RESOURCE_POOL_PLAN,values,concat,and,or

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_RESOURCE_POOL_PLAN_NODE.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：CJ_PAM_RESOURCE_POOL_PLAN_NODE,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_RESOURCE_POOL_SOURCE.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_PAM_RESOURCE_POOL_SOURCE,values,concat

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_RESOURCE_POOL_X_PRODUCT.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：values,NOW,CJ_PAM_RESOURCE_POOL_X_PRODUCT

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_SPEC_CPU.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：concat,now,CJ_PAM_SPEC_CPU,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_SPEC_DISK.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：concat,now,CJ_PAM_SPEC_DISK,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_SPEC_GPU.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：values,concat,now,CJ_PAM_SPEC_GPU

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_SPEC_HBA.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：concat,now,CJ_PAM_SPEC_HBA,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_SPEC_MEMORY.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：concat,now,CJ_PAM_SPEC_MEMORY,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_SPEC_NIC.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：concat,now,CJ_PAM_SPEC_NIC,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_SPEC_RAID.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：concat,now,CJ_PAM_SPEC_RAID,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_PAM_TASK_JOB.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_PAM_TASK_JOB,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_SYS_DIC.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：in,now,CJ_SYS_DIC,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_SYS_DISPLAY_NAME_CONFIG.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：NOW,CJ_SYS_DISPLAY_NAME_CONFIG,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_SYS_OPER_LOG.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：and,CJ_SYS_OPER_LOG,VALUES,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_SYS_PARAM.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：size,now,CJ_SYS_PARAM,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_SYS_REPORT_CONFIG.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：CJ_SYS_REPORT_CONFIG,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_SYS_REPORT_GROUP.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：values,now,CJ_SYS_REPORT_GROUP

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CJ_SYS_SCREEN.xml
> sql统计:复杂4个，简单4个
>
> 使用的关键字：ON,SUM,on,ISNULL,count,date_format,concat,curdate,FROM,IF,from,COUNT,ifnull
#### queryHostNumberTrendByRecentYear
```

        SELECT #{cloudType} as cloudType,
        (
            SELECT ifnull(count(DISTINCT ENTITY_ID), 0) FROM
        CJ_CMP_HOST_DAY_REPORT  report WHERE report.STAT_TIME like concat(date_format(curdate(), '%Y-%m') ,'-%')
        AND MEMBER_ID IN
        <foreach item="item" index="index" collection="memberIds" open="(" separator="," close=")">
            #{item}
        </foreach>
            ) AS `total`,
        time.datetime,
        COUNT(DISTINCT report.ENTITY_ID) as num
        FROM (
        <include refid="Time_List"/>
        ) time
        LEFT JOIN CJ_CMP_HOST_DAY_REPORT report
        ON (report.STAT_TIME like concat(time.datetime,'-%')
        AND MEMBER_ID IN
        <foreach item="item" index="index" collection="memberIds" open="(" separator="," close=")">
            #{item}
        </foreach>)
        GROUP BY time.datetime;
    
```
#### queryCloudNativeClusterTrend
```

        SELECT
        #{cloudType} AS cloudNativeType,
        (SELECT ifnull(count(DISTINCT CLUSTER_ID), 0) FROM CJ_CMP_KUBERNETES_NODE_DAY_REPORT) AS `count`,
        time.datetime,
        COUNT(DISTINCT node.CLUSTER_ID) as num
        FROM (
        <include refid="Time_List"/>
        ) time
        LEFT JOIN CJ_CMP_KUBERNETES_NODE_DAY_REPORT node
        ON (node.STAT_TIME like concat(time.datetime,'-%'))
        GROUP BY time.datetime;
    
```
#### queryCloudNativePodTrend
```

        SELECT
        #{cloudType} AS cloudNativeType,
        (
        SELECT ifnull(count(DISTINCT pod.ENTITY_ID), 0)
        FROM CJ_CMP_KUBERNETES_NODE_DAY_REPORT node
        LEFT JOIN CJ_CMP_KUBERNETES_POD pod on (node.ID = pod.NODE_ID)
        ) AS `count`,
        time.datetime AS datetime,
        COUNT(DISTINCT pod.ENTITY_ID) AS num
        FROM (
        <include refid="Time_List"/>
        ) time
        LEFT JOIN CJ_CMP_KUBERNETES_NODE_DAY_REPORT node
        ON (node.STAT_TIME like concat(time.datetime, '-%'))
        LEFT JOIN CJ_CMP_KUBERNETES_POD pod on (node.ID = pod.NODE_ID)
        GROUP BY time.datetime;
    
```
#### queryCloudNativeSystemTrend
```

        SELECT
        #{cloudType} AS cloudNativeType,
        (SELECT ifnull(count(DISTINCT node.APP_SYSTEM_ID), 0)
        FROM CJ_CMP_KUBERNETES_NODE node
        WHERE node.IS_DELETED = 0
        ) AS `count`,
        time.datetime AS datetime,
        COUNT(DISTINCT node.APP_SYSTEM_ID) as num
        FROM (
        <include refid="Time_List"/>
        ) time
        LEFT JOIN CJ_CMP_KUBERNETES_NODE_DAY_REPORT node_re
        ON (node_re.STAT_TIME like concat(time.datetime, '-%'))
        LEFT JOIN CJ_CMP_KUBERNETES_NODE node
        ON (node.ID = node_re.ID)
        GROUP BY time.datetime;
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CidrBlockXBlockMapper.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CMP_CIDR_BLOCK_X_BLOCK,VALUES,NOW,count,now,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CidrRelRulerMapper.xml
> sql统计:复杂0个，简单0个
>
> 使用的关键字：

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CloudAccountSyncResultItemMapper.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CMP_CLOUD_ACCOUNT_SYNC_RESULT_ITEM,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CloudAccountSyncResultMapper.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CMP_CLOUD_ACCOUNT_SYNC_RESULT,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CloudAccountSyncTaskMapper.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：count,from,CJ_CMP_CLOUD_ACCOUNT_SYNC_TASK,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CloudBillMapper.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：SUM,CAST,DECIMAL,FROM

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CloudContainerMapper.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：or,and,CONCAT,on,where

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CloudProductTypeMapper.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CloudosPerformanceMetricMapper.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：now,CJ_CMP_CLOUDOS_PERFORMANCE_METRIC,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/ClusterDayReportMapper.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：CJ_CMP_CLUSTER_DAY_REPORT,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CmpCloudEnvMapper.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：now,concat,CJ_CMP_CLOUD_ENV,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/CmpElasticResourceGroupMapper.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CMP_ELASTIC_RESOURCE_GROUP,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/ContainerResourceDayReport.xml
> sql统计:复杂6个，简单0个
>
> 使用的关键字：count,DATE,ifnull
#### getTKEClusterTotal
```

        SELECT
        ifnull(count( DISTINCT ENTITY_ID, SERVICE_ACCOUNT_ID ),0) as num
        FROM
        CJ_CMDB_CI_TKE_CLUSTER_DAY_REPORT
        WHERE
        STAT_TIME = DATE(#{statTime})
        <if test="memberId != 0">
            and MEMBER_ID = #{memberId}
        </if>
        and
        IS_DELETED = 0
    
```
#### getFusionCCEClusterTotal
```

        SELECT
        ifnull(count( DISTINCT ENTITY_ID, SERVICE_ACCOUNT_ID ),0) as num
        FROM
        CJ_CMP_FUSION_CCE_CLUSTER_DAY_REPORT
        WHERE
        STAT_TIME = DATE(#{statTime})
        <if test="memberId != 0">
            and MEMBER_ID = #{memberId}
        </if>
        and
        IS_DELETED = 0
    
```
#### getKubernetesNodeTotal
```

        SELECT
        ifnull(count( DISTINCT ENTITY_ID, SERVICE_ACCOUNT_ID ),0) as num
        FROM
        CJ_CMP_KUBERNETES_NODE_DAY_REPORT
        WHERE
        STAT_TIME = DATE(#{statTime})
        <if test="memberId != 0">
            and MEMBER_ID = #{memberId}
        </if>
        and
        IS_DELETED = 0
    
```
#### getKubernetesDeploymentTotal
```

        SELECT
        ifnull(count( DISTINCT ENTITY_ID, SERVICE_ACCOUNT_ID ),0) as num
        FROM
        CJ_CMP_KUBERNETES_DEPLOYMENT_DAY_REPORT
        WHERE
        STAT_TIME = DATE(#{statTime})
        <if test="memberId != 0">
            and MEMBER_ID = #{memberId}
        </if>
        and
        IS_DELETED = 0
    
```
#### getKubernetesStatefulSetTotal
```

        SELECT
        ifnull(count( DISTINCT ENTITY_ID, SERVICE_ACCOUNT_ID ),0) as num
        FROM
        CJ_CMP_KUBERNETES_STATEFUL_SET_DAY_REPORT
        WHERE
        STAT_TIME = DATE(#{statTime})
        <if test="memberId != 0">
            and MEMBER_ID = #{memberId}
        </if>
        and
        IS_DELETED = 0
    
```
#### getKubernetesDaemonSetTotal
```

        SELECT
        ifnull(count( DISTINCT ENTITY_ID, SERVICE_ACCOUNT_ID ),0) as num
        FROM
        CJ_CMP_KUBERNETES_DAEMON_SET_DAY_REPORT
        WHERE
        STAT_TIME = DATE(#{statTime})
        <if test="memberId != 0">
            and MEMBER_ID = #{memberId}
        </if>
        and
        IS_DELETED = 0
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/EnvInstanceDOMapper.xml
> sql统计:复杂0个，简单17个
>
> 使用的关键字：COUNT,size,and,CJ_CMP_SERVICE_INSTANCE,values,CONCAT,IN,from,count

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/EnvInstanceResourceDOMapper.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：from

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/EnvUnitJobMapper.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：CJ_CMP_ENV_UNIT_JOB,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/HostDayReportMapper.xml
> sql统计:复杂8个，简单7个
>
> 使用的关键字：and,CJ_CMP_HOST_DAY_REPORT,values,DATE,from,in,size,ifnull,group_concat,FROM,sum,round,max,DATE_FORMAT,count
#### statVmwareHostBycaId
```

    select count(*) as hostSum,sum(CPUS) as cpuSum, sum(CPUS) * 3 as vCpuSum, round(sum(MEMORY_SUM/1024)) as memSum
    from (
           select
             host.ENTITY_ID,
             host.SERVICE_ACCOUNT_ID,
             max(CPUS)       as CPUS,
             max(MEMORY_SUM) as MEMORY_SUM
           from CJ_CMP_HOST_DAY_REPORT host
           left join CJ_CMP_HOST_REL_DAY_REPORT rel on rel.STAT_TIME = host.STAT_TIME and rel.HOST_ID = host.ID and rel.TYPE = host.TYPE
           where host.TYPE = 'vmware' and host.STAT_TIME = #{endTime} and host.MEMBER_ID = #{memberId}
                 and rel.CLOUD_ACCOUNT_ID = #{cloudAccountId}
           group by host.ENTITY_ID,host.SERVICE_ACCOUNT_ID
         ) host;
  
```
#### statFusionCloudHostBycaId
```

    select
      count(*)                      as hostSum,
      sum(CPUS)                     as cpuSum,
      sum(VIRTUAL_CPU_TOTAL)        as vCpuSum,
      round(sum(MEMORY_SUM / 1024)) as memSum
    from (
           select
             host.ENTITY_ID,
             host.SERVICE_ACCOUNT_ID,
             max(CPUS)              as CPUS,
             max(VIRTUAL_CPU_TOTAL) as VIRTUAL_CPU_TOTAL,
             max(MEMORY_SUM)        as MEMORY_SUM
           from CJ_CMP_HOST_DAY_REPORT host
           left join CJ_CMP_HOST_REL_DAY_REPORT rel
               on rel.STAT_TIME = host.STAT_TIME and rel.HOST_ID = host.ID and rel.TYPE = host.TYPE
           where host.TYPE = 'fusionCloud' and host.STAT_TIME = #{endTime} and host.MEMBER_ID = #{memberId}
                 and rel.CLOUD_ACCOUNT_ID = #{cloudAccountId}
           group by host.ENTITY_ID,host.SERVICE_ACCOUNT_ID
         ) host;
  
```
#### statVmwareHostCpuList
```

    select
    host.ID                            as id,
    group_concat(distinct host.NAME)   as hostName,
    group_concat(distinct sa.NAME)     as serviceAccountName,
    group_concat(distinct ca.NAME)     as poolName,
    max(host.CPUS)     as cpuSum,
    max(host.CPUS) * 3 as vCpuSum
    from CJ_CMP_HOST_DAY_REPORT host
    left join CJ_CMP_HOST_REL_DAY_REPORT rel on rel.STAT_TIME = host.STAT_TIME and rel.HOST_ID = host.ID and rel.TYPE = host.TYPE
    join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID = host.SERVICE_ACCOUNT_ID
    join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = rel.CLOUD_ACCOUNT_ID
    where host.TYPE = 'vmware' and host.STAT_TIME = #{endTime} and host.MEMBER_ID = #{memberId}
    and host.ENTITY_ID is not null and host.SERVICE_ACCOUNT_ID is not null
    <if test="condition != null and condition != ''">
      and (host.NAME = #{condition} or sa.NAME = #{condition} or ca.NAME = #{condition})
    </if>
    group by host.ID
  
```
#### statFusioncloudHostCpuList
```

    select
    host.ID                          as id,
    group_concat(distinct host.NAME) as hostName,
    group_concat(distinct sa.NAME)   as serviceAccountName,
    group_concat(distinct ca.NAME)   as poolName,
    max(host.CPUS)                   as cpuSum,
    max(host.VIRTUAL_CPU_TOTAL)      as vCpuSum
    from CJ_CMP_HOST_DAY_REPORT host
    left join CJ_CMP_HOST_REL_DAY_REPORT rel on rel.STAT_TIME = host.STAT_TIME and rel.HOST_ID = host.ID and rel.TYPE = host.TYPE
    left join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID = host.SERVICE_ACCOUNT_ID
    left join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = rel.CLOUD_ACCOUNT_ID
    where host.TYPE = 'fusioncloud' and host.STAT_TIME = #{endTime}  and host.MEMBER_ID = #{memberId}
    and host.ENTITY_ID is not null and host.SERVICE_ACCOUNT_ID is not null
    <if test="condition != null and condition != ''">
      and (host.NAME = #{condition} or sa.NAME = #{condition} or ca.NAME = #{condition})
    </if>
    group by host.ID
  
```
#### statVmwareHostMemList
```

    select
    host.ID                            as id,
    group_concat(distinct host.NAME)   as hostName,
    group_concat(distinct sa.NAME)     as serviceAccountName,
    group_concat(distinct ca.NAME)     as poolName,
    round(max(host.MEMORY_SUM / 1024)) as memSum
    from CJ_CMP_HOST_DAY_REPORT host
    left join CJ_CMP_HOST_REL_DAY_REPORT rel on rel.STAT_TIME = host.STAT_TIME and rel.HOST_ID = host.ID and rel.TYPE = host.TYPE
    join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID = host.SERVICE_ACCOUNT_ID
    join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = rel.CLOUD_ACCOUNT_ID
    where host.TYPE = 'vmware' and host.STAT_TIME = #{endTime} and host.MEMBER_ID = #{memberId}
    and host.ENTITY_ID is not null and host.SERVICE_ACCOUNT_ID is not null
    <if test="condition != null and condition != ''">
      and (host.NAME = #{condition} or sa.NAME = #{condition} or ca.NAME = #{condition})
    </if>
    group by host.ID
  
```
#### statFusionCloudHostMemList
```

    select
    host.ID                            as id,
    group_concat(distinct host.NAME)   as hostName,
    group_concat(distinct sa.NAME)     as serviceAccountName,
    group_concat(distinct ca.NAME)     as poolName,
    round(max(host.MEMORY_SUM / 1024)) as memSum
    from CJ_CMP_HOST_DAY_REPORT host
    left join CJ_CMP_HOST_REL_DAY_REPORT rel on rel.STAT_TIME = host.STAT_TIME and rel.HOST_ID = host.ID and rel.TYPE = host.TYPE
    left join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID = host.SERVICE_ACCOUNT_ID
    left join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = rel.CLOUD_ACCOUNT_ID
    where host.TYPE = 'fusioncloud' and host.STAT_TIME = #{endTime} and host.MEMBER_ID = #{memberId}
    and host.ENTITY_ID is not null and host.SERVICE_ACCOUNT_ID is not null
    <if test="condition != null and condition != ''">
      and (host.NAME = #{condition} or sa.NAME = #{condition} or ca.NAME = #{condition})
    </if>
    group by host.ID
  
```
#### groupBySaAndTime
```

    SELECT
    ifnull(count(DISTINCT ENTITY_ID, SERVICE_ACCOUNT_ID), 0) AS num,
    DATE_FORMAT(host.STAT_TIME, #{dateFormat}) AS days
    FROM (SELECT
    report.STAT_TIME,
    report.TYPE,
    ENTITY_ID,
    report.SERVICE_ACCOUNT_ID
    FROM CJ_CMP_HOST_DAY_REPORT report
    inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc on report.LDC_ID = cdc.LDC_ID and report.SERVICE_ACCOUNT_ID = cdc.SERVICE_ACCOUNT_ID and cdc.IS_DELETED = 0
    inner join CJ_CMP_CLOUD_ACCOUNT ca on cdc.CLOUD_ACCOUNT_ID = ca.ID and ca.IS_DELETED = 0
    <choose>
      <when test="memberId != 0">
        and ca.MEMBER_ID = #{memberId}
      </when>
      <otherwise>
        and ca.SCOPE = 'public'
      </otherwise>
    </choose>
    WHERE report.SERVICE_ACCOUNT_ID in (select ID from CJ_CMP_SERVICE_ACCOUNT where IS_DELETED = 0)
    GROUP BY STAT_TIME, TYPE, ENTITY_ID, SERVICE_ACCOUNT_ID) host
    <where>
      <if test="serviceAccountId != null and serviceAccountId != ''">
        and host.SERVICE_ACCOUNT_ID = #{serviceAccountId}
      </if>
      <if test="type != null and type != ''">
        and host.TYPE=#{type}
      </if>
      <if test="startTime != null and endTime != null ">
        and (host.STAT_TIME &gt;= DATE(#{startTime}) AND host.STAT_TIME &lt;= DATE(#{endTime}))
      </if>
    </where>
    GROUP BY days
    ORDER BY days asc
  
```
#### getTotalBySaAndTime
```

    SELECT
        ifnull(count( DISTINCT report.ENTITY_ID, report.SERVICE_ACCOUNT_ID ), 0) as num
    FROM
    CJ_CMP_HOST_DAY_REPORT report
    INNER JOIN CJ_CMP_SERVICE_ACCOUNT sa ON sa.ID = report.SERVICE_ACCOUNT_ID
    INNER JOIN CJ_CMP_CLOUD_ACCOUNT_DC cdc on report.LDC_ID = cdc.LDC_ID and report.SERVICE_ACCOUNT_ID = cdc.SERVICE_ACCOUNT_ID and cdc.IS_DELETED = 0
    INNER JOIN CJ_CMP_CLOUD_ACCOUNT ca on cdc.CLOUD_ACCOUNT_ID = ca.ID and ca.IS_DELETED = 0
    <choose>
      <when test="memberId != 0">
        and ca.MEMBER_ID = #{memberId}
      </when>
      <otherwise>
        and ca.SCOPE = 'public'
      </otherwise>
    </choose>
    AND sa.IS_DELETED = 0
    WHERE
    STAT_TIME = DATE(#{statTime})
  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/HostRelDayReportMapper.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：CJ_CMP_HOST_REL_DAY_REPORT,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/INSPECTION_HOST_CHECK_RECORD.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/INSPECTION_JOB.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：CJ_INSPECTION_JOB,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/INSPECTION_JOB_RECORD.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：max,now,values,FROM,IFNULL,JOIN,CONCAT,JSON_EXTRACT,CJ_INSPECTION_JOB_RECORD

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/INSPECTION_RULE.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：concat

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/INSPECTION_RULE_CHECK_RECORD.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：CJ_INSPECTION_RULE_CHECK_RECORD,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/INSPECTION_RULE_GROUP.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：count,concat

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/ImageConfigMapper.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：values,now,CJ_CMP_IMAGE_CONFIG

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/IpRelMapper.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：NOW,CJ_CMP_IP_REL,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/KubernetesClusterMapper.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：and,CONCAT

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/KubernetesContainerMapper.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/KubernetesDaemonSetMapper.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：and,now,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/KubernetesDeploymentMapper.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：and,now,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/KubernetesNamespaceMapper.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：now,NOW,CONCAT,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/KubernetesNodeMapper.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：and,CONCAT,now,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/KubernetesOwnerReferenceMapper.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/KubernetesPersistentVolumeClaimMapper.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/KubernetesPersistentVolumeMapper.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/KubernetesPodMapper.xml
> sql统计:复杂2个，简单7个
>
> 使用的关键字：now,NOW,in,and,coalesce,CONCAT
#### list
```

        select
        pod.ID as ID ,
        pod.MEMBER_ID as MEMBER_ID,
        pod.SERVICE_ACCOUNT_ID as SERVICE_ACCOUNT_ID,
        pod.CLOUD_ACCOUNT_ID as CLOUD_ACCOUNT_ID,
        pod.LDC_ID as LDC_ID,
        pod.SERVICE_ACCOUNT_TYPE as SERVICE_ACCOUNT_TYPE,
        pod.OWNED_BY as OWNED_BY,
        pod.ENTITY_ID as ENTITY_ID,
        pod.NAME as NAME,
        pod.OWNER as OWNER,
        coalesce(deployment.NAME, statefulSet.NAME, daemonSet.NAME) as workloadName,
        coalesce(deployment.USED_FOR, statefulSet.USED_FOR, daemonSet.USED_FOR) as usedFor,
        coalesce(deployment.REMARK, statefulSet.REMARK, daemonSet.REMARK) as remark,
        coalesce(deployment.APP_SYSTEM_ID, statefulSet.APP_SYSTEM_ID, daemonSet.APP_SYSTEM_ID) as appSystemId,
        pod.CLOUD_ACCOUNT as CLOUD_ACCOUNT,
        pod.DEPARTMENT as DEPARTMENT,
        pod.IP as IP,
        pod.NODE_ID as NODE_ID,
        pod.NAMESPACE_ID as NAMESPACE_ID,
        pod.CLUSTER_ID as CLUSTER_ID,
        pod.CREATE_DATE as CREATE_DATE,
        pod.CREATE_BY as CREATE_BY,
        pod.STATUS as STATUS,
        pod.NAMESPACE_NAME as NAMESPACE,
        pod.CLUSTER_NAME as CLUSTER,
        pod.NODE_NAME as NODE
        from CJ_CMP_POD_VIEW pod
        inner join CJ_CMP_KUBERNETES_OWNER_REFERENCE rel on pod.ENTITY_ID = rel.RESOURCE_ENTITY_ID and pod.SERVICE_ACCOUNT_ID = rel.SERVICE_ACCOUNT_ID and rel.RESOURCE_TYPE = 'Pod' and rel.IS_DELETED = 0 and rel.OWNER_TYPE in ('ReplicaSet', 'StatefulSet', 'DaemonSet', 'Deployment')
        left join CJ_CMP_KUBERNETES_REPLICA_SET replicaSet on replicaSet.ENTITY_ID = rel.OWNER_ENTITY_ID and rel.SERVICE_ACCOUNT_ID = replicaSet.SERVICE_ACCOUNT_ID and rel.OWNER_TYPE = 'ReplicaSet' and replicaSet.IS_DELETED = 0
        left join CJ_CMP_KUBERNETES_OWNER_REFERENCE rel1 on replicaSet.ENTITY_ID = rel1.RESOURCE_ENTITY_ID and replicaSet.SERVICE_ACCOUNT_ID = rel1.SERVICE_ACCOUNT_ID and  rel1.RESOURCE_TYPE ='ReplicaSet' and rel1.IS_DELETED = 0
        left join CJ_CMP_KUBERNETES_DEPLOYMENT deployment on deployment.ENTITY_ID = rel1.OWNER_ENTITY_ID and rel1.SERVICE_ACCOUNT_ID = deployment.SERVICE_ACCOUNT_ID and rel1.OWNER_TYPE = 'Deployment' and deployment.IS_DELETED = 0
        left join CJ_CMP_KUBERNETES_STATEFUL_SET statefulSet on statefulSet.ENTITY_ID = rel.OWNER_ENTITY_ID and rel.SERVICE_ACCOUNT_ID = statefulSet.SERVICE_ACCOUNT_ID and rel.OWNER_TYPE = 'StatefulSet' and statefulSet.IS_DELETED = 0
        left join CJ_CMP_KUBERNETES_DAEMON_SET daemonSet on daemonSet.ENTITY_ID = rel.OWNER_ENTITY_ID  and rel.SERVICE_ACCOUNT_ID = daemonSet.SERVICE_ACCOUNT_ID and rel.OWNER_TYPE = 'DaemonSet' and daemonSet.IS_DELETED = 0
        where pod.MEMBER_ID = #{memberId} and pod.ENTITY_ID is not null and (pod.NAMESPACE_NAME != 'kube-system' or pod.NAMESPACE_NAME is null)
        <if test="userIds != null and userIds.size > 0 ">
            and ( pod.OWNED_BY in
            <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
            <if test="departmentList != null and departmentList.size != 0">
                or pod.DEPARTMENT_ID in
                <foreach collection="departmentList" item="department" open="(" close=")" separator=",">#{department}
                </foreach>
            </if>
            )
        </if>
        <if test="name != null and name != ''">
            and pod.NAME like CONCAT('%',#{name},'%')
        </if>
        <if test="ip != null and ip != ''">
            and pod.IP like CONCAT('%',#{ip},'%')
        </if>
        <if test="namespace != null and namespace != ''">
            and pod.NAMESPACE_NAME like CONCAT('%',#{namespace},'%')
        </if>
        <if test="owner != null">
            and pod.OWNER like CONCAT('%',#{owner},'%')
        </if>
        <if test="node != null and node != ''">
            and pod.NODE_NAME like CONCAT('%',#{node},'%')
        </if>
        <if test="cloudAccountId != null">
            and pod.CLOUD_ACCOUNT_ID =#{cloudAccountId}
        </if>
        <if test="ldcId != null">
            and pod.LDC_ID = #{ldcId}
        </if>
        <if test="searchKey != null and searchKey != ''">
            and (pod.NAME like CONCAT('%',#{searchKey},'%') or pod.IP like CONCAT('%',#{searchKey},'%') or
            pod.NAMESPACE_NAME like CONCAT('%',#{searchKey},'%')
            or pod.OWNER like CONCAT('%',#{searchKey},'%') or pod.NODE_NAME like CONCAT('%',#{searchKey},'%'))
        </if>
        order by pod.CREATE_DATE, pod.ID
    
```
#### queryDetailByIdAndType
```

        select
        pod.ID as ID ,
        pod.MEMBER_ID as MEMBER_ID,
        pod.SERVICE_ACCOUNT_ID as SERVICE_ACCOUNT_ID,
        pod.SERVICE_ACCOUNT_TYPE as SERVICE_ACCOUNT_TYPE,
        pod.OWNED_BY as OWNED_BY,
        pod.ENTITY_ID as ENTITY_ID,
        pod.NAME as NAME,
        pod.OWNER as OWNER,
        coalesce(deployment.NAME, statefulSet.NAME, daemonSet.NAME) as workloadName,
        coalesce(deployment.USED_FOR, statefulSet.USED_FOR, daemonSet.USED_FOR) as usedFor,
        coalesce(deployment.REMARK, statefulSet.REMARK, daemonSet.REMARK) as remark,
        coalesce(deployment.APP_SYSTEM_ID, statefulSet.APP_SYSTEM_ID, daemonSet.APP_SYSTEM_ID) as appSystemId,
        pod.CLOUD_ACCOUNT as CLOUD_ACCOUNT,
        pod.DEPARTMENT as DEPARTMENT,
        pod.IP as IP,
        pod.NODE_ID as NODE_ID,
        pod.NAMESPACE_ID as NAMESPACE_ID,
        pod.CLUSTER_ID as CLUSTER_ID,
        pod.CREATE_DATE as CREATE_DATE,
        pod.CREATE_BY as CREATE_BY,
        pod.STATUS as STATUS,
        pod.NAMESPACE_NAME as NAMESPACE,
        pod.CLUSTER_NAME as CLUSTER,
        pod.NODE_NAME as NODE
        from CJ_CMP_POD_VIEW pod
        inner join CJ_CMP_KUBERNETES_OWNER_REFERENCE rel on pod.ENTITY_ID = rel.RESOURCE_ENTITY_ID and pod.SERVICE_ACCOUNT_ID = rel.SERVICE_ACCOUNT_ID and rel.RESOURCE_TYPE = 'Pod' and rel.IS_DELETED = 0 and rel.OWNER_TYPE in ('ReplicaSet', 'StatefulSet', 'DaemonSet', 'Deployment')
        left join CJ_CMP_KUBERNETES_REPLICA_SET replicaSet on replicaSet.ENTITY_ID = rel.OWNER_ENTITY_ID and rel.SERVICE_ACCOUNT_ID = replicaSet.SERVICE_ACCOUNT_ID and rel.OWNER_TYPE = 'ReplicaSet' and replicaSet.IS_DELETED = 0
        left join CJ_CMP_KUBERNETES_OWNER_REFERENCE rel1 on replicaSet.ENTITY_ID = rel1.RESOURCE_ENTITY_ID and replicaSet.SERVICE_ACCOUNT_ID = rel1.SERVICE_ACCOUNT_ID and  rel1.RESOURCE_TYPE ='ReplicaSet' and rel1.IS_DELETED = 0
        left join CJ_CMP_KUBERNETES_DEPLOYMENT deployment on deployment.ENTITY_ID = rel1.OWNER_ENTITY_ID and rel1.SERVICE_ACCOUNT_ID = deployment.SERVICE_ACCOUNT_ID and rel1.OWNER_TYPE = 'Deployment' and deployment.IS_DELETED = 0
        left join CJ_CMP_KUBERNETES_STATEFUL_SET statefulSet on statefulSet.ENTITY_ID = rel.OWNER_ENTITY_ID and rel.SERVICE_ACCOUNT_ID = statefulSet.SERVICE_ACCOUNT_ID and rel.OWNER_TYPE = 'StatefulSet' and statefulSet.IS_DELETED = 0
        left join CJ_CMP_KUBERNETES_DAEMON_SET daemonSet on daemonSet.ENTITY_ID = rel.OWNER_ENTITY_ID  and rel.SERVICE_ACCOUNT_ID = daemonSet.SERVICE_ACCOUNT_ID and rel.OWNER_TYPE = 'DaemonSet' and daemonSet.IS_DELETED = 0
        where pod.ID = #{id} and pod.SERVICE_ACCOUNT_TYPE = #{type} and pod.MEMBER_ID = #{memberId}
        <if test="userIds != null and userIds.size > 0 ">
            and ( pod.OWNED_BY in
            <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
            <if test="departmentList != null and departmentList.size != 0">
                or pod.DEPARTMENT_ID in
                <foreach collection="departmentList" item="department" open="(" close=")" separator=",">#{department}
                </foreach>
            </if>
            )
        </if>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/KubernetesPodVolumeMapper.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/KubernetesProjectViewMapper.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：CONCAT,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/KubernetesReplicaSetMapper.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/KubernetesStatefulSetMapper.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：and,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/KubernetesWorkloadMapper.xml
> sql统计:复杂0个，简单14个
>
> 使用的关键字：and,CONCAT,or

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/LogicSegmentMapper.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：in,CONCAT,NOW,now,CJ_CMP_LOGIC_SEGMENT,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/LogicSegmentXAppSystemMapper.xml
> sql统计:复杂1个，简单9个
>
> 使用的关键字：and,CONCAT,CJ_CMP_LOGIC_SEGMENT_X_APP_SYSTEM,values,now,count,ifnull,join
#### countLogicSegmentAllRelAppSystem
```

        SELECT ifnull(count(DISTINCT rel.LOGIC_SEGMENT_ID), 0)
        FROM CJ_CMP_LOGIC_SEGMENT_X_APP_SYSTEM rel
        inner JOIN CJ_CMP_APP_SYSTEM instance ON rel.APP_SYSTEM_ID = instance.ID AND instance.IS_DELETED = 0
        WHERE rel.ACTIVE =1 and rel.MEMBER_ID = #{memberId} and rel.LOGIC_SEGMENT_ID in <foreach collection="logicSegmentIds" item="logicId" open="(" close=")" separator=",">#{logicId}</foreach>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/ModuleMapper.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：count,CJ_CPG_MODULE,values,concat

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/ModuleVersionMapper.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：count,CJ_CPG_MODULE_VERSION,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/OracleOvmDcMapper.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/OracleOvmHostMapper.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：and,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/OracleOvmRepositoryMapper.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：and,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/OracleOvmVmMapper.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：and,now,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/PmDayReportMapper.xml
> sql统计:复杂2个，简单1个
>
> 使用的关键字：DATE_FORMAT,FROM,in,and,ifnull,count,DATE,CJ_CMP_PM_DAY_REPORT,values
#### groupBySaAndTime
```

    SELECT
    ifnull(count(DISTINCT ENTITY_ID, SERVICE_ACCOUNT_ID), 0)  AS num,
    DATE_FORMAT(pm.STAT_TIME, #{dateFormat}) AS days
    FROM (SELECT
    STAT_TIME,
    ENTITY_ID,
    SERVICE_ACCOUNT_ID
    FROM CJ_CMP_PM_DAY_REPORT
    WHERE SERVICE_ACCOUNT_ID in (select ID from CJ_CMP_SERVICE_ACCOUNT where IS_DELETED = 0)
    <if test="memberId != 0">
      and MEMBER_ID = #{memberId}
    </if>
    GROUP BY STAT_TIME, ENTITY_ID, SERVICE_ACCOUNT_ID) pm
    <where>
      <if test="serviceAccountId != null and serviceAccountId != '' ">
        and pm.SERVICE_ACCOUNT_ID = #{serviceAccountId}
      </if>
      <if test="startTime != null and endTime != null ">
        and (pm.STAT_TIME &gt;= DATE(#{startTime}) AND pm.STAT_TIME &lt;= DATE(#{endTime}))
      </if>
    </where>
    GROUP BY days
    ORDER BY days asc
  
```
#### getTotalBySaAndTime
```

    SELECT
        ifnull(count( DISTINCT ENTITY_ID, SERVICE_ACCOUNT_ID ),0) as num
    FROM
        CJ_CMP_PM_DAY_REPORT report
    INNER JOIN CJ_CMP_SERVICE_ACCOUNT sa ON sa.ID = report.SERVICE_ACCOUNT_ID
    AND sa.IS_DELETED = 0
    WHERE
      STAT_TIME = DATE(#{statTime})
      <if test="memberId != 0">
        and report.MEMBER_ID = #{memberId}
        <if test="userIds != null and userIds.size >0 ">
          and  report.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
          <if test="departmentList != null and departmentList.size != 0">
            or report.DEPT_ID in <foreach collection="departmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
          </if>
        </if>
      </if>
  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/PmModelMapper.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：values,concat,now,CJ_PAM_PM_MODEL

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/PolicyExportMapper.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/QingCloudHostMapper.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/QingcloudPerformanceMetricMapper.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：CJ_CMP_QINGCLOUD_PERFORMANCE_METRIC,VALUES,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/RESOURCE_REPORT.xml
> sql统计:复杂5个，简单0个
>
> 使用的关键字：ifnull,round,join,count,group_concat,sum,ceil,length,replace,and,in
#### cloudAccountCpuStat
```

        select ca.ID as cloudAccountId,ca.NAME as name,ca.DATACENTER_TYPE as datacenterType,clu.serviceAccounts,h.hosts,clu.clusters,h.cpus,h.vcpuTotal,
        ifnull(vm.vcpuUsed,0) as vcpuUsed,h.vcpuTotal-ifnull(vm.vcpuUsed,0) as vcpuRemaining,ifnull(case when vm.vcpuUsed &gt;= 0 and h.vcpuTotal &gt; 0 then round(vm.vcpuUsed*100/h.vcpuTotal,1) end,0) as vcpuUsage
        from CJ_CMP_CLOUD_ACCOUNT_DAY_REPORT ca
        inner join (select ldc.CLOUD_ACCOUNT_ID,count(clu.ID)+count(az.ID) as clusters,group_concat(distinct sa.NAME) serviceAccounts from CJ_CMP_LDC_DAY_REPORT ldc
          inner join CJ_CMP_SERVICE_ACCOUNT_DAY_REPORT sa on ldc.STAT_TIME=#{statTime} and sa.STAT_TIME=#{statTime} and sa.ID=ldc.SERVICE_ACCOUNT_ID
          left outer join CJ_CMP_CLUSTER_DAY_REPORT clu on clu.STAT_TIME=#{statTime} and ldc.LDC_TYPE='vmware' and clu.LDC_ID=ldc.LDC_ID
          left outer join CJ_CMP_CLOUD_AZ_DAY_REPORT az on az.STAT_TIME=#{statTime} and ldc.SERVICE_ACCOUNT_ID=az.SERVICE_ACCOUNT_ID and ldc.LDC_ID=az.LDC_ID
          where ldc.STAT_TIME=#{statTime}  group by ldc.CLOUD_ACCOUNT_ID) clu on clu.CLOUD_ACCOUNT_ID=ca.ID and ca.STAT_TIME=#{statTime}
        left outer join (select hr.CLOUD_ACCOUNT_ID,count(*) as hosts,sum(ifnull(hd.CPUS,0)) as cpus,
          sum(ifnull(hd.VIRTUAL_CPU_TOTAL,ifnull(hd.CPUS*3,0))) as vcpuTotal
          from CJ_CMP_HOST_DAY_REPORT hd,CJ_CMP_HOST_REL_DAY_REPORT hr where hd.STAT_TIME=#{statTime} and hr.STAT_TIME=#{statTime}
          and hr.HOST_ID=hd.ID and hr.TYPE=hd.TYPE group by hr.CLOUD_ACCOUNT_ID) h on h.CLOUD_ACCOUNT_ID=ca.ID and ca.DATACENTER_TYPE in('vmware','fusionCloud')
        left outer join (select CLOUD_ACCOUNT_ID,sum(ifnull(vm.CPUS,0)) vcpuUsed from CJ_CMP_VM_DAY_REPORT vm where vm.STAT_TIME=#{statTime} and vm.MEMBER_ID=#{memberId}
            group by CLOUD_ACCOUNT_ID) vm on vm.CLOUD_ACCOUNT_ID=ca.ID
        where ca.MEMBER_ID=#{parentMemberId}
        <if test="datacenterType != null and datacenterType != '' ">
            and ca.DATACENTER_TYPE = #{datacenterType}
        </if>
        <if test="cloudAccountName != null and cloudAccountName != '' ">
            and ca.NAME like #{cloudAccountName}
        </if>
        order by vcpuUsage desc
    
```
#### cloudAccountMemoryStat
```

        select ca.ID as cloudAccountId,ca.NAME as name,ca.DATACENTER_TYPE as datacenterType,clu.serviceAccounts,
          h.hosts,clu.clusters,ceil(h.memoryTotal /1024) as memoryTotal,ceil(ifnull(vm.memoryUsed,0)/1024) as memoryUsed,ceil((h.memoryTotal-ifnull(vm.memoryUsed,0)) /1024) as memoryRemaining,
          case when vm.memoryUsed &gt;= 0 and h.memoryTotal &gt; 0 then round(vm.memoryUsed*100/h.memoryTotal,1) end as memoryUsage
        from CJ_CMP_CLOUD_ACCOUNT_DAY_REPORT ca
        inner join (select ldc.CLOUD_ACCOUNT_ID,count(clu.ID)+count(az.ID) as clusters,group_concat(distinct sa.NAME) serviceAccounts from CJ_CMP_LDC_DAY_REPORT ldc
          inner join CJ_CMP_SERVICE_ACCOUNT_DAY_REPORT sa on ldc.STAT_TIME=#{statTime} and sa.STAT_TIME=#{statTime} and sa.ID=ldc.SERVICE_ACCOUNT_ID
          left outer join CJ_CMP_CLUSTER_DAY_REPORT clu on clu.STAT_TIME=#{statTime} and ldc.LDC_TYPE='vmware' and clu.LDC_ID=ldc.LDC_ID
          left outer join CJ_CMP_CLOUD_AZ_DAY_REPORT az on az.STAT_TIME=#{statTime} and ldc.SERVICE_ACCOUNT_ID=az.SERVICE_ACCOUNT_ID and ldc.LDC_ID=az.LDC_ID
          where ldc.STAT_TIME=#{statTime}  group by ldc.CLOUD_ACCOUNT_ID) clu on clu.CLOUD_ACCOUNT_ID=ca.ID and ca.STAT_TIME=#{statTime}
        left outer join (select hr.CLOUD_ACCOUNT_ID,count(*) as hosts,
          count(DISTINCT ifnull(hd.CLUSTER_ID,hd.ZONE_ID)) as clusters,sum(ifnull(hd.MEMORY_SUM,0)) as memoryTotal
          from CJ_CMP_HOST_DAY_REPORT hd,CJ_CMP_HOST_REL_DAY_REPORT hr where hd.STAT_TIME=#{statTime} and hr.STAT_TIME=#{statTime} 
          and hr.HOST_ID=hd.ID and hr.TYPE=hd.TYPE group by hr.CLOUD_ACCOUNT_ID) h on ca.STAT_TIME=#{statTime} and h.CLOUD_ACCOUNT_ID=ca.ID and ca.DATACENTER_TYPE in('vmware','fusionCloud')
        left outer join (select CLOUD_ACCOUNT_ID,sum(ifnull(vm.MEMORY,0)) memoryUsed from CJ_CMP_VM_DAY_REPORT vm where vm.STAT_TIME=#{statTime} and vm.MEMBER_ID=#{memberId}
            group by CLOUD_ACCOUNT_ID) vm on vm.CLOUD_ACCOUNT_ID=ca.ID
        where ca.MEMBER_ID=#{parentMemberId}
        <if test="datacenterType != null and datacenterType != '' ">
            and ca.DATACENTER_TYPE = #{datacenterType}
        </if>
        <if test="cloudAccountName != null and cloudAccountName != '' ">
            and ca.NAME like #{cloudAccountName}
        </if>
        order by memoryUsage desc
    
```
#### cloudAccountIpTotalStat
```

       select ca.ID as id,ca.NAME,ca.DATACENTER_TYPE,group_concat(distinct sa.NAME) as serviceAccounts,count(distinct cidr.ID) cidrTotal,count(distinct ip.ID) ipTotal,
         count(distinct case when ip.STATUS='unused' then ip.ID end) as ipAvailable,count(distinct case when ip.STATUS='unused' then null else ip.ID end) as ipUsed
         from CJ_CMP_CLOUD_ACCOUNT ca
         left outer join CJ_CMP_CLOUD_ACCOUNT_DC cdc on cdc.CLOUD_ACCOUNT_ID=ca.ID and cdc.IS_DELETED=0
         left outer join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID=cdc.SERVICE_ACCOUNT_ID and sa.IS_DELETED=0
         left outer join CJ_CMP_VDS vds on vds.LDC_ID=cdc.LDC_ID and vds.SERVICE_ACCOUNT_ID=cdc.SERVICE_ACCOUNT_ID
         left outer join CJ_CMP_VDS_PORTGROUP pg on pg.VDS_ID=vds.ID
         left outer join CJ_CMP_FUSION_CLOUD_NETWORK_SUBNET subnet on subnet.LDC_ID=cdc.LDC_ID and subnet.SERVICE_ACCOUNT_ID=cdc.SERVICE_ACCOUNT_ID
         left outer join CJ_CMP_CIDR_BLOCK_X_NETWORK cx on cx.SERVICE_ACCOUNT_ID=cdc.SERVICE_ACCOUNT_ID and cx.NETWORK_ID=ifnull(pg.ID,subnet.ID)
         left outer join CJ_CMP_CIDR_BLOCK cidr on cidr.ID=cx.CIDR_BLOCK_ID and cidr.IP_VERSION='IPv4'
         left outer join CJ_CMP_IP_POOL ip on ip.CIDR_BLOCK_ID=cidr.ID
        where ca.DATACENTER_TYPE in('vmware','fusionCloud') and ca.MEMBER_ID=#{memberId} and ca.IS_DELETED=0
        <if test="datacenterType != null and datacenterType != '' ">
            and ca.DATACENTER_TYPE = #{datacenterType}
        </if>
        <if test="cloudAccountName != null and cloudAccountName != '' ">
            and ca.NAME like #{cloudAccountName}
        </if>
         group by ca.ID
    
```
#### cloudAccountAppStat
```

       select app.ID,app.NAME,app.CODE,count(*) as vmTotal,sum(ifnull(vm.CPUS,0)) as cpuTotal,ceil(sum(ifnull(vm.MEMORY,0))/1024) as memoryTotal,ceil(sum(ifnull(vm.DISK_SUM,0))) as diskTotal,
       sum(ifnull(length(ifnull(vm.IP,''))-length(replace(ifnull(vm.IP,''),',',''))+1,0)) ipTotal
         from CJ_CMP_APP_SYSTEM_DAY_REPORT app,CJ_CMP_VM_DAY_REPORT vm where vm.STAT_TIME=#{statTime} and app.STAT_TIME=#{statTime} and vm.APP_SYSTEM_ID=app.ID 
         and app.MEMBER_ID=#{memberId} and vm.MEMBER_ID=app.MEMBER_ID
         <if test="cloudAccountId != null">
            and vm.CLOUD_ACCOUNT_ID = #{cloudAccountId}
        </if>
       <if test="searchKey != null and searchKey != '' ">
            and (app.NAME like #{searchKey} or app.CODE like #{searchKey})
        </if>
       group by app.ID,app.NAME,app.CODE
    
```
#### cloudAccountProjectStat
```

       select proj.ID,proj.NAME,proj.CODE,count(*) as vmTotal,sum(ifnull(vm.CPUS,0)) as cpuTotal,ceil(sum(ifnull(vm.MEMORY,0))/1024) as memoryTotal,ceil(sum(ifnull(vm.DISK_SUM,0))) as diskTotal,
       sum(ifnull(length(ifnull(vm.IP,''))-length(replace(ifnull(vm.IP,''),',',''))+1,0)) ipTotal
       from CJ_CMP_PROJECT_DAY_REPORT proj,CJ_CMP_VM_DAY_REPORT vm where vm.STAT_TIME=#{statTime} and proj.STAT_TIME=#{statTime} and vm.PROJECT_ID=proj.ID
         and proj.MEMBER_ID=#{memberId} and vm.MEMBER_ID=proj.MEMBER_ID
       <if test="cloudAccountId != null">
            and vm.CLOUD_ACCOUNT_ID = #{cloudAccountId}
        </if>
       <if test="searchKey != null and searchKey != '' ">
            and (proj.NAME like #{searchKey} or proj.CODE like #{searchKey})
        </if>
       group by proj.ID,proj.NAME,proj.CODE
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/SPEC_FOR_QUOTA.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：and,in

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/SamHostGroupMapper.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：and,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/SamHostMapper.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：and,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/SamStorageFsMapper.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：and,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/SamStoragePoolMapper.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：and,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/SamTagMapper.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：and,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/SamVirtualPoolMapper.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：and,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/SendDataJobMapper.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：NOW,HEX,now,values,CONCAT,size,concat,UNIX_TIMESTAMP,CJ_CMP_SEND_DATA_JOB

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/SendDataJobVersionMapper.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：CJ_CMP_SEND_DATA_JOB_VERSION,values,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/SendDataLogMapper.xml
> sql统计:复杂2个，简单2个
>
> 使用的关键字：NOW,CJ_CMP_SEND_DATA_LOG,values,if,concat
#### getById
```

		select log.*,job.NAME as jobName,sc.NAME as scheduleName,if(log.CREATE_BY is null,'定时任务',user.NAME) as createByUser from CJ_CMP_SEND_DATA_LOG log
		left outer join CJ_CMP_SEND_DATA_JOB job on log.JOB_ID=job.ID left outer join CJ_CMP_SEND_DATA_SCHEDULE sc on log.SCHEDULE_ID=sc.ID
		left outer join ydduc.UC_USER user on log.CREATE_BY=user.ID
		where log.ID = #{id}
	
```
#### queryList
```

		select log.*,job.NAME as jobName,sc.NAME as scheduleName,if(log.CREATE_BY is null,'定时任务',user.NAME) as createByUser from CJ_CMP_SEND_DATA_LOG log
		inner join CJ_CMP_SEND_DATA_JOB job on log.JOB_ID=job.ID left outer join CJ_CMP_SEND_DATA_SCHEDULE sc on log.SCHEDULE_ID=sc.ID
		left outer join ydduc.UC_USER user on log.CREATE_BY=user.ID
		<where><trim>
			<if test="jobId!=null"> and log.JOB_ID=#{jobId}</if>
			<if test="jobName!=null"> and job.NAME like concat('%',#{jobName},'%')</if>
			<if test="scheduleId!=null"> and log.SCHEDULE_ID=#{scheduleId}</if>
			<if test="scheduleName!=null"> and sc.NAME like concat('%',#{scheduleName},'%')</if>
			<if test="batchNo!=null"> and log.BATCH_NO=#{batchNo}</if>
			<if test="startTime!=null"> and log.START_TIME &gt;= #{startTime}</if>
			<if test="startTime2!=null"> and log.START_TIME &lt;= #{startTime2}</if>
			<if test="status!=null"> and log.STATUS=#{status}</if>
			<if test="createBy!=null"> and log.CREATE_BY=#{createBy}</if>
		</trim></where>
		order by ${sortField} ${sortType}
	
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/SendDataLogRecordMapper.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CMP_SEND_DATA_LOG_RECORD,values,max,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/SendDataRecordMd5Mapper.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：now,CJ_CMP_SEND_DATA_RECORD_MD5,values,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/SendDataScheduleMapper.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：UNIX_TIMESTAMP,now,CONCAT,concat,HEX,CJ_CMP_SEND_DATA_SCHEDULE,values,count,NOW,REPLACE

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/ServiceInstanceIntegrationMapper.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：values,now,CJ_CMP_SERVICE_INSTANCE_INTEGRATION

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/ServiceInstanceMapper.xml
> sql统计:复杂1个，简单27个
>
> 使用的关键字：join,now,or,convert,in,sum,count,ON,NOW,CJ_CMP_SERVICE_INSTANCE,CONCAT,and,VALUES
#### list
```

        select srvInst.*
        from CJ_CMP_SERVICE_INSTANCE srvInst
        <if test="(envInstanceSource != null and envInstanceSource != '') or (envInstanceSourceId != null and envInstanceSourceId != '')">
            join CJ_CMP_APP_INSTANCE appInst on srvInst.APP_INST_ID = appInst.ID and appInst.IS_DELETED = 0
        </if>
        <if test="envInstanceSource != null and envInstanceSource != ''">
            and appInst.SOURCE = #{envInstanceSource}
        </if>
        <if test="envInstanceSourceId != null and envInstanceSourceId != ''">
            and appInst.SOURCE_ID = #{envInstanceSourceId}
        </if>
        where srvInst.IS_DELETED = 0 and srvInst.MEMBER_ID = #{memberId}
        <if test="status != null and status != ''"> and srvInst.STATUS=#{status}</if>
        <if test="status == null or status == ''"> and srvInst.STATUS !='archived'</if>
        <if test="keyword != null and keyword != ''" >
          <choose>
            <when test="queryType != null and queryType == 'name'" >
                and srvInst.`NAME` like CONCAT('%',#{keyword},'%')
            </when>
            <when test="queryType != null and queryType == 'type'" >
                and srvInst.`TYPE` like CONCAT('%',#{keyword},'%')
            </when>
            <when test="queryType != null and queryType == 'status'" >
                and srvInst.STATUS like CONCAT('%',#{keyword},'%')
            </when>
            <when test="queryType != null and queryType == 'entityId'" >
                and srvInst.ENTITY_ID like CONCAT('%',#{keyword},'%')
            </when>
            <when test="queryType != null and queryType == 'srvNo'" >
                and srvInst.SRV_NO like CONCAT('%',#{keyword},'%')
            </when>
            <when test="queryType != null and queryType == 'description'" >
                and srvInst.TYPE like CONCAT('%',#{keyword},'%')
            </when>
          </choose>
        </if>
        <if test="appSystemId != null"> and srvInst.APP_SYSTEM_ID = #{appSystemId}</if>
        <if test="appInstId != null"> and srvInst.APP_INST_ID = #{appInstId}</if>
        <if test="userId != null"> and (srvInst.OWNED_BY=#{userId} or srvInst.APP_SYSTEM_ID in (select ID from CJ_CMP_APP_SYSTEM_X_USER where USER_ID=#{userId}))</if>
        <if test="sortField != null and sortType != ''">
            order by convert(srvInst.${sortField} USING gbk) ${sortType}
        </if>
        <if test="sortField == null or sortType == ''">
            order by srvInst.LAST_MODIFIED_DATE desc
        </if>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/ServiceInstanceResourceDuRelMapper.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：CONCAT,and,now,CJ_CMP_SERVICE_INSTANCE_RESOURCE,VALUES,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/ServiceInstanceResourcesRelMapper.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CMP_SERVICE_INSTANCE_X_RESOURCE,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/SpotEnvBackupRestoreMapper.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：CJ_CMP_SPOT_ENV_BACKUP_RESTORE,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/SpotEnvElasticGroupMapper.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CMP_SPOT_ENV_ELASTIC_GROUP,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/SpotEnvElasticGroupResourceMapper.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：CJ_CMP_SPOT_ENV_ELASTIC_GROUP_RESOURCE,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/SpotEnvInterruptMapper.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：CJ_CMP_SPOT_ENV_INTERRUPT,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/SpotEnvReqLogMapper.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CMP_SPOT_ENV_REQ_LOG,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/TagMapper.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：count,now,CJ_CMP_TAG,VALUES,from,COUNT,in,concat

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/TagXObjectMapper.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：VALUES,now,CJ_CMP_TAG_X_OBJECT

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/TencentCvmMapper.xml
> sql统计:复杂0个，简单15个
>
> 使用的关键字：and,now,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/TencentDcMapper.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/TencentDisasterRecoverGroupMapper.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：CJ_CMP_TENCENT_DISASTER_RECOVER_GROUP,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/TencentSecurityGroupMapper.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/TencentSecurityGroupPolicyMapper.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/TencentSubnetapper.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：IF,ISNULL,CONCAT,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/TencentVpcDOMapper.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：CJ_CMP_TENCENT_VPC,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/src/main/resources/META-INF/mybatis/sqlmap/VmPerformanceChartMapper.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：DATE_FORMAT

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/AliyunAckClusterMapper.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：NOW,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/AliyunEcsBillMapper.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：values,CJ_CMP_ALIYUN_BILL

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/AppEnvMapper.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：concat,now,CJ_CMP_APP_ENV,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/BizInstChangeRecordMapper.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CPG_BIZ_INST_CHANGE_RECORD,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_APPLICATION_CLUSTER.xml
> sql统计:复杂2个，简单6个
>
> 使用的关键字：FROM,count,and,NOW,now,ifnull,sum,AND,COUNT,DATE
#### querySoftAssignList
```

        SELECT
            temp.name,
            temp.version,
            ifnull(sum(temp.count), 0) assignNum
        FROM ( <foreach collection="appSofts" item="app" separator=" union all ">
            select #{app.name} as name,VERSION as version,SERVER_ID as serverId, SERVER_TYPE as serverType, count(*) as count
            from ${app.table}  where IS_DELETED=0 and MEMBER_ID =#{memberId} and DATE(CREATE_DATE) BETWEEN #{startTime} and #{endTime}  GROUP BY VERSION,SERVER_ID,SERVER_TYPE 
        </foreach>) temp
        JOIN cj_cmp_vm_view vm ON temp.serverId = vm.ID AND temp.serverType = vm.TYPE
        <where>
            <if test="isCatalog">
                and vm.SRV_NO IS NOT NULL
            </if>
        </where>
        GROUP BY temp.version, temp.name ORDER BY temp.name asc
    
```
#### statSoftAssignList
```

        SELECT
            temp.name,
            ifnull(sum(temp.count), 0) num
        FROM ( <foreach collection="appSofts" item="app" separator=" union all ">
            select #{app.name} as name,SERVER_ID as serverId, SERVER_TYPE as serverType, count(*) as count
            from ${app.table}  where IS_DELETED=0 and MEMBER_ID =#{memberId} and DATE(CREATE_DATE) BETWEEN #{startTime} and #{endTime}  GROUP BY SERVER_ID,SERVER_TYPE 
        </foreach>) temp
        JOIN cj_cmp_vm_view vm ON temp.serverId = vm.ID AND temp.serverType = vm.TYPE
        <where>
            <if test="isCatalog">
                and vm.SRV_NO IS NOT NULL
            </if>
        </where>
        GROUP BY temp.name ORDER BY temp.name asc
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_APP_SERVER_TOMCAT.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：and,AND,size,count,DATE,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_APP_SERVER_WEBLOGIC.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：AND,size,count,DATE,NOW,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_APP_SERVER_WEBSPHERE.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：count,DATE,NOW,and,AND,size

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_CABINET.xml
> sql统计:复杂0个，简单14个
>
> 使用的关键字：now,CJ_CMDB_CI_CABINET,values,concat,count,in,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_CLOUDBOOT_PM_RAW_DATA.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CMDB_CI_CLOUDBOOT_PM_RAW_DATA,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_CLOUD_BOOT_SUBNET.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：IF,ISNULL,CONCAT,count,JOIN,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_COGNOS.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：DATE,NOW,count

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_COMPUTER_ROOM.xml
> sql统计:复杂0个，简单13个
>
> 使用的关键字：CONCAT,NOW,CJ_CMDB_CI_COMPUTER_ROOM,VALUES,count

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_CONNECT_DIRECT.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：and,AND,size,count,DATE,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_DATASTAGE.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_DB_DB2_INSTANCE.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：and,AND,size,count,DATE,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_DB_ELASTICSEARCH_INSTANCE.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_DB_GBASE_INSTANCE.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：NOW,CJ_CMDB_CI_DB_GBASE_INSTANCE,values,and,AND,size,count

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_DB_MONGODB_INSTANCE.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_DB_MYSQL_INSTANCE.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：NOW,and,AND,size,count,DATE

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_DB_ORA_INSTANCE.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：count,DATE,NOW,and,AND,size

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_DB_POSTGRESQL_INSTANCE.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_DB_REDIS_INSTANCE.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：and,AND,size,count,DATE,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_DB_SQLSERVER_INSTANCE.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：and,AND,size,count,DATE,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_FLUME.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_HADOOP.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：DATE,NOW,and,AND,size,count

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_HARDWARE_CONF_TEMPLATE.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：concat,NOW,join,CONCAT,and,count,JOIN

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_IBM_WMQ.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：and,AND,size,count,DATE,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_IHS_WEB_SERVER.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：count,DATE,NOW,and,AND,size

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_IMAGE_TEMPLATE.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：JOIN,split,NOW,join,CONCAT,and,count

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_KAFKA.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_LOGICAL_DISK.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_MYCAT.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_NAS_STORAGE.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：now,CJ_CMDB_CI_NAS_STORAGE,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_NAS_VOLUME.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：now,CJ_CMDB_CI_NAS_VOLUME,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_NAS_VOLUME_EXPORT.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：now,CJ_CMDB_CI_NAS_VOLUME_EXPORT,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_NGINX_WEB_SERVER.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：count,DATE,NOW,and,AND,size

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_OPENSHIFT_NODE.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：count,DATE,NOW,and,AND,size

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_PHYSICAL_DATACENTER.xml
> sql统计:复杂0个，简单12个
>
> 使用的关键字：NOW,CJ_CMDB_CI_PHYSICAL_DATACENTER,values,CONCAT,count

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_PHYSICAL_MACHINE.xml
> sql统计:复杂4个，简单33个
>
> 使用的关键字：and,count,split,join,if,from,CONCAT,sum,in,now,concat,IFNULL,INSTR,DATE,ifnull,DATE_FORMAT,WHERE,NOW,values
#### list
```

      select pm.ID,pm.MEMBER_ID,pm.NAME,pm.CPU_CORE_COUNT as cpus,pm.RAM as memory,pm.DISK_SPACE as disk, pm.SN, pm.ENTITY_ID, pm.OPERATIONAL_STATUS as `status`, pm.RUN_STATUS as runStatus, pm.OOB_IP as ip,pm.BIZ_IP,pm.BIZ_VLAN, 
        pm.label, concat(pm.OS_DOMAIN, IFNULL(pm.OS_VERSION,'')) as os,pm.IS_LOCKED,        pm.OWNED_BY,u.`NAME` as owner, depart.`NAME` as dept, sa.NAME AS serviceAccountName,sa.DATACENTER_TYPE AS datacenterType, cdc.CLOUD_ACCOUNT_ID,
        ca.NAME as CLOUD_ACCOUNT_NAME,app.NAME as appSystemName, du.NAME as appDuName , du.APP_DU_TYPE as appDuType, dc.NAME as dataCenter, room.NAME as serverRoom,pm.U_START as uStart, region.name as region, pm.USED_FOR as `usage`,
        concat(IFNULL(cabinet.PRE_NAME,''), if(cabinet.PRE_NAME is null,'','-'), cabinet.NAME) as serverCabinet
      from CJ_CMDB_CI_PHYSICAL_DATACENTER dc inner join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID=dc.SERVICE_ACCOUNT_ID and sa.IS_DELETED=0 and dc.IS_DELETED=0
      left outer join CJ_CMP_CLOUD_ACCOUNT_DC cdc on cdc.SERVICE_ACCOUNT_ID=dc.SERVICE_ACCOUNT_ID and cdc.LDC_ID=dc.ID and cdc.IS_DELETED=0
      left outer join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID=cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED=0
      inner join CJ_CMDB_CI_PHYSICAL_MACHINE pm on pm.LDC_ID=dc.ID and pm.IS_DELETED=0
      left outer join CJ_CMDB_CI_COMPUTER_ROOM room on pm.COMPUTER_ROOM_ID=room.ID
      left outer join CJ_CMDB_CI_CABINET cabinet on cabinet.ID=pm.CABINET_ID
      left outer join CJ_CMP_APP_SYSTEM app on app.ID=pm.APP_SYSTEM_ID
      left outer join CJ_CMDB_CI_SYS_REGION region on pm.REGION_ID = region.ID and region.IS_DELETED = 0
      left join CJ_CMP_APP_DU du on pm.APP_DU_ID = du.ID and du.IS_DELETED = 0
      left join ydduc.UC_USER u ON pm.OWNED_BY = u.ID
      left join ydduc.UC_DEPARTMENT depart ON u.DEPARTMENT = depart.ID
      where pm.ENTITY_ID is not null and pm.IS_DELETED=0
      <if test="queryParam.cloudAccountId != null and queryParam.cloudAccountId != ''"> and ca.ID=#{queryParam.cloudAccountId}</if>
      <if test="queryParam.serviceAccountId != null and queryParam.serviceAccountId != ''"> and sa.ID=#{queryParam.serviceAccountId}</if>
      <if test="queryParam.ldcId != null and queryParam.ldcId != ''"> and dc.ID=#{queryParam.ldcId}</if>
      <if test="queryParam.azId != null and queryParam.azId != ''"> and room.ID=#{queryParam.azId}</if>
    <if test="queryParam.memberId != 0">  and pm.MEMBER_ID = #{queryParam.memberId}</if>
    <if test="queryParam.appSystemName != null and queryParam.appSystemName != ''"> and app.NAME like CONCAT('%',#{queryParam.appSystemName},'%')</if>
    <if test="queryParam.name != null and queryParam.name != ''"> and pm.NAME like CONCAT('%',#{queryParam.name},'%')</if>
    <if test="queryParam.ip != null and queryParam.ip != ''"> and pm.OOB_IP like CONCAT('%',#{queryParam.ip},'%')</if>
    <if test="queryParam.userIds != null and queryParam.userIds.size >0 ">
     and ( pm.OWNED_BY in <foreach collection="queryParam.userIds" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
       <if test="queryParam.appUserId !=null ">
           or app.SYS_OPR_MANT_OWNER_ID= #{queryParam.appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{queryParam.appUserId} or app.BIZ_OWNER_ID=#{queryParam.appUserId}
           <if test="queryParam.appDepartmentList != null and queryParam.appDepartmentList.size != 0">
             or app.DEPT_ID in <foreach collection="queryParam.appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
             or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="queryParam.appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
           </if>
       </if>
     )
    </if>
    <if test="queryParam.ownedByList != null and queryParam.ownedByList.size != 0">
      and pm.OWNED_BY in <foreach collection="queryParam.ownedByList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
    </if>
    <if test="queryParam.sn != null and queryParam.sn != ''"> and pm.SN like CONCAT('%',#{queryParam.sn},'%')</if>
    <if test="queryParam.runStatus != null and queryParam.runStatus != ''"> and pm.RUN_STATUS = #{queryParam.runStatus}</if>
    <if test="queryParam.status != null and queryParam.status != ''"> and pm.OPERATIONAL_STATUS = #{queryParam.status}</if>
    <if test="queryParam.searchKey != null and queryParam.searchKey != ''">
      and (pm.NAME like CONCAT('%',#{queryParam.searchKey},'%') or pm.OOB_IP like CONCAT('%',#{queryParam.searchKey},'%') or pm.sn like CONCAT('%',#{queryParam.searchKey},'%') or pm.RUN_STATUS = #{queryParam.searchKey} or  pm.OPERATIONAL_STATUS = #{queryParam.searchKey} or pm.BIZ_IP like CONCAT('%', #{queryParam.searchKey}, '%') or app.NAME like CONCAT('%',#{queryParam.searchKey},'%')
      <if test="queryParam.searchKeyList != null and queryParam.searchKeyList.size != 0">
        or pm.OWNED_BY in <foreach collection="queryParam.searchKeyList" item="searchKey" open="(" close=")" separator=",">#{searchKey}</foreach>
      </if>
      )
    </if>
    <if test=" queryParam.bizIps != null and queryParam.bizIps.size >0 ">
      and <foreach collection="queryParam.bizIps" item="ip" open="(" close=")" separator="or">INSTR(pm.BIZ_IP, #{ip})</foreach>
    </if>

    order by pm.NAME
  
```
#### queryDetail
```

    select pm.ID,pm.SERVICE_ACCOUNT_ID,pm.MEMBER_ID,pm.NAME,pm.NAME as hostname,pm.CPU_CORE_COUNT as cpus,pm.RAM as memory,pm.DISK_SPACE as disk, pm.SN, pm.ENTITY_ID, pm.OPERATIONAL_STATUS as `status`,
      pm.RUN_STATUS as runStatus, pm.OOB_IP as ip, pm.BIZ_IP,pm.BIZ_VLAN, pm.label, concat(pm.OS_DOMAIN, IFNULL(pm.OS_VERSION,'')) as os,du.NAME as appDuName ,du.APP_DU_TYPE as appDuType,app.NAME as appSystemName,pm.IS_LOCKED,
      pm.USED_FOR as `usage`,u.`NAME` as owner, depart.`NAME` as dept, pm.BOOTOS_ACTIVE_TIME as bootOSActiveTime, pm.OPERATING_SYSTEM as osType, pm.OWNED_BY, pm.manufacturer, pm.MODEL_ID as model, pm.U_START,
      pm.CREATE_BY, pm.CREATE_DATE, pm.LAST_MODIFIED_BY, pm.LAST_MODIFIED_DATE, sa.NAME AS serviceAccountName, sa.DATACENTER_TYPE as serviceAccountType, cdc.CLOUD_ACCOUNT_ID, ca.NAME as CLOUD_ACCOUNT_NAME,
      concat(IFNULL(cabinet.PRE_NAME,''),if(cabinet.PRE_NAME is null,'','-'), cabinet.NAME) as SERVER_ROOM, room.ID as SERVER_ROOM_ID,cabinet.NAME as serverCabinet, cabinet.ID as serverCabinetId, dc.NAME as dataCenter, region.name as region
    from CJ_CMDB_CI_PHYSICAL_MACHINE pm left outer join CJ_CMDB_CI_CABINET cabinet on cabinet.ID=pm.CABINET_ID
    left outer join CJ_CMDB_CI_COMPUTER_ROOM room on room.ID=pm.COMPUTER_ROOM_ID
    left outer join CJ_CMDB_CI_PHYSICAL_DATACENTER dc on dc.ID=pm.LDC_ID
    left outer join CJ_CMP_CLOUD_ACCOUNT_DC cdc on cdc.SERVICE_ACCOUNT_ID=pm.SERVICE_ACCOUNT_ID and cdc.LDC_ID=pm.LDC_ID and cdc.IS_DELETED=0
    left outer join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID=cdc.CLOUD_ACCOUNT_ID
    left outer join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID=pm.SERVICE_ACCOUNT_ID
    left outer join CJ_CMDB_CI_SYS_REGION region on pm.REGION_ID = region.ID and region.IS_DELETED = 0
    left join CJ_CMP_APP_DU du on pm.APP_DU_ID = du.ID and du.IS_DELETED = 0
    left join  CJ_CMP_APP_SYSTEM app on pm.APP_SYSTEM_ID=app.ID and  app.IS_DELETED=0
    left join ydduc.UC_USER u ON pm.OWNED_BY = u.ID
    left join ydduc.UC_DEPARTMENT depart ON u.DEPARTMENT = depart.ID
    where pm.ID = #{id} and pm.IS_DELETED=0
    <if test="memberId != 0"> and pm.MEMBER_ID = #{memberId}</if>
  
```
#### countByRole
```

    select ifnull(count(*),0)
    from CJ_CMDB_CI_PHYSICAL_MACHINE pm
    left outer join CJ_CMP_APP_SYSTEM app on app.ID=pm.APP_SYSTEM_ID
    where pm.IS_DELETED=0 and pm.MEMBER_ID = #{memberId}
    <if test="userIds != null and userIds.size >0 ">
      and ( pm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
      <if test="appUserId !=null ">
        or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
        <if test="appDepartmentList != null and appDepartmentList.size != 0">
          or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
          or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
        </if>
      </if>
      )
    </if>
    <if test="startTime != null and endTime != null ">
      and (pm.CREATE_DATE &gt;= DATE(#{startTime}) AND pm.CREATE_DATE &lt;= DATE(#{endTime}))
    </if>
  
```
#### groupByTime
```

    SELECT
    ifnull( count( DISTINCT ENTITY_ID, SERVICE_ACCOUNT_ID ), 0 ) AS num,
    DATE_FORMAT(report.CREATE_DATE, #{dateFormat}) AS days
    FROM
    CJ_CMDB_CI_PHYSICAL_MACHINE report
    LEFT OUTER JOIN CJ_CMP_APP_SYSTEM app ON app.ID = report.APP_SYSTEM_ID
    inner join CJ_CMP_SERVICE_ACCOUNT sa on sa.id = report.SERVICE_ACCOUNT_ID and sa.IS_DELETED = 0
    WHERE
    (report.CREATE_DATE &gt;= DATE(#{startTime}) AND report.CREATE_DATE &lt;= DATE(#{endTime}))
    <if test="memberId != 0">
      and report.MEMBER_ID = #{memberId}
    </if>
    <if test="userIds != null and userIds.size >0">
      and ( report.OWNED_BY in
      <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
      <if test="appUserId !=null ">
        or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId}
        or app.BIZ_OWNER_ID=#{appUserId}
        <if test="appDepartmentList != null and appDepartmentList.size != 0">
          or app.DEPT_ID in
          <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">
            #{department}
          </foreach>
          or app.SYS_OPR_MANT_DEPT_ID in
          <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">
            #{department}
          </foreach>
        </if>
      </if>
      )
    </if>
    GROUP BY days
    ORDER BY days asc
  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_PHYSICAL_NIC.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_PHYSICAL_NIC_PORT.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_PXE_TEMPLATE.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：count,JOIN,NOW,join,CONCAT,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_QINGCLOUD_DATACENTER.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_QINGCLOUD_SUBNET.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：NOW,values,IF,ISNULL,CONCAT

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_QINGCLOUD_VM_INSTANCE.xml
> sql统计:复杂0个，简单18个
>
> 使用的关键字：and,now,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_QINGCLOUD_VPC.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：NOW,values,in,and,CONCAT

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_RABBITMQ.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_ROCKETMQ.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：NOW,and,AND,size,count,DATE

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_STORAGE_DISK.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_STORAGE_HBA.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：now,NOW,CJ_CMDB_CI_STORAGE_HBA,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_STORAGE_HBA_PORT.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_STORM.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_SYS_REGION.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_TKE_CLUSTER.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：and,now,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_TKE_NS.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：and,now,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_TKE_PROJECT.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：and,now,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_TKE_PROJECT_X_CLUSTER.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_ZOOKEEPER.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_ALIYUN_DC.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_ALIYUN_ECS.xml
> sql统计:复杂0个，简单21个
>
> 使用的关键字：and,now,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_APP_DU.xml
> sql统计:复杂0个，简单12个
>
> 使用的关键字：CJ_CMP_APP_DU,VALUES,and,count,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_APP_DU_X_RESOURCE.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：count,now,CJ_CMP_APP_DU_X_RESOURCE,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_APP_INSTANCE.xml
> sql统计:复杂0个，简单12个
>
> 使用的关键字：now,CJ_CMP_APP_INSTANCE,VALUES,and,or,count

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_APP_MGR_CONFIG.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：CJ_CMP_APP_MGR_CONFIG,VALUES,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_APP_RESOURCE.xml
> sql统计:复杂1个，简单0个
>
> 使用的关键字：ifnull,ceil,and,CONCAT
#### queryResourceList
```

        select vm.ID          id,
        vm.NAME               name,
        vm.IP                 ip,
        vm.OS,
        vm.TYPE               deviceType,
        vm.RUN_STATUS,
        vm.CLUSTER_NAME       clusterName,
        vm.ZONE_NAME          zoneName,
        vm.SERVICE_ACCOUNT_ID,
        vm.CLOUD_ACCOUNT_ID   cloudAccountId,
        vm.CLOUD_ACCOUNT_NAME cloudAccountName,
        vm.LDC_TYPE           ldcType,
        vm.LDC_ID             ldcId,
        vm.LDC_NAME           ldcName,
        vm.SN                 sn,
        app.NAME              appName,
        du.NAME               appDuName,
        du.ID                 appDuId,
        du.APP_DU_TYPE,dt.NAME as appDuTypeName,du.NAME_EN_ABBR,
        vm.APP_SYSTEM_ID      appSystemId,
        CONCAT(ifnull(vm.CPUS,''),'C',ifnull(ceil(vm.MEMORY/1024),''),'G') as spec
        from CJ_CMP_PHYSICAL_VIRTUAL_MACHINE_VIEW vm
        inner join CJ_CMP_APP_SYSTEM app on app.ID =vm.APP_SYSTEM_ID and app.IS_DELETED = 0
        left outer join CJ_CMP_APP_DU du on du.ID = vm.APP_DU_ID and du.IS_DELETED = 0
        left outer join CJ_SYS_DIC dt on dt.TYPE_CODE='APP_DU_TYPE' and dt.CODE=du.APP_DU_TYPE and dt.IS_DELETED=0
        where vm.MEMBER_ID = #{memberId}
        <if test="appSystemId!=null and appSystemId!=''"> and app.ID=#{appSystemId}</if>
        <if test="duId!=null and duId!=''"> and du.ID=#{duId}</if>
        <if test="searchKey != null and searchKey != ''">
            <if test="searchType=='' or searchType==null">
                and (du.NAME like #{searchKey} or dt.NAME like #{searchKey} or du.NAME_EN_ABBR like #{searchKey} or vm.NAME like #{searchKey} or vm.IP like #{searchKey})
            </if>
            <if test="searchType=='appDuName'">and du.NAME like #{searchKey} </if>
            <if test="searchType=='appDuType'">and dt.NAME like #{searchKey}</if>
            <if test="searchType=='appDuNameEnAbbr'">and du.NAME_EN_ABBR like #{searchKey}</if>
            <if test="searchType=='hostName'">and vm.NAME like #{searchKey}</if>
            <if test="searchType=='ip'">and vm.IP like #{searchKey}</if>
         </if>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_APP_SYSTEM.xml
> sql统计:复杂0个，简单28个
>
> 使用的关键字：and,or,count,CONCAT,VALUES,CJ_CMP_APP_SYSTEM_X_USER,now,CJ_CMP_APP_SYSTEM,CJ_CMP_APP_SYSTEM_X_ASSIGNER_USER

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_ASYNC_TASK.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：now,CJ_CMP_ASYNC_TASK,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_ASYNC_TASK_MESSAGE.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：now,CJ_CMP_ASYNC_TASK_MESSAGE,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_BP.xml
> sql统计:复杂1个，简单8个
>
> 使用的关键字：in,and,or,CONCAT,convert,NOW,CJ_CMP_BP,VALUES
#### selectByCondition
```

    select *
    from CJ_CMP_BP
    where IS_DELETED = 0 and (MEMBER_ID = #{memberId} or (MEMBER_ID = 0 and status = 'published'))
    <if test="status != null and status != ''" >
      and `STATUS` = #{status}
    </if>
    <if test="name != null and name != ''" >
        and `NAME` like CONCAT('%',#{name},'%')
    </if>
    ORDER BY convert(${sortField} USING gbk) ${sortType}
  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_BP_OP.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：in,NOW,CJ_CMP_BP_OP,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_BP_OP_PARAM.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：NOW,CJ_CMP_BP_OP_PARAM,VALUES,in

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_BP_OP_STEP.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：in,NOW,CJ_CMP_BP_OP_STEP,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_BP_RB.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：VALUES,in,NOW,CJ_CMP_BP_RB

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_CABINET_CONFIG.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：NOW,CJ_CMP_CABINET_CONFIG,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_CAPACITY.xml
> sql统计:复杂7个，简单7个
>
> 使用的关键字：CJ_CMP_CAPACITY,values,ifnull,sum,round,count,JOIN,NOW
#### queryAppSubsystemCapacityVmUsed
```

    SELECT sub.ID as capacityObjId,sub.NAME as capacityObjName ,ifnull(sum(ifnull(vm.CPUS,0)),0) as vcpuUsed,ifnull(round(sum(ifnull(vm.MEMORY,0))/1024),0) as memoryUsed,count(vm.ID) as vmInstanceUsed,
	ifnull(round(sum(ifnull(vmStorage.DISK_SPACE,0))),0) as storageUsed,ifnull(sum(ifnull(vmStorage.DISKS,0)),0) as diskUsed
	FROM CJ_CMP_APP_SYSTEM sub
	LEFT JOIN cj_cmp_vm_view vm on vm.APP_SYSTEM_ID=sub.ID and sub.IS_DELETED=0
	LEFT JOIN (select SERVICE_ACCOUNT_ID,VM_DEVICE_ID,sum(ifnull(DISK_SPACE,0)) as DISK_SPACE,count(*) as DISKS from CJ_CMP_VM_VOLUME v where v.IS_DELETED=0 group by SERVICE_ACCOUNT_ID,VM_DEVICE_ID) as vmStorage on vmStorage.SERVICE_ACCOUNT_ID=vm.SERVICE_ACCOUNT_ID and vmStorage.VM_DEVICE_ID=vm.ID
	where sub.MEMBER_ID=#{memberId}
	<if test="appSubIds != null and appSubIds.size != 0">
        and sub.ID in <foreach collection="appSubIds" item="objId" open="(" close=")" separator=",">#{objId}</foreach>
    </if>
	group by sub.ID,sub.NAME; 
  
```
#### queryAppSubsystemCapacityPmUsed
```

    SELECT sub.ID as capacityObjId,sub.NAME as capacityObjName,
	count(*) as pmInstanceUsed,
	ifnull(round(sum(ifnull(hdd.storageUsed,0))),0) as storageUsed,
	ifnull(sum(ifnull(hdd.diskUsed,0)),0) as diskUsed,
	ifnull(sum(ifnull(pm.CPU_CORE_COUNT,0)),0) as vcpuUsed,
	ifnull(sum(ifnull(pm.RAM,0)),0) as memoryUsed
	FROM CJ_CMP_APP_SYSTEM sub
	INNER JOIN CJ_CMDB_CI_PHYSICAL_MACHINE pm on pm.APP_SYSTEM_ID=sub.ID and pm.IS_DELETED=0 and sub.IS_DELETED=0
	LEFT JOIN (select SERVER_ID,count(*) as diskUsed,sum(ifnull(DISK_SPACE,0)) as storageUsed from CJ_CMDB_CI_STORAGE_DISK where IS_DELETED=0 group by SERVER_ID) as hdd on hdd.SERVER_ID=pm.ID
	where sub.MEMBER_ID=#{memberId}
	<if test="appSubIds != null and appSubIds.size != 0">
        and sub.ID in <foreach collection="appSubIds" item="objId" open="(" close=")" separator=",">#{objId}</foreach>
    </if>
	group by sub.ID,sub.NAME; 
  
```
#### queryDeptCapacityVmUsed
```

    SELECT ifnull(sum(ifnull(vm.CPUS,0)),0) as vcpuUsed,ifnull(round(sum(ifnull(vm.MEMORY,0))/1024),0) as memoryUsed,count(vm.ID) as vmInstanceUsed,ifnull(round(sum(ifnull(vmStorage.DISK_SPACE,0))),0) as storageUsed,ifnull(sum(ifnull(vmStorage.DISKS,0)),0) as diskUsed
	FROM cj_cmp_vm_view vm 
	LEFT JOIN (select SERVICE_ACCOUNT_ID,VM_DEVICE_ID,sum(ifnull(DISK_SPACE,0)) as DISK_SPACE,count(*) as DISKS from CJ_CMP_VM_VOLUME v where v.IS_DELETED=0 group by SERVICE_ACCOUNT_ID,VM_DEVICE_ID) as vmStorage on vmStorage.SERVICE_ACCOUNT_ID=vm.SERVICE_ACCOUNT_ID and vmStorage.VM_DEVICE_ID=vm.ID
    where vm.OWNED_BY in <foreach collection="userIds" item="objId" open="(" close=")" separator=",">#{objId}</foreach>
  
```
#### queryDeptCapacityPmUsed
```

    select count(*) as pmInstanceUsed,ifnull(round(sum(ifnull(hdd.storageUsed,0))),0) as storageUsed,count(hdd.diskUsed) as diskUsed,ifnull(sum(ifnull(pm.CPU_CORE_COUNT,0)),0) as vcpuUsed,ifnull(sum(ifnull(pm.RAM,0)),0) as memoryUsed
    from CJ_CMDB_CI_PHYSICAL_MACHINE pm LEFT JOIN (select SERVER_ID,count(*) as diskUsed,sum(ifnull(DISK_SPACE,0)) as storageUsed from CJ_CMDB_CI_STORAGE_DISK where IS_DELETED=0 group by SERVER_ID) as hdd on hdd.SERVER_ID=pm.ID
    where pm.IS_DELETED=0 and pm.OWNED_BY in <foreach collection="userIds" item="objId" open="(" close=")" separator=",">#{objId}</foreach>
  
```
#### queryProjectCapacityVmUsed
```

        SELECT ifnull(sum(ifnull(vm.CPUS,0)),0) as vcpuUsed,ifnull(round(sum(ifnull(vm.MEMORY,0))/1024),0) as
        memoryUsed,count(vm.ID) as vmInstanceUsed,
        ifnull(round(sum(ifnull(vmStorage.DISK_SPACE,0))),0) as storageUsed,ifnull(sum(ifnull(vmStorage.DISKS,0)),0) as
        diskUsed
        FROM cj_cmp_vm_view vm
        LEFT JOIN (select SERVICE_ACCOUNT_ID,VM_DEVICE_ID,sum(ifnull(DISK_SPACE,0)) as DISK_SPACE,count(*) as DISKS from
        CJ_CMP_VM_VOLUME v where v.IS_DELETED=0 group by SERVICE_ACCOUNT_ID,VM_DEVICE_ID) as vmStorage on
        vmStorage.SERVICE_ACCOUNT_ID=vm.SERVICE_ACCOUNT_ID and vmStorage.VM_DEVICE_ID=vm.ID
        where vm.PROJECT_ID in
        <foreach collection="projectIds" item="objId" open="(" close=")" separator=",">#{objId}</foreach>
    
```
#### queryProjectCapacityPmUsed
```

        select count(*) as pmInstanceUsed,ifnull(round(sum(ifnull(hdd.storageUsed,0))),0) as
        storageUsed,count(hdd.diskUsed) as diskUsed,ifnull(sum(ifnull(pm.CPU_CORE_COUNT,0)),0) as
        vcpuUsed,ifnull(sum(ifnull(pm.RAM,0)),0) as memoryUsed
        from CJ_CMDB_CI_PHYSICAL_MACHINE pm LEFT JOIN (select SERVER_ID,count(*) as diskUsed,sum(ifnull(DISK_SPACE,0))
        as storageUsed from CJ_CMDB_CI_STORAGE_DISK where IS_DELETED=0 group by SERVER_ID) as hdd on hdd.SERVER_ID=pm.ID
        where pm.IS_DELETED=0 and pm.PROJECT_ID in
        <foreach collection="projectIds" item="objId" open="(" close=")" separator=",">#{objId}</foreach>
    
```
#### queryCloudAccountCapacityVmUsed
```

        SELECT ca.ID as capacityObjId,ca.NAME as capacityObjName ,ifnull(sum(ifnull(vm.CPUS,0)),0) as vcpuUsed,ifnull(round(sum(ifnull(vm.MEMORY,0))/1024),0) as memoryUsed,count(vm.ID) as vmInstanceUsed,
        ifnull(round(sum(ifnull(vmStorage.DISK_SPACE,0))),0) as storageUsed,ifnull(sum(ifnull(vmStorage.DISKS,0)),0) as diskUsed
        FROM CJ_CMP_CLOUD_ACCOUNT ca
        LEFT JOIN cj_cmp_vm_view vm on vm.CLOUD_ACCOUNT_ID=ca.ID and ca.IS_DELETED=0
        LEFT JOIN (select SERVICE_ACCOUNT_ID,VM_DEVICE_ID,sum(ifnull(DISK_SPACE,0)) as DISK_SPACE,count(*) as DISKS from CJ_CMP_VM_VOLUME v where v.IS_DELETED=0 group by SERVICE_ACCOUNT_ID,VM_DEVICE_ID) as vmStorage on vmStorage.SERVICE_ACCOUNT_ID=vm.SERVICE_ACCOUNT_ID and vmStorage.VM_DEVICE_ID=vm.ID
        where ca.ID in <foreach collection="cloudAccountIds" item="objId" open="(" close=")" separator=",">#{objId}</foreach>
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>
        group by ca.ID,ca.NAME;
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_CAS_CLUSTER.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_CAS_DC.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_CAS_HOST.xml
> sql统计:复杂3个，简单7个
>
> 使用的关键字：round,if,and,count,sum,NOW,group_concat,on,in
#### queryHost
```

        select
        host.ID,
        host.NAME,
        host.IP,
        host.ENTITY_ID,
        host.CPU_COUNT as cpus,
        host.CPU_RATE,
        host.MEMORY as memorySum,
        host.MEMORY_RATE,
        host.STORAGE_CAPACITY,
        host.VM_NUM,
        host.VM_RUN_COUNT,
        host.VM_SHUTOFF,
        host.STATUS,
        cdc.LDC_TYPE,
        group_concat(distinct clu.NAME) as clusterName,
        group_concat(distinct dc.NAME) as ldcName,
        ca.ID as cloudAccountId,
        ca.NAME AS cloudAccountName,
        sa.NAME AS serviceAccountName,
        sa.ID AS serviceAccountId
        from
        CJ_CMP_CLOUD_ACCOUNT ca
        inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc on ca.ID = cdc.CLOUD_ACCOUNT_ID
        and ca.IS_DELETED = 0
        and cdc.LDC_TYPE = 'CAS'
        inner join CJ_CMP_CAS_DC dc on cdc.LDC_ID = dc.ID
        and cdc.IS_DELETED = 0
        and dc.IS_DELETED = 0
        INNER JOIN CJ_CMP_SERVICE_ACCOUNT sa ON cdc.SERVICE_ACCOUNT_ID = sa.ID
        AND sa.IS_DELETED = 0
        inner join CJ_CMP_CAS_HOST host on (
        host.SERVICE_ACCOUNT_ID = sa.ID
        or host.SERVICE_ACCOUNT_ID = sa.PARENT_ID
        )
        and host.IS_DELETED = 0
        INNER JOIN CJ_CMP_CAS_CLUSTER as clu ON host.CLUSTER_ENTITY_ID = clu.ENTITY_ID
        <where>
            <choose>
                <when test="memberId != 0">
                    and ca.MEMBER_ID = #{memberId}
                </when>
                <otherwise>
                    and ca.SCOPE = 'public'
                </otherwise>
            </choose>
            <if test="id != null and id != ''">and host.ID=#{id}</if>
            <if test="serviceAccountId != null and serviceAccountId != ''">and
                cdc.SERVICE_ACCOUNT_ID=#{serviceAccountId}
            </if>
            <if test="cloudAccountId != null and cloudAccountId != ''">and ca.ID=#{cloudAccountId}</if>
            <if test="ldcId != null and ldcId != ''">and dc.ID=#{ldcId}</if>
            <if test="name != null and name != ''">and host.NAME like #{name}</if>
            <if test="ip != null and ip != ''">and host.IP like #{ip}</if>
            <if test="searchKey != null and searchKey != ''">and (host.NAME like #{searchKey} or host.IP like
                #{searchKey} or host.ENTITY_ID like #{searchKey})
            </if>
        </where>
        group by
        host.ID,
        host.NAME,
        host.IP,
        host.ENTITY_ID,
        host.CPU_COUNT,
        host.CPU_RATE,
        host.MEMORY,
        host.MEMORY_RATE,
        host.STORAGE_CAPACITY,
        host.VM_NUM,
        host.VM_RUN_COUNT,
        host.VM_SHUTOFF,
        cdc.LDC_TYPE,
        ca.ID,
        ca.NAME,
        sa.NAME,
        sa.ID
    
```
#### statisticHostByServiceAccoutId
```

        select count(0)                                                                                 as hostSum,
               sum(host.CPUS)                                                                           as cpus,
               sum(host.CPU_USED)                                                                       as cpuUsed,
               round(if(sum(host.CPUS) = 0, 0, sum(host.CPU_USED) / sum(host.CPUS)), 2) * 100           as cpuUsage,
               sum(host.VIRTUAL_MEMORY_MB_USED)                                                         as memoryUsed,
               sum(host.VIRTUAL_MEMORY_MB_TOTAL)                                                        as memorySum,
               round(if(sum(host.VIRTUAL_MEMORY_MB_TOTAL) = 0, 0,
                        sum(host.VIRTUAL_MEMORY_MB_USED) / sum(host.VIRTUAL_MEMORY_MB_TOTAL)), 2) * 100 as memoryUsage
        from CJ_CMP_FUSION_CLOUD_HOST host
        where SERVICE_ACCOUNT_ID = #{serviceAccountId}
          AND IS_DELETED = 0;
    
```
#### statisticHostByCloudAccoutId
```

        select
        count(0) as hostSum,
        sum(host.CPUS) as cpus,
        sum(host.CPU_USED) as cpuUsed,
        round(if(sum(host.CPUS) = 0, 0, sum(host.CPU_USED) / sum(host.CPUS)), 2) * 100 as cpuUsage,
        sum(host.VIRTUAL_MEMORY_MB_USED) as memoryUsed,
        sum(host.VIRTUAL_MEMORY_MB_TOTAL) as memorySum,
        round(if(sum(host.VIRTUAL_MEMORY_MB_TOTAL) = 0, 0, sum(host.VIRTUAL_MEMORY_MB_USED) /
        sum(host.VIRTUAL_MEMORY_MB_TOTAL)), 2) * 100 as memoryUsage
        from CJ_CMP_FUSION_CLOUD_HOST host
        where SERVICE_ACCOUNT_ID in(select adc.SERVICE_ACCOUNT_ID
        from CJ_CMP_CLOUD_ACCOUNT_DC adc inner join CJ_CMP_CLOUD_ACCOUNT ca on adc.CLOUD_ACCOUNT_ID = ca.ID
        where adc.CLOUD_ACCOUNT_ID = #{cloudAccountId} AND adc.IS_DELETED = 0
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>
        ) AND IS_DELETED = 0;
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_CAS_RESOURCE.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_CAS_STORAGE.xml
> sql统计:复杂4个，简单7个
>
> 使用的关键字：in,sum,round,if,and,NOW
#### statisticDataStoreByServiceAccoutId
```

        SELECT
        sum(da.DISK_SUM)  as DISK_SUM,
        sum(da.DISK_SUM - da.DISK_FREE) as DISK_USED,
        round(if(sum(da.DISK_SUM) = 0, 0, sum(da.DISK_SUM - da.DISK_FREE) / sum(da.DISK_SUM)), 2) * 100 as DISK_USAGE
        FROM CJ_CMP_FUSION_CLOUD_STORAGE da
        where SERVICE_ACCOUNT_ID = #{serviceAccountId} AND IS_DELETED = 0;
    
```
#### statisticDataStoreByCloudAccoutId
```

        SELECT
        sum(da.DISK_SUM)  as DISK_SUM,
        sum(da.DISK_SUM - da.DISK_FREE) as DISK_USED,
        round(if(sum(da.DISK_SUM) = 0, 0, sum(da.DISK_SUM - da.DISK_FREE) / sum(da.DISK_SUM)), 2) * 100 as DISK_USAGE
        FROM CJ_CMP_FUSION_CLOUD_STORAGE da
        where SERVICE_ACCOUNT_ID in (select adc.SERVICE_ACCOUNT_ID
                                      from CJ_CMP_CLOUD_ACCOUNT_DC adc inner join CJ_CMP_CLOUD_ACCOUNT ca on adc.CLOUD_ACCOUNT_ID = ca.ID
                                      where adc.CLOUD_ACCOUNT_ID = #{cloudAccountId} AND adc.IS_DELETED = 0
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>) AND IS_DELETED = 0;
    
```
#### statisticDataStoreTypeBySaId
```

        select
        TYPE,
        SERVICE_ACCOUNT_ID,
        sum(DISK_SUM)             as DISK_SUM,
        sum(DISK_FREE)            as DISK_FREE,
        sum(DISK_SUM - DISK_FREE) as DISK_USED,
        sum(PROVISIONED)          as PROVISIONED,
        round(if(sum(DISK_SUM) = 0, 0, sum(DISK_SUM - DISK_FREE) / sum(DISK_SUM)), 2) * 100 as DISK_USAGE
        from CJ_CMP_FUSION_CLOUD_STORAGE
        where SERVICE_ACCOUNT_ID = #{serviceAccountId}
        group by TYPE, SERVICE_ACCOUNT_ID, MEMBER_ID
    
```
#### statisticDataStoreTypeByCaId
```

        select
            TYPE,
            SERVICE_ACCOUNT_ID,
            sum(DISK_SUM)                                                                       as DISK_SUM,
            sum(DISK_FREE)                                                                      as DISK_FREE,
            sum(DISK_SUM - DISK_FREE)                                                           as DISK_USED,
            sum(PROVISIONED)                                                                    as PROVISIONED,
            round(if(sum(DISK_SUM) = 0, 0, sum(DISK_SUM - DISK_FREE) / sum(DISK_SUM)), 2) * 100 as DISK_USAGE
        from CJ_CMP_FUSION_CLOUD_STORAGE
        where SERVICE_ACCOUNT_ID in (select adc.SERVICE_ACCOUNT_ID
                                      from CJ_CMP_CLOUD_ACCOUNT_DC adc inner join CJ_CMP_CLOUD_ACCOUNT ca on adc.CLOUD_ACCOUNT_ID = ca.ID
                                      where adc.CLOUD_ACCOUNT_ID = #{cloudAccountId} AND adc.IS_DELETED = 0
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>)
        group by TYPE, SERVICE_ACCOUNT_ID, MEMBER_ID
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_CAS_VDS.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：NOW,values,in,and,CONCAT

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_CAS_VM.xml
> sql统计:复杂1个，简单29个
>
> 使用的关键字：in,sum,now,NOW,and,GROUP_CONCAT,if,count
#### getAllByCondition
```

        select ecs.*,prj.CODE as projectCode,prj.NAME as projectName,prj.PROJECT_SOURCE_ID as projectSourceId,
        app.CODE as appSystemCode,app.NAME as appSystemName,app.SOURCE_ID as appSystemSourceId, GROUP_CONCAT(tag.NAME)
        as tags
        from CJ_CMP_CAS_VM ecs
        <if test="srvCompletionTimeStart!=null or srvCompletionTimeEnd!=null ">
        left outer join CJ_CMP_RITM_COMPLETED_VIEW req on ecs.SRV_NO=req.NUMBER
        </if>
        left outer join CJ_CMP_PROJECT prj on prj.ID=ecs.PROJECT_ID
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=ecs.APP_SYSTEM_ID
        left outer join CJ_CMP_APP_DU du on du.ID=ecs.APP_DU_ID
        left outer join CJ_CMP_TAG_X_OBJECT txo on ecs.ID = txo.OBJECT_ID and txo.OBJECT_TYPE = 'fusionCloud'
        left outer join CJ_CMP_TAG tag on tag.ID = txo.TAG_ID and tag.IS_DELETED = 0
        <where>
            <if test="memberId != 0">and ecs.MEMBER_ID = #{memberId}</if>
            <if test="startTime!=null and  endTime!=null ">
                and ecs.CREATE_DATE between #{startTime,jdbcType= TIMESTAMP} and #{endTime,jdbcType= TIMESTAMP}
            </if>
            <if test="startTime==null   and  endTime!=null ">
                and ecs.CREATE_DATE &lt;= #{endTime,jdbcType= TIMESTAMP}
            </if>
            <if test="startTime!=null  and  endTime==null ">
                and ecs.CREATE_DATE &gt;= #{startTime,jdbcType= TIMESTAMP}
            </if>
            <if test="srvCompletionTimeStart!=null and srvCompletionTimeEnd!=null ">
                and if(ecs.IS_DELETED=1,ecs.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) between
                #{srvCompletionTimeStart,jdbcType= TIMESTAMP} and #{srvCompletionTimeEnd,jdbcType= TIMESTAMP}
            </if>
            <if test="srvCompletionTimeStart==null and srvCompletionTimeEnd!=null ">
                and if(ecs.IS_DELETED=1,ecs.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) &lt;=
                #{srvCompletionTimeEnd,jdbcType= TIMESTAMP}
            </if>
            <if test="srvCompletionTimeStart!=null and srvCompletionTimeEnd==null ">
                and if(ecs.IS_DELETED=1,ecs.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) &gt;=
                #{srvCompletionTimeStart,jdbcType= TIMESTAMP}
            </if>
            <if test="isDeleted != null ">
                <choose>
                    <when test="isDeleted">
                        and ecs.IS_DELETED=1
                    </when>
                    <otherwise>
                        and ecs.IS_DELETED=0
                    </otherwise>
                </choose>
            </if>
        </where>
        GROUP BY ecs.ID
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_CIDR_BLOCK.xml
> sql统计:复杂3个，简单22个
>
> 使用的关键字：sum,CONCAT,join,and,ifnull,count,size,CJ_CMP_CIDR_BLOCK,VALUES,round,concat,convert,from,on,NOW
#### selectByCondition
```

     select distinct cidr.*, area.NAME as NETWORK_AREA_NAME,
                    (CASE WHEN cidr.IP_VERSION="IPv6" THEN null WHEN cidr.IP_VERSION="IPv4" THEN count(ip.CIDR_BLOCK_ID) END) as IP_SUM,
                    (CASE WHEN cidr.IP_VERSION="IPv6" THEN null WHEN cidr.IP_VERSION="IPv4" THEN sum(ip.STATUS != 'unused') END) as IP_USED,
                    (CASE WHEN cidr.IP_VERSION="IPv6" THEN null WHEN cidr.IP_VERSION="IPv4" THEN sum(ip.STATUS = 'unused') END) as IP_UNUSED,
                    (CASE WHEN cidr.IP_VERSION="IPv6" THEN null WHEN cidr.IP_VERSION="IPv4" THEN round((sum(ip.STATUS != 'unused')/count(ip.CIDR_BLOCK_ID) * 100), 2) END) as IP_USAGE
      from CJ_CMP_CIDR_BLOCK cidr
        left join
        (select CIDR_BLOCK_ID,`TYPE` from CJ_CMP_CIDR_BLOCK_X_NETWORK rel
        inner join CJ_CMP_SERVICE_ACCOUNT sa on rel.SERVICE_ACCOUNT_ID = sa.ID
        where sa.TYPE = 'aliyunPublic')
        as al on cidr.ID = al.CIDR_BLOCK_ID
        left join CJ_CMP_NETWORK_AREA area on cidr.NETWORK_AREA_ID = area.ID
        left join CJ_CMP_IP_POOL ip on cidr.ID = ip.CIDR_BLOCK_ID
        where cidr.MEMBER_ID = #{memberId} and al.TYPE is null
        <if test="ids != null and ids.size() > 0" >
          and cidr.ID in <foreach collection="ids" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
        <if test="name != null and name != ''" >
          and cidr.`NAME` like CONCAT('%',#{name},'%')
        </if>
        <if test="type != null and type != ''" >
          and cidr.TYPE = #{type}
        </if>
        <if test="ipVersion != null and ipVersion != ''" >
          and cidr.IP_VERSION = #{ipVersion}
        </if>
        <if test="networkAreaId != null" >
          and cidr.NETWORK_AREA_ID = #{networkAreaId}
        </if>
        <if test="networkAreaName != null and networkAreaName != '' " >
          and area.NAME LIKE concat('%', #{networkAreaName}, '%')
        </if>
        <if test="keyword != null and keyword!= '' ">
          and (cidr.`NAME` like CONCAT('%',#{keyword},'%') or cidr.TYPE like CONCAT('%',#{keyword},'%') or area.NAME LIKE concat('%', #{keyword}, '%') or cidr.IP_VERSION like CONCAT('%',#{keyword},'%') or cidr.CIDR_BLOCK like concat('%', #{keyword}, '%'))
        </if>
        <if test="cidrBlock !=null and cidrBlock !=''">
          and cidr.CIDR_BLOCK like concat('%', #{cidrBlock}, '%')
        </if>
        <if test="networkAreaIds != null and networkAreaIds.size()>0">
             and cidr.NETWORK_AREA_ID IN <foreach collection="networkAreaIds" item="naId" open="(" separator="," close=")"> #{naId} </foreach>
          </if>
        group by cidr.ID
        <if test="sortField != null and sortField!= '' and sortType != null and sortType!= '' ">
          <choose>
            <when test="sortField == 'NAME'">
              ORDER BY convert(cidr.${sortField} USING gbk) ${sortType}
            </when>
            <when test="sortField == 'NETWORK_AREA_NAME'">
              ORDER BY convert(${sortField} USING gbk) ${sortType}
            </when>
            <otherwise>
              ORDER BY ${sortField} ${sortType}
            </otherwise>
          </choose>
        </if>
  
```
#### pageByCondition
```

    select distinct cidr.*, area.NAME as NETWORK_AREA_NAME,
      (CASE WHEN cidr.IP_VERSION='IPv6' THEN null WHEN cidr.IP_VERSION='IPv4' THEN count(ip.CIDR_BLOCK_ID) END) as IP_SUM,
      (CASE WHEN cidr.IP_VERSION='IPv6' THEN null WHEN cidr.IP_VERSION='IPv4' THEN sum(ip.STATUS != 'unused') END) as IP_USED,
      (CASE WHEN cidr.IP_VERSION='IPv6' THEN null WHEN cidr.IP_VERSION='IPv4' THEN sum(ip.STATUS = 'unused') END) as IP_UNUSED,
      (CASE WHEN cidr.IP_VERSION='IPv6' THEN null WHEN cidr.IP_VERSION='IPv4' THEN round((sum(ip.STATUS != 'unused')/count(ip.CIDR_BLOCK_ID) * 100), 2) END) as IP_USAGE
    from (
      select cidrBlock.* from CJ_CMP_CIDR_BLOCK cidrBlock
      left join CJ_CMP_CIDR_BLOCK_X_NETWORK rel on cidrBlock.ID = rel.CIDR_BLOCK_ID
      left join CJ_CMP_SERVICE_ACCOUNT sa on rel.SERVICE_ACCOUNT_ID = sa.ID and sa.TYPE = 'aliyunPublic'
      <where>
        and cidrBlock.MEMBER_ID = #{memberId}
        and sa.TYPE is null
        <if test="ids != null" >
          and cidrBlock.ID in <foreach collection="ids" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
        <if test="name != null" >
          and cidrBlock.`NAME` like CONCAT('%',#{name},'%')
        </if>
        <if test="type != null" >
          and cidrBlock.TYPE = #{type}
        </if>
        <if test="ipVersion != null" >
          and cidrBlock.IP_VERSION = #{ipVersion}
        </if>
        <if test="networkAreaId != null" >
          and cidrBlock.NETWORK_AREA_ID = #{networkAreaId}
        </if>
        <if test="cidrBlock !=null">
          and cidrBlock.CIDR_BLOCK like concat('%', #{cidrBlock}, '%')
        </if>
        <if test="networkAreaIds != null">
          and cidrBlock.NETWORK_AREA_ID IN <foreach collection="networkAreaIds" item="naId" open="(" separator="," close=")"> #{naId} </foreach>
        </if>
      </where>
      group by cidrBlock.ID
      <if test="networkAreaName == null">
        <if test="sortField != null and sortField!= '' and sortType != null and sortType!= '' ">
          <choose>
            <when test="sortField == 'NAME'">
              ORDER BY convert(cidr.${sortField} USING gbk) ${sortType}
            </when>
            <when test="sortField == 'NETWORK_AREA_NAME'">
              ORDER BY convert(${sortField} USING gbk) ${sortType}
            </when>
            <otherwise>
              ORDER BY ${sortField} ${sortType}
            </otherwise>
          </choose>
        </if>
        limit #{offset}, #{limit}
      </if>
    ) cidr
    left join (
      select * from CJ_CMP_NETWORK_AREA
      <where>
        <if test="networkAreaName != null" >
          and `NAME` LIKE concat('%', #{networkAreaName}, '%')
        </if>
      </where>
    ) area on cidr.NETWORK_AREA_ID = area.ID
    left join CJ_CMP_IP_POOL ip on cidr.ID = ip.CIDR_BLOCK_ID
    <where>
      <if test="keyword != null">
        and (cidr.`NAME` like CONCAT('%',#{keyword},'%') or cidr.TYPE like CONCAT('%',#{keyword},'%') or area.NAME LIKE concat('%', #{keyword}, '%') or cidr.IP_VERSION like CONCAT('%',#{keyword},'%') or cidr.CIDR_BLOCK like concat('%', #{keyword}, '%'))
      </if>
    </where>
    group by cidr.ID
    <if test="networkAreaName != null">
      <if test="sortField != null and sortField!= '' and sortType != null and sortType!= '' ">
        <choose>
          <when test="sortField == 'NAME'">
            ORDER BY convert(cidr.${sortField} USING gbk) ${sortType}
          </when>
          <when test="sortField == 'NETWORK_AREA_NAME'">
            ORDER BY convert(${sortField} USING gbk) ${sortType}
          </when>
          <otherwise>
            ORDER BY ${sortField} ${sortType}
          </otherwise>
        </choose>
      </if>
      limit #{offset}, #{limit}
    </if>
  
```
#### countCidrBlockAllRelNetworks
```

    SELECT ifnull(count(DISTINCT rel.CIDR_BLOCK_ID), 0)
    FROM CJ_CMP_CIDR_BLOCK_X_NETWORK rel
           LEFT JOIN CJ_CMP_SERVICE_ACCOUNT sa ON rel.SERVICE_ACCOUNT_ID = sa.ID
           INNER JOIN CJ_CMP_SUBNET_VIEW subnet
                      ON rel.NETWORK_ID = subnet.ID AND rel.SERVICE_ACCOUNT_ID = subnet.SERVICE_ACCOUNT_ID
    WHERE rel.MEMBER_ID =#{memberId} and rel.CIDR_BLOCK_ID in <foreach collection="cidrBlockIds" item="cidrId" open="(" close=")" separator=",">#{cidrId}</foreach>
  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_CIDR_BLOCK_X_APP_INSTANCE.xml
> sql统计:复杂1个，简单9个
>
> 使用的关键字：join,and,CONCAT,CJ_CMP_CIDR_BLOCK_X_APP_INSTANCE,values,count,ifnull
#### countCidrBlockAllRelAppSystem
```

        SELECT ifnull(count(DISTINCT rel.CIDR_BLOCK_ID), 0)
        FROM CJ_CMP_CIDR_BLOCK_X_APP_INSTANCE rel
                 inner JOIN CJ_CMP_APP_SYSTEM instance ON rel.APP_INSTANCE_ID = instance.ID AND instance.IS_DELETED = 0
        WHERE rel.MEMBER_ID = #{memberId} and rel.CIDR_BLOCK_ID in <foreach collection="cidrBlockIds" item="cidrId" open="(" close=")" separator=",">#{cidrId}</foreach>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_CIDR_BLOCK_X_NETWORK.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：CJ_CMP_CIDR_BLOCK_X_NETWORK,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_CIDR_CHECK_IP_LOG.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：in,CJ_CMP_CIDR_CHECK_IP_LOG,VALUES,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_CIDR_LOGIC.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：in,CJ_CMP_CIDR_LOGIC,VALUES,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_CLOUDOS_DC.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：NOW,CJ_CMP_CLOUDOS_DC,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_CLOUDOS_HOST.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：values,and,now,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_CLOUDOS_NETWORK.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：count,in,and,CONCAT,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_CLOUDOS_SUBNET.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：IF,ISNULL,CONCAT,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_CLOUDOS_VM.xml
> sql统计:复杂0个，简单20个
>
> 使用的关键字：and,now,NOW,CJ_CMP_CLOUDOS_VM,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_CLOUDSINO_COMPUTER_ROOM.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：CONCAT,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_CLOUDSINO_FRAME.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：and,CONCAT

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_CLOUDSINO_PHYSICAL_MACHINE.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：now,NOW,CONCAT,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_CLOUDSINO_STRATEGY.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：and,CONCAT

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_CLOUD_ACCOUNT.xml
> sql统计:复杂7个，简单18个
>
> 使用的关键字：concat,NOW,in,and,group_concat,ifnull,sum,AND,round,now,CJ_CMP_CLOUD_ACCOUNT,VALUES
#### getByProvider
```

        select
        vm.LDC_TYPE as type,
        vm.CLOUD_ACCOUNT_ID as id,
        group_concat(distinct ca.NAME) as poolName,
        group_concat(distinct sa.NAME) as serviceAccountName
        from CJ_CMP_VM_DAY_REPORT vm
        left join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = vm.CLOUD_ACCOUNT_ID
        left join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID = vm.SERVICE_ACCOUNT_ID
        where STAT_TIME BETWEEN #{startTime} and #{endTime} and LDC_TYPE = #{provider} and
        vm.CLOUD_ACCOUNT_ID is not null
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>
        <if test="condition!=null">
            and ca.NAME = #{condition}
        </if>
        group BY vm.LDC_TYPE, vm.CLOUD_ACCOUNT_ID
        union
        select
        rel.TYPE as type,
        rel.CLOUD_ACCOUNT_ID as id,
        group_concat(distinct ca.NAME) as poolName,
        group_concat(distinct sa.NAME) as serviceAccountName
        from CJ_CMP_HOST_DAY_REPORT host
        left join CJ_CMP_HOST_REL_DAY_REPORT rel on host.ID = rel.HOST_ID and host.TYPE = rel.TYPE and host.STAT_TIME =
        rel.STAT_TIME
        left join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID = host.SERVICE_ACCOUNT_ID
        left join CJ_CMP_CLOUD_ACCOUNT ca on rel.CLOUD_ACCOUNT_ID = ca.ID
        where host.STAT_TIME BETWEEN #{startTime} and #{endTime} and host.TYPE = #{provider} and
        rel.CLOUD_ACCOUNT_ID is not null
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>
        <if test="condition!=null">
            and ca.NAME = #{condition}
        </if>
        group BY rel.TYPE, rel.CLOUD_ACCOUNT_ID
    
```
#### queryCloudAccountUsage
```

        select  ca.NAME,
                vm.ID as vmId,
                ca.DATACENTER_TYPE AS ldcType,
                ifnull( cap.VCPU_LIMIT, 0 ) AS vcpuLimit,
                ifnull( cap.MEMORY_LIMIT DIV 1024, 0 ) AS memoryLimit,
                ifnull( cap.STORAGE_LIMIT, 0 ) AS storageLimit,
                ifnull( vm.CPUS, 0 ) AS vcpu,
                ifnull( vm.MEMORY, 0 ) AS memory,
                ifnull( vol.DISK_SPACE, 0 ) DIV 1 AS STORAGE
        from CJ_CMP_CLOUD_ACCOUNT ca
            inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc ON ca.ID = cdc.CLOUD_ACCOUNT_ID AND cdc.IS_DELETED = 0
            inner join CJ_CMP_SERVICE_ACCOUNT sa on cdc.SERVICE_ACCOUNT_ID = sa.ID and sa.IS_DELETED = 0
            left join CJ_CMP_CLOUD_ACCOUNT_CAPACITY cap on cap.CLOUD_ACCOUNT_ID = ca.ID
            left join cj_cmp_vm_view vm
                   on vm.CLOUD_ACCOUNT_ID = ca.ID and vm.LDC_ID = cdc.LDC_ID
                   <if test="memberId != 0">and vm.MEMBER_ID = #{memberId}</if>
            left join CJ_CMP_VM_VOLUME vol on vol.SERVICE_ACCOUNT_ID = vm.SERVICE_ACCOUNT_ID and vol.VM_DEVICE_ID = vm.ID
                   and vol.IS_DELETED = 0
        where ca.IS_DELETED = 0
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>
        order by ca.NAME;
    
```
#### queryVMwareResUsageByCaId
```

        select sum(host.CPUS)                                                 as cpuSum,
               sum(host.CPU_USED)                                             as cpuUsed,
               sum(host.MEMORY_SUM) / 1024                                    as memorySum,
               sum(host.MEMORY_USED) / 1024                                   as memoryUsed,
               sum(host.DISK_SUM)                                             as localStorageSum,
               sum(host.DISK_USED)                                            as localStorageUsed,
               round((sum(host.CPU_USED) / sum(host.CPUS)) * 100, 2)          as cpuUsage,
               round((sum(host.MEMORY_USED) / sum(host.MEMORY_SUM)) * 100, 2) as memoryUsage,
               round((sum(host.DISK_USED) / sum(host.DISK_SUM)) * 100, 2)     as localStorageUsage
         FROM CJ_CMP_SERVICE_ACCOUNT sa
         INNER JOIN CJ_CMP_CLOUD_ACCOUNT_DC cdc
                    ON sa.ID = cdc.SERVICE_ACCOUNT_ID AND cdc.IS_DELETED = 0 AND sa.IS_DELETED = 0
         INNER JOIN CJ_CMP_CLOUD_ACCOUNT ca ON cdc.CLOUD_ACCOUNT_ID = ca.ID AND ca.IS_DELETED = 0
         inner join CJ_CMP_VMWARE_DC dc on dc.ID = cdc.LDC_ID and dc.SERVICE_ACCOUNT_ID = sa.ID
         inner join CJ_CMP_VMWARE_HOST host on host.LDC_ID = dc.ID
         where ca.ID = #{cloudAccountId} and ca.MEMBER_ID = #{memberId}
    
```
#### queryVMwareStorageUsageByCaId
```

        select sum(store.DISK_SUM)                                          as sharedStorageSum,
               sum(store.DISK_SUM - store.DISK_FREE)                        as sharedStorageUsed,
               sum(store.PROVISIONED)                                       as storageProvisioned,
               round((sum(store.DISK_SUM - store.DISK_FREE) / sum(store.DISK_SUM)) * 100, 2) as sharedStorageUsage
        FROM CJ_CMP_SERVICE_ACCOUNT sa
        INNER JOIN CJ_CMP_CLOUD_ACCOUNT_DC cdc
                    ON sa.ID = cdc.SERVICE_ACCOUNT_ID AND cdc.IS_DELETED = 0 AND sa.IS_DELETED = 0
        INNER JOIN CJ_CMP_CLOUD_ACCOUNT ca ON cdc.CLOUD_ACCOUNT_ID = ca.ID AND ca.IS_DELETED = 0
        inner join CJ_CMP_VMWARE_DC dc on dc.ID = cdc.LDC_ID and dc.SERVICE_ACCOUNT_ID = sa.ID
        inner join CJ_CMP_VMWARE_DATASTORE store on store.LDC_ID = dc.ID
        where ca.ID = #{cloudAccountId}
        and ca.MEMBER_ID = #{memberId}
    
```
#### queryFusionComputeResUsageByCaId
```

        select sum(clu.CPU_SUM)                                             as cpuSum,
               sum(clu.CPU_USED)                                            as cpuUsed,
               sum(clu.MEMORY_SUM) / 1024                                   as memorySum,
               sum(clu.MEMORY_USED) / 1024                                  as memoryUsed,
               round((sum(clu.CPU_USED) / sum(clu.CPU_SUM)) * 100, 2)       as cpuUsage,
               round((sum(clu.MEMORY_USED) / sum(clu.MEMORY_SUM)) * 100, 2) as memoryUsage
        FROM CJ_CMP_SERVICE_ACCOUNT sa
         INNER JOIN CJ_CMP_CLOUD_ACCOUNT_DC cdc
                    ON sa.ID = cdc.SERVICE_ACCOUNT_ID AND cdc.IS_DELETED = 0 AND sa.IS_DELETED = 0
         INNER JOIN CJ_CMP_CLOUD_ACCOUNT ca ON cdc.CLOUD_ACCOUNT_ID = ca.ID AND ca.IS_DELETED = 0
         inner join CJ_CMP_FUSION_COMPUTE_DC dc on dc.ID = cdc.LDC_ID and dc.SERVICE_ACCOUNT_ID = sa.ID
         inner join CJ_CMP_FUSION_COMPUTE_CLUSTER clu on clu.LDC_ID = dc.ID
         where ca.ID = #{cloudAccountId}
            and ca.MEMBER_ID = #{memberId}
    
```
#### queryFusionComputeStorageUsageByCaId
```

        select sum(store.CAPACITY_GB)                                             as sharedStorageSum,
               sum(store.USED_SIZE_GB)                                            as sharedStorageUsed,
               round((sum(store.USED_SIZE_GB) / sum(store.CAPACITY_GB)) * 100, 2) as sharedStorageUsage
        FROM CJ_CMP_SERVICE_ACCOUNT sa
                 INNER JOIN CJ_CMP_CLOUD_ACCOUNT_DC cdc
                            ON sa.ID = cdc.SERVICE_ACCOUNT_ID AND cdc.IS_DELETED = 0 AND sa.IS_DELETED = 0
                 INNER JOIN CJ_CMP_CLOUD_ACCOUNT ca ON cdc.CLOUD_ACCOUNT_ID = ca.ID AND ca.IS_DELETED = 0
                 inner join CJ_CMP_FUSION_COMPUTE_DC dc on dc.ID = cdc.LDC_ID and dc.SERVICE_ACCOUNT_ID = sa.ID
                 inner join CJ_CMP_FUSION_COMPUTE_DATASTORE store on store.LDC_ID = dc.ID
        where ca.ID = #{cloudAccountId}
        and ca.MEMBER_ID = #{memberId}
    
```
#### queryFusionCloudResUsageByCaId
```

        select sum(host.CPUS)                                                 as cpuSum,
               sum(host.CPU_USED)                                             as cpuUsed,
               sum(host.MEMORY_SUM) / 1024                                    as memorySum,
               sum(host.MEMORY_USED) / 1024                                   as memoryUsed,
               round((sum(host.CPU_USED) / sum(host.CPUS)) * 100, 2)          as cpuUsage,
               round((sum(host.MEMORY_USED) / sum(host.MEMORY_SUM)) * 100, 2) as memoryUsage
        FROM CJ_CMP_SERVICE_ACCOUNT sa
         inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc
                    ON sa.ID = cdc.SERVICE_ACCOUNT_ID AND cdc.IS_DELETED = 0 AND sa.IS_DELETED = 0
         inner join CJ_CMP_CLOUD_ACCOUNT ca ON cdc.CLOUD_ACCOUNT_ID = ca.ID AND ca.IS_DELETED = 0
         inner join CJ_CMP_FUSION_CLOUD_DC_X_AZ rel on rel.SERVICE_ACCOUNT_ID = sa.ID and rel.LDC_ID = cdc.LDC_ID
         left outer join CJ_CMP_FUSION_CLOUD_DC fdc on fdc.ID = rel.LDC_ID and fdc.IS_DELETED = 0 and
                                                       fdc.SERVICE_ACCOUNT_ID = rel.SERVICE_ACCOUNT_ID
         left outer join CJ_CMP_CLOUD_AZ az on rel.AZ_ID = az.ID and az.LDC_TYPE = cdc.LDC_TYPE and az.IS_DELETED = 0
         left outer join CJ_CMP_FUSION_CLOUD_HOST host on host.ZONE_ID = az.ID
        where ca.ID = #{cloudAccountId}
        and ca.MEMBER_ID = #{memberId}
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_CLOUD_ACCOUNT_CAPACITY.xml
> sql统计:复杂19个，简单33个
>
> 使用的关键字：VALUES,sum,ifnull,count,in,now,CJ_CMP_CLOUD_ACCOUNT_CAPACITY
#### sumAliyunCapacityByLdcIds
```

        select sum(ifnull(ecs.CPUS,0)) as vcpu,sum(ifnull(ecs.MEMORY,0)) as memory,count(*) as vmInstance
        from CJ_CMP_ALIYUN_DC dc inner join CJ_CMP_ALIYUN_ECS ecs on ecs.LDC_ID=dc.ID
        where ecs.IS_DELETED=0 and dc.IS_DELETED=0 and ecs.ENTITY_ID is not null
        <if test="memberId != 0">AND ecs.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
             and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumVmwareCapacityByLdcIds
```

        select sum(ifnull(vm.CPUS,0)) as vcpu,sum(ifnull(vm.MEMORY,0)) as memory,count(*) as vmInstance
        from CJ_CMP_VMWARE_DC dc inner join CJ_CMP_VMWARE_VM vm on vm.LDC_ID=dc.ID
        where vm.IS_DELETED=0 AND vm.IS_RECYCLED = 0 and vm.ENTITY_ID is not null
        <if test="memberId != 0">AND vm.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size != 0">
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumFusionCloudCapacityByLdcIds
```

        select sum(ifnull(ecs.CPUS,0)) as vcpu,sum(ifnull(ecs.MEMORY,0)) as memory,count(*) as vmInstance
        from CJ_CMP_FUSION_CLOUD_DC dc inner join CJ_CMP_FUSION_CLOUD_ECS ecs on ecs.LDC_ID=dc.ID
        where ecs.IS_DELETED=0 and ecs.IS_RECYCLED = 0 and dc.IS_DELETED=0 AND ecs.ENTITY_ID is not null
        <if test="memberId != 0">AND ecs.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumCloudosCapacityByLdcIds
```

        select sum(ifnull(ecs.CPUS,0)) as vcpu,sum(ifnull(ecs.MEMORY,0)) as memory,count(*) as vmInstance
        from CJ_CMP_CLOUDOS_DC dc inner join CJ_CMP_CLOUDOS_VM ecs on ecs.LDC_ID=dc.ID
        where ecs.IS_DELETED=0 and ecs.IS_RECYCLED = 0 and dc.IS_DELETED=0 and ecs.ENTITY_ID is not null
        <if test="memberId != 0">AND ecs.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumQingCloudCapacityByLdcIds
```

        select sum(ifnull(vm.CPUS,0)) as vcpu,sum(ifnull(vm.MEMORY,0)) as memory,count(*) as vmInstance
        from CJ_CMDB_CI_QINGCLOUD_DATACENTER dc inner join CJ_CMDB_CI_QINGCLOUD_VM_INSTANCE vm on vm.LDC_ID=dc.ID
        where vm.IS_DELETED=0 and vm.IS_RECYCLED = 0 and dc.IS_DELETED=0 and vm.ENTITY_ID is not null
        <if test="memberId != 0">AND vm.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumQingCloudEcsVolumeByLdcIds
```

        select sum(ifnull(vol.DISK_SPACE,0))
        from CJ_CMDB_CI_QINGCLOUD_DATACENTER dc inner join CJ_CMDB_CI_QINGCLOUD_VM_INSTANCE vm on vm.LDC_ID=dc.ID and vm.IS_DELETED=0
        inner join CJ_CMP_VM_VOLUME vol on vol.VM_DEVICE_ID=vm.ID and vol.SERVICE_ACCOUNT_ID=dc.SERVICE_ACCOUNT_ID
        where vol.IS_DELETED=0
          AND vm.IS_RECYCLED = 0
        <if test="memberId != 0">AND vol.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumFusionAccessCapacityByLdcIds
```

        select sum(ifnull(vm.CPUS,0)) as vcpu,sum(ifnull(vm.MEMORY,0)) as memory,count(*) as vmInstance
        from CJ_CMP_FUSION_ACCESS_DC dc inner join CJ_CMP_FUSION_ACCESS_VM_INSTANCE vm on vm.LDC_ID=dc.ID
        where vm.IS_DELETED=0 and dc.IS_DELETED=0 and vm.ENTITY_ID is not null
        <if test="memberId != 0">AND vm.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumFusionComputeCapacityByLdcIds
```

        select sum(ifnull(vm.CPUS,0)) as vcpu,sum(ifnull(vm.MEMORY,0)) as memory,count(*) as vmInstance
        from CJ_CMP_FUSION_COMPUTE_DC dc inner join CJ_CMP_FUSION_COMPUTE_VM vm on vm.LDC_ID=dc.ID
        where vm.IS_DELETED=0 and dc.IS_DELETED=0 and vm.ENTITY_ID is not null and vm.IS_RECYCLED = 0
        <if test="memberId != 0">AND vm.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumFusionAccessEcsVolumeByLdcIds
```

        select sum(ifnull(vol.DISK_SPACE,0))
        from CJ_CMP_FUSION_ACCESS_DC dc inner join CJ_CMP_FUSION_ACCESS_VM_INSTANCE vm on vm.LDC_ID=dc.ID and vm.IS_DELETED=0
        inner join CJ_CMP_VM_VOLUME vol on vol.VM_DEVICE_ID=vm.ID and vol.SERVICE_ACCOUNT_ID=dc.SERVICE_ACCOUNT_ID
        where vol.IS_DELETED=0
        <if test="memberId != 0">AND vol.MEMBER_ID =#{memberId}</if>
        <if test="memberId != 0">AND vm.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumFusionComputeEcsVolumeByLdcIds
```

        select sum(ifnull(vol.DISK_SPACE,0))
        from CJ_CMP_FUSION_COMPUTE_DC dc inner join CJ_CMP_FUSION_COMPUTE_VM vm on vm.LDC_ID=dc.ID and vm.IS_DELETED=0
        inner join CJ_CMP_VM_VOLUME vol on vol.VM_DEVICE_ID=vm.ID and vol.SERVICE_ACCOUNT_ID=dc.SERVICE_ACCOUNT_ID
        where vol.IS_DELETED=0 and vm.IS_RECYCLED = 0
        <if test="memberId != 0">AND vol.MEMBER_ID =#{memberId}</if>
        <if test="memberId != 0">AND vm.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumAliyunEcsVolumeByLdcIds
```

        select sum(ifnull(vol.DISK_SPACE,0))
        from CJ_CMP_ALIYUN_DC dc inner join CJ_CMP_ALIYUN_ECS ecs on ecs.LDC_ID=dc.ID and ecs.IS_DELETED=0
        inner join CJ_CMP_VM_VOLUME vol on vol.VM_DEVICE_ID=ecs.ID and vol.SERVICE_ACCOUNT_ID=dc.SERVICE_ACCOUNT_ID
        where vol.IS_DELETED=0
        <if test="memberId != 0">AND vol.MEMBER_ID =#{memberId}</if>
        <if test="memberId != 0">AND ecs.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
             and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumVmwareVmVolumeByLdcIds
```

        select sum(ifnull(vol.DISK_SPACE,0))
        from CJ_CMP_VMWARE_DC dc
        inner join CJ_CMP_VMWARE_VM vm on vm.LDC_ID=dc.ID and dc.IS_DELETED=0 and vm.IS_DELETED=0
        inner join CJ_CMP_VM_VOLUME vol on vol.VM_DEVICE_ID=vm.ID and vol.SERVICE_ACCOUNT_ID=dc.SERVICE_ACCOUNT_ID
        where vol.IS_DELETED=0
        AND vm.IS_RECYCLED = 0
        <if test="memberId != 0">AND vol.MEMBER_ID =#{memberId}</if>
        <if test="memberId != 0">AND vm.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size != 0">
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumFusionCloudEcsVolumeByLdcIds
```

        select sum(ifnull(vol.DISK_SPACE,0))
        from CJ_CMP_FUSION_CLOUD_DC dc inner join CJ_CMP_FUSION_CLOUD_ECS ecs on ecs.LDC_ID=dc.ID and ecs.IS_DELETED=0
        inner join CJ_CMP_VM_VOLUME vol on vol.VM_DEVICE_ID=ecs.ID and vol.SERVICE_ACCOUNT_ID=dc.SERVICE_ACCOUNT_ID
        where vol.IS_DELETED=0
          AND ecs.IS_RECYCLED = 0
        <if test="memberId != 0">AND vol.MEMBER_ID =#{memberId}</if>
        <if test="memberId != 0">AND ecs.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumCloudosEcsVolumeByLdcIds
```

        select sum(ifnull(vol.DISK_SPACE,0))
        from CJ_CMP_CLOUDOS_DC dc inner join CJ_CMP_CLOUDOS_VM ecs on ecs.LDC_ID=dc.ID and ecs.IS_DELETED=0
        inner join CJ_CMP_VM_VOLUME vol on vol.VM_DEVICE_ID=ecs.ID and vol.SERVICE_ACCOUNT_ID=dc.SERVICE_ACCOUNT_ID
        where vol.IS_DELETED=0
          AND ecs.IS_RECYCLED = 0
        <if test="memberId != 0">AND vol.MEMBER_ID =#{memberId}</if>
        <if test="memberId != 0">AND ecs.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumOracleOvmCapacityByLdcIds
```

        select sum(ifnull(vm.CPUS,0)) as vcpu,sum(ifnull(vm.MEMORY,0)) as memory,count(*) as vmInstance
        from CJ_CMP_ORACLE_OVM_DC dc inner join CJ_CMP_ORACLE_OVM_VM vm on vm.LDC_ID=dc.ID
        where vm.IS_DELETED=0 and dc.IS_DELETED=0 and vm.ENTITY_ID is not null
        <if test="memberId != 0">AND vm.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumTencentCapacityByLdcIds
```

        select sum(ifnull(cvm.CPU,0)) as vcpu,sum(ifnull(cvm.MEMORY_MB,0)) as memory,count(*) as vmInstance
        from CJ_CMP_TENCENT_DC dc inner join CJ_CMP_TENCENT_CVM cvm on cvm.LDC_ID=dc.ID
        where cvm.IS_DELETED=0 and dc.IS_DELETED=0 and cvm.ENTITY_ID is not null
        <if test="memberId != 0">AND cvm.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumTencentCvmVolumeByLdcIds
```

        select sum(ifnull(vol.DISK_SPACE,0))
        from CJ_CMP_TENCENT_DC dc inner join CJ_CMP_TENCENT_CVM cvm on cvm.LDC_ID=dc.ID and cvm.IS_DELETED=0
        inner join CJ_CMP_VM_VOLUME vol on vol.VM_DEVICE_ID=cvm.ID and vol.SERVICE_ACCOUNT_ID=dc.SERVICE_ACCOUNT_ID
        where vol.IS_DELETED=0
        <if test="memberId != 0">AND vol.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumCASCapacityByLdcIds
```

        select
            sum(ifnull(vm.CPU, 0)) as vcpu,
            sum(ifnull(vm.MEMORY, 0)) as memory,
            count(*) as vmInstance
        from
            CJ_CMP_CAS_VM vm
            left join CJ_CMP_CAS_DC ldc ON ldc.ID = vm.LDC_ID
            left join CJ_CMP_CLOUD_ACCOUNT_DC cdc ON cdc.LDC_ID = ldc.ID
            left join CJ_CMP_CLOUD_ACCOUNT ca ON ca.ID = cdc.CLOUD_ACCOUNT_ID
        where
            vm.IS_DELETED = 0
            and ldc.IS_DELETED = 0
            and cdc.SERVICE_ACCOUNT_ID = ldc.SERVICE_ACCOUNT_ID
            and cdc.IS_DELETED = 0
            and ca.IS_DELETED = 0
            and vm.IS_RECYCLED = 0
            AND vm.ENTITY_ID is not null
            <if test="memberId != 0">AND ca.MEMBER_ID =#{memberId}</if>
            <if test="ldcIds != null and ldcIds.size >0" >
                and ldc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
            </if>
    
```
#### sumCASEcsVolumeByLdcIds
```

        select
               sum(ifnull(vol.DISK_SPACE,0))
        from CJ_CMP_CAS_DC dc inner join CJ_CMP_CAS_VM ecs on ecs.LDC_ID=dc.ID
                                                                  and ecs.IS_DELETED=0
        inner join CJ_CMP_VM_VOLUME vol on vol.VM_DEVICE_ID=ecs.ID
                                               and vol.SERVICE_ACCOUNT_ID=dc.SERVICE_ACCOUNT_ID
        where vol.IS_DELETED=0
          AND ecs.IS_RECYCLED = 0
        <if test="memberId != 0">AND vol.MEMBER_ID =#{memberId}</if>
        <if test="memberId != 0">AND ecs.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_CLOUD_ACCOUNT_DC.xml
> sql统计:复杂1个，简单31个
>
> 使用的关键字：if,concat,and,now,CJ_CMP_CLOUD_ACCOUNT_DC,VALUES,on
#### getDcList
```

        <choose>
            <when test="ldcType != null and ldcType == 'fusionCloud'">
                select if(sa.PARENT_ID is null, sa.ID, sa.PARENT_ID) AS serviceAccountId, if(parentSa.NAME is not null, parentSa.NAME, sa.NAME) AS serviceAccountName, ca.ID as cloudAccountId,ca.NAME as cloudAccountName,
                dc.ID as ldcId, if(vdc.NAME is null, dc.NAME, concat(dc.NAME, '(', vdc.NAME, ')')) as ldcName, dc.ENTITY_ID as ldcEntityId,dc.LAST_DISCOVERED as lastDiscovered
                from CJ_CMP_SERVICE_ACCOUNT sa
                left join CJ_CMP_SERVICE_ACCOUNT parentSa on parentSa.ID = sa.PARENT_ID and parentSa.IS_DELETED = 0
                inner join CJ_CMP_DC_VIEW dc on dc.SERVICE_ACCOUNT_ID = sa.ID
                left join CJ_CMP_CLOUD_ACCOUNT_DC cdc on cdc.LDC_ID = dc.ID and cdc.LDC_TYPE = dc.LDC_TYPE and cdc.IS_DELETED=0
                left join CJ_CMP_FUSION_CLOUD_VDC vdc on dc.VDC_ID = vdc.ID and vdc.IS_DELETED = 0
                left join CJ_CMP_CLOUD_ACCOUNT ca on cdc.CLOUD_ACCOUNT_ID=ca.ID and ca.IS_DELETED=0
            </when>
            <when test="ldcType != null and ldcType == 'huaweiObs'">
                select sa.ID AS serviceAccountId, sa.NAME AS serviceAccountName, ca.ID as cloudAccountId,ca.NAME as cloudAccountName,
                cdc.LDC_ID as ldcId,'-' as ldcName, '-' as ldcEntityId,cdc.CREATE_DATE as lastDiscovered
                from CJ_CMP_SERVICE_ACCOUNT sa
                inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc on cdc.SERVICE_ACCOUNT_ID=sa.ID and cdc.IS_DELETED=0 and sa.DATACENTER_TYPE='huaweiObs'
                left outer join CJ_CMP_CLOUD_ACCOUNT ca on cdc.CLOUD_ACCOUNT_ID=ca.ID and ca.IS_DELETED=0
            </when>
            <otherwise>
                select sa.ID AS serviceAccountId, sa.NAME AS serviceAccountName, ca.ID as cloudAccountId,ca.NAME as cloudAccountName,
                dc.ID as ldcId,dc.NAME as ldcName, dc.ENTITY_ID as ldcEntityId,dc.LAST_DISCOVERED as lastDiscovered
                from CJ_CMP_SERVICE_ACCOUNT sa
                inner join CJ_CMP_DC_VIEW dc on dc.SERVICE_ACCOUNT_ID=sa.ID and sa.IS_DELETED=0
                left outer join CJ_CMP_CLOUD_ACCOUNT_DC cdc on cdc.SERVICE_ACCOUNT_ID=sa.ID and cdc.IS_DELETED=0 and cdc.LDC_ID=dc.ID
                left outer join CJ_CMP_CLOUD_ACCOUNT ca on cdc.CLOUD_ACCOUNT_ID=ca.ID and ca.IS_DELETED=0
            </otherwise>
        </choose>
        <where>
        <if test="ids != null and ids.size > 0 ">
            and (sa.ID in <foreach collection="ids" item="id" open="(" close=")" separator=",">#{id}</foreach>
            or sa.PARENT_ID in <foreach collection="ids" item="id" open="(" close=")" separator=",">#{id}</foreach>)
        </if>
        <if test="cloudAccountId != null and cloudAccountId != ''"> and ca.ID=#{cloudAccountId}</if>
        <if test="vdcId != null and vdcId != ''"> and dc.VDC_ID=#{vdcId}</if>
        </where>
        order by serviceAccountName, ldcName
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_CLOUD_ACCOUNT_DISCOVERY.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：now,CJ_CMP_CLOUD_ACCOUNT_DISCOVERY,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_CLOUD_AZ.xml
> sql统计:复杂2个，简单13个
>
> 使用的关键字：size,GROUP_CONCAT,sum,now,NOW,VALUES,COALESCE,and,round,if,concat,in,CJ_CMP_CLOUD_AZ
#### queryAz
```

        select distinct az.ID, az.NAME, az.ENTITY_ID, az.SHORT_DESCRIPTION,
        null,
        cdc.LDC_TYPE,
        COALESCE(alidc.ENTITY_ID, sdc.ENTITY_ID, qdc.ENTITY_ID, tdc.ENTITY_ID) as ldcEntityId,
        COALESCE(alidc.NAME, sdc.NAME, qdc.NAME,tdc.NAME) as ldcName,
        sa.NAME      as serviceAccountName,
        sa.ID        as serviceAccountId,
        null as cpuSum,
        null as cpuUsed,
        null as memorySum,
        null as memoryUsed,
        null as cpuUsage,
        null as memoryUsage
        from CJ_CMP_SERVICE_ACCOUNT sa
        inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc on sa.ID = cdc.SERVICE_ACCOUNT_ID and sa.IS_DELETED = 0 and cdc.IS_DELETED = 0 and sa.DATACENTER_TYPE != 'fusionCloud'
        inner join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED = 0
        left outer join CJ_CMP_ALIYUN_DC alidc on cdc.LDC_ID = alidc.ID and alidc.IS_DELETED = 0 and alidc.SERVICE_ACCOUNT_ID=sa.ID
        left outer join CJ_CMP_TENCENT_DC tdc on cdc.LDC_ID = tdc.ID and tdc.IS_DELETED = 0 and tdc.SERVICE_ACCOUNT_ID=sa.ID
        left outer join CJ_CMP_CLOUDOS_DC sdc on sdc.ID = cdc.LDC_ID and sdc.IS_DELETED = 0 and sdc.SERVICE_ACCOUNT_ID=sa.ID
        left outer join CJ_CMDB_CI_QINGCLOUD_DATACENTER qdc on qdc.ID = cdc.LDC_ID and qdc.IS_DELETED = 0 and qdc.SERVICE_ACCOUNT_ID=sa.ID
        inner join CJ_CMP_CLOUD_AZ az on cdc.LDC_ID = az.LDC_ID and az.LDC_TYPE = cdc.LDC_TYPE and az.IS_DELETED = 0
        where az.IS_DELETED=0
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>
        <if test="azId != null and azId != ''"> and az.ID=#{azId}</if>
        <if test="serviceAccountId != null and serviceAccountId != ''"> and sa.ID=#{serviceAccountId}</if>
        <if test="cloudAccountId != null and cloudAccountId != ''"> and ca.ID=#{cloudAccountId}</if>
        <if test="ldcId != null and ldcId != ''"> and cdc.LDC_ID=#{ldcId}</if>
        <if test="ldcType != null and ldcType != ''"> and cdc.LDC_TYPE=#{ldcType}</if>
        <if test="searchKey != null and searchKey != ''"> and (az.NAME like #{searchKey} or az.ENTITY_ID like #{searchKey})</if>
        <if test="name != null and name != ''"> and az.NAME like #{name}</if>
        <if test="ldcIds != null and ldcIds.size()>0">
           and cdc.LDC_ID IN <foreach collection="ldcIds" item="ldc" open="(" separator="," close=")"> #{ldc} </foreach>
        </if>
        union all
        select az.ID, az.NAME, az.ENTITY_ID, az.SHORT_DESCRIPTION,
        null,
        cdc.LDC_TYPE,
        GROUP_CONCAT(distinct fdc.ENTITY_ID) as ldcEntityId,
        GROUP_CONCAT(distinct fdc.NAME) as ldcName,
        sa.NAME      as serviceAccountName,
        sa.ID        as serviceAccountId,
        sum(host.CPUS)                                as cpuSum,
        sum(host.CPU_USED)                            as cpuUsed,
        sum(host.MEMORY_SUM) / 1024                   as memorySum,
        sum(host.MEMORY_USED) / 1024                  as memoryUsed,
        round((sum(host.CPU_USED) / sum(host.CPUS)) * 100 , 2) as cpuUsage,
        round((sum(host.MEMORY_USED) / sum(host.MEMORY_SUM)) * 100, 2)  as memoryUsage
        from CJ_CMP_SERVICE_ACCOUNT sa
        inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc on sa.ID = cdc.SERVICE_ACCOUNT_ID and sa.IS_DELETED = 0 and cdc.IS_DELETED = 0
        inner join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED = 0 and cdc.LDC_TYPE='fusionCloud'
        inner join CJ_CMP_FUSION_CLOUD_DC fdc on fdc.ID = cdc.LDC_ID and fdc.IS_DELETED = 0
        inner join CJ_CMP_FUSION_CLOUD_DC_X_AZ rel on rel.LDC_ID = fdc.ID
        left outer join CJ_CMP_CLOUD_AZ az on rel.AZ_ID = az.ID and az.LDC_TYPE ='fusionCloud' and az.IS_DELETED = 0
        left outer join CJ_CMP_FUSION_CLOUD_HOST host on host.ZONE_ID = az.ID
        where az.IS_DELETED=0
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>
        <if test="azId != null and azId != ''"> and az.ID=#{azId}</if>
        <if test="serviceAccountId != null and serviceAccountId != ''"> and sa.ID=#{serviceAccountId}</if>
        <if test="cloudAccountId != null and cloudAccountId != ''"> and ca.ID=#{cloudAccountId}</if>
        <if test="ldcId != null and ldcId != ''"> and cdc.LDC_ID=#{ldcId}</if>
        <if test="ldcType != null and ldcType != ''"> and cdc.LDC_TYPE=#{ldcType}</if>
        <if test="searchKey != null and searchKey != ''"> and (az.NAME like #{searchKey} or az.ENTITY_ID like #{searchKey})</if>
        <if test="name != null and name != ''"> and az.NAME like #{name}</if>
        <if test="ldcIds != null and ldcIds.size()>0">
           and cdc.LDC_ID IN <foreach collection="ldcIds" item="ldc" open="(" separator="," close=")"> #{ldc} </foreach>
        </if>
        group by az.ID, sa.ID
        <if test="sortField != null and sortField!= '' and sortType != null and sortType!= '' ">
            <choose>
                <when test="sortField == 'cpuUsage' or sortField == 'memoryUsage' or sortField == 'localStorageUsage'">
                    ORDER BY ${sortField} ${sortType}
                </when>
                <otherwise>
                    order by NAME
                </otherwise>
            </choose>
        </if>
        <if test="sortField == null or sortType == null ">
            order by NAME
        </if>
    
```
#### queryFusionCloudRegionAz
```

        select az.ID,
        az.NAME,
        az.ENTITY_ID,az.CPU_ARCH,az.TYPE,
        cdc.LDC_ID,
        cdc.LDC_TYPE,
        dc.ENTITY_ID as ldcEntityId,
        if(vdc.NAME is null, dc.NAME, concat(dc.NAME, '(', vdc.NAME, ')')) as ldcName,
        sa.NAME      as serviceAccountName,
        sa.ID        as serviceAccountId
        from CJ_CMP_SERVICE_ACCOUNT sa
        inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc on sa.ID = cdc.SERVICE_ACCOUNT_ID and sa.IS_DELETED = 0 and cdc.IS_DELETED = 0
        inner join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED = 0 and cdc.LDC_TYPE='fusionCLoud'
        left join CJ_CMP_FUSION_CLOUD_DC dc on cdc.LDC_ID = dc.ID and dc.IS_DELETED = 0
        left join CJ_CMP_FUSION_CLOUD_VDC vdc on dc.VDC_ID = vdc.ID and vdc.IS_DELETED = 0
        inner join CJ_CMP_FUSION_CLOUD_DC_X_AZ rel on rel.LDC_ID = cdc.LDC_ID
        inner join CJ_CMP_CLOUD_AZ az on rel.AZ_ID=az.ID
        where dc.IS_DELETED=0 and cdc.CLOUD_ACCOUNT_ID=#{cloudAccountId} and az.NAME != 'manage-az'
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>
        <if test="azNotNull != null and azNotNull"> and az.ID is not null</if>
        order by dc.NAME,az.NAME
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_CLOUD_AZ_GROUP.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：CONCAT,NOW,CJ_CMP_CLOUD_AZ_GROUP,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_CLOUD_AZ_GROUP_MANAGE.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：NOW,CJ_CMP_CLOUD_AZ_GROUP_MANAGE,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_CLUSTER_AZ_VIEW.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_DATASTORE_DAY_REPORT.xml
> sql统计:复杂2个，简单2个
>
> 使用的关键字：and,CJ_CMP_DATASTORE_DAY_REPORT,values,ifnull,sum,in,DATE,DATE_FORMAT,FROM
#### groupBySaAndTime
```

        SELECT
        ifnull(sum(store.DISK_SUM), 0)           AS num,
        DATE_FORMAT(store.STAT_TIME, #{dateFormat}) AS days
        FROM (SELECT
        report.DISK_SUM,
        report.STAT_TIME,
        report.PROVIDER,
        report.ID,
        report.SERVICE_ACCOUNT_ID
        FROM CJ_CMP_DATASTORE_DAY_REPORT report
        inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc on report.LDC_ID = cdc.LDC_ID and report.SERVICE_ACCOUNT_ID = cdc.SERVICE_ACCOUNT_ID and cdc.IS_DELETED = 0
        inner join CJ_CMP_CLOUD_ACCOUNT ca on cdc.CLOUD_ACCOUNT_ID = ca.ID and ca.IS_DELETED = 0
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>
        WHERE report.SERVICE_ACCOUNT_ID in (select ID from CJ_CMP_SERVICE_ACCOUNT where IS_DELETED = 0)
        GROUP BY STAT_TIME, PROVIDER, ID, SERVICE_ACCOUNT_ID) store
        <where>
            <if test="serviceAccountId != null and serviceAccountId != ''">
               and store.SERVICE_ACCOUNT_ID = #{serviceAccountId}
            </if>
            <if test="provider != null and provider != ''">
                and store.PROVIDER=#{provider}
            </if>
            <if test="startTime != null and endTime != null ">
                and (store.STAT_TIME &gt;= DATE(#{startTime}) AND store.STAT_TIME &lt;= DATE(#{endTime}))
            </if>
        </where>
        GROUP BY days
        ORDER BY days asc
    
```
#### getTotalBySaAndTime
```

        SELECT
            ifnull(sum( DISK_SUM ),0) as num
        FROM
        CJ_CMP_DATASTORE_DAY_REPORT report
        INNER JOIN CJ_CMP_SERVICE_ACCOUNT sa ON sa.ID = report.SERVICE_ACCOUNT_ID
        INNER JOIN CJ_CMP_CLOUD_ACCOUNT_DC cdc on report.LDC_ID = cdc.LDC_ID and report.SERVICE_ACCOUNT_ID = cdc.SERVICE_ACCOUNT_ID and cdc.IS_DELETED = 0
        INNER JOIN CJ_CMP_CLOUD_ACCOUNT ca on cdc.CLOUD_ACCOUNT_ID = ca.ID and ca.IS_DELETED = 0
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>
        AND sa.IS_DELETED = 0
        WHERE
        STAT_TIME = DATE(#{statTime})
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_DAY_REPORT.xml
> sql统计:复杂1个，简单15个
>
> 使用的关键字：CJ_CMP_KUBERNETES_DAEMON_SET_DAY_REPORT,in,CJ_CMP_FUSION_CCE_CLUSTER_DAY_REPORT,CJ_CMP_KUBERNETES_DEPLOYMENT_DAY_REPORT,CJ_CMP_KUBERNETES_NODE_DAY_REPORT,CJ_CMP_FUSION_CLOUD_DC_X_AZ_DAY_REPORT,CJ_CMP_PROJECT_DAY_REPORT,CJ_CMP_APP_SYSTEM_DAY_REPORT,CJ_CMP_SERVICE_ACCOUNT_DAY_REPORT,CJ_CMP_PM_DAY_REPORT,CJ_CMDB_CI_TKE_CLUSTER_DAY_REPORT,CJ_CMP_KUBERNETES_STATEFUL_SET_DAY_REPORT,join,ifnull,CJ_CMP_CLOUD_AZ_DAY_REPORT,CJ_CMP_LDC_DAY_REPORT,CJ_CMP_VM_DAY_REPORT,sum,CJ_CMP_CLOUD_ACCOUNT_DAY_REPORT
#### batchInsertVmDayReport
```

        INSERT INTO CJ_CMP_VM_DAY_REPORT (STAT_TIME, VM_ID, MEMBER_ID, CPUS, DUE, IP, SPEC_ID, MANAGED_BY, MEMORY, DISK_SUM, NAME, PROJECT_ID, APP_SYSTEM_ID, APP_SUB_SYSTEM_ID, APP_DU_ID, SERVICE_ACCOUNT_ID, OWNED_BY, SN, INSTALL_STATUS, ENTITY_ID, OS, OS_FAMILY, HOST_ID, RUN_STATUS, HOSTNAME, CLOUD_ACCOUNT_ID, CLOUD_ACCOUNT_NAME, LDC_TYPE, LDC_ID, LDC_NAME, LDC_ENTITY_ID, CLUSTER_NAME, CLUSTER_ENTITY_ID, ZONE_NAME, ZONE_ENTITY_ID, IMAGE_NAME, IMAGE_ENTITY_ID, HOST_ENTITY_NAME, HOST_ENTITY_ID, HOST_IP, SPEC_ENTITY_ID, SPEC_NAME, TYPE, CREATE_BY, CREATE_DATE, LAST_MODIFIED_BY, LAST_MODIFIED_DATE)
          select #{statTime},ID, MEMBER_ID, CPUS, DUE, IP, SPEC_ID, MANAGED_BY, MEMORY,vol.DISK_SUM ,NAME, PROJECT_ID, APP_SYSTEM_ID, APP_SUB_SYSTEM_ID, APP_DU_ID, SERVICE_ACCOUNT_ID, OWNED_BY, SN, INSTALL_STATUS, ENTITY_ID, OS, OS_FAMILY, HOST_ID, RUN_STATUS, HOSTNAME, CLOUD_ACCOUNT_ID, CLOUD_ACCOUNT_NAME, LDC_TYPE, LDC_ID, LDC_NAME, LDC_ENTITY_ID, CLUSTER_NAME, CLUSTER_ENTITY_ID, ZONE_NAME, ZONE_ENTITY_ID, IMAGE_NAME, IMAGE_ENTITY_ID, HOST_ENTITY_NAME, HOST_ENTITY_ID, HOST_IP, SPEC_ENTITY_ID, SPEC_NAME, TYPE, null, CREATE_DATE, null, LAST_MODIFIED_DATE from cj_cmp_vm_view vm left outer join (select SERVICE_ACCOUNT_ID as saId,VM_DEVICE_ID as vmId,sum(ifnull(DISK_SPACE,0)) DISK_SUM from CJ_CMP_VM_VOLUME where IS_DELETED=0 group by SERVICE_ACCOUNT_ID,VM_DEVICE_ID) vol on vol.saId=SERVICE_ACCOUNT_ID and vol.vmId=vm.ID;
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_DC_VIEW.xml
> sql统计:复杂1个，简单4个
>
> 使用的关键字：AND,if,concat
#### getDataCenterByServiceAccountId
```

        select dc.ID, if(vdc.NAME is null, dc.NAME, concat(dc.NAME, '(', vdc.NAME, ')')) as NAME, dc.SERVICE_ACCOUNT_ID, dc.ENTITY_ID,
               account.ID AS CLOUD_ACCOUNT_DC_ID, account.CLOUD_ACCOUNT_ID,dc.ID as LDC_ID, sa.DATACENTER_TYPE as LDC_TYPE
        from CJ_CMP_DC_VIEW dc inner join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID=dc.SERVICE_ACCOUNT_ID and sa.IS_DELETED=0
        left join CJ_CMP_FUSION_CLOUD_VDC vdc on dc.VDC_ID = vdc.ID and vdc.IS_DELETED = 0
        left outer join CJ_CMP_CLOUD_ACCOUNT_DC account ON dc.ID = account.LDC_ID and sa.ID=account.SERVICE_ACCOUNT_ID and account.IS_DELETED=0
        WHERE sa.DATACENTER_TYPE  =#{dcType} AND (sa.ID =#{serviceAccountId} or sa.PARENT_ID = #{serviceAccountId})
        <if test="cloudAccountId!='' and cloudAccountId != null">
            AND account.CLOUD_ACCOUNT_ID = #{cloudAccountId}
        </if>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_DEV_X_NETWORK.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_ENV_BACKUP_INFO.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：CJ_CMP_ENV_BACKUP_INFO,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_ENV_BACKUP_RECORD.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：now,CJ_CMP_ENV_BACKUP_RECORD,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_F5_DEVICE.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：CONCAT,now,NOW,CJ_CMP_F5_DEVICE,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_F5_DEVICE_GROUP.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：NOW,CJ_CMP_F5_DEVICE_GROUP,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_F5_MONITOR.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：CJ_CMP_F5_MONITOR,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_F5_NODE.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：now,NOW,CJ_CMP_F5_NODE,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_F5_PARTITION.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：now,NOW,CJ_CMP_F5_PARTITION,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_F5_POOL.xml
> sql统计:复杂1个，简单6个
>
> 使用的关键字：CJ_CMP_F5_POOL,values,where,in,group_concat,now,NOW
#### queryList
```

        select pool.*, sa.DATACENTER_TYPE as serviceAccountType ,part.NAME as partitionName, device.NAME as deviceName, group_concat(deviceGroup.NAME) as deviceGroupName
        from CJ_CMP_F5_POOL pool LEFT JOIN CJ_CMP_F5_PARTITION part on pool.PARTITION_ID = part.ID AND pool.SERVICE_ACCOUNT_ID = part.SERVICE_ACCOUNT_ID and part.IS_DELETED = 0
        and pool.MEMBER_ID = part.MEMBER_ID
        inner join CJ_CMP_F5_DEVICE device on pool.DEVICE_ID = device.ID
        inner join CJ_CMP_SERVICE_ACCOUNT sa on pool.SERVICE_ACCOUNT_ID = sa.ID
        left join CJ_CMP_F5_DEVICE_GROUP_X_DEVICE rel on pool.DEVICE_ID = rel.DEVICE_ID
        left join CJ_CMP_F5_DEVICE_GROUP deviceGroup on rel.DEVICE_GROUP_ID = deviceGroup.ID
        WHERE pool.IS_DELETED = 0
        <if test="id != null and id !=''">
            and  pool.ID =#{id}
        </if>
        <if test="serviceAccountId != null and serviceAccountId !=''">
            and  pool.SERVICE_ACCOUNT_ID =#{serviceAccountId}
        </if>
        <if test="deviceId != null and deviceId !=''">
            and  pool.DEVICE_ID =#{deviceId}
        </if>
        <if test="partitionId != null and partitionId !=''">
            and  pool.PARTITION_ID =#{partitionId}
        </if>
        group by pool.ID, part.NAME, device.NAME
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_F5_POOL_MEMBER.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CMP_F5_POOL_MEMBER,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_F5_PROFILE.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：CJ_CMP_F5_PROFILE,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_F5_SNAT_POOL.xml
> sql统计:复杂1个，简单6个
>
> 使用的关键字：group_concat,now,CJ_CMP_F5_SNAT_POOL,values
#### list
```

    select pool.*, part.NAME as partitionName, device.NAME as deviceName, group_concat(deviceGroup.NAME) as deviceGroupName from CJ_CMP_F5_SNAT_POOL pool
      left join CJ_CMP_F5_PARTITION part on pool.PARTITION_ID = part.ID
      inner join CJ_CMP_F5_DEVICE device on pool.DEVICE_ID = device.ID
      left join CJ_CMP_F5_DEVICE_GROUP_X_DEVICE rel on pool.DEVICE_ID = rel.DEVICE_ID
      left join CJ_CMP_F5_DEVICE_GROUP deviceGroup on rel.DEVICE_GROUP_ID = deviceGroup.ID
    where pool.IS_DELETED = 0
    <if test="serviceAccountId != null and serviceAccountId !=''">
      and  pool.SERVICE_ACCOUNT_ID =#{serviceAccountId}
    </if>
    <if test="deviceId != null and deviceId !=''">
      and  pool.DEVICE_ID =#{deviceId}
    </if>
    group by pool.ID, part.NAME, device.NAME
  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_F5_SNAT_POOL_MEMBER.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：now,CJ_CMP_F5_SNAT_POOL_MEMBER,values,in

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_F5_VS.xml
> sql统计:复杂1个，简单11个
>
> 使用的关键字：DATE,now,in,values,where,group_concat,count,NOW,CJ_CMP_F5_VS
#### queryList
```

        select vs.*, ip.IP as ip, part.NAME as partitionName, device.NAME as deviceName, group_concat(deviceGroup.NAME) as deviceGroupName
        from CJ_CMP_F5_VS vs INNER JOIN CJ_CMP_F5_VS_IP ip ON vs.ID = ip.VIRTUAL_SERVER_ID LEFT JOIN CJ_CMP_F5_PARTITION part on part.ID = vs.PARTITION_ID
        inner join CJ_CMP_F5_DEVICE device on vs.DEVICE_ID = device.ID
        left join CJ_CMP_F5_DEVICE_GROUP_X_DEVICE rel on vs.DEVICE_ID = rel.DEVICE_ID
        left join CJ_CMP_F5_DEVICE_GROUP deviceGroup on rel.DEVICE_GROUP_ID = deviceGroup.ID
        WHERE  vs.IS_DELETED = 0
        <if test="serviceAccountId != null and serviceAccountId !=''">
          and  vs.SERVICE_ACCOUNT_ID =#{serviceAccountId}
        </if>
        <if test="deviceId != null and deviceId !=''">
          and  vs.DEVICE_ID =#{deviceId}
        </if>
        <if test="snatPoolId != null and snatPoolId !=''">
            and  vs.SNAT_POOL_ID =#{snatPoolId}
        </if>
        group by vs.ID, ip.ip, part.NAME, device.NAME
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_FROZEN_RESOURCE_MAPPER.xml
> sql统计:复杂1个，简单4个
>
> 使用的关键字：ifnull,sum,now,CJ_CMP_FROZEN_RESOURCE,values
#### selectByFrozenResourceByType
```

    select
    ifnull(sum(ifnull(frozen.CPU,0)),0) as cpu,
    ifnull(sum(ifnull(frozen.MEMORY,0)),0) as memory,
    ifnull(sum(ifnull(frozen.STORAGE,0)),0) as storage,
    ifnull(sum(ifnull(frozen.VM_INSTANCE,0)),0) as vmInstance,
    ifnull(sum(ifnull(frozen.PM_INSTANCE,0)),0) as pmInstance
    from CJ_CMP_FROZEN_RESOURCE frozen where FROZEN_RESOURCE_ID = #{frozenResourceId} and FROZEN_RESOURCE_TYPE = #{frozenResourceType} and MEMBER_ID = #{memberId} and IS_DELETED = 0
  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSIONCLOUD_DC.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_ACCESS_CLUSTER.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：values,and,size,now,CJ_CMP_FUSION_ACCESS_CLUSTER

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_ACCESS_DATASTORE.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：now,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_ACCESS_DC.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：now,CJ_CMP_FUSION_ACCESS_DC,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_ACCESS_DESKTOP.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：now,CJ_CMP_FUSION_ACCESS_DESKTOP,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_ACCESS_DESKTOP_GROUP.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：count,and,now,CJ_CMP_FUSION_ACCESS_DESKTOP_GROUP,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_ACCESS_DOMAIN.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：and,count,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_ACCESS_DOMAIN_OU.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：now,CJ_CMP_FUSION_ACCESS_DOMAIN_OU,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_ACCESS_PORT_GROUP.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：and,now,CJ_CMP_FUSION_ACCESS_PORT_GROUP,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_ACCESS_RESOURCE_GROUP.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：values,count,and,now,CJ_CMP_FUSION_ACCESS_RESOURCE_GROUP

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_ACCESS_SECURITY_GROUP.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：now,CJ_CMP_FUSION_ACCESS_SECURITY_GROUP,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_ACCESS_VMNAME_POLICY.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：now,CJ_CMP_FUSION_ACCESS_VMNAME_POLICY,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_ACCESS_VM_INSTANCE.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：sum,count,CJ_CMP_FUSION_ACCESS_VM_INSTANCE,from,in,JOIN,values,and,now,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_ACCESS_VM_USER.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：now,CJ_CMP_FUSION_ACCESS_VM_USER,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CCE_CLUSTER.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：now,NOW,CJ_CMP_FUSION_CCE_CLUSTER,values,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CCE_DC.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：now,NOW,CJ_CMP_FUSION_CCE_DC,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CLOUD_BMS_FLAVOR.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：now,CJ_CMP_FUSION_CLOUD_BMS_FLAVOR,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CLOUD_BMS_INSTANCE.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：on,and,now,CJ_CMP_FUSION_CLOUD_BMS_INSTANCE,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CLOUD_ECS.xml
> sql统计:复杂1个，简单30个
>
> 使用的关键字：if,count,in,sum,now,NOW,and,GROUP_CONCAT
#### getAllByCondition
```

        select ecs.*,prj.CODE as projectCode,prj.NAME as projectName,prj.PROJECT_SOURCE_ID as projectSourceId,
        app.CODE as appSystemCode,app.NAME as appSystemName,app.SOURCE_ID as appSystemSourceId, GROUP_CONCAT(tag.NAME) as tags
        from CJ_CMP_FUSION_CLOUD_ECS ecs
          <if test="srvCompletionTimeStart!=null or srvCompletionTimeEnd!=null ">
          left outer join CJ_CMP_RITM_COMPLETED_VIEW req on ecs.SRV_NO=req.NUMBER
          </if>
          left outer join CJ_CMP_PROJECT prj on prj.ID=ecs.PROJECT_ID
          left outer join CJ_CMP_APP_SYSTEM app on app.ID=ecs.APP_SYSTEM_ID
          left outer join CJ_CMP_APP_DU du on du.ID=ecs.APP_DU_ID
          left outer join CJ_CMP_TAG_X_OBJECT txo on ecs.ID = txo.OBJECT_ID and txo.OBJECT_TYPE = 'fusionCloud'
          left outer join CJ_CMP_TAG tag on tag.ID = txo.TAG_ID and tag.IS_DELETED = 0
        <where>
            <if test="memberId != 0"> and ecs.MEMBER_ID = #{memberId}</if>
            <if test="startTime!=null and  endTime!=null ">
                and ecs.CREATE_DATE between #{startTime,jdbcType= TIMESTAMP} and  #{endTime,jdbcType= TIMESTAMP}
            </if>
            <if test="startTime==null   and  endTime!=null ">
                and ecs.CREATE_DATE &lt;=  #{endTime,jdbcType= TIMESTAMP}
            </if>
            <if test="startTime!=null  and  endTime==null ">
                and ecs.CREATE_DATE &gt;=  #{startTime,jdbcType= TIMESTAMP}
            </if>
            <if test="srvCompletionTimeStart!=null and srvCompletionTimeEnd!=null ">
                and if(ecs.IS_DELETED=1,ecs.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) between #{srvCompletionTimeStart,jdbcType= TIMESTAMP} and  #{srvCompletionTimeEnd,jdbcType= TIMESTAMP}
            </if>
            <if test="srvCompletionTimeStart==null and srvCompletionTimeEnd!=null ">
                and if(ecs.IS_DELETED=1,ecs.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) &lt;=  #{srvCompletionTimeEnd,jdbcType= TIMESTAMP}
            </if>
            <if test="srvCompletionTimeStart!=null and srvCompletionTimeEnd==null ">
                and if(ecs.IS_DELETED=1,ecs.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) &gt;=  #{srvCompletionTimeStart,jdbcType= TIMESTAMP}
            </if>
            <if  test="isDeleted != null ">
                <choose>
                    <when test="isDeleted">
                        and ecs.IS_DELETED=1
                    </when>
                    <otherwise>
                        and ecs.IS_DELETED=0
                    </otherwise>
                </choose>
            </if>
        </where>
        GROUP BY ecs.ID
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CLOUD_HOST.xml
> sql统计:复杂3个，简单7个
>
> 使用的关键字：and,in,count,sum,round,if,NOW,group_concat
#### queryHost
```

        select host.ID,host.NAME ,host.IP,host.ENTITY_ID,host.CPUS,host.CPU_USED,host.SN,host.VIRTUAL_CPU_TOTAL,host.VIRTUAL_MEMORY_MB_TOTAL,host.MEMORY_SUM, host.MEMORY_USED,host.VIRTUAL_MEMORY_MB_USED, host.MEMORY_PROVISIONED, host.DISK_PROVISIONED,host.DISK_SUM,host.DISK_USED,host.STATUS,host.RUN_STATUS , group_concat(distinct az.NAME) as zoneName, cdc.LDC_TYPE, group_concat(distinct dc.NAME) as ldcName, ca.ID as cloudAccountId,ca.NAME AS cloudAccountName,sa.NAME AS serviceAccountName, sa.ID AS serviceAccountId
        from CJ_CMP_CLOUD_ACCOUNT ca
        inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc on ca.ID=cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED=0 and cdc.LDC_TYPE='fusionCloud'
        inner join CJ_CMP_FUSION_CLOUD_DC dc on cdc.LDC_ID=dc.ID and cdc.IS_DELETED=0 and dc.IS_DELETED=0
        INNER JOIN CJ_CMP_SERVICE_ACCOUNT sa ON cdc.SERVICE_ACCOUNT_ID = sa.ID AND sa.IS_DELETED=0
        inner join CJ_CMP_FUSION_CLOUD_DC_X_AZ rel on rel.LDC_ID = cdc.LDC_ID 
        inner join CJ_CMP_CLOUD_AZ az on az.ID=rel.AZ_ID and az.IS_DELETED = 0 and az.NAME != 'manage-az'
        inner join CJ_CMP_FUSION_CLOUD_HOST host on host.ZONE_ID=az.ID and host.IS_DELETED=0
        <where>
            <choose>
                <when test="memberId != 0">
                    and ca.MEMBER_ID = #{memberId}
                </when>
                <otherwise>
                    and ca.SCOPE = 'public'
                </otherwise>
            </choose>
            <if test="id != null and id != ''"> and host.ID=#{id}</if>
            <if test="serviceAccountId != null and serviceAccountId != ''"> and cdc.SERVICE_ACCOUNT_ID=#{serviceAccountId}</if>
            <if test="cloudAccountId != null and cloudAccountId != ''"> and ca.ID=#{cloudAccountId}</if>
            <if test="ldcId != null and ldcId != ''"> and dc.ID=#{ldcId}</if>
            <if test="name != null and name != ''"> and host.NAME like #{name}</if>
            <if test="ip != null and ip != ''"> and host.IP like #{ip}</if>
            <if test="searchKey != null and searchKey != ''"> and (host.NAME like #{searchKey} or host.IP like #{searchKey} or host.ENTITY_ID like #{searchKey})</if>
        </where>
        group by host.ID,host.NAME,host.IP,host.ENTITY_ID,host.CPUS,host.CPU_USED,host.VIRTUAL_MEMORY_MB_TOTAL,host.MEMORY_SUM, host.MEMORY_USED,host.VIRTUAL_MEMORY_MB_USED,host.DISK_SUM,host.DISK_USED,host.STATUS,host.RUN_STATUS, cdc.LDC_TYPE,ca.ID,ca.NAME,sa.NAME, sa.ID
    
```
#### statisticHostByServiceAccoutId
```

        select
            count(0)                                                                                      as hostSum,
            sum(host.CPUS)                                                                                as cpus,
            sum(host.CPU_USED)                                                                            as cpuUsed,
            round(if(sum(host.CPUS) = 0, 0, sum(host.CPU_USED) / sum(host.CPUS)), 2) * 100                as cpuUsage,
            sum(host.VIRTUAL_MEMORY_MB_USED)                                                                         as memoryUsed,
            sum(host.VIRTUAL_MEMORY_MB_TOTAL)                                                                          as memorySum,
            round(if(sum(host.VIRTUAL_MEMORY_MB_TOTAL) = 0, 0, sum(host.VIRTUAL_MEMORY_MB_USED) / sum(host.VIRTUAL_MEMORY_MB_TOTAL)), 2) * 100 as memoryUsage
        from CJ_CMP_FUSION_CLOUD_HOST host
        where SERVICE_ACCOUNT_ID = #{serviceAccountId} AND IS_DELETED = 0;
    
```
#### statisticHostByCloudAccoutId
```

        select
            count(0)                                                                                      as hostSum,
            sum(host.CPUS)                                                                                as cpus,
            sum(host.CPU_USED)                                                                            as cpuUsed,
            round(if(sum(host.CPUS) = 0, 0, sum(host.CPU_USED) / sum(host.CPUS)), 2) * 100                as cpuUsage,
            sum(host.VIRTUAL_MEMORY_MB_USED)                                                                         as memoryUsed,
            sum(host.VIRTUAL_MEMORY_MB_TOTAL)                                                                          as memorySum,
            round(if(sum(host.VIRTUAL_MEMORY_MB_TOTAL) = 0, 0, sum(host.VIRTUAL_MEMORY_MB_USED) / sum(host.VIRTUAL_MEMORY_MB_TOTAL)), 2) * 100 as memoryUsage
        from CJ_CMP_FUSION_CLOUD_HOST host
        where SERVICE_ACCOUNT_ID in(select adc.SERVICE_ACCOUNT_ID
                                    from CJ_CMP_CLOUD_ACCOUNT_DC adc inner join CJ_CMP_CLOUD_ACCOUNT ca on adc.CLOUD_ACCOUNT_ID = ca.ID
                                    where adc.CLOUD_ACCOUNT_ID = #{cloudAccountId} AND adc.IS_DELETED = 0
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>) AND IS_DELETED = 0;
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CLOUD_NETWORK.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：count,and,in,CONCAT,NOW,where,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CLOUD_NETWORK_PORT.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：NOW,where

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CLOUD_NETWORK_SUBNET.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：ISNULL,CONCAT,NOW,where,values,IF

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CLOUD_OBS_BUCKET.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：on,and,now,CJ_CMP_FUSION_CLOUD_OBS_BUCKET,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CLOUD_SECURITY_GROUP.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CLOUD_SFS_SHARE.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：on,and,now,CJ_CMP_FUSION_CLOUD_SFS_SHARE,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CLOUD_SFS_SHARE_ACL.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：now,CJ_CMP_FUSION_CLOUD_SFS_SHARE_ACL,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CLOUD_STORAGE.xml
> sql统计:复杂4个，简单7个
>
> 使用的关键字：in,sum,round,if,and,NOW
#### statisticDataStoreByServiceAccoutId
```

        SELECT
        sum(da.DISK_SUM)  as DISK_SUM,
        sum(da.DISK_SUM - da.DISK_FREE) as DISK_USED,
        round(if(sum(da.DISK_SUM) = 0, 0, sum(da.DISK_SUM - da.DISK_FREE) / sum(da.DISK_SUM)), 2) * 100 as DISK_USAGE
        FROM CJ_CMP_FUSION_CLOUD_STORAGE da
        where SERVICE_ACCOUNT_ID = #{serviceAccountId} AND IS_DELETED = 0;
    
```
#### statisticDataStoreByCloudAccoutId
```

        SELECT
        sum(da.DISK_SUM)  as DISK_SUM,
        sum(da.DISK_SUM - da.DISK_FREE) as DISK_USED,
        round(if(sum(da.DISK_SUM) = 0, 0, sum(da.DISK_SUM - da.DISK_FREE) / sum(da.DISK_SUM)), 2) * 100 as DISK_USAGE
        FROM CJ_CMP_FUSION_CLOUD_STORAGE da
        where SERVICE_ACCOUNT_ID in (select adc.SERVICE_ACCOUNT_ID
                                      from CJ_CMP_CLOUD_ACCOUNT_DC adc inner join CJ_CMP_CLOUD_ACCOUNT ca on adc.CLOUD_ACCOUNT_ID = ca.ID
                                      where adc.CLOUD_ACCOUNT_ID = #{cloudAccountId} AND adc.IS_DELETED = 0
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>) AND IS_DELETED = 0;
    
```
#### statisticDataStoreTypeBySaId
```

        select
        TYPE,
        SERVICE_ACCOUNT_ID,
        sum(DISK_SUM)             as DISK_SUM,
        sum(DISK_FREE)            as DISK_FREE,
        sum(DISK_SUM - DISK_FREE) as DISK_USED,
        sum(PROVISIONED)          as PROVISIONED,
        round(if(sum(DISK_SUM) = 0, 0, sum(DISK_SUM - DISK_FREE) / sum(DISK_SUM)), 2) * 100 as DISK_USAGE
        from CJ_CMP_FUSION_CLOUD_STORAGE
        where SERVICE_ACCOUNT_ID = #{serviceAccountId}
        group by TYPE, SERVICE_ACCOUNT_ID, MEMBER_ID
    
```
#### statisticDataStoreTypeByCaId
```

        select
            TYPE,
            SERVICE_ACCOUNT_ID,
            sum(DISK_SUM)                                                                       as DISK_SUM,
            sum(DISK_FREE)                                                                      as DISK_FREE,
            sum(DISK_SUM - DISK_FREE)                                                           as DISK_USED,
            sum(PROVISIONED)                                                                    as PROVISIONED,
            round(if(sum(DISK_SUM) = 0, 0, sum(DISK_SUM - DISK_FREE) / sum(DISK_SUM)), 2) * 100 as DISK_USAGE
        from CJ_CMP_FUSION_CLOUD_STORAGE
        where SERVICE_ACCOUNT_ID in (select adc.SERVICE_ACCOUNT_ID
                                      from CJ_CMP_CLOUD_ACCOUNT_DC adc inner join CJ_CMP_CLOUD_ACCOUNT ca on adc.CLOUD_ACCOUNT_ID = ca.ID
                                      where adc.CLOUD_ACCOUNT_ID = #{cloudAccountId} AND adc.IS_DELETED = 0
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>)
        group by TYPE, SERVICE_ACCOUNT_ID, MEMBER_ID
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CLOUD_VDC.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CLOUD_VPC.xml
> sql统计:复杂1个，简单4个
>
> 使用的关键字：if,group_concat,on,and,CONCAT,NOW,where,in
#### selectDetailById
```

     select fvpc.ID,fvpc.MEMBER_ID,fvpc.ENTITY_ID,fvpc.SERVICE_ACCOUNT_ID,fvpc.NAME,fvpc.LDC_ID,fcdc.LDC_TYPE,fvpc.CIDR as CIDR_BLOCK,'可用' as statusName,
     fsa.TYPE as sAccountType,fvpc.CREATE_BY,fvpc.CREATE_DATE,fvpc.LAST_MODIFIED_BY,fvpc.LAST_MODIFIED_DATE,
     fsa.NAME as sAccountName,fdc.NAME as ldcName,if(EXTERNAL_GATEWAY_NETWORK_ENTITY_ID is null,0,1) as isExternal,
     (select group_concat(az.NAME) from CJ_CMP_FUSION_CLOUD_VPC_X_AZ x,CJ_CMP_CLOUD_AZ az where x.AZ_ID=az.ID and az.IS_DELETED=0 and x.VPC_ID=#{id}) as azNames
     from CJ_CMP_SERVICE_ACCOUNT fsa
     inner join CJ_CMP_FUSION_CLOUD_DC fdc on fdc.SERVICE_ACCOUNT_ID=fsa.ID and fsa.IS_DELETED=0 and fdc.IS_DELETED=0
     inner join CJ_CMP_CLOUD_ACCOUNT_DC fcdc on fcdc.LDC_TYPE = 'fusionCloud' and fcdc.LDC_ID=fdc.ID and fcdc.IS_DELETED=0
     inner join CJ_CMP_CLOUD_ACCOUNT fca on fcdc.CLOUD_ACCOUNT_ID=fca.ID and fca.IS_DELETED=0
     inner join CJ_CMP_FUSION_CLOUD_VPC fvpc on fvpc.LDC_ID=fdc.ID and fvpc.IS_DELETED=0
     where fvpc.ID=#{id}
      <choose>
          <when test="memberId != 0">
              and fca.MEMBER_ID = #{memberId}
          </when>
          <otherwise>
              and fca.SCOPE = 'public'
          </otherwise>
      </choose>
  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_COMPUTE_CLUSTER.xml
> sql统计:复杂1个，简单6个
>
> 使用的关键字：NOW,CJ_CMP_FUSION_COMPUTE_CLUSTER,values,round,ceil,ifnull,and,size
#### queryCluster
```

    select clu.ID,
    clu.NAME,
    clu.ENTITY_ID,
    clu.CPU_SUM,
    clu.CPU_USED,
    round((clu.CPU_USED / clu.CPU_SUM) * 100, 2)                                                       as cpuUsage,
    ceil(ifnull(clu.MEMORY_SUM, 0) / 1024)                                                             as memorySum,
    ceil(ifnull(clu.MEMORY_USED, 0) / 1024)                                                            as memoryUsed,
    round((ceil(ifnull(clu.MEMORY_USED, 0) / 1024) / ceil(ifnull(clu.MEMORY_SUM, 0) / 1024)) * 100,
    2)                                                                                           as memoryUsage,
    cdc.LDC_ID,
    cdc.LDC_TYPE,
    dc.ENTITY_ID                                                                                       as ldcEntityId,
    dc.NAME                                                                                            as ldcName,
    sa.NAME                                                                                            as serviceAccountName,
    sa.ID                                                                                              as serviceAccountId
    from CJ_CMP_SERVICE_ACCOUNT sa
    inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc on sa.ID = cdc.SERVICE_ACCOUNT_ID and sa.IS_DELETED = 0 AND cdc.IS_DELETED=0
    inner join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED = 0
    inner join CJ_CMP_FUSION_COMPUTE_DC dc on cdc.LDC_ID = dc.ID and dc.IS_DELETED = 0 and dc.SERVICE_ACCOUNT_ID=sa.ID
    left outer join CJ_CMP_FUSION_COMPUTE_CLUSTER clu on dc.ID = clu.LDC_ID
    left outer join CJ_CMP_FUSION_COMPUTE_HOST host on host.CLUSTER_ID = clu.ID
    where dc.IS_DELETED=0 and clu.IS_DELETED = 0
    <choose>
      <when test="memberId != 0">
        and ca.MEMBER_ID = #{memberId}
      </when>
      <otherwise>
        and ca.SCOPE = 'public'
      </otherwise>
    </choose>
    <if test="clusterId != null and clusterId != ''"> and clu.ID=#{clusterId}</if>
    <if test="serviceAccountId != null and serviceAccountId != ''"> and sa.ID=#{serviceAccountId}</if>
    <if test="cloudAccountId != null and cloudAccountId != ''"> and ca.ID=#{cloudAccountId}</if>
    <if test="ldcId != null and ldcId != ''"> and cdc.LDC_ID=#{ldcId}</if>
    <if test="ldcType != null and ldcType != ''"> and cdc.LDC_TYPE=#{ldcType}</if>
    <if test="searchKey != null and searchKey != ''"> and (clu.NAME like #{searchKey} or clu.ENTITY_ID like #{searchKey})</if>
    <if test="name != null and name != ''"> and clu.NAME like #{name} </if>
    <if test="ldcIds != null and ldcIds.size()>0">
      and cdc.LDC_ID IN <foreach collection="ldcIds" item="ldc" open="(" separator="," close=")"> #{ldc} </foreach>
    </if>
    group by clu.ID, clu.NAME, clu.ENTITY_ID, clu.CPU_SUM, clu.CPU_USED, round((clu.CPU_USED / clu.CPU_SUM) * 100, 2), ceil(ifnull(clu.MEMORY_SUM, 0) / 1024), ceil(ifnull(clu.MEMORY_USED, 0) / 1024), round((ceil(ifnull(clu.MEMORY_USED, 0) / 1024) / ceil(ifnull(clu.MEMORY_SUM, 0) / 1024)) * 100,
    2), cdc.LDC_ID, cdc.LDC_TYPE, dc.ENTITY_ID, dc.NAME, sa.NAME, sa.ID
    <if test="sortField != null and sortField!= '' and sortType != null and sortType!= '' ">
      <choose>
        <when test="sortField == 'cpuUsage' or sortField == 'memoryUsage' or sortField == 'localStorageUsage'">
          ORDER BY ${sortField} ${sortType}
        </when>
        <otherwise>
          order by clu.NAME
        </otherwise>
      </choose>
    </if>
    <if test="sortField == null or sortType == null ">
      order by clu.NAME
    </if>

  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_COMPUTE_DATASTORE.xml
> sql统计:复杂1个，简单6个
>
> 使用的关键字：NOW,CJ_CMP_FUSION_COMPUTE_DATASTORE,values,join,group_concat,and
#### queryDatastore
```

        SELECT ds.ID,ds.SERVICE_ACCOUNT_ID,ds.STATUS,ds.NAME,ds.ENTITY_ID,ds.CAPACITY_GB as DISK_SUM,ds.USED_SIZE_GB as
        DISK_USED,ds.FREE_SIZE_GB as DISK_FREE,ds.STORAGE_TYPE,cdc.LDC_TYPE,cdc.LDC_ID,dc.NAME as ldcName,dc.ENTITY_ID
        as ldcEntityId, sa.NAME as serviceAccountName, store.*
        FROM CJ_CMP_CLOUD_ACCOUNT ca
        inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc on ca.ID=cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED=0 and
        cdc.LDC_TYPE='fusionCompute' AND cdc.IS_DELETED=0
        inner join CJ_CMP_FUSION_COMPUTE_DC dc on cdc.LDC_ID=dc.ID and cdc.IS_DELETED=0 and dc.IS_DELETED=0
        inner join CJ_CMP_SERVICE_ACCOUNT sa on dc.SERVICE_ACCOUNT_ID = sa.ID and sa.IS_DELETED=0
        inner join CJ_CMP_FUSION_COMPUTE_DATASTORE ds ON ds.LDC_ID= dc.ID and
        ds.SERVICE_ACCOUNT_ID=dc.SERVICE_ACCOUNT_ID
        left join
        (
        SELECT group_concat(clu.ID) as CLUSTER_ID, group_concat(host.ID) as HOST_ID, group_concat(clu.NAME) AS
        clusterName , group_concat(clu.ENTITY_ID) clusterEntityId, group_concat(host.NAME) as hostName,
        group_concat(host.ENTITY_ID) as hostEntityId, group_concat(host.IP)as hostIp,dt.ID AS dsId
        FROM CJ_CMP_FUSION_COMPUTE_HOST host LEFT JOIN CJ_CMP_FUSION_COMPUTE_CLUSTER clu ON host.CLUSTER_ID = clu.ID
        inner join CJ_CMP_FUSION_COMPUTE_DATASTORE_X_HOST mou on mou.HOST_ID=host.ID
        inner join CJ_CMP_FUSION_COMPUTE_DATASTORE dt on dt.ID=mou.DATASTORE_ID
        GROUP BY dsId
        ) store ON dsId= ds.ID
        <where>
            <choose>
                <when test="memberId != 0">
                    and ca.MEMBER_ID = #{memberId}
                </when>
                <otherwise>
                    and ca.SCOPE = 'public'
                </otherwise>
            </choose>
            <if test="id != null and id != ''">and ds.ID=#{id}</if>
            <if test="serviceAccountId != null and serviceAccountId != ''">and
                cdc.SERVICE_ACCOUNT_ID=#{serviceAccountId}
            </if>
            <if test="cloudAccountId != null and cloudAccountId != ''">and ca.ID=#{cloudAccountId}</if>
            <if test="ldcId != null and ldcId != ''">and dc.ID=#{ldcId}</if>
            <if test="name != null and name != ''">and ds.NAME like #{name}</if>
            <if test="clusterId != null and clusterId != ''">and store.CLUSTER_ID=#{clusterId}</if>
            <if test="hostId != null and hostId != ''">and store.HOST_ID=#{hostId}</if>
            <if test="entityId != null and entityId != ''">and ds.ENTITY_ID like #{entityId}</if>
            <if test="searchKey != null and searchKey != ''">and (ds.NAME like #{searchKey} or ds.ENTITY_ID like
                #{searchKey} or hostIp like #{searchKey})
            </if>
            <if test="hostIp != null and hostIp != ''">and hostIp like #{hostIp}</if>
        </where>

    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_COMPUTE_DC.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：CJ_CMP_FUSION_COMPUTE_DC,values,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_COMPUTE_HOST.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：and,NOW,CJ_CMP_FUSION_COMPUTE_HOST,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_COMPUTE_PORT_GROUP.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：ISNULL,NOW,CJ_CMP_FUSION_COMPUTE_PORT_GROUP,values,count,and,CONCAT,IF

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_COMPUTE_VDS.xml
> sql统计:复杂1个，简单7个
>
> 使用的关键字：in,CONCAT,values,and,NOW,CJ_CMP_FUSION_COMPUTE_VDS,from,if,concat,group_concat,count
#### selectByKeyValueAndServiceAccount
```

    select * from (select  vds.ID,vds.MEMBER_ID,vds.ENTITY_ID,vds.SERVICE_ACCOUNT_ID,
    if(vds.TYPE = 'VSS',concat(vds.NAME, if(group_concat(vmHost.IP) is null, '', concat('[', group_concat(vmHost.IP), ']'))),vds.NAME) as NAME,
           vds.TYPE, vds.LDC_ID,saccount.DATACENTER_TYPE as LDC_TYPE,vds.SHORT_DESCRIPTION as DESCRIPTION, group_concat(vmHost.NAME) as hostName,
    (select count(0) from CJ_CMP_FUSION_COMPUTE_PORT_GROUP vpg where vds.ID = vpg.VDS_ID and vpg.IS_DELETED=0)  as PORT_GROUP_NUM,
    dc.name as ldcName, saccount.NAME as sAccountName
    from CJ_CMP_FUSION_COMPUTE_VDS vds
    inner join CJ_CMP_FUSION_COMPUTE_DC dc on vds.LDC_ID = dc.ID
    inner join CJ_CMP_SERVICE_ACCOUNT saccount on vds.SERVICE_ACCOUNT_ID = saccount.ID
    inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc on cdc.SERVICE_ACCOUNT_ID=saccount.ID and cdc.IS_DELETED=0 and dc.ID = cdc.LDC_ID
    inner join CJ_CMP_CLOUD_ACCOUNT ca on cdc.CLOUD_ACCOUNT_ID = ca.ID and ca.IS_DELETED = 0
    left join CJ_CMP_FUSION_COMPUTE_VDS_X_HOST vdsRel on vds.ID = vdsRel.VDS_ID
    left join CJ_CMP_FUSION_COMPUTE_HOST vmHost on vdsRel.HOST_ID = vmHost.ID
    where vds.IS_DELETED=0
    <choose>
      <when test="memberId != 0">
        and ca.MEMBER_ID = #{memberId}
      </when>
      <otherwise>
        and ca.SCOPE = 'public'
      </otherwise>
    </choose>
    <if test="id != null" >
      and vds.ID = #{id}
    </if>
    <if test="serviceAccountId!=null and serviceAccountId != 'ALL'" >
      and vds.SERVICE_ACCOUNT_ID = #{serviceAccountId}
    </if>
    <if test="cloudAccountId !=null and cloudAccountId != 'ALL'" >
      and vds.LDC_ID in (
      select cadc.LDC_ID from  CJ_CMP_CLOUD_ACCOUNT_DC cadc where cadc.CLOUD_ACCOUNT_ID = #{cloudAccountId}
      )
    </if>
    <if test="ldcId != '' and ldcId != null" >
      and vds.LDC_ID = #{ldcId}
    </if>
    group by vds.ID) t where 1 = 1
    <if test="queryValue != null" >
      <if test="queryValue != ''" >
      <choose>
          <when test="queryKey == 'ALL'" >
              and (
              t.NAME like CONCAT('%',#{queryValue},'%')
              OR t.ENTITY_ID like CONCAT('%',#{queryValue},'%')
              )
          </when>
          <otherwise>
              <if test="queryKey == 'ENTITY_ID'" >
                  and t.ENTITY_ID like CONCAT('%',#{queryValue},'%')
              </if>
              <if test="queryKey == 'NAME'" >
                  and t.NAME like CONCAT('%',#{queryValue},'%')
              </if>
          </otherwise>
      </choose>
      </if>
    </if>

  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_COMPUTE_VM.xml
> sql统计:复杂1个，简单19个
>
> 使用的关键字：sum,GROUP_CONCAT,if,now,NOW,CJ_CMP_FUSION_COMPUTE_VM,values,and
#### getAllByCondition
```

      select vm.*,prj.CODE as projectCode,prj.NAME as projectName,prj.PROJECT_SOURCE_ID as projectSourceId,
      app.CODE as appSystemCode,app.NAME as appSystemName,app.SOURCE_ID as appSystemSourceId, GROUP_CONCAT(tag.NAME) as tags
      from CJ_CMP_FUSION_COMPUTE_VM vm
      <if test="srvCompletionTimeStart!=null or srvCompletionTimeEnd!=null ">
      left outer join CJ_CMP_RITM_COMPLETED_VIEW req on vm.SRV_NO=req.NUMBER
      </if>
      left outer join CJ_CMP_PROJECT prj on prj.ID=vm.PROJECT_ID
      left outer join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
      left outer join CJ_CMP_APP_DU du on du.ID=vm.APP_DU_ID
      left outer join CJ_CMP_TAG_X_OBJECT txo on vm.ID = txo.OBJECT_ID and txo.OBJECT_TYPE = 'fusionCompute'
      left outer join CJ_CMP_TAG tag on tag.ID = txo.TAG_ID and tag.IS_DELETED = 0
      <where>
        <if test="memberId != 0"> and vm.MEMBER_ID = #{memberId}</if>
        <if test="startTime!=null and endTime!=null ">
          and vm.CREATE_DATE between #{startTime,jdbcType= TIMESTAMP} and  #{endTime,jdbcType= TIMESTAMP}
        </if>
        <if test="startTime==null and endTime!=null ">
          and vm.CREATE_DATE &lt;=  #{endTime,jdbcType= TIMESTAMP}
        </if>
        <if test="startTime!=null and endTime==null ">
          and vm.CREATE_DATE &gt;=  #{startTime,jdbcType= TIMESTAMP}
        </if>

        <if test="srvCompletionTimeStart!=null and srvCompletionTimeEnd!=null ">
          and if(vm.IS_DELETED=1,vm.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) between #{srvCompletionTimeStart,jdbcType= TIMESTAMP} and  #{srvCompletionTimeEnd,jdbcType= TIMESTAMP}
        </if>
        <if test="srvCompletionTimeStart==null and srvCompletionTimeEnd!=null ">
          and if(vm.IS_DELETED=1,vm.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) &lt;=  #{srvCompletionTimeEnd,jdbcType= TIMESTAMP}
        </if>
        <if test="srvCompletionTimeStart!=null and srvCompletionTimeEnd==null ">
          and if(vm.IS_DELETED=1,vm.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) &gt;=  #{srvCompletionTimeStart,jdbcType= TIMESTAMP}
        </if>

        <if  test="isDeleted != null ">
          <choose>
            <when test="isDeleted">
              and vm.IS_DELETED=1
            </when>
            <otherwise>
              and vm.IS_DELETED=0
            </otherwise>
          </choose>
        </if>
      </where>
      GROUP BY vm.ID
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_IP_OPER_LOG.xml
> sql统计:复杂1个，简单4个
>
> 使用的关键字：from,if,and,or,CJ_CMP_IP_OPER_LOG,values,now,CONCAT
#### queryMemberIpLog
```

    select * from (select ipLog.ID, ipLog.IP_ID, ipLog.IP, ipLog.STATUS, ipLog.USAGE_INFO, ipLog.REMARK, ipLog.DEV_INFO,
    ipLog.OPER_TYPE, ipLog.CREATE_DATE, `member`.NAME as memberName, if(user.name is not null, user.name,
    ipLog.CREATE_BY) as operator, cidr.CIDR_BLOCK, cidr.NAME as cidrBlockName,
    null as devId, null as devType, null as devName, null as appSystemName
    from CJ_CMP_IP_OPER_LOG ipLog
    inner join CJ_CMP_CIDR_BLOCK cidr on ipLog.CIDR_BLOCK_ID = cidr.ID
    inner join ydduc.UC_MEMBER `member` on ipLog.MEMBER_ID = `member`.ID
    left join ydduc.UC_USER user on ipLog.CREATE_BY = user.ID
    <where>
      and `member`.STATUS = 'ENABLED'
      <if test="memberId !=null and memberId !=0">and ipLog.MEMBER_ID = #{memberId}</if>
      <if test="ip != null and ip != ''">and ipLog.IP = #{ip}</if>
      <if test="status != null and status != ''">and ipLog.STATUS = #{status}</if>
      <if test="operator != null and operator != ''">and (user.NAME like CONCAT('%',#{operator},'%') or (ipLog.CREATE_BY = 'sys' and #{showSysLog} = true))</if>
      <if test="startTime != null and startTime != ''">and ipLog.CREATE_DATE &gt;= #{startTime}</if>
      <if test="endTime != null and endTime != ''">and ipLog.CREATE_DATE &lt;= #{endTime}</if>
    </where>
    <if test="sortField != '' and sortField != null">
      order by ipLog.${sortField} ${sortType}
    </if>
    <if test="sortField == '' or sortField == null">
      order by ipLog.ID desc
    </if>) operLog
    <if test="(status == null or status == '') and (operator == null or operator == '')">
      union all
      select devIp.ID, null, devIp.IP, 'unmanage', null, null, null, null, devIp.CREATE_DATE, `member`.NAME as memberName, if(user.name is not null, user.name, devIp.CREATE_BY) as operator, null, null,
      devIp.ID as devId, devIp.TYPE as devType, devIp.NAME as devName, appSystem.NAME as appSystemName
      from CJ_CMP_DEV_IP_VIEW devIp
      left join CJ_CMP_APP_SYSTEM appSystem on devIp.APP_SYSTEM_ID = appSystem.ID and appSystem.IS_DELETED = 0
      inner join ydduc.UC_MEMBER `member` on devIp.MEMBER_ID = `member`.ID
      left join ydduc.UC_USER user on devIp.CREATE_BY = user.ID
      left join CJ_CMP_IP_X_DEV rel on devIp.ID = rel.DEV_ID and devIp.TYPE = rel.DEV_TYPE and devIp.SERVICE_ACCOUNT_ID = rel.SERVICE_ACCOUNT_ID
      where rel.ID is null
      <if test="memberId !=null and memberId !=0">and devIp.MEMBER_ID = #{memberId}</if>
      <if test="ip != '' and ip != null" > and devIp.IP like CONCAT('%',#{ip},'%')</if>
      <if test="startTime != null and startTime != ''">and devIp.CREATE_DATE &gt;= #{startTime}</if>
      <if test="endTime != null and endTime != ''">and devIp.CREATE_DATE &lt;= #{endTime}</if>
    </if>

  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_IP_POOL.xml
> sql统计:复杂12个，简单32个
>
> 使用的关键字：inet_aton,JOIN,sum,INET_ATON,count,group_concat,select,IF,now,and,from,round,HEX,INET6_ATON,CJ_CMP_IP_POOL,CONCAT,FROM,join,values
#### selectInCidrBlock
```

    select * from CJ_CMP_IP_POOL where CIDR_BLOCK_ID = #{cidrBlockId} and MEMBER_ID = #{memberId}
    <if test="ip != '' and ip != null" >
      and IP like CONCAT('%',#{ip},'%')
    </if>
    <if test="status != '' and status != null" >
      and `STATUS` = #{status}
    </if>
    <if test="ipVersion != null and ipVersion == 'IPv6'">order by IP</if>
    <if test="ipVersion != null and ipVersion == 'IPv4'">order by inet_aton(IP)</if>
  
```
#### selectByCidrBlockAndStatus
```

    select ipPool.*,cidr.CIDR_BLOCK as cidrBlock,cidr.DNS as dns,
    cidr.NETMASK as netmask,cidr.GATEWAY as gateway from CJ_CMP_IP_POOL ipPool
    INNER join CJ_CMP_CIDR_BLOCK cidr on ipPool.CIDR_BLOCK_ID = cidr.ID  where ipPool.CIDR_BLOCK_ID = #{cidrBlockId} and ipPool.MEMBER_ID = #{memberId} and ipPool.STATUS = #{status}
    <if test="startIp != null and startIp != ''">
       and inet_aton(ipPool.IP) > inet_aton(#{startIp})
    </if>
    order by inet_aton(ipPool.IP)
    <if test="num != null and num != 0">
      limit #{num}
    </if>
  
```
#### selectByCidrBlockAndStatusFromAvaliableLogicSegment
```

    select ipPool.*,
           cidr.CIDR_BLOCK as cidrBlock,
           cidr.DNS as dns,
           cidr.NETMASK as netmask,
           cidr.GATEWAY as gateway
    from CJ_CMP_IP_POOL ipPool
    inner join CJ_CMP_CIDR_BLOCK cidr on ipPool.CIDR_BLOCK_ID = cidr.ID
    where ipPool.CIDR_BLOCK_ID = #{cidrBlockId}
      and ipPool.MEMBER_ID = #{memberId}
      and ipPool.STATUS = #{status}
      and ipPool.LOGIC_SEGMENT_ID is not null
    <if test="startIp != null and startIp != ''">
      and inet_aton(ipPool.IP) > inet_aton(#{startIp})
    </if>
    order by inet_aton(ipPool.IP)
    <if test="num != null and num != 0">
      limit #{num}
    </if>
  
```
#### selectByLogicSegmentAndStatus
```

    select ipPool.*,cidr.CIDR_BLOCK as cidrBlock,cidr.DNS as dns,
    cidr.NETMASK as netmask,cidr.GATEWAY as gateway from CJ_CMP_IP_POOL ipPool
    INNER join CJ_CMP_CIDR_BLOCK cidr on ipPool.CIDR_BLOCK_ID = cidr.ID
    INNER join CJ_CMP_LOGIC_SEGMENT ls on ipPool.LOGIC_SEGMENT_ID = ls.ID
    where ipPool.LOGIC_SEGMENT_ID = #{logicSegmentId} and ipPool.MEMBER_ID = #{memberId} and ipPool.STATUS = #{status}
    <if test="startIp != null and startIp != ''">
      and inet_aton(ipPool.IP) > inet_aton(#{startIp})
    </if>
    order by inet_aton(ipPool.IP)
    <if test="num != null and num != 0">
      limit #{num}
    </if>
  
```
#### selectIpByCidrBlockId
```

    select * from CJ_CMP_IP_POOL where CIDR_BLOCK_ID = #{cidrBlockId} and MEMBER_ID = #{memberId}
    <if test="ipVersion == 'IPv4'">
      <if test="startIp != null"> and inet_aton(IP) &gt;= inet_aton(#{startIp})</if>
      <if test="endIp != null"> and inet_aton(IP) &lt;= inet_aton(#{endIp})</if>
      order by ID
    </if>
    <if test="ipVersion == 'IPv6'">
      <if test="startIp != null"> and IP &gt;= #{startIp}</if>
      <if test="endIp != null"> and IP &lt;= #{endIp}</if>
      order by IP
    </if>

  
```
#### listIps
```

    SELECT* FROM  (
      SELECT
      ip.ID,
      ip.IP,
      ip.CIDR_BLOCK_ID,
      ip.USAGE_INFO,
      ip.REMARK,
      cidr.CIDR_BLOCK,
      ip.STATUS,
      group_concat( ip.IP_TYPE )as ipType,
      group_concat( rel.DEV_ID ) AS devId,
      group_concat( rel.DEV_TYPE ) AS devType,
      group_concat( dev.NAME ) AS devName,
      group_concat( appSystem.NAME ) AS appSystemName,
      ip.CREATE_BY,
      ip.CREATE_DATE,
      ip.LAST_MODIFIED_BY,
      ip.LAST_MODIFIED_DATE,
      ip.FROZEN_DATE,
      ip.LOGIC_SEGMENT_ID
    FROM CJ_CMP_CIDR_BLOCK cidr
      INNER JOIN CJ_CMP_IP_POOL ip ON ip.CIDR_BLOCK_ID = cidr.ID
      LEFT JOIN CJ_CMP_IP_X_DEV rel ON ip.ID = rel.IP_ID
      LEFT JOIN CJ_CMP_DEV_VIEW dev ON rel.DEV_ID = dev.ID
      AND rel.SERVICE_ACCOUNT_ID = dev.SERVICE_ACCOUNT_ID
      LEFT JOIN CJ_CMP_APP_SYSTEM appSystem ON dev.APP_SYSTEM_ID = appSystem.ID  AND appSystem.IS_DELETED = 0
    <where>
      and ip.MEMBER_ID = #{memberId}
      <if test="ip != '' and ip != null" >
        and ip.IP like CONCAT('%',#{ip},'%')
      </if>
      <if test="cidrBlockId != null" >
        and ip.CIDR_BLOCK_ID = #{cidrBlockId}
      </if>
      <if test="logicSegmentId != null" >
        and ip.LOGIC_SEGMENT_ID = #{logicSegmentId}
      </if>
      <if test="status != '' and status != null" >
        and ip.STATUS = #{status}
      </if>
      <if test="devType != '' and devType != null" >
        and rel.DEV_TYPE = #{devType}
      </if>
      <if test="devName != '' and devName != null" >
        and dev.NAME like CONCAT('%',#{dev.NAME},'%')
      </if>
      <if test="usageInfo != '' and usageInfo != null" >
        and ip.USAGE_INFO like CONCAT('%',#{usageInfo},'%')
      </if>
    </where>
    group by ip.ID order by
    <if test="sortField != '' and sortField != null">
      ip.${sortField} ${sortType},
    </if>
    <if test="orderByIp != null and orderByIp == true">
      inet_aton(ip.IP),
    </if>
    ip.ID) ipPool
    <if test="(status == null or status == '') and (usageInfo == null or usageInfo == '') and cidrBlockId == null and logicSegmentId == null">
      union all
      select devIp.ID, devIp.IP, null, null, null, null, 'unmanage',null, devIp.ID as devId, devIp.TYPE as devType, devIp.NAME as devName, appSystem.NAME as appSystemName,
      devIp.CREATE_BY, devIp.CREATE_DATE, devIp.LAST_MODIFIED_BY, devIp.LAST_MODIFIED_DATE, null,null
      from CJ_CMP_DEV_IP_VIEW devIp
      left join CJ_CMP_APP_SYSTEM appSystem on devIp.APP_SYSTEM_ID = appSystem.ID and appSystem.IS_DELETED = 0
      left join CJ_CMP_IP_X_DEV rel on devIp.ID = rel.DEV_ID and devIp.TYPE = rel.DEV_TYPE and devIp.SERVICE_ACCOUNT_ID = rel.SERVICE_ACCOUNT_ID
      where rel.ID is null and devIp.MEMBER_ID = #{memberId}
      <if test="ip != '' and ip != null" >
        and devIp.IP like CONCAT('%',#{ip},'%')
      </if>
      <if test="devName != '' and devName != null" >
        and devIp.NAME like CONCAT('%',#{dev.NAME},'%')
      </if>
    </if>
  
```
#### pagePoolIps
```

    SELECT
      ip.ID,
      ip.IP,
      ip.CIDR_BLOCK_ID,
      ip.USAGE_INFO,
      ip.REMARK,
      cidr.CIDR_BLOCK,
      ip.STATUS,
      group_concat( ip.IP_TYPE )as ipType,
      group_concat( rel.DEV_ID ) AS devId,
      group_concat( rel.DEV_TYPE ) AS devType,
      group_concat( dev.NAME ) AS devName,
      group_concat( appSystem.NAME ) AS appSystemName,
      ip.CREATE_BY,
      ip.CREATE_DATE,
      ip.LAST_MODIFIED_BY,
      ip.LAST_MODIFIED_DATE,
      ip.FROZEN_DATE,
      ip.LOGIC_SEGMENT_ID,
      CONCAT('poolIP-', ip.ID) uniqueIndex,
      'poolIP' AS ipSource
    FROM (select * from CJ_CMP_IP_POOL ipPool
          <where>
            <if test="ip != null" >
              and ipPool.IP like CONCAT('%',#{ip},'%')
            </if>
            <if test="cidrBlockId != null" >
              and ipPool.CIDR_BLOCK_ID = #{cidrBlockId}
            </if>
            <if test="logicSegmentId != null" >
              and ipPool.LOGIC_SEGMENT_ID = #{logicSegmentId}
            </if>
            <if test="status != null" >
              and ipPool.STATUS = #{status}
            </if>
            <if test="ipType != null" >
              and ipPool.IP_TYPE = #{ipType}
            </if>
            <if test="usageInfo != null" >
              and ipPool.USAGE_INFO like CONCAT('%',#{usageInfo},'%')
            </if>
            and ipPool.MEMBER_ID = #{memberId}
          </where>
          <if test="ip == null and cidrBlockId == null and logicSegmentId == null and status == null and usageInfo == null and devType == null and devName == null" >
            order by
            <if test="sortField != '' and sortField != null">
              ipPool.${sortField} ${sortType},
            </if>
            <if test="orderByIp != null and orderByIp == true">
              inet_aton(ipPool.IP),
            </if>
            ipPool.ID
            <if test="offset != 0 or limit != 0">
                limit #{offset}, #{limit}
            </if>
          </if>
    ) ip
    LEFT JOIN CJ_CMP_CIDR_BLOCK cidr ON ip.CIDR_BLOCK_ID = cidr.ID
    LEFT JOIN (select * from CJ_CMP_IP_X_DEV ipDev
                <where>
                  <if test="devType != null" >
                    and ipDev.DEV_TYPE = #{devType}
                  </if>
                </where>
    ) rel ON ip.ID = rel.IP_ID
    LEFT JOIN (select * from CJ_CMP_DEV_VIEW devView
                <where>
                  <if test="devName != '' and devName != null" >
                    and devView.NAME like CONCAT('%',#{dev.NAME},'%')
                  </if>
                </where>
    ) dev ON rel.DEV_ID = dev.ID AND rel.SERVICE_ACCOUNT_ID = dev.SERVICE_ACCOUNT_ID
    LEFT JOIN CJ_CMP_APP_SYSTEM appSystem ON dev.APP_SYSTEM_ID = appSystem.ID AND appSystem.IS_DELETED = 0
    group by ip.ID
    <if test="ip != null or cidrBlockId != null or logicSegmentId != null or status != null or usageInfo != null or devType != null or devName != null" >
      order by
      <if test="sortField != '' and sortField != null">
        ip.${sortField} ${sortType},
      </if>
      <if test="orderByIp != null and orderByIp == true">
        inet_aton(ip.IP),
      </if>
      ip.ID
      <if test="offset != 0 or limit != 0">
        limit #{offset}, #{limit}
      </if>
    </if>
  
```
#### pageDevIps
```

      select devIp.ID, devIp.IP, null, null, null, null, 'unmanage',null, devIp.ID as devId, devIp.TYPE as devType,
      devIp.NAME as devName, appSystem.NAME as appSystemName,
      devIp.CREATE_BY, devIp.CREATE_DATE, devIp.LAST_MODIFIED_BY, devIp.LAST_MODIFIED_DATE, null, null, CONCAT('devIP-', devIp.uniqueIndex) uniqueIndex, 'devIP' as ipSource
      from (
        select @index := @index + 1 as `uniqueIndex`, devView.* from
        (select * from CJ_CMP_DEV_IP_VIEW) devView,
        (select @index := 0) indexId
      ) devIp
      left join CJ_CMP_APP_SYSTEM appSystem on devIp.APP_SYSTEM_ID = appSystem.ID and appSystem.IS_DELETED = 0
      left join CJ_CMP_IP_X_DEV rel on devIp.ID = rel.DEV_ID and devIp.TYPE = rel.DEV_TYPE and devIp.SERVICE_ACCOUNT_ID = rel.SERVICE_ACCOUNT_ID
      where rel.ID is null and devIp.MEMBER_ID = #{memberId}
      <if test="ip != '' and ip != null">
        and devIp.IP like CONCAT('%',#{ip},'%')
      </if>
      <if test="devName != '' and devName != null">
        and devIp.NAME like CONCAT('%',#{dev.NAME},'%')
      </if>
      order by
      <if test="sortField != '' and sortField != null">
        devIp.${sortField} ${sortType},
      </if>
      <if test="orderByIp != null and orderByIp == true">
        inet_aton(devIp.IP),
      </if>
      devIp.ID
      <if test="offset != 0 or limit != 0">
        limit #{offset}, #{limit}
      </if>
  
```
#### pageIpCount
```

    SELECT * FROM (
        SELECT count(ip1.ID) FROM (SELECT ip.ID
        FROM (select * from CJ_CMP_IP_POOL ipPool
              <where>and ipPool.MEMBER_ID = #{memberId}
                <if test="ip != null" >
                and ipPool.IP like CONCAT('%',#{ip},'%')
                </if>
                <if test="cidrBlockId != null" >
                  and ipPool.CIDR_BLOCK_ID = #{cidrBlockId}
                </if>
                <if test="logicSegmentId != null" >
                  and ipPool.LOGIC_SEGMENT_ID = #{logicSegmentId}
                </if>
                <if test="status != null" >
                  and ipPool.STATUS = #{status}
                </if>
                <if test="ipType != null" >
                  and ipPool.IP_TYPE = #{ipType}
                </if>
                <if test="usageInfo != null" >
                  and ipPool.USAGE_INFO like CONCAT('%',#{usageInfo},'%')
                </if>
              </where>
              order by ipPool.ID
        ) ip
        LEFT JOIN CJ_CMP_CIDR_BLOCK cidr ON ip.CIDR_BLOCK_ID = cidr.ID
        <if test="devType != null" >
          LEFT JOIN (select * from CJ_CMP_IP_X_DEV ipDev
                    <where>
                      <if test="devType != null" >
                        and ipDev.DEV_TYPE = #{devType}
                      </if>
                    </where>
          ) rel ON ip.ID = rel.IP_ID
        </if>
        <if test="devName != '' and devName != null" >
          LEFT JOIN (select * from CJ_CMP_DEV_VIEW devView
                    <where>
                      <if test="devName != '' and devName != null" >
                        and devView.NAME like CONCAT('%',#{dev.NAME},'%')
                      </if>
                    </where>
          ) dev ON rel.DEV_ID = dev.ID AND rel.SERVICE_ACCOUNT_ID = dev.SERVICE_ACCOUNT_ID
        </if>
        group by ip.ID order by
        <if test="sortField != '' and sortField != null">
          ip.${sortField} ${sortType},
        </if>
        <if test="orderByIp != null and orderByIp == true">
          inet_aton(ip.IP),
        </if>
        ip.ID) ip1
      <if test="(status == null or status == '') and (ipType == null or ipType == '') and (usageInfo == null or usageInfo == '') and cidrBlockId == null and logicSegmentId == null">
        union all
        SELECT count(ip2.ID) FROM (select devIp.ID
        from CJ_CMP_DEV_IP_VIEW devIp
        left join CJ_CMP_APP_SYSTEM appSystem on devIp.APP_SYSTEM_ID = appSystem.ID and appSystem.IS_DELETED = 0
        left join CJ_CMP_IP_X_DEV rel on devIp.ID = rel.DEV_ID and devIp.TYPE = rel.DEV_TYPE and devIp.SERVICE_ACCOUNT_ID = rel.SERVICE_ACCOUNT_ID
        where rel.ID is null and devIp.MEMBER_ID = #{memberId}
        <if test="ip != '' and ip != null">
          and devIp.IP like CONCAT('%',#{ip},'%')
        </if>
        <if test="devName != '' and devName != null">
          and devIp.NAME like CONCAT('%',#{dev.NAME},'%')
        </if>
        ) ip2
      </if>
    ) ipPool
  
```
#### listIpInfo
```

    select ip.ID, ip.IP, ip.CIDR_BLOCK_ID, ip.USAGE_INFO, ip.REMARK, cidr.CIDR_BLOCK, ip.STATUS, group_concat(rel.DEV_ID) as devId, group_concat(rel.DEV_TYPE) as devType, group_concat(dev.NAME) as devName, group_concat(appSystem.NAME) as appSystemName,
    ip.CREATE_BY, ip.CREATE_DATE, ip.LAST_MODIFIED_BY, ip.LAST_MODIFIED_DATE, ip.FROZEN_DATE
    from CJ_CMP_CIDR_BLOCK cidr
    inner join CJ_CMP_IP_POOL ip on ip.CIDR_BLOCK_ID = cidr.ID
    left join CJ_CMP_IP_X_DEV rel on ip.ID = rel.IP_ID
    left join CJ_CMP_DEV_VIEW dev on rel.DEV_ID = dev.ID and  rel.SERVICE_ACCOUNT_ID = dev.SERVICE_ACCOUNT_ID
    left join CJ_CMP_APP_SYSTEM appSystem on dev.APP_SYSTEM_ID = appSystem.ID and appSystem.IS_DELETED = 0
    <where>
      and ip.MEMBER_ID = #{memberId}
      <if test="id != '' and id != null" >
        and ip.ID = #{id}
      </if>
    </where>
    group by ip.ID order by ip.ID
  
```
#### queryAllIpUsage
```

    select (CASE
            WHEN cidr.IP_VERSION = 'IPv6' THEN null
            WHEN cidr.IP_VERSION = 'IPv4' THEN count(ip.CIDR_BLOCK_ID) END)    as ipSum,
       (CASE
            WHEN cidr.IP_VERSION = 'IPv6' THEN null
            WHEN cidr.IP_VERSION = 'IPv4' THEN sum(ip.STATUS != 'unused') END) as ipUsed,
       (CASE
            WHEN cidr.IP_VERSION = 'IPv6' THEN null
            WHEN cidr.IP_VERSION = 'IPv4' THEN sum(ip.STATUS = 'unused') END)  as ipUnused,
       (CASE
            WHEN cidr.IP_VERSION = 'IPv6' THEN null
            WHEN cidr.IP_VERSION = 'IPv4' THEN round((sum(ip.STATUS != 'unused') / count(ip.CIDR_BLOCK_ID) * 100),
                                                     2) END)                   as ipUsage,cidr.IP_VERSION
from CJ_CMP_CIDR_BLOCK cidr
         left join
     (select CIDR_BLOCK_ID, `TYPE`
      from CJ_CMP_CIDR_BLOCK_X_NETWORK rel
               inner join CJ_CMP_SERVICE_ACCOUNT sa on rel.SERVICE_ACCOUNT_ID = sa.ID
      where sa.TYPE = 'aliyunPublic')
         as al on cidr.ID = al.CIDR_BLOCK_ID
         left join CJ_CMP_IP_POOL ip on cidr.ID = ip.CIDR_BLOCK_ID
      where al.TYPE is  null and cidr.IP_VERSION = 'IPV4' and cidr.MEMBER_ID = #{memberId}
      group by cidr.IP_VERSION

  
```
#### deleteBatchByIpAndCidr
```

    delete from CJ_CMP_IP_POOL
    where MEMBER_ID = #{memberId}
    and CIDR_BLOCK_ID = #{cidrBlockId}
    and inet_aton(IP) &gt;= inet_aton(#{startIp})
    and inet_aton(ip) &lt;= inet_aton(#{endIp})
  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_IP_X_DEV.xml
> sql统计:复杂0个，简单14个
>
> 使用的关键字：values,NOW,CJ_CMP_IP_X_DEV

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_KUBESPHERE_CLUSTER.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：and,now,CJ_CMP_KUBESPHERE_CLUSTER,values,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_MAIN_MEMBER_GRANT.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：now,CJ_CMP_MAIN_MEMBER_GRANT,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_MID_SERVER_JOB.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：max,CJ_CMP_MID_SERVER_JOB,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_NETWORK_AREA.xml
> sql统计:复杂1个，简单7个
>
> 使用的关键字：CJ_CMP_NETWORK_AREA,IF,join,NOW,CONCAT,values,count,sum,round
#### selectAllPage
```

    select  area.ID,
            area.NAME,
            area.CODE,
            area.create_by,
            area.description,
            area.NODE_AREA,
            area.DATACENTER_ID,
            area.create_date,
            area.last_modified_by,
            area.last_modified_date,
    count(case when cidr.IP_VERSION = 'IPv6' then 0 when cidr.IP_VERSION = 'IPv4' then ip.IP end)  as IP_SUM,
    sum(case when cidr.IP_VERSION = 'IPv6' then 0 when cidr.IP_VERSION = 'IPv4' then IF(ip.STATUS = 'used', 1, 0) end)   as IP_USED,
    sum(case when cidr.IP_VERSION = 'IPv6' then 0 when cidr.IP_VERSION = 'IPv4' then IF(ip.STATUS = 'unused', 1, 0) end)   as IP_UNUSED,
    round(sum(case when cidr.IP_VERSION = 'IPv6' then 0 when cidr.IP_VERSION = 'IPv4' then IF(ip.STATUS = 'used', 1, 0) end)/ sum(case when cidr.IP_VERSION = 'IPv6' then 0 when cidr.IP_VERSION = 'IPv4' then ip.IP end)* 100,2) as IP_USAGE
    from CJ_CMP_NETWORK_AREA area
    left join CJ_CMP_CIDR_BLOCK cidr on cidr.NETWORK_AREA_ID = area.ID
    left join
    (select CIDR_BLOCK_ID, `TYPE`
    from CJ_CMP_CIDR_BLOCK_X_NETWORK rel
    inner join CJ_CMP_SERVICE_ACCOUNT sa on rel.SERVICE_ACCOUNT_ID = sa.ID
    where sa.TYPE = 'aliyunPublic')
    as al on cidr.ID = al.CIDR_BLOCK_ID
    left join CJ_CMP_IP_POOL ip on cidr.ID = ip.CIDR_BLOCK_ID
    WHERE area.MEMBER_ID = #{memberId} and area.IS_DELETED = 0
    <if test="name != null and name != ''" >
      and area.`NAME` like CONCAT('%',#{name},'%')
    </if>
    <if test="searchKey != null and searchKey != ''" >
      and area.`NAME` like CONCAT('%',#{searchKey},'%')
    </if>
    group by area.ID, area.NAME, area.CODE
    <if test="sortField != null and sortField!= '' and sortType != null and sortType!= '' ">
      ORDER BY ${sortField} ${sortType}
    </if>

  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_OBSERVABILITY_REPORT.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：COUNT,and,in,count,date_add

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_OS.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：NOW,in,and,now,CJ_CMP_OS,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_OS_X_IMAGE.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：from,join,CJ_CMP_OS_X_IMAGE,values,NOW,count

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_PHYSICAL_VIRTUAL_MACHINE_VIEW.xml
> sql统计:复杂1个，简单1个
>
> 使用的关键字：COUNT,DISTINCT,ifnull,concat,and,from,SUM,ceil
#### queryCloudComputerList
```

        select v.ID,v.SERVICE_ACCOUNT_ID,v.CLOUD_ACCOUNT_ID,v.LDC_ID,v.LDC_TYPE,v.TYPE,v.ENTITY_ID, v.NAME,sa.NAME as serviceAccountName,v.MEMBER_ID as memberId, um.`NAME` AS memberName,v.CLOUD_ACCOUNT_NAME,v.LDC_NAME,
        ifnull(v.CLUSTER_NAME,v.ZONE_NAME) as clusterName,v.RUN_STATUS,v.IP,concat(v.CPUS,'C/',ceil(v.MEMORY/1024),'G') as spec,v.HOST_ENTITY_NAME,v.HOST_SN,v.HOST_IP,app.NAME as appSystemName,
        v.OWNED_BY,uu.USER_NAME as ownedByName,project.NAME AS projectName,depart.NAME as dept,uaas.USER_NAME as assigner,v.ASSIGNED_TO
        from cj_cmp_vm_view v
        inner join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID=v.SERVICE_ACCOUNT_ID and sa.IS_DELETED=0
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=v.APP_SYSTEM_ID
        left outer join CJ_CMP_PROJECT project on project.ID=v.PROJECT_ID
        left join ydduc.UC_MEMBER um on um.ID = v.MEMBER_ID
        left join ydduc.UC_USER uu on uu.ID = v.OWNED_BY
        LEFT JOIN ydduc.UC_USER uaas ON v.ASSIGNED_TO = uaas.ID
        LEFT JOIN ydduc.UC_DEPARTMENT depart ON uu.DEPARTMENT = depart.ID
        <where>
        <if test="memberId != 0">and v.MEMBER_ID = #{memberId}</if>
        <if test="searchKey != null ">
            <choose>
                <when test="searchType == 'name'">
                    and v.NAME like #{searchKey}
                </when>
                <when test="searchType == 'serviceAccount'">
                    and sa.NAME like #{searchKey}
                </when>
                <when test="searchType == 'cloudAccount'">
                    and v.CLOUD_ACCOUNT_NAME like #{searchKey}
                </when>
                <when test="searchType == 'ldc'">
                    and v.LDC_NAME like #{searchKey}
                </when>
                <when test="searchType == 'cluster'">
                    and ifnull(v.CLUSTER_NAME,v.ZONE_NAME) like #{searchKey}
                </when>
                <when test="searchType == 'ip'">
                    and v.IP like #{searchKey}
                </when>
                <when test="searchType == 'app'">
                    and app.NAME like #{searchKey}
                </when>
                <when test="searchType == 'owner'">
                    and v.OWNED_BY in<foreach collection="ownerIds" item="id" open="(" close=")" separator=","> #{id} </foreach>
                </when>
                <otherwise>
                and ( v.NAME like #{searchKey}
                    or sa.NAME like #{searchKey}
                    or v.CLOUD_ACCOUNT_NAME like #{searchKey}
                    or v.LDC_NAME like #{searchKey}
                    or ifnull(v.CLUSTER_NAME,v.ZONE_NAME) like #{searchKey}
                    or v.IP like #{searchKey}
                    or app.NAME like #{searchKey}
                    or v.HOST_ENTITY_NAME like #{searchKey}
                    or concat(v.CPUS,'C/',ceil(v.MEMORY/1024),'G') like #{searchKey}
                    or v.OWNED_BY in<foreach collection="ownerIds" item="id" open="(" close=")" separator=","> #{id} </foreach>
                )
                </otherwise>
            </choose>
        </if>
        </where>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_PM_HARDWARE_TEMPLATE.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：and,CONCAT,now,CJ_CMP_PM_HARDWARE_TEMPLATE,values,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_PM_INSTANCE.xml
> sql统计:复杂1个，简单0个
>
> 使用的关键字：join,concat,IFNULL,and,INSTR,LOWER,CONCAT,SUBSTRING_INDEX,REPLACE,ifnull
#### list
```

    select pm.ID,pm.MEMBER_ID,pm.NAME,pm.CPU_CORE_COUNT as cpus,pm.RAM as memory,pm.DISK_SPACE as disk, pm.SN, pm.ENTITY_ID, pm.OPERATIONAL_STATUS as `status`, pm.RUN_STATUS as runStatus, pm.OOB_IP as ip,pm.BIZ_IP, pm.label, concat(pm.OS_DOMAIN, IFNULL(pm.OS_VERSION,'')) as os,pm.IS_LOCKED,
    pm.OWNED_BY, depart.`NAME` as dept, sa.NAME AS serviceAccountName, cdc.CLOUD_ACCOUNT_ID, ca.NAME asCLOUD_ACCOUNT_NAME,app.NAME as appSystemName, du.NAME as appDuName , du.APP_DU_TYPE as appDuType, dc.NAME as dataCenter,room.NAME as serverRoom,cabinet.NAME as serverCabinet,
    pm.U_START as uStart, region.NAME as region, pm.USED_FOR as `usage`,sa.DATACENTER_TYPE, pm.MANUFACTURER, pm.MODEL_ID as model
    from CJ_CMDB_CI_PHYSICAL_DATACENTER dc inner join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID=dc.SERVICE_ACCOUNT_ID and sa.IS_DELETED=0 and dc.IS_DELETED=0
    left outer join CJ_CMP_CLOUD_ACCOUNT_DC cdc on cdc.SERVICE_ACCOUNT_ID=dc.SERVICE_ACCOUNT_ID and cdc.LDC_ID=dc.ID and cdc.IS_DELETED=0
    left outer join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID=cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED=0
    inner join CJ_CMDB_CI_PHYSICAL_MACHINE pm on pm.LDC_ID=dc.ID and pm.IS_DELETED=0
    left outer join CJ_CMDB_CI_COMPUTER_ROOM room on pm.COMPUTER_ROOM_ID=room.ID
    left outer join CJ_CMDB_CI_CABINET cabinet on cabinet.ID=pm.CABINET_ID
     left outer join CJ_CMP_APP_SYSTEM app on app.ID=pm.APP_SYSTEM_ID
     left outer join CJ_CMDB_CI_SYS_REGION region on pm.REGION_ID = region.ID and region.IS_DELETED = 0
     left join CJ_CMP_APP_DU du on pm.APP_DU_ID = du.ID and du.IS_DELETED = 0
     LEFT JOIN ydduc.UC_USER u ON pm.OWNED_BY = u.ID
     LEFT JOIN ydduc.UC_DEPARTMENT depart ON u.DEPARTMENT = depart.ID
     where pm.ENTITY_ID is not null and pm.IS_DELETED=0
      <if test="queryParam.cloudAccountId != null and queryParam.cloudAccountId != ''"> and ca.ID=#{queryParam.cloudAccountId}</if>
      <if test="queryParam.serviceAccountId != null and queryParam.serviceAccountId != ''"> and sa.ID=#{queryParam.serviceAccountId}</if>
      <if test="queryParam.ldcId != null and queryParam.ldcId != ''"> and dc.ID=#{queryParam.ldcId}</if>
      <if test="queryParam.azId != null and queryParam.azId != ''"> and room.ID=#{queryParam.azId}</if>
    <if test="queryParam.memberId != 0">  and pm.MEMBER_ID = #{queryParam.memberId}</if>
    <if test="queryParam.appSystemName != null and queryParam.appSystemName != ''"> and app.NAME like CONCAT('%',#{queryParam.appSystemName},'%')</if>
    <if test="queryParam.name != null and queryParam.name != ''"> and pm.NAME like CONCAT('%',#{queryParam.name},'%')</if>
    <if test="queryParam.ip != null and queryParam.ip != ''"> and pm.OOB_IP like CONCAT('%',#{queryParam.ip},'%')</if>
    <if test="queryParam.userIds != null and queryParam.userIds.size >0 ">
     and ( pm.OWNED_BY in <foreach collection="queryParam.userIds" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
       <if test="queryParam.appUserId !=null ">
           or app.SYS_OPR_MANT_OWNER_ID= #{queryParam.appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{queryParam.appUserId} or app.BIZ_OWNER_ID=#{queryParam.appUserId}
           <if test="queryParam.appDepartmentList != null and queryParam.appDepartmentList.size != 0">
             or app.DEPT_ID in <foreach collection="queryParam.appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
             or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="queryParam.appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
           </if>
       </if>
     )
    </if>
    <if test="queryParam.ownedByList != null and queryParam.ownedByList.size != 0">
      and pm.OWNED_BY in <foreach collection="queryParam.ownedByList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
    </if>
    <if test="queryParam.sn != null and queryParam.sn != ''"> and pm.SN like CONCAT('%',#{queryParam.sn},'%')</if>
    <if test="queryParam.runStatus != null and queryParam.runStatus != ''"> and pm.RUN_STATUS = #{queryParam.runStatus}</if>
    <if test="queryParam.status != null and queryParam.status != ''"> and pm.OPERATIONAL_STATUS = #{queryParam.status}</if>
    <if test="queryParam.searchKey != null and queryParam.searchKey != ''">
      and (pm.NAME like CONCAT('%',#{queryParam.searchKey},'%') or pm.OOB_IP like CONCAT('%',#{queryParam.searchKey},'%') or pm.sn like CONCAT('%',#{queryParam.searchKey},'%') or pm.RUN_STATUS = #{queryParam.searchKey} 
           or pm.OPERATIONAL_STATUS = #{queryParam.searchKey} or pm.BIZ_IP like CONCAT('%', #{queryParam.searchKey}, '%') or app.NAME like CONCAT('%',#{queryParam.searchKey},'%')
           or dc.NAME like CONCAT('%',#{queryParam.searchKey},'%') or room.NAME like CONCAT('%',#{queryParam.searchKey},'%') or cabinet.NAME like CONCAT('%',#{queryParam.searchKey},'%')
      <if test="queryParam.searchKeyList != null and queryParam.searchKeyList.size != 0">
        or pm.OWNED_BY in <foreach collection="queryParam.searchKeyList" item="searchKey" open="(" close=")" separator=",">#{searchKey}</foreach>
      </if>
      )
    </if>
    <if test=" queryParam.bizIps != null and queryParam.bizIps.size >0 ">
      and <foreach collection="queryParam.bizIps" item="ip" open="(" close=")" separator="or">INSTR(pm.BIZ_IP, #{ip})</foreach>
    </if>
    union all
    select  cpm.ID,cpm.MEMBER_ID,cpm.DEVICE_NAME as NAME,SUBSTRING_INDEX(LOWER(cpm.SPEC),'c',1) as cpus, REPLACE(SUBSTRING_INDEX(LOWER(cpm.SPEC),'c',-1),'g','')*1024 as memory,'' as disk ,cpm.SERVICE_TAG as SN, cpm.ENTITY_ID, cpm.OPERATIONAL_STATUS as `status`, cpm.RUN_STATUS as runStatus, cpm.IP as ip,'' as BIZ_IP,cpm.MANUFACTURER as label,cpm.OS as os,cpm.IS_LOCKED,
        cpm.OWNED_BY, depart.`NAME` as dept, sbTable.NAME AS serviceAccountName, sbTable.CLOUD_ACCOUNT_ID, sbTable.CLOUD_ACCOUNT_NAME,app.NAME as appSystemName, du.NAME as appDuName , du.APP_DU_TYPE as appDuType, sbTable.DATACENTER as dataCenter, cpm.ROOM_NAME as serverRoom,cpm.FRAME_CODE as serverCabinet,
        cpm.START_U as uStart,'' as region, cpm.DESCRIPTION as `usage`,sbTable.DATACENTER_TYPE, cpm.MANUFACTURER, cpm.MODEL
        from CJ_CMP_CLOUDSINO_PHYSICAL_MACHINE cpm inner join
        ( select distinct
        `sa`.ID as SERVICE_ACCOUNT_ID,
        `sa`.NAME,
        `sa`.DATACENTER_TYPE,
        '' as DATACENTER,
        `ca`.ID as CLOUD_ACCOUNT_ID,
        `ca`.NAME as CLOUD_ACCOUNT_NAME
        from
        `CJ_CMP_SERVICE_ACCOUNT` `sa`
        INNER JOIN `CJ_CMP_CLOUD_ACCOUNT_DC` `cdc` ON `cdc`.SERVICE_ACCOUNT_ID = `sa`.ID and `cdc`.IS_DELETED = 0
        INNER JOIN `CJ_CMP_CLOUD_ACCOUNT` `ca` ON `ca`.ID = `cdc`.CLOUD_ACCOUNT_ID and `ca`.IS_DELETED = 0
        inner join `CJ_CMP_CLOUDSINO_PHYSICAL_MACHINE` `dc` on `dc`.SERVICE_ACCOUNT_ID = `sa`.ID and `dc`.IS_DELETED = 0
        <where>
          <if test="queryParam.memberId != null and queryParam.memberId != ''">  and `dc`.MEMBER_ID = #{queryParam.memberId}</if>
        </where>
        ) sbTable on cpm.SERVICE_ACCOUNT_ID = sbTable.SERVICE_ACCOUNT_ID
        left outer join CJ_CMP_APP_SYSTEM app on app.ID = cpm.APP_SYSTEM_ID
        LEFT JOIN ydduc.UC_USER u ON cpm.OWNED_BY = u.ID
        LEFT JOIN ydduc.UC_DEPARTMENT depart ON u.DEPARTMENT = depart.ID
        left join CJ_CMP_APP_DU du on cpm.APP_DU_ID = du.ID
        and du.IS_DELETED = 0
        where  cpm.IS_DELETED = 0
        <if test="queryParam.memberId != null and queryParam.memberId != ''">  and cpm.MEMBER_ID = #{queryParam.memberId}</if>
        <if test="queryParam.appSystemName != null and queryParam.appSystemName != ''"> and app.NAME like CONCAT('%',#{queryParam.appSystemName},'%')</if>
        <if test="queryParam.name != null and queryParam.name != ''"> and cpm.DEVICE_NAME like CONCAT('%',#{queryParam.name},'%')</if>
        <if test="queryParam.ip != null and queryParam.ip != ''"> and cpm.IP like CONCAT('%',#{queryParam.ip},'%')</if>
        <if test="queryParam.userIds != null and queryParam.userIds.size >0 ">
            and ( cpm.OWNED_BY in <foreach collection="queryParam.userIds" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
            <if test="queryParam.appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{queryParam.appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{queryParam.appUserId} or app.BIZ_OWNER_ID=#{queryParam.appUserId}
                <if test="queryParam.appDepartmentList != null and queryParam.appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="queryParam.appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="queryParam.appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
            )
        </if>
        <if test="queryParam.ownedByList != null and queryParam.ownedByList.size != 0">
            and cpm.OWNED_BY in <foreach collection="queryParam.ownedByList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
        </if>
        <if test="queryParam.sn != null and queryParam.sn != ''"> and cpm.SERVICE_TAG like CONCAT('%',#{queryParam.sn},'%')</if>
        <if test="queryParam.runStatus != null and queryParam.runStatus != ''"> and cpm.RUN_STATUS = #{queryParam.runStatus}</if>
        <if test="queryParam.status != null and queryParam.status != ''"> and cpm.OPERATIONAL_STATUS = #{queryParam.status}</if>
        <if test="queryParam.searchKey != null and queryParam.searchKey != ''">
            and (cpm.DEVICE_NAME like CONCAT('%',#{queryParam.searchKey},'%') or cpm.IP like CONCAT('%',#{queryParam.searchKey},'%') or cpm.SERVICE_TAG like CONCAT('%',#{queryParam.searchKey},'%') 
                  or cpm.RUN_STATUS = #{queryParam.searchKey} or  cpm.OPERATIONAL_STATUS = #{queryParam.searchKey} or app.NAME like CONCAT('%',#{queryParam.searchKey},'%')
                  or sbTable.DATACENTER like CONCAT('%',#{queryParam.searchKey},'%') or cpm.ROOM_NAME like CONCAT('%',#{queryParam.searchKey},'%') or cpm.FRAME_CODE like CONCAT('%',#{queryParam.searchKey},'%')
            <if test="queryParam.searchKeyList != null and queryParam.searchKeyList.size != 0">
                or cpm.OWNED_BY in <foreach collection="queryParam.searchKeyList" item="searchKey" open="(" close=")" separator=",">#{searchKey}</foreach>
            </if>
            )
        </if>
    union all
    select pm.ID,pm.MEMBER_ID,pm.NAME,pm.CPU_CORE_COUNT as cpus,pm.RAM as memory,
    pm.DISK_SPACE as disk, pm.SN, pm.ENTITY_ID, pm.OPERATIONAL_STATUS as `status`,
    pm.RUN_STATUS as runStatus, pm.OOB_IP as ip,pm.BIZ_IP, pm.label,
    concat(pm.OS_DOMAIN, IFNULL(pm.OS_VERSION,'')) as os,pm.IS_LOCKED,
    pm.OWNED_BY, depart.`NAME` as dept, sa.NAME AS serviceAccountName,
    ca.ID as CLOUD_ACCOUNT_ID, ca.NAME as CLOUD_ACCOUNT_NAME,null,
    null , null as appDuType, dc.NAME as dataCenter,
    az.NAME as serverRoom,cabinet.NAME as serverCabinet,
    pm.U_START as uStart,null, pm.USED_FOR as `usage`,
    sa.DATACENTER_TYPE, pm.MANUFACTURER, pm.MODEL_ID as model
    from CJ_CMDB_CI_PHYSICAL_MACHINE pm
    inner join CJ_PAM_ASSET ass on pm.ID = ass.PM_ID
    LEFT JOIN CJ_CMDB_CI_CABINET cabinet on cabinet.ID=pm.CABINET_ID and cabinet.IS_DELETED=0
    LEFT JOIN CJ_CMDB_CI_COMPUTER_ROOM az on az.ID = cabinet.COMPUTER_ROOM_ID and az.IS_DELETED = 0
    LEFT JOIN CJ_CMDB_CI_PHYSICAL_DATACENTER dc on dc.ID = az.DATACENTER_ID and dc.IS_DELETED = 0
    LEFT JOIN CJ_CMP_SERVICE_ACCOUNT sa on sa.ID = pm.SERVICE_ACCOUNT_ID
    LEFT JOIN CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = ass.CLOUD_ACCOUNT_ID and ca.id
    LEFT JOIN ydduc.UC_USER u ON pm.OWNED_BY = u.ID
    LEFT JOIN ydduc.UC_DEPARTMENT depart ON u.DEPARTMENT = depart.ID
    where pm.ENTITY_ID is not null and pm.IS_DELETED=0
    <if test="queryParam.sn != null and queryParam.sn != ''">  and pm.SN like CONCAT('%',#{queryParam.sn},'%')</if>
    union all
    select bms.ID,bms.MEMBER_ID,bms.SERVICE_ACCOUNT_ID,spec.VCPUS,spec.RAM,spec.DISK,bms.SN,bms.ENTITY_ID,bms.STATUS,null,null,ifnull(bms.IPV4,bms.IPV6),null,img.NAME,0,bms.OWNED_BY,depart.`NAME` as dept, sa.NAME,cdc.CLOUD_ACCOUNT_ID,ca.NAME,app.NAME,null,null,null,null,null,null,dc.NAME,bms.USED_FOR,sa.DATACENTER_TYPE,null,null
    from CJ_CMP_FUSION_CLOUD_BMS_INSTANCE bms inner join CJ_CMP_FUSION_CLOUD_DC dc on bms.LDC_ID=dc.ID
    inner join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID=bms.SERVICE_ACCOUNT_ID
    inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc on cdc.LDC_ID=dc.ID and bms.SERVICE_ACCOUNT_ID=cdc.SERVICE_ACCOUNT_ID and cdc.IS_DELETED=0
    inner join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID=cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED=0
    <choose> <when test="queryParam.mainMemberId != 0"> and ca.MEMBER_ID = #{queryParam.mainMemberId} </when> <otherwise> and ca.SCOPE = 'public' </otherwise> </choose>
    left outer join CJ_CMP_FUSION_CLOUD_BMS_FLAVOR spec on spec.ID=bms.SPEC_ID
    left outer join CJ_CMP_VM_IMAGE img on img.ID=bms.IMAGE_ID
    LEFT JOIN ydduc.UC_USER u ON bms.OWNED_BY = u.ID
    LEFT JOIN ydduc.UC_DEPARTMENT depart ON u.DEPARTMENT = depart.ID
    left outer join CJ_CMP_APP_SYSTEM app on app.ID=bms.APP_SYSTEM_ID
    where bms.IS_DELETED=0 and bms.ENTITY_ID is not null
    <if test="queryParam.cloudAccountId != null and queryParam.cloudAccountId != ''"> and ca.ID=#{queryParam.cloudAccountId}</if>
    <if test="queryParam.serviceAccountId != null and queryParam.serviceAccountId != ''"> and sa.ID=#{queryParam.serviceAccountId}</if>
    <if test="queryParam.ldcId != null and queryParam.ldcId != ''"> and dc.ID=#{queryParam.ldcId}</if>
    <if test="queryParam.azId != null and queryParam.azId != ''"> and bms.ZONE_ID=#{queryParam.azId}</if>

    <if test="queryParam.memberId != 0">  and bms.MEMBER_ID = #{queryParam.memberId}</if>
    <if test="queryParam.appSystemName != null and queryParam.appSystemName != ''"> and app.NAME like CONCAT('%',#{queryParam.appSystemName},'%')</if>
    <if test="queryParam.name != null and queryParam.name != ''"> and bms.NAME like CONCAT('%',#{queryParam.name},'%')</if>
    <if test="queryParam.ip != null and queryParam.ip != ''"> and (bms.IPV4 like CONCAT('%',#{queryParam.ip},'%') or bms.IPV6 like CONCAT('%',#{queryParam.ip},'%'))</if>
    <if test="queryParam.userIds != null and queryParam.userIds.size >0 ">
     and ( bms.OWNED_BY in <foreach collection="queryParam.userIds" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
       <if test="queryParam.appUserId !=null ">
           or app.SYS_OPR_MANT_OWNER_ID= #{queryParam.appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{queryParam.appUserId} or app.BIZ_OWNER_ID=#{queryParam.appUserId}
           <if test="queryParam.appDepartmentList != null and queryParam.appDepartmentList.size != 0">
             or app.DEPT_ID in <foreach collection="queryParam.appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
             or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="queryParam.appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
           </if>
       </if>
     )
    </if>
    <if test="queryParam.ownedByList != null and queryParam.ownedByList.size != 0">
      and bms.OWNED_BY in <foreach collection="queryParam.ownedByList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
    </if>
    <if test="queryParam.sn != null and queryParam.sn != ''"> and bms.SN like CONCAT('%',#{queryParam.sn},'%')</if>
    <if test="queryParam.status != null and queryParam.status != ''"> and bms.STATUS = #{queryParam.status}</if>
    <if test="queryParam.searchKey != null and queryParam.searchKey != ''">
      and (bms.NAME like CONCAT('%',#{queryParam.searchKey},'%') or bms.IPV4 like CONCAT('%',#{queryParam.searchKey},'%') or bms.IPV6 like CONCAT('%',#{queryParam.searchKey},'%') or bms.SN like CONCAT('%',#{queryParam.searchKey},'%') 
          or bms.STATUS = #{queryParam.searchKey} or app.NAME like CONCAT('%',#{queryParam.searchKey},'%')
      <if test="queryParam.searchKeyList != null and queryParam.searchKeyList.size != 0">
        or bms.OWNED_BY in <foreach collection="queryParam.searchKeyList" item="searchKey" open="(" close=")" separator=",">#{searchKey}</foreach>
      </if>
      )
    </if>
    <if test=" queryParam.bizIps != null and queryParam.bizIps.size >0 ">
      and <foreach collection="queryParam.bizIps" item="ip" open="(" close=")" separator="or">INSTR(bms.IPV4, #{ip})</foreach>
    </if>
    order by 3
  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_PM_OR_HOST_VIEW.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：exists,and,IN

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_PM_TYPE.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：values,count,concat,NOW,now,CJ_CMP_PM_TYPE

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_PM_TYPE_X_PM.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：NOW,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_POLICY.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：or,in,now,CJ_CMP_POLICY,values,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_POLICY_RULE.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：now,CJ_CMP_POLICY_RULE,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_POLICY_SCRIPT.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：now,CJ_CMP_POLICY_SCRIPT,VALUES,WHERE,concat,AND,OR

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_POLICY_X_CATALOG_ITEM.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：values,now,CJ_CMP_POLICY_X_CATALOG_ITEM

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_PROJECT.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：concat,or,AND,IN,NOW,CJ_CMP_PROJECT,VALUES,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_PROJECT_X_APP_SYSTEM.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：NOW,CJ_CMP_PROJECT_X_APP_SYSTEM,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_PROJECT_X_USER.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：NOW,CJ_CMP_PROJECT_X_USER,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_QUOTA.xml
> sql统计:复杂0个，简单38个
>
> 使用的关键字：concat,isEmpty,startsWith,CJ_CMP_QUOTA_CONSUMPTION,VALUES,substring,indexOf,CJ_CMP_QUOTA_DEFINITION,values,CJ_CMP_QUOTA_CONFIGURATION,and,from,CJ_CMP_QUOTA_RESOURCE_TYPE,CJ_CMP_QUOTA_RESOURCE_ATTR,contains,toUpperCase,CJ_CMP_QUOTA_RESOURCE_CODE,split

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_RB.xml
> sql统计:复杂1个，简单10个
>
> 使用的关键字：CONCAT,convert,concat,NOW,CJ_CMP_RB,VALUES,and,or
#### selectByCondition
```

    select *
    from CJ_CMP_RB
    where IS_DELETED = 0 and (MEMBER_ID = #{memberId} or (MEMBER_ID = 0 and status = 'published'))
      <if test="status != null and status != ''" >
          and `STATUS` = #{status}
      </if>
      <if test="keyword != null and keyword != ''" >
          <choose>
              <when test="queryType != null and queryType == 'name'" >
                  and `NAME` like CONCAT('%',#{keyword},'%')
              </when>
              <when test="queryType != null and queryType == 'layer'" >
                  and (LAYER like CONCAT('%',#{keyword},'%') OR LAYER_NAME like CONCAT('%',#{keyword},'%'))
              </when>
              <otherwise>
                  and (
                  `NAME` like CONCAT('%',#{keyword},'%')
                  OR LAYER like CONCAT('%',#{keyword},'%')
                  OR LAYER_NAME like CONCAT('%',#{keyword},'%')
                  )
              </otherwise>
          </choose>
      </if>
      ORDER BY convert(${sortField} USING gbk) ${sortType}
  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_RB_CAPI_PROVIDER.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_RB_OP.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：and,where,NOW,CJ_CMP_RB_OP,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_RB_OP_PARAM.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：and,NOW,CJ_CMP_RB_OP_PARAM,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_RB_OP_STEP.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：and,NOW,CJ_CMP_RB_OP_STEP,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_RECYCLE_RESOURCE.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：CONCAT,concat,and,now,CJ_CMP_RECYCLE_RESOURCE,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_RESOURCE_ATTRIBUTE.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_RESOURCE_AUTHORIZATION.xml
> sql统计:复杂2个，简单6个
>
> 使用的关键字：ifnull,and,now,CJ_CMP_RESOURCE_AUTHORIZATION,values,size,NOW
#### findList
```

        select * from CJ_CMP_RESOURCE_AUTHORIZATION where MEMBER_ID = #{memberId} and IS_DELETED = 0 and BIZ_FUNCTION=#{bizFunction}
        <if test="authObjType!=null">
            and AUTH_OBJ_TYPE=#{authObjType}
            <if test="authObjIds == null || authObjIds.size() == 0">and false</if>
            <if test="authObjIds != null and authObjIds.size() > 0">
                and AUTH_OBJ_ID in <foreach collection="authObjIds" item="authObjId" open="(" separator="," close=")">#{authObjId}</foreach>
            </if>
            and NOW() between ifnull(START_TIME,NOW()) and ifnull(END_TIME,NOW())
        </if>
    
```
#### updateExpireNotify
```

        update CJ_CMP_RESOURCE_AUTHORIZATION set EXPIRE_NOTIFY=ifnull(EXPIRE_NOTIFY,0)|#{notifyTimeType} where ID in <foreach collection="ids" item="id" open="(" close=")" separator=",">#{id}</foreach>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_RESOURCE_AUTH_ENV_CONDITION.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CMP_RESOURCE_AUTH_ENV_CONDITION,VALUES,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_RESOURCE_AUTH_OBJECT.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：CJ_CMP_RESOURCE_AUTH_OBJECT,VALUES,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_RESOURCE_AUTH_RECORD.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：now,FROM,concat,WHERE,isEmpty,FIND_IN_SET,CJ_CMP_RESOURCE_AUTH_RECORD,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_RESOURCE_AUTH_SUBJECT.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：VALUES,now,CJ_CMP_RESOURCE_AUTH_SUBJECT

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_RESOURCE_OPERATION.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：VALUES,isEmpty,now,CJ_CMP_RESOURCE_OPERATION

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_RESOURCE_OPERATION_APPLICABLE_PAGE.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：NOW,CJ_CMP_RESOURCE_OPERATION_APPLICABLE_PAGE,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_RESOURCE_OPERATION_CONTROL.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：now,CJ_CMP_RESOURCE_OPERATION_CONTROL,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_RESOURCE_OPERATION_METHOD.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：NOW,CJ_CMP_RESOURCE_OPERATION_METHOD,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_RESOURCE_OPER_LOG.xml
> sql统计:复杂2个，简单5个
>
> 使用的关键字：min,if,ifnull,CONCAT,and,GROUP_CONCAT,now,max,group_concat,join,CJ_CMP_RESOURCE_OPER_LOG,values
#### queryResourceOperLog
```

      select min(log.ID) as ID, log.MEMBER_ID, if(log.MEMBER_ID=0, '平台租户', `member`.NAME) as memberName, log.SERVICE_ACCOUNT_ID, log.RESOURCE_ID,
      log.RESOURCE_TYPE, log.RESOURCE_ENTITY_ID, log.RESOURCE_NAME, log.RESOURCE_IP, log.ACTION, log.SOURCE, log.CREATE_BY, max(log.CREATE_DATE) as CREATE_DATE,
      group_concat(CHANGE_TYPE, '####', CHANGE_FIELD, '####', ifnull(OLD_VALUE, '-'), '####', ifnull(NEW_VALUE, '-') SEPARATOR '######') as changeContext
      from CJ_CMP_RESOURCE_OPER_LOG log
      left join ydduc.UC_MEMBER `member` on log.MEMBER_ID = `member`.ID
     <where>
        log.RESOURCE_TYPE = 'vm'
       <if test="queryType != null and queryType != '' and keyword != null and keyword != ''">
         <if test="queryType == 'resourceName'"> and log.RESOURCE_NAME like CONCAT('%',#{keyword},'%')</if>
         <if test="queryType == 'resourceIp'"> and log.RESOURCE_IP like CONCAT('%',#{keyword},'%')</if>
         <if test="queryType == 'resourceEntityId'"> and RESOURCE_ENTITY_ID like CONCAT('%',#{keyword},'%')</if>
         <if test="queryType == 'all'">
          and (log.RESOURCE_NAME like CONCAT('%',#{keyword},'%')
          or log.RESOURCE_IP like CONCAT('%',#{keyword},'%')
          or log.RESOURCE_ENTITY_ID like CONCAT('%',#{keyword},'%')
          or `member`.name like CONCAT('%',#{keyword},'%')
         )
         </if>
       </if>
       <if test="startTime != null and startTime != ''"> and log.CREATE_DATE &gt;= #{startTime}</if>
       <if test="endTime != null and endTime != ''"> and log.CREATE_DATE &lt;= #{endTime}</if>
     </where>
      group by log.TRACE_ID, log.RESOURCE_ID, log.MEMBER_ID, log.SERVICE_ACCOUNT_ID,
      log.RESOURCE_TYPE, log.RESOURCE_ENTITY_ID, log.RESOURCE_NAME, log.RESOURCE_IP, log.ACTION,  log.SOURCE, log.CREATE_BY
      order by min(log.ID) desc
  
```
#### getChangedVm
```

        select distinct vm.*,prj.CODE as projectCode,prj.NAME as projectName,prj.PROJECT_SOURCE_ID as projectSourceId,
        app.CODE as appSystemCode,app.NAME as appSystemName,app.SOURCE_ID as appSystemSourceId, vmtag.tags
        from CJ_CMP_RESOURCE_OPER_LOG op
        inner join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID = op.SERVICE_ACCOUNT_ID and sa.IS_DELETED = 0
        <if test="ldcType != null">
            <choose>
                <when test="ldcType == 'vmware'">
                    inner join CJ_CMP_VMWARE_VM vm on vm.SERVICE_ACCOUNT_ID = sa.ID and vm.ENTITY_ID = op.RESOURCE_ENTITY_ID
                    and vm.MEMBER_ID = op.MEMBER_ID
                </when>
                <when test="ldcType == 'fusionCloud'">
                    inner join CJ_CMP_FUSION_CLOUD_ECS vm on vm.SERVICE_ACCOUNT_ID = sa.ID and vm.ENTITY_ID = op.RESOURCE_ENTITY_ID
                    and vm.MEMBER_ID = op.MEMBER_ID
                </when>
            </choose>
        </if>
        <if test="srvCompletionTimeStart!=null or srvCompletionTimeEnd!=null ">
        left outer join CJ_CMP_RITM_COMPLETED_VIEW req on vm.SRV_NO=req.NUMBER
        </if>
        left outer join CJ_CMP_PROJECT prj on prj.ID = vm.PROJECT_ID
        left outer join CJ_CMP_APP_SYSTEM app on app.ID = vm.APP_SYSTEM_ID
        left outer join CJ_CMP_APP_DU du on du.ID = vm.APP_DU_ID
        left outer join (SELECT rel.OBJECT_ID, rel.OBJECT_TYPE, GROUP_CONCAT(tag.`NAME`) as tags
        from CJ_CMP_TAG tag
        INNER JOIN CJ_CMP_TAG_X_OBJECT rel on tag.ID = rel.TAG_ID
        GROUP BY rel.OBJECT_ID, rel.OBJECT_TYPE) as vmtag
        on vm.ID = vmtag.OBJECT_ID and vmtag.OBJECT_TYPE = #{ldcType}
        where vm.MEMBER_ID = #{memberId}
        and sa.DATACENTER_TYPE = #{ldcType}
        and RESOURCE_TYPE = 'vm'
        <if test="updateDateStart != null and updateDateEnd != null">
            and op.CREATE_DATE between #{updateDateStart,jdbcType= TIMESTAMP} and #{updateDateEnd,jdbcType= TIMESTAMP}
        </if>
        <if test="updateDateStart==null   and  updateDateEnd!=null ">
            and op.CREATE_DATE &lt;=  #{updateDateEnd,jdbcType= TIMESTAMP}
        </if>
        <if test="updateDateStart!=null  and  updateDateEnd==null ">
            and op.CREATE_DATE &gt;=  #{updateDateStart,jdbcType= TIMESTAMP}
        </if>
        <if test="startTime!=null and  endTime!=null ">
            and vm.CREATE_DATE between #{startTime,jdbcType= TIMESTAMP} and  #{endTime,jdbcType= TIMESTAMP}
        </if>
        <if test="startTime==null   and  endTime!=null ">
            and vm.CREATE_DATE &lt;=  #{endTime,jdbcType= TIMESTAMP}
        </if>
        <if test="startTime!=null  and  endTime==null ">
            and vm.CREATE_DATE &gt;=  #{startTime,jdbcType= TIMESTAMP}
        </if>
        <if test="srvCompletionTimeStart!=null and srvCompletionTimeEnd!=null ">
            and if(vm.IS_DELETED=1,vm.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) between #{srvCompletionTimeStart,jdbcType= TIMESTAMP} and  #{srvCompletionTimeEnd,jdbcType= TIMESTAMP}
        </if>
        <if test="srvCompletionTimeStart==null and srvCompletionTimeEnd!=null ">
            and if(vm.IS_DELETED=1,vm.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) &lt;=  #{srvCompletionTimeEnd,jdbcType= TIMESTAMP}
        </if>
        <if test="srvCompletionTimeStart!=null and srvCompletionTimeEnd==null ">
            and if(vm.IS_DELETED=1,vm.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) &gt;=  #{srvCompletionTimeStart,jdbcType= TIMESTAMP}
        </if>
        <if test="deleted != null ">
            <choose>
                <when test="deleted">
                    and vm.IS_DELETED=1
                </when>
                <otherwise>
                    and vm.IS_DELETED=0
                </otherwise>
            </choose>
        </if>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_RESOURCE_POOL.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：concat,NOW,CJ_CMP_RESOURCE_POOL,VALUES,IN

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_RESOURCE_TYPE.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：CJ_CMP_RESOURCE_TYPE,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_SCRIPT.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：count,in,CONCAT,NOW,CJ_CMP_SCRIPT,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_SCRIPT_CATEGORY.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：CJ_CMP_SCRIPT_CATEGORY,values,in,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_SERVICE_ACCOUNT.xml
> sql统计:复杂0个，简单17个
>
> 使用的关键字：VALUES,size,count,in,CONCAT,NOW,concat,and,now,CJ_CMP_SERVICE_ACCOUNT

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_SERVICE_INSTANCE_CHANGE.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：VALUES,on,AND,OR,in,NOW,CJ_CMP_SERVICE_INSTANCE_CHANGE

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_SERVICE_INSTANCE_OPERATE.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：NOW,CJ_CMP_SERVICE_INSTANCE_OPERATE,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_SERVICE_POOL.xml
> sql统计:复杂6个，简单8个
>
> 使用的关键字：count,sum,join,VALUES,size,and,exists,select,round,now,CJ_CMP_SERVICE_POOL
#### queryIpStatisticsBySpId
```

        select (CASE
            WHEN cidr.IP_VERSION = 'IPv6' THEN null
            WHEN cidr.IP_VERSION = 'IPv4' THEN count(ip.CIDR_BLOCK_ID) END)    as ipSum,
       (CASE
            WHEN cidr.IP_VERSION = 'IPv6' THEN null
            WHEN cidr.IP_VERSION = 'IPv4' THEN sum(ip.STATUS != 'unused') END) as ipUsed,
       (CASE
            WHEN cidr.IP_VERSION = 'IPv6' THEN null
            WHEN cidr.IP_VERSION = 'IPv4' THEN sum(ip.STATUS = 'unused') END)  as ipUnused,
       (CASE
            WHEN cidr.IP_VERSION = 'IPv6' THEN null
            WHEN cidr.IP_VERSION = 'IPv4' THEN round((sum(ip.STATUS != 'unused') / count(ip.CIDR_BLOCK_ID) * 100),
                                                     2) END)                   as ipUsage
        from CJ_CMP_CIDR_BLOCK cidr
         inner join CJ_CMP_SERVICE_POOL_X_GRANT_RES res
                    on res.GRANT_RESOURCE_TYPE = 'CIDR' and res.GRANT_RESOURCE_ID = cidr.ID and
                       res.SERVICE_POOL_ID = #{servicePoolId}
         left join
         (select CIDR_BLOCK_ID, `TYPE`
          from CJ_CMP_CIDR_BLOCK_X_NETWORK rel
                   inner join CJ_CMP_SERVICE_ACCOUNT sa on rel.SERVICE_ACCOUNT_ID = sa.ID
          where sa.TYPE = 'aliyunPublic')
         as al on cidr.ID = al.CIDR_BLOCK_ID
         left join CJ_CMP_NETWORK_AREA area on cidr.NETWORK_AREA_ID = area.ID
         left join CJ_CMP_IP_POOL ip on cidr.ID = ip.CIDR_BLOCK_ID
        where cidr.MEMBER_ID = #{memberId}
          and al.TYPE is null
          and cidr.IP_VERSION = 'IPv4'
        group by cidr.IP_VERSION
    
```
#### queryVMwareClusterResBySpId
```

        select sum(host.CPUS)                                                 as cpuSum,
               sum(host.CPU_USED)                                             as cpuUsed,
               sum(host.MEMORY_SUM) / 1024                                    as memorySum,
               sum(host.MEMORY_USED) / 1024                                   as memoryUsed,
               sum(host.DISK_SUM)                                             as localStorageSum,
               sum(host.DISK_USED)                                            as localStorageUsed,
               round((sum(host.CPU_USED) / sum(host.CPUS)) * 100, 2)          as cpuUsage,
               round((sum(host.MEMORY_USED) / sum(host.MEMORY_SUM)) * 100, 2) as memoryUsage,
               round((sum(host.DISK_USED) / sum(host.DISK_SUM)) * 100, 2)     as localStorageUsage
        from CJ_CMP_SERVICE_POOL_X_GRANT_RES res
                 left join CJ_CMP_VMWARE_CLUSTER clu
                           on res.GRANT_RESOURCE_TYPE = 'CLUSTER' and res.GRANT_RESOURCE_ID = clu.ID and
                              res.SERVICE_POOL_ID = #{servicePoolId} and res.MEMBER_ID = #{memberId}
                 left join CJ_CMP_VMWARE_HOST host on host.CLUSTER_ID = clu.ID
    
```
#### queryVMwareStorageBySpId
```

        select sum(store.DISK_SUM)                                          as sharedStorageSum,
       sum(store.DISK_SUM - store.DISK_FREE)                        as sharedStorageUsed,
       sum(store.PROVISIONED)                                       as storageProvisioned,
       round((sum(store.DISK_SUM - store.DISK_FREE) / sum(store.DISK_SUM)) * 100, 2) as sharedStorageUsage
        from CJ_CMP_SERVICE_POOL_X_GRANT_RES res
         left join CJ_CMP_VMWARE_DATASTORE store
                   on res.GRANT_RESOURCE_TYPE = 'STORAGE' and res.GRANT_RESOURCE_ID = store.ID and
                      res.SERVICE_POOL_ID = #{servicePoolId} and res.MEMBER_ID = #{memberId}

    
```
#### queryFusionCloudAzResBySpId
```

        select sum(host.CPUS)                                                 as cpuSum,
               sum(host.CPU_USED)                                             as cpuUsed,
               sum(host.MEMORY_SUM) / 1024                                    as memorySum,
               sum(host.MEMORY_USED) / 1024                                   as memoryUsed,
               sum(host.DISK_SUM)                                             as localStorageSum,
               sum(host.DISK_USED)                                            as localStorageUsed,
               round((sum(host.CPU_USED) / sum(host.CPUS)) * 100, 2)          as cpuUsage,
               round((sum(host.MEMORY_USED) / sum(host.MEMORY_SUM)) * 100, 2) as memoryUsage,
               round((sum(host.DISK_USED) / sum(host.DISK_SUM)) * 100, 2)     as localStorageUsage
        from CJ_CMP_SERVICE_POOL_X_GRANT_RES res
                 left join CJ_CMP_CLOUD_AZ az
                           on res.GRANT_RESOURCE_TYPE = 'AZ' and res.GRANT_RESOURCE_ID = az.ID and
                              res.SERVICE_POOL_ID = #{servicePoolId} and res.MEMBER_ID = #{memberId}
                 left join CJ_CMP_FUSION_CLOUD_HOST host on host.ZONE_ID = az.ID
    
```
#### queryFusionComputeClusterResBySpId
```

        select sum(clu.CPU_SUM)                                       as cpuSum,
               sum(clu.CPU_USED)                                       as cpuUsed,
               sum(clu.MEMORY_SUM / 1024)                              as memorySum,
               sum(clu.MEMORY_USED / 1024)                             as memoryUsed,
               round((sum(clu.CPU_USED) / sum(clu.CPU_SUM)) * 100, 2)       as cpuUsage,
               round((sum(clu.MEMORY_USED) / sum(clu.MEMORY_SUM)) * 100, 2) as memoryUsage
         from CJ_CMP_SERVICE_POOL_X_GRANT_RES res
         left join CJ_CMP_FUSION_COMPUTE_CLUSTER clu
                   on res.GRANT_RESOURCE_TYPE = 'CLUSTER' and res.GRANT_RESOURCE_ID = clu.ID and
                      res.SERVICE_POOL_ID = #{servicePoolId} and res.MEMBER_ID = #{memberId}
    
```
#### queryFusionComputeStorageBySpId
```

        select sum(store.CAPACITY_GB)                                          as sharedStorageSum,
               sum(store.USED_SIZE_GB)                        as sharedStorageUsed,
               round((sum(store.USED_SIZE_GB) / sum(store.CAPACITY_GB)) * 100, 2) as sharedStorageUsage
        from CJ_CMP_SERVICE_POOL_X_GRANT_RES res
        left join CJ_CMP_FUSION_COMPUTE_DATASTORE store
                   on res.GRANT_RESOURCE_TYPE = 'STORAGE' and res.GRANT_RESOURCE_ID = store.ID and
                      res.SERVICE_POOL_ID = #{servicePoolId} and res.MEMBER_ID = #{memberId}
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_SERVICE_POOL_X_GRANT_RES.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：VALUES,now,size,CJ_CMP_SERVICE_POOL_X_GRANT_RES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_SOFTWARE_ASSIGN.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：count,DATE

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_SOFTWARE_INSTANCE.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：count

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_SOFTWARE_RESOURCE.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：concat,and,CONCAT,NOW,now,CJ_CMP_SOFTWARE_RESOURCE,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_SPEC.xml
> sql统计:复杂1个，简单13个
>
> 使用的关键字：CJ_CMP_SPEC,values,and,in,CONCAT,group_concat,now
#### queryWithPmType
```

        select spec.*, group_concat(pmType.NAME) pmType from CJ_CMP_SPEC spec
        left join CJ_CMP_SPEC_X_PM_TYPE rel on spec.ID = rel.SPEC_ID
        left join CJ_CMP_PM_TYPE pmType on rel.PM_TYPE_ID = pmType.ID and pmType.IS_DELETED=0
        where spec.IS_DELETED = 0
        <if test="name != null and name != ''">
            and spec.NAME like CONCAT('%',#{name},'%')
        </if>
        <if test="needCustom != null and needCustom == false">
            and spec.NAME != '自定义规格'
        </if>
        group by spec.ID
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_SPEC_CATAGORY.xml
> sql统计:复杂1个，简单8个
>
> 使用的关键字：now,CJ_CMP_SPEC_CATAGORY,values,ifnull,JOIN,count,in
#### queryAll
```

        SELECT catagory.ID AS id,catagory.NAME AS name,ifnull(spec.num,0) num 
        FROM CJ_CMP_SPEC_CATAGORY catagory 
        LEFT JOIN (
            select SPEC_CATAGORY_ID,count(distinct s.ID) as num from CJ_CMP_SPEC s
            <if test="memberId != null and memberId != 0">
                inner join CJ_CMP_SPEC_X_MEMBER xm on xm.SPEC_ID=s.ID and xm.IS_DELETED=0 and xm.MEMBER_ID=#{memberId}
            </if>
            where s.IS_DELETED = 0 group by SPEC_CATAGORY_ID
        ) spec ON catagory.ID = spec.SPEC_CATAGORY_ID
        WHERE  catagory.IS_DELETED = 0;
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_SPEC_X_MEMBER.xml
> sql统计:复杂1个，简单7个
>
> 使用的关键字：concat,and,now,CJ_CMP_SPEC_X_MEMBER,NOW,ceil,ifnull,exists,values
#### queryUnRelList
```

        select distinct sat.CODE as SERVICE_ACCOUNT_TYPE,sat.NAME as SERVICE_ACCOUNT_TYPE_NAME,s.ID as specId,s.NAME,s.CPU,s.MEMORY,sc.NAME as CATAGORY
        from CJ_CMP_SPEC s
        INNER JOIN CJ_SYS_DIC sat on sat.TYPE_CODE='SERVICE_ACCOUNT_TYPE'
        LEFT JOIN CJ_CMP_SPEC_CATAGORY sc on sc.ID=s.SPEC_CATAGORY_ID
        LEFT JOIN CJ_CMP_SPEC_X_PM_TYPE xp on xp.SPEC_ID=s.ID
        LEFT JOIN CJ_CMP_SPEC_X_MEMBER x on s.ID=x.SPEC_ID and x.IS_DELETED=0 and x.MEMBER_ID=#{memberId} and x.SERVICE_ACCOUNT_TYPE=sat.CODE and ifnull(x.PM_TYPE_ID,0) =ifnull(xp.PM_TYPE_ID,0)
        where s.IS_DELETED=0 and x.ID is null
        and exists (select xs.SPEC_ID from CJ_CMP_SPEC_X_VM_SPEC xs, CJ_CMP_SERVICE_ACCOUNT sa where xs.SERVICE_ACCOUNT_ID=sa.ID and xs.SPEC_ID=s.ID and sa.TYPE=sat.CODE)
        <if test="searchKey!='' and searchKey != null">
            <choose>
                <when test="searchType=='serviceAccountType'">
                    and sat.NAME like concat('%',#{searchKey},'%')
                </when>
                <when test="searchType=='spec'">
                    and s.NAME like concat('%',#{searchKey},'%')
                </when>
                <when test="searchType=='catagory'">
                    and sc.NAME like concat('%',#{searchKey},'%')
                </when>
                <otherwise>
                    and (sat.NAME like concat('%',#{searchKey},'%') or s.NAME like concat('%',#{searchKey},'%') or sc.NAME like concat('%',#{searchKey},'%'))
                </otherwise>
            </choose>
        </if>
        order by sat.NAME,CPU,MEMORY
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_SPEC_X_PM_TYPE.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：join,IN,now,CJ_CMP_SPEC_X_PM_TYPE,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_SPEC_X_VM_SPEC.xml
> sql统计:复杂1个，简单10个
>
> 使用的关键字：CJ_CMP_SPEC_X_VM_SPEC,values,now,coalesce,and,in
#### queryBySpecId
```

      SELECT xSpec.ID as id,sa.ID as serviceAccountId,sa.NAME,sa.DATACENTER_TYPE, vmSpec.ENTITY_ID,vmSpec.NAME AS entityName,
		  dc.ID as ldcId,dc.NAME as datacenter,coalesce(az.NAME,clu.NAME,fcClu.NAME) as azName,xSpec.AZ_ID as azId
		FROM CJ_CMP_SPEC_X_VM_SPEC xSpec
		join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID=xSpec.SERVICE_ACCOUNT_ID
		LEFT JOIN CJ_CMP_VM_SPEC vmSpec ON xSpec.VM_SPEC_ID = vmSpec.ID
		left outer join CJ_CMP_VMWARE_CLUSTER clu on clu.SERVICE_ACCOUNT_ID=sa.ID and clu.ID=xSpec.AZ_ID
        left outer join CJ_CMP_FUSION_COMPUTE_CLUSTER fcClu on fcClu.SERVICE_ACCOUNT_ID=sa.ID and fcClu.ID=xSpec.AZ_ID
		left outer join CJ_CMP_CLOUD_AZ az on az.SERVICE_ACCOUNT_ID=sa.ID and az.ID=xSpec.AZ_ID
		JOIN CJ_CMP_DC_VIEW dc on dc.LDC_TYPE=sa.DATACENTER_TYPE and dc.ID=xSpec.LDC_ID
        WHERE xSpec.SPEC_ID = #{id} 
        <if test="serviceAccountId != null">
            and xSpec.SERVICE_ACCOUNT_ID=#{serviceAccountId}
        </if>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_STORAGE_ARRAY.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：from,count,now,CJ_CMP_STORAGE_ARRAY,values,concat,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_STORAGE_ARRAY_X_DATASTORE.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：in,CJ_CMP_STORAGE_ARRAY_X_DATASTORE,values,and,CONCAT

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_STORAGE_VIEW.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_TASK_OPERATION_HISTORY.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：CJ_CMP_TASK_OPERATION_HISTORY,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_USER_PROFILE.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：CJ_CMP_USER_PROFILE,VALUES,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_VDS.xml
> sql统计:复杂2个，简单7个
>
> 使用的关键字：from,concat,CONCAT,values,group_concat,count,if,in,and
#### selectById
```

    select
      vds.ID,vds.MEMBER_ID,vds.ENTITY_ID,vds.SERVICE_ACCOUNT_ID,vds.NAME,vds.LDC_ID,vds.LDC_TYPE,vds.STATUS,vds.DESCRIPTION, vds.TYPE as cloudWebType, group_concat(vmHost.NAME) as hostName,
      dc.name  as ldcName,
       saccount.DATACENTER_TYPE as sAccountType,
      saccount.ACCOUNT_ID as sAccountEntityId,
      saccount.NAME as sAccountName,
      (select count(0) from CJ_CMP_VDS_PORTGROUP where VDS_ID = #{id} )  as PORT_GROUP_NUM
    from CJ_CMP_VDS vds
    inner join CJ_CMP_VMWARE_DC dc on vds.LDC_ID = dc.ID
    inner join CJ_CMP_SERVICE_ACCOUNT saccount on vds.SERVICE_ACCOUNT_ID = saccount.ID
    left join CJ_CMP_CLOUD_ACCOUNT_DC cdc on dc.SERVICE_ACCOUNT_ID = cdc.SERVICE_ACCOUNT_ID and dc.ID = cdc.LDC_ID and cdc.IS_DELETED = 0
    left join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED = 0
    left join CJ_CMP_VDS_X_HOST vdsRel on vds.ID = vdsRel.VDS_ID
    left join CJ_CMP_VMWARE_HOST vmHost on vdsRel.HOST_ID = vmHost.ID
    where vds.ID = #{id,jdbcType=BIGINT}
    <choose>
      <when test="memberId != 0">
        and ca.MEMBER_ID = #{memberId}
      </when>
      <otherwise>
        and ca.SCOPE = 'public'
      </otherwise>
    </choose>
    group by vds.ID
  
```
#### selectByKeyValueAndServiceAccount
```

    select * from (select  vds.ID,vds.MEMBER_ID,vds.ENTITY_ID,vds.SERVICE_ACCOUNT_ID,
    if(vds.TYPE = 'VSS',concat(vds.NAME, if(group_concat(vmHost.IP) is null, '', concat('[', group_concat(vmHost.IP), ']'))),vds.NAME) as NAME,
           vds.TYPE, vds.LDC_ID,vds.LDC_TYPE,vds.STATUS,vds.DESCRIPTION, group_concat(vmHost.NAME) as hostName,
    (select count(0) from CJ_CMP_VDS_PORTGROUP vpg where vds.ID = vpg.VDS_ID )  as PORT_GROUP_NUM,
    dc.name as ldcName, saccount.NAME as sAccountName
    from CJ_CMP_VDS vds
    inner join CJ_CMP_VMWARE_DC dc on vds.LDC_ID = dc.ID
    inner join CJ_CMP_SERVICE_ACCOUNT saccount on vds.SERVICE_ACCOUNT_ID = saccount.ID
    left join CJ_CMP_CLOUD_ACCOUNT_DC cdc on dc.SERVICE_ACCOUNT_ID = cdc.SERVICE_ACCOUNT_ID and dc.ID = cdc.LDC_ID and cdc.IS_DELETED = 0
    left join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED = 0
    left join CJ_CMP_VDS_X_HOST vdsRel on vds.ID = vdsRel.VDS_ID
    left join CJ_CMP_VMWARE_HOST vmHost on vdsRel.HOST_ID = vmHost.ID
    <where>
      <choose>
        <when test="memberId != 0">
          and ca.MEMBER_ID = #{memberId}
        </when>
        <otherwise>
          and ca.SCOPE = 'public'
        </otherwise>
      </choose>
    <if test="serviceAccountId != 'ALL'" >
      and vds.SERVICE_ACCOUNT_ID = #{serviceAccountId}
    </if>
    <if test="cloudAccountId != 'ALL'" >
      and vds.LDC_ID in (
      select cadc.LDC_ID from  CJ_CMP_CLOUD_ACCOUNT_DC cadc where cadc.CLOUD_ACCOUNT_ID = #{cloudAccountId}
      )
    </if>
    <if test="ldcId != '' and ldcId != null" >
      and vds.LDC_ID = #{ldcId}
    </if>
    </where>
    group by vds.ID) t where 1 = 1
    <if test="queryValue != null" >
      <if test="queryValue != ''" >
      <choose>
          <when test="queryKey == 'ALL'" >
              and (
              t.NAME like CONCAT('%',#{queryValue},'%')
              OR t.ENTITY_ID like CONCAT('%',#{queryValue},'%')
              )
          </when>
          <otherwise>
              <if test="queryKey == 'ENTITY_ID'" >
                  and t.ENTITY_ID like CONCAT('%',#{queryValue},'%')
              </if>
              <if test="queryKey == 'NAME'" >
                  and t.NAME like CONCAT('%',#{queryValue},'%')
              </if>
          </otherwise>
      </choose>
      </if>
    </if>

  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_VDS_PORTGROUP.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：CONCAT,count,values,IF,ISNULL,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_VMWARE_CLUSTER.xml
> sql统计:复杂1个，简单6个
>
> 使用的关键字：size,in,sum,round,and
#### queryCluster
```

        select clu.ID,
        clu.NAME,
        clu.ENTITY_ID,
        cdc.LDC_ID,
        cdc.LDC_TYPE,
        dc.ENTITY_ID                                  as ldcEntityId,
        dc.NAME                                       as ldcName,
        sa.NAME                                       as serviceAccountName,
        sa.ID                                         as serviceAccountId,
        sum(host.CPUS)                                as cpuSum,
        sum(host.CPU_USED)                            as cpuUsed,
        sum(host.MEMORY_SUM) / 1024                   as memorySum,
        sum(host.MEMORY_USED) / 1024                  as memoryUsed,
        sum(host.DISK_SUM)                            as localStorageSum,
        sum(host.DISK_USED)                           as localStorageUsed,
        round((sum(host.CPU_USED) / sum(host.CPUS)) * 100 , 2) as cpuUsage,
        round((sum(host.MEMORY_USED) / sum(host.MEMORY_SUM)) * 100, 2)  as memoryUsage,
        round((sum(host.DISK_USED) / sum(host.DISK_SUM)) * 100, 2) as localStorageUsage
        from CJ_CMP_SERVICE_ACCOUNT sa
        inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc
        on sa.ID = cdc.SERVICE_ACCOUNT_ID and sa.IS_DELETED = 0 AND cdc.IS_DELETED = 0
        inner join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED = 0
        inner join CJ_CMP_VMWARE_DC dc on cdc.LDC_ID = dc.ID and dc.IS_DELETED = 0 and dc.SERVICE_ACCOUNT_ID = sa.ID
        inner join CJ_CMP_VMWARE_CLUSTER clu on dc.ID = clu.LDC_ID
        left join CJ_CMP_VMWARE_HOST host on host.CLUSTER_ID = clu.ID
        where dc.IS_DELETED=0
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>
        <if test="clusterId != null and clusterId != ''"> and clu.ID=#{clusterId}</if>
        <if test="serviceAccountId != null and serviceAccountId != ''"> and sa.ID=#{serviceAccountId}</if>
        <if test="cloudAccountId != null and cloudAccountId != ''"> and ca.ID=#{cloudAccountId}</if>
        <if test="ldcId != null and ldcId != ''"> and cdc.LDC_ID=#{ldcId}</if>
        <if test="ldcType != null and ldcType != ''"> and cdc.LDC_TYPE=#{ldcType}</if>
        <if test="searchKey != null and searchKey != ''"> and (clu.NAME like #{searchKey} or clu.ENTITY_ID like #{searchKey})</if>
        <if test="name != null and name != ''"> and clu.NAME like #{name} </if>
        <if test="ldcIds != null and ldcIds.size()>0">
           and cdc.LDC_ID IN <foreach collection="ldcIds" item="ldc" open="(" separator="," close=")"> #{ldc} </foreach>
        </if>
        group by clu.ID, clu.NAME, clu.ENTITY_ID, cdc.LDC_ID, cdc.LDC_TYPE, dc.ENTITY_ID, dc.NAME, sa.NAME, sa.ID
        <if test="sortField != null and sortField!= '' and sortType != null and sortType!= '' ">
            <choose>
                <when test="sortField == 'cpuUsage' or sortField == 'memoryUsage' or sortField == 'localStorageUsage'">
                    ORDER BY ${sortField} ${sortType}
                </when>
                <otherwise>
                    order by clu.NAME
                </otherwise>
            </choose>
        </if>
        <if test="sortField == null or sortType == null ">
            order by clu.NAME
        </if>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_VMWARE_DATASTORE.xml
> sql统计:复杂5个，简单10个
>
> 使用的关键字：group_concat,if,in,sum,round,IN,join,size,and
#### queryDatastore
```

        SELECT ds.ID,ds.SERVICE_ACCOUNT_ID,ds.NAME,ds.ENTITY_ID,ds.IS_DISABLED,ds.DISK_SUM,ds.DISK_FREE,ds.PROVISIONED,ds.TYPE,ds.IS_CLUSTERED,cdc.LDC_TYPE,cdc.LDC_ID,dc.NAME as ldcName,dc.ENTITY_ID as ldcEntityId, store.*,
        ((ds.DISK_SUM - DISK_FREE) / DISK_SUM) as diskUsage,  ((ds.PROVISIONED) / DISK_SUM) as provisionUsage
        FROM CJ_CMP_CLOUD_ACCOUNT ca
        inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc on ca.ID=cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED=0 and cdc.LDC_TYPE='vmware' AND cdc.IS_DELETED=0
        inner join CJ_CMP_VMWARE_DC dc on cdc.LDC_ID=dc.ID and cdc.IS_DELETED=0 and dc.IS_DELETED=0
        inner join CJ_CMP_VMWARE_DATASTORE ds ON ds.LDC_ID= dc.ID and ds.SERVICE_ACCOUNT_ID=dc.SERVICE_ACCOUNT_ID
        left join
        (
        SELECT group_concat(clu.ID) as CLUSTER_ID, group_concat(host.ID) as HOST_ID, group_concat(clu.NAME) AS clusterName , group_concat(clu.ENTITY_ID) clusterEntityId, group_concat(host.NAME) as hostName, group_concat(host.ENTITY_ID) as hostEntityId, group_concat(host.IP)as hostIp,dt.ID AS dsId
        FROM CJ_CMP_VMWARE_HOST host LEFT JOIN CJ_CMP_VMWARE_CLUSTER clu ON host.CLUSTER_ID = clu.ID
        inner join CJ_CMP_VMWARE_DATASTORE_HOSTMOUNT mou on mou.VMWARE_HOST_ID=host.ID
        inner join CJ_CMP_VMWARE_DATASTORE dt on dt.ID=mou.VMWARE_DATASTORE_ID
        <where>
            <if test="clusterIds != null and clusterIds.size()>0">
                and clu.ID IN <foreach collection="clusterIds" item="clu" open="(" separator="," close=")"> #{clu} </foreach>
            </if>
            <if test="hostId != null and hostId != ''"> and host.ID=#{hostId}</if>
        </where>
        GROUP BY dsId
        ) store ON dsId= ds.ID
        <where>
            <choose>
                <when test="memberId != 0">
                    and ca.MEMBER_ID = #{memberId}
                </when>
                <otherwise>
                    and ca.SCOPE = 'public'
                </otherwise>
            </choose>
            <if test="id != null and id != ''"> and ds.ID=#{id}</if>
            <if test="serviceAccountId != null and serviceAccountId != ''"> and cdc.SERVICE_ACCOUNT_ID=#{serviceAccountId}</if>
            <if test="cloudAccountId != null and cloudAccountId != ''"> and ca.ID=#{cloudAccountId}</if>
            <if test="ldcId != null and ldcId != ''"> and dc.ID=#{ldcId}</if>
            <if test="name != null and name != ''"> and ds.NAME like #{name}</if>
            <if test="clusterId != null and clusterId != ''"> and store.CLUSTER_ID=#{clusterId}</if>
            <if test="hostId != null and hostId != ''"> and store.HOST_ID=#{hostId}</if>
            <if test="entityId != null and entityId != ''"> and ds.ENTITY_ID like #{entityId}</if>
            <if test="searchKey != null and searchKey != ''"> and (ds.NAME like #{searchKey} or ds.ENTITY_ID like #{searchKey} or hostIp like #{searchKey})</if>
            <if test="hostIp != null and hostIp != ''"> and hostIp like #{hostIp}</if>
            <if test="ldcIds != null and ldcIds.size()>0">
                and dc.ID IN <foreach collection="ldcIds" item="ldc" open="(" separator="," close=")"> #{ldc} </foreach>
            </if>
            <if test="clusterIds != null and clusterIds.size()>0">
                and store.CLUSTER_ID IN <foreach collection="clusterIds" item="clu" open="(" separator="," close=")"> #{clu} </foreach>
            </if>
        </where>
        <if test="sortField != null and sortField!= '' and sortType != null and sortType!= '' ">
            ORDER BY ${sortField} ${sortType}
        </if>
                   
    
```
#### statisticDataStoreByServiceAccoutId
```

        SELECT
            sum(da.DISK_SUM)  as DISK_SUM,
            sum(da.DISK_SUM - da.DISK_FREE) as DISK_USED,
            round(if(sum(da.DISK_SUM) = 0, 0, sum(da.DISK_SUM - da.DISK_FREE) / sum(da.DISK_SUM)), 2) * 100 as DISK_USAGE
        FROM CJ_CMP_VMWARE_DATASTORE da
        where SERVICE_ACCOUNT_ID = #{serviceAccountId};
    
```
#### statisticDataStoreByCloudAccoutId
```

        SELECT
        sum(da.DISK_SUM)  as DISK_SUM,
        sum(da.DISK_SUM - da.DISK_FREE) as DISK_USED,
        round(if(sum(da.DISK_SUM) = 0, 0, sum(da.DISK_SUM - da.DISK_FREE) / sum(da.DISK_SUM)), 2) * 100 as DISK_USAGE
        FROM CJ_CMP_VMWARE_DATASTORE da
        where LDC_ID IN (select adc.LDC_ID
                                    from CJ_CMP_CLOUD_ACCOUNT_DC adc inner join CJ_CMP_CLOUD_ACCOUNT ca on adc.CLOUD_ACCOUNT_ID = ca.ID
                                    where adc.CLOUD_ACCOUNT_ID = #{cloudAccountId} AND adc.IS_DELETED = 0
                                    <choose>
                                        <when test="memberId != 0">
                                            and ca.MEMBER_ID = #{memberId}
                                        </when>
                                        <otherwise>
                                            and ca.SCOPE = 'public'
                                        </otherwise>
                                    </choose>);
    
```
#### statisticDataStoreTypeBySaId
```

        select
            TYPE,
            SERVICE_ACCOUNT_ID,
            sum(DISK_SUM)             as DISK_SUM,
            sum(DISK_FREE)            as DISK_FREE,
            sum(DISK_SUM - DISK_FREE) as DISK_USED,
            sum(PROVISIONED)          as PROVISIONED,
            round(if(sum(DISK_SUM) = 0, 0, sum(DISK_SUM - DISK_FREE) / sum(DISK_SUM)), 2) * 100 as DISK_USAGE
        from CJ_CMP_VMWARE_DATASTORE where SERVICE_ACCOUNT_ID = #{serviceAccountId}
        group by TYPE, SERVICE_ACCOUNT_ID, MEMBER_ID
    
```
#### statisticDataStoreTypeByCaId
```

        select
            TYPE,
            LDC_ID,
            sum(DISK_SUM)                                                                       as DISK_SUM,
            sum(DISK_FREE)                                                                      as DISK_FREE,
            sum(DISK_SUM - DISK_FREE)                                                           as DISK_USED,
            sum(PROVISIONED)                                                                    as PROVISIONED,
            round(if(sum(DISK_SUM) = 0, 0, sum(DISK_SUM - DISK_FREE) / sum(DISK_SUM)), 2) * 100 as DISK_USAGE
        from CJ_CMP_VMWARE_DATASTORE where LDC_ID in (select adc.LDC_ID from CJ_CMP_CLOUD_ACCOUNT_DC adc inner join CJ_CMP_CLOUD_ACCOUNT ca on adc.CLOUD_ACCOUNT_ID = ca.ID
                                                            where adc.CLOUD_ACCOUNT_ID = #{cloudAccountId} AND adc.IS_DELETED = 0
                                                            <choose>
                                                                <when test="memberId != 0">
                                                                    and ca.MEMBER_ID = #{memberId}
                                                                </when>
                                                                <otherwise>
                                                                    and ca.SCOPE = 'public'
                                                                </otherwise>
                                                            </choose>)
        group by TYPE, LDC_ID, MEMBER_ID
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_VMWARE_DC.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：now,NOW,CJ_CMP_VMWARE_DC,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_VMWARE_FOLDER.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_VMWARE_HOST.xml
> sql统计:复杂3个，简单11个
>
> 使用的关键字：size,and,if,group_concat,round,in,count,sum,select
#### queryByServiceAccountId
```

        select
        host.ID,
        host.NAME,
        host.CPUS,
        host.CPU_USED,
        round(if(host.MEMORY_SUM is not null ,host.MEMORY_SUM/1024,0),2)                              as MEMORY_SUM,
        round(if(host.MEMORY_USED is not null ,host.MEMORY_USED/1024,0),2)                              as MEMORY_USED,
        host.DISK_SUM,
        host.DISK_USED,
        host.SERVICE_ACCOUNT_ID
        from CJ_CMP_VMWARE_HOST host
        <where>
            <if test="serviceAccountId != null and serviceAccountId != ''"> and host.SERVICE_ACCOUNT_ID=#{serviceAccountId}</if>
        </where>
    
```
#### queryByCloudAccountId
```

        select
            host.ID,
            host.NAME,
            host.CPUS,
            host.CPU_USED,
            round(if(host.MEMORY_SUM is not null ,host.MEMORY_SUM/1024,0),2)                              as MEMORY_SUM,
            round(if(host.MEMORY_USED is not null ,host.MEMORY_USED/1024,0),2)                              as MEMORY_USED,
            host.DISK_SUM,
            host.DISK_USED,
            host.SERVICE_ACCOUNT_ID
        from CJ_CMP_VMWARE_HOST host
        where host.LDC_ID in (select adc.LDC_ID
        from CJ_CMP_CLOUD_ACCOUNT_DC adc inner join CJ_CMP_CLOUD_ACCOUNT ca on adc.CLOUD_ACCOUNT_ID = ca.ID
        where adc.CLOUD_ACCOUNT_ID = #{cloudAccountId} AND adc.IS_DELETED = 0
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>)
    
```
#### queryHostAndDataStoreIDByHostIdList
```

        select (select group_concat(VMWARE_DATASTORE_ID) from CJ_CMP_VMWARE_DATASTORE_HOSTMOUNT where VMWARE_HOST_ID=host.ID) as datastoreIds,host.* from CJ_CMP_VMWARE_HOST host
        where  host.ID in
         <foreach collection="list" open="(" close=")" item="id">
             #{id}
         </foreach>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_VMWARE_VC.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：in,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_VMWARE_VM.xml
> sql统计:复杂3个，简单42个
>
> 使用的关键字：if,in,GROUP_CONCAT,ON,CJ_CMP_VMWARE_VM,and,count,round,ifnull,AND,now,size,JOIN,sum,FROM,NOW,VALUES
#### getAllByCondition
```

        select vm.*,prj.CODE as projectCode,prj.NAME as projectName,prj.PROJECT_SOURCE_ID as projectSourceId,
        app.CODE as appSystemCode,app.NAME as appSystemName,app.SOURCE_ID as appSystemSourceId, vmtag.tags
        from CJ_CMP_VMWARE_VM vm
          <if test="srvCompletionTimeStart!=null or srvCompletionTimeEnd!=null ">
          left outer join CJ_CMP_RITM_COMPLETED_VIEW req on vm.SRV_NO=req.NUMBER
          </if>
          left outer join CJ_CMP_PROJECT prj on prj.ID=vm.PROJECT_ID
          left outer join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
          left outer join CJ_CMP_APP_DU du on du.ID=vm.APP_DU_ID
          LEFT JOIN (SELECT rel.OBJECT_ID, rel.OBJECT_TYPE, GROUP_CONCAT(tag.`NAME`) as tags from CJ_CMP_TAG tag INNER JOIN CJ_CMP_TAG_X_OBJECT rel on tag.ID = rel.TAG_ID GROUP BY rel.OBJECT_ID, rel.OBJECT_TYPE) as vmtag
          on vm.ID = vmtag.OBJECT_ID and vmtag.OBJECT_TYPE = 'vmware'
        <where>
            <if test="memberId != 0"> and vm.MEMBER_ID = #{memberId}</if>
            <if test="startTime!=null and endTime!=null ">
                and vm.CREATE_DATE between #{startTime,jdbcType= TIMESTAMP} and  #{endTime,jdbcType= TIMESTAMP}
            </if>
            <if test="startTime==null and endTime!=null ">
                and vm.CREATE_DATE &lt;=  #{endTime,jdbcType= TIMESTAMP}
            </if>
            <if test="startTime!=null and endTime==null ">
                and vm.CREATE_DATE &gt;=  #{startTime,jdbcType= TIMESTAMP}
            </if>

            <if test="srvCompletionTimeStart!=null and srvCompletionTimeEnd!=null ">
                and if(vm.IS_DELETED=1,vm.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) between #{srvCompletionTimeStart,jdbcType= TIMESTAMP} and  #{srvCompletionTimeEnd,jdbcType= TIMESTAMP}
            </if>
            <if test="srvCompletionTimeStart==null and srvCompletionTimeEnd!=null ">
                and if(vm.IS_DELETED=1,vm.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) &lt;=  #{srvCompletionTimeEnd,jdbcType= TIMESTAMP}
            </if>
            <if test="srvCompletionTimeStart!=null and srvCompletionTimeEnd==null ">
                and if(vm.IS_DELETED=1,vm.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) &gt;=  #{srvCompletionTimeStart,jdbcType= TIMESTAMP}
            </if>

            <if  test="isDeleted != null ">
                <choose>
                    <when test="isDeleted">
                        and vm.IS_DELETED=1
                    </when>
                    <otherwise>
                        and vm.IS_DELETED=0
                    </otherwise>
                </choose>
            </if>
        </where>
    
```
#### getAppSystemVmPmStatistics
```

        SELECT app.NAME AS name,app.MEMBER_ID AS memberId,info.* FROM (SELECT  vmPm.appSystemId,
        round(ifnull(sum(vmPm.cpu),0),0) AS cpu,
        round(ifnull(sum(vmPm.memory),0),0) AS memory,
        round(ifnull(sum(vmPm.disk),0),0) AS disk,
        sum(vmPm.pmNum) AS pmNum,
        sum(vmPm.vmNum) AS vmNum
        FROM
        (SELECT
        vm.APP_SYSTEM_ID AS appSystemId,
        ifnull(sum(vm.CPUS),0) AS cpu,
        ifnull(sum(vm.MEMORY),0)/1024 AS memory,
        ifnull(sum(vmDisk.DISK_SPACE),0) AS disk,
        0 AS pmNum,
        count(DISTINCT vm.ID) AS vmNum
        FROM cj_cmp_vm_view vm LEFT JOIN(
        SELECT vol.SERVICE_ACCOUNT_ID,vol.VM_DEVICE_ID,sum(vol.DISK_SPACE) DISK_SPACE from CJ_CMP_VM_VOLUME vol where vol.IS_DELETED = 0 group BY vol.SERVICE_ACCOUNT_ID,vol.VM_DEVICE_ID
        )vmDisk ON vmDisk.SERVICE_ACCOUNT_ID = vm.SERVICE_ACCOUNT_ID AND vmDisk.VM_DEVICE_ID=vm.ID
        <if test="memberId!=null and memberId!= 0 ">
            WHERE vm.MEMBER_ID = #{memberId}
        </if>
        GROUP BY vm.APP_SYSTEM_ID
        UNION ALL
        SELECT
        pm.APP_SYSTEM_ID AS appSystemId,
        ifnull(sum(pm.CPU_CORE_COUNT),0) AS cpu,
        ifnull(sum(pm.RAM),0) AS memory,
        ifnull(sum(pm.DISK_SPACE),0) AS disk,
        count(DISTINCT pm.ID) AS pmNum,
        0 AS vmNum
        FROM CJ_CMDB_CI_PHYSICAL_MACHINE pm
        WHERE pm.IS_DELETED = 0
        <if test="memberId!=null and memberId!= 0 ">
            AND pm.MEMBER_ID = #{memberId}
        </if>
        GROUP BY pm.APP_SYSTEM_ID) AS vmPm group by vmPm.appSystemId) AS info
        INNER JOIN CJ_CMP_APP_SYSTEM app ON info.appSystemId = app.ID
        <if test="appSystemId!=null and appSystemId!= '' ">
            WHERE app.ID =  #{appSystemId}
        </if>
    
```
#### getProjectVmPmStatistics
```

        SELECT info.*, project.NAME as name, project.MEMBER_ID AS memberId
        FROM
        (SELECT  vmPm.projectId,
        round(ifnull(sum(vmPm.cpu),0),0) AS cpu,
        round(ifnull(sum(vmPm.memory),0),0) AS memory,
        round(ifnull(sum(vmPm.disk),0),0) AS disk,
        sum(vmPm.pmNum) AS pmNum,
        sum(vmPm.vmNum) AS vmNum
        FROM
        (SELECT
        vm.PROJECT_ID AS projectId,
        ifnull(sum(vm.CPUS),0) AS cpu,
        ifnull(sum(vm.MEMORY),0)/1024 AS memory,
        ifnull(sum(vmDisk.DISK_SPACE),0) AS disk,
        0 AS pmNum,
        count(DISTINCT vm.ID) AS vmNum
        FROM cj_cmp_vm_view vm  LEFT JOIN(
        SELECT vol.SERVICE_ACCOUNT_ID,vol.VM_DEVICE_ID,sum(vol.DISK_SPACE) DISK_SPACE from CJ_CMP_VM_VOLUME vol where vol.IS_DELETED = 0 group BY vol.SERVICE_ACCOUNT_ID,vol.VM_DEVICE_ID
        )vmDisk ON vmDisk.SERVICE_ACCOUNT_ID = vm.SERVICE_ACCOUNT_ID AND vmDisk.VM_DEVICE_ID=vm.ID
        <if test="memberId != null and memberId != 0 ">
            WHERE vm.MEMBER_ID = #{memberId}
        </if>
        GROUP BY vm.PROJECT_ID
        UNION ALL
        SELECT
        pm.PROJECT_ID AS projectId,
        ifnull(sum(pm.CPU_CORE_COUNT),0) AS cpu,
        ifnull(sum(pm.RAM),0) AS memory,
        ifnull(sum(pm.DISK_SPACE),0) AS disk,
        count(DISTINCT pm.ID) AS pmNum,
        0 AS vmNum
        FROM CJ_CMDB_CI_PHYSICAL_MACHINE pm
        WHERE pm.IS_DELETED = 0
        <if test="memberId != null and memberId != 0 ">
            AND pm.MEMBER_ID = #{memberId}
        </if>
        GROUP BY pm.PROJECT_ID) AS vmPm group by vmPm.projectId) as info
        INNER JOIN CJ_CMP_PROJECT project ON info.projectId = project.ID AND project.IS_DELETED=0
        <if test="projectId != null and projectId != '' ">
            and project.ID = #{projectId}
        </if>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_VM_APP_SYSTEM_DAY_REPORT.xml
> sql统计:复杂1个，简单1个
>
> 使用的关键字：and,CJ_CMP_VM_APP_SYSTEM_DAY_REPORT,VALUES,ifnull,count,DATE
#### getTotalBySaAndTime
```

        SELECT
        ifnull(count( DISTINCT report.`NAME`),0) as num
        FROM CJ_CMP_VM_APP_SYSTEM_DAY_REPORT report
        left join CJ_CMP_APP_SYSTEM app on app.ID = report.APP_SYSTEM_ID
        WHERE
        STAT_TIME = DATE(#{statTime})
        <if test="memberId != 0">
            and report.MEMBER_ID = #{memberId}
            <if test="userIds != null and userIds.size >0 ">
                and (app.SYS_OPR_MANT_OWNER_ID in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
                or app.SYS_OPR_MANT_OWNER2_ID in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
                <if test="departmentList != null and departmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="departmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="departmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>)
            </if>
        </if>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_VM_DAY_REPORT.xml
> sql统计:复杂7个，简单10个
>
> 使用的关键字：round,CJ_CMP_VM_DAY_REPORT,DATE_FORMAT,and,sum,if,max,WHERE,count,from,DATE,SUM,min,concat,ifnull,FROM,VALUES,in,size
#### groupBySaAndTime
```

        SELECT
        ifnull(count(DISTINCT ENTITY_ID, SERVICE_ACCOUNT_ID), 0)                   AS num,
        DATE_FORMAT(vm.STAT_TIME, #{dateFormat}) AS days
        FROM (SELECT
        STAT_TIME,
        TYPE,
        ENTITY_ID,
        SERVICE_ACCOUNT_ID
        FROM CJ_CMP_VM_DAY_REPORT
        WHERE SERVICE_ACCOUNT_ID in (select ID from CJ_CMP_SERVICE_ACCOUNT where IS_DELETED = 0)
        <if test="memberId != 0">
            and MEMBER_ID = #{memberId}
        </if>
        AND LDC_TYPE in <foreach collection="ldcTypeList" item="ldcType" open="(" close=")" separator=",">#{ldcType}</foreach>
        GROUP BY STAT_TIME, TYPE, ENTITY_ID, SERVICE_ACCOUNT_ID) vm
        <where>
            <if test="serviceAccountId != null and serviceAccountId != ''">
                and vm.SERVICE_ACCOUNT_ID = #{serviceAccountId}
            </if>
            <if test="type != null and type != ''">
                and vm.TYPE=#{type}
            </if>
            <if test="startTime != null and endTime != null ">
                and (vm.STAT_TIME &gt;= DATE(#{startTime}) AND vm.STAT_TIME &lt;= DATE(#{endTime}))
            </if>
        </where>
        GROUP BY days
        ORDER BY days asc
    
```
#### getTotalBySaAndTime
```

        SELECT
            ifnull(count( DISTINCT ENTITY_ID, SERVICE_ACCOUNT_ID ),0) as num
        FROM
            CJ_CMP_VM_DAY_REPORT report
        INNER JOIN CJ_CMP_SERVICE_ACCOUNT sa ON sa.ID = report.SERVICE_ACCOUNT_ID
        AND sa.IS_DELETED = 0
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=report.APP_SYSTEM_ID  AND app.IS_DELETED = 0
        WHERE
            STAT_TIME = DATE(#{statTime})
            <if test="memberId != 0">
                and report.MEMBER_ID = #{memberId}
                <if test="userIds != null and userIds.size >0 ">
                    and  (
                    report.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
                    <if test="appUserId !=null ">
                        or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                        <if test="departmentList != null and departmentList.size != 0">
                            or app.DEPT_ID in <foreach collection="departmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                            or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="departmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                        </if>
                    </if>
                    )
                </if>
            </if>
    
```
#### getTotalDiskSumBySaAndTime
```

        select sum(if(DISK_SUM is null ,0,DISK_SUM)) as num
        from (SELECT DISTINCT report.ENTITY_ID, report.SERVICE_ACCOUNT_ID,report.DISK_SUM DISK_SUM
        FROM
        CJ_CMP_VM_DAY_REPORT report
        INNER JOIN CJ_CMP_SERVICE_ACCOUNT sa ON sa.ID = report.SERVICE_ACCOUNT_ID AND sa.IS_DELETED = 0
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=report.APP_SYSTEM_ID  AND app.IS_DELETED = 0
        WHERE
        STAT_TIME = DATE(#{statTime})
        <if test="memberId != 0">
            and report.MEMBER_ID = #{memberId}
            <if test="userIds != null and userIds.size >0 ">
                and  (
                report.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
                <if test="appUserId !=null ">
                    or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                    <if test="departmentList != null and departmentList.size != 0">
                        or app.DEPT_ID in <foreach collection="departmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                        or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="departmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    </if>
                </if>
                )
            </if>
        </if>) a
    
```
#### statPowerOnVmMemByHostId
```

        select
            count(*)    as powerOnVmSum,
            sum(MEMORY) as powerOnVmProvisionedMem
        from (select
                  round(max(MEMORY / 1024)) MEMORY
              from CJ_CMP_VM_DAY_REPORT
              where HOST_ID = #{hostId} and STAT_TIME = #{endTime} and RUN_STATUS = 'running' and MEMBER_ID = #{memberId}
              group by ENTITY_ID,SERVICE_ACCOUNT_ID) vm;
    
```
#### statAllocateMemByHostId
```

        select sum(MEMORY) as provisionedMem
        from (select round(max(MEMORY / 1024)) MEMORY
              from CJ_CMP_VM_DAY_REPORT
              where HOST_ID = #{hostId} and STAT_TIME = #{endTime} and MEMBER_ID = #{memberId}
              group by ENTITY_ID,SERVICE_ACCOUNT_ID) vm;
    
```
#### countCloudVm
```

        select count(*) as num, SUM(ifnull(vm.DISK_SUM,0)) as diskSum
        from CJ_CMP_VM_DAY_REPORT vm
        left outer join CJ_CMP_APP_SYSTEM app on app.ID = vm.APP_SYSTEM_ID
        where vm.MEMBER_ID = #{memberId}
        <if test="userIds != null and userIds.size >0">
            and ( vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
            )
        </if>
        <if test="startTime != null and endTime != null ">
            and (vm.CREATE_DATE &gt;= DATE(#{startTime}) AND vm.CREATE_DATE &lt;= DATE(#{endTime}))
        </if>
    
```
#### groupByTime
```

        SELECT
        ifnull( count( DISTINCT ENTITY_ID, SERVICE_ACCOUNT_ID ), 0 ) AS num,
        DATE_FORMAT(report.STAT_TIME, #{dateFormat}) AS days
        FROM
        CJ_CMP_VM_DAY_REPORT report
        LEFT OUTER JOIN CJ_CMP_APP_SYSTEM app ON app.ID = report.APP_SYSTEM_ID
        inner join CJ_CMP_SERVICE_ACCOUNT sa on sa.id = report.SERVICE_ACCOUNT_ID and sa.IS_DELETED = 0
        WHERE
        (report.STAT_TIME &gt;= DATE(#{startTime}) AND report.STAT_TIME &lt;= DATE(#{endTime}))
        <if test="memberId != 0">
            and report.MEMBER_ID = #{memberId}
        </if>
        <if test="userIds != null and userIds.size >0">
            and ( report.OWNED_BY in
            <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId}
                or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in
                    <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">
                        #{department}
                    </foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in
                    <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">
                        #{department}
                    </foreach>
                </if>
            </if>
            )
        </if>
        GROUP BY days
        ORDER BY days asc
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_VM_DEPT_DAY_REPORT.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：CJ_CMP_VM_DEPT_DAY_REPORT,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_VM_IMAGE.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：and,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_VM_ISSUE_VIEW.xml
> sql统计:复杂1个，简单0个
>
> 使用的关键字：FROM,count,DATE_SUB,CURDATE,date
#### queryAppTopByIssue
```

    SELECT vmInfo.appName, vmInfo.num
        FROM (SELECT
        app.NAME AS appName,
        count(1) AS num
        FROM cj_cmp_vm_issue_view vm
        inner join CJ_CMP_APP_SYSTEM app on app.ID = vm.APP_SYSTEM_ID
        where vm.MEMBER_ID = #{memberId} and DATE_SUB(CURDATE(), INTERVAL #{intervalTime} MONTH ) &lt;= date(vm.CREATE_DATE)
        group by app.NAME
        order by app.NAME) AS vmInfo
    order by vmInfo.num desc
    limit 10;
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_VM_PERFORMANCE_METRIC_DAY_REPORT.xml
> sql统计:复杂3个，简单3个
>
> 使用的关键字：ROUND,MAX,values,now,avg,and,SUM,round,sum,DATE_SUB,CEILING,max,AVG,cast,decimal,curdate,DATE,CJ_CMP_VM_PERFORMANCE_METRIC_DAY_REPORT,concat,ifnull,JOIN
#### queryEcsPerformanceList
```

    SELECT
    vm.`NAME`           vmName,
    vm.MEMBER_ID        memberId,
    vm.ID               vmId,
    vm.APP_DU_ID        appUnitId,
    app.ID              appSystemId,
    app.NAME            appSystemName,
    vm.IP               ip,
    vm.LDC_ID           ldcId,
    vm.OWNED_BY         ownedBy,
    table_total.*
    FROM CJ_CMP_VMWARE_VM vm LEFT JOIN CJ_CMP_APP_SYSTEM app ON vm.APP_SYSTEM_ID=app.ID AND app.IS_DELETED=0
    , (SELECT
    CEILING(max(day_report.CPUS))                                                           cpus,
    ROUND(avg(day_report.CPU_UTILIZATION), 2)                                               cpuUtilisation,
    ROUND(avg(day_report.CPU_USED), 2)                                                      cpuUsed,
    ROUND(avg(day_report.MEMORY_UTILIZATION), 2)                                            memoryUtilisation,
    ROUND(avg(day_report.DISK_UTILIZATION), 2)                                              diskUtilisation,
    CEILING(max(day_report.MEMORY_SUM) / 1024)                                              memorySum,
    ROUND(AVG((1 - day_report.MEMORY_UTILIZATION / 100) * day_report.MEMORY_SUM / 1024), 2) memoryFree,
    CEILING(max(day_report.DISK_SUM))                                                       diskSum,
    ROUND(avg(day_report.MAX_CPU_USED), 2)                                                  maxCpuUsed,
    ROUND(max(day_report.MAX_CPU_UTILIZATION), 2)                                           maxCpuUtilisation,
    ROUND(max(day_report.MAX_MEMORY_UTILIZATION), 2)                                        maxMemoryUtilisation,
    day_report.SERVICE_ACCOUNT_ID                                                           serviceAccountId,
    day_report.VM_ENTITY_ID                                                                 vmEntityId
    FROM CJ_CMP_VM_PERFORMANCE_METRIC_DAY_REPORT day_report
    WHERE day_report.TIME &gt;= #{startDate} AND day_report.TIME &lt;= #{endDate}
    GROUP BY day_report.SERVICE_ACCOUNT_ID, day_report.VM_ENTITY_ID) table_total
    WHERE table_total.vmEntityId = vm.ENTITY_ID AND vm.ENTITY_ID is NOT NULL AND vm.SERVICE_ACCOUNT_ID = table_total.serviceAccountId and vm.MEMBER_ID = #{memberId}
    <if test="appSystemId != null and appSystemId !='' " >
      and app.ID = #{appSystemId}
    </if>
    <if test="userIds != null and userIds.size>0 " >
      and vm.OWNED_BY in <foreach item="userId" index="index" collection="userIds" open="(" separator="," close=")"> #{userId} </foreach>
    </if>
    <if test="ids != null and ids.size>0 " >
      and vm.ID in <foreach item="id" index="index" collection="ids" open="(" separator="," close=")"> #{id} </foreach>
    </if>
    <if test="searchKey != null and searchKey !='' " >
      and ( vm.NAME like concat('%', #{searchKey}, '%') or vm.IP like concat('%', #{searchKey}, '%') )
    </if>
    UNION ALL
    SELECT
    vm.`NAME`           vmName,
    vm.MEMBER_ID        memberId,
    vm.ID               vmId,
    vm.APP_DU_ID        appUnitId,
    app.ID              appSystemId,
    app.NAME            appSystemName,
    vm.IP               ip,
    vm.LDC_ID           ldcId,
    ''                  ownedBy,
    table_total.*
    FROM CJ_CMDB_CI_QINGCLOUD_VM_INSTANCE vm LEFT JOIN CJ_CMP_APP_SYSTEM app ON vm.APP_SYSTEM_ID=app.ID AND app.IS_DELETED=0
    , (SELECT
    CEILING(max(day_report.CPUS))                                                           cpus,
    ROUND(avg(ifnull(day_report.CPU_UTILIZATION,0.00)), 2)                                  cpuUtilisation,
    ROUND(avg(day_report.CPU_USED), 2)                                                      cpuUsed,
    ROUND(avg(ifnull(day_report.MEMORY_UTILIZATION,0.00)), 2)                               memoryUtilisation,
    ROUND(avg(day_report.DISK_UTILIZATION), 2)                                              diskUtilisation,
    CEILING(max(day_report.MEMORY_SUM) / 1024)                                              memorySum,
    ROUND(AVG((1 - day_report.MEMORY_UTILIZATION / 100) * day_report.MEMORY_SUM / 1024), 2) memoryFree,
    CEILING(max(day_report.DISK_SUM))                                                       diskSum,
    ROUND(max(day_report.CPU_USED), 2)                                                      maxCpuUsed,
    ROUND(max(day_report.CPU_UTILIZATION), 2)                                               maxCpuUtilisation,
    ROUND(max(day_report.MEMORY_UTILIZATION), 2)                                            maxMemoryUtilisation,
    day_report.SERVICE_ACCOUNT_ID                                                           serviceAccountId,
    day_report.VM_ENTITY_ID                                                                 vmEntityId
    FROM CJ_CMP_VM_PERFORMANCE_METRIC_DAY_REPORT day_report
    WHERE day_report.TIME &gt;= #{startDate} AND day_report.TIME &lt;= #{endDate}
    GROUP BY day_report.SERVICE_ACCOUNT_ID, day_report.VM_ENTITY_ID) table_total
    WHERE table_total.vmEntityId = vm.ENTITY_ID AND vm.ENTITY_ID is NOT NULL AND vm.SERVICE_ACCOUNT_ID = table_total.serviceAccountId and vm.MEMBER_ID = #{memberId}
    <if test="appSystemId != null and appSystemId !='' " >
      and app.ID = #{appSystemId}
    </if>
    <if test="ids != null and ids.size>0 " >
      and vm.ID in <foreach item="id" index="index" collection="ids" open="(" separator="," close=")"> #{id} </foreach>
    </if>
    <if test="searchKey != null and searchKey !='' " >
      and ( vm.NAME like concat('%', #{searchKey}, '%') or vm.IP like concat('%', #{searchKey}, '%') )
    </if>
    UNION ALL
    SELECT
    vm.`NAME`           vmName,
    vm.MEMBER_ID        memberId,
    vm.ID               vmId,
    vm.APP_DU_ID        appUnitId,
    app.ID              appSystemId,
    app.NAME            appSystemName,
    vm.IP               ip,
    vm.LDC_ID           ldcId,
    ''                  ownedBy,
    table_total.*
    FROM CJ_CMP_CLOUDOS_VM vm LEFT JOIN CJ_CMP_APP_SYSTEM app ON vm.APP_SYSTEM_ID=app.ID AND app.IS_DELETED=0
    , (SELECT
    CEILING(max(day_report.CPUS))                                                           cpus,
    ROUND(avg(ifnull(day_report.CPU_UTILIZATION,0.00)), 2)                                  cpuUtilisation,
    ROUND(avg(day_report.CPU_USED), 2)                                                      cpuUsed,
    ROUND(avg(ifnull(day_report.MEMORY_UTILIZATION,0.00)), 2)                               memoryUtilisation,
    ROUND(avg(day_report.DISK_UTILIZATION), 2)                                              diskUtilisation,
    CEILING(max(day_report.MEMORY_SUM) / 1024)                                              memorySum,
    ROUND(AVG((1 - day_report.MEMORY_UTILIZATION / 100) * day_report.MEMORY_SUM / 1024), 2) memoryFree,
    CEILING(max(day_report.DISK_SUM))                                                       diskSum,
    ROUND(max(day_report.CPU_USED), 2)                                                      maxCpuUsed,
    ROUND(max(day_report.CPU_UTILIZATION), 2)                                               maxCpuUtilisation,
    ROUND(max(day_report.MEMORY_UTILIZATION), 2)                                            maxMemoryUtilisation,
    day_report.SERVICE_ACCOUNT_ID                                                           serviceAccountId,
    day_report.VM_ENTITY_ID                                                                 vmEntityId
    FROM CJ_CMP_VM_PERFORMANCE_METRIC_DAY_REPORT day_report
    WHERE day_report.TIME &gt;= #{startDate} AND day_report.TIME &lt;= #{endDate}
    GROUP BY day_report.SERVICE_ACCOUNT_ID, day_report.VM_ENTITY_ID) table_total
    WHERE table_total.vmEntityId = vm.ENTITY_ID AND vm.ENTITY_ID is NOT NULL AND vm.SERVICE_ACCOUNT_ID = table_total.serviceAccountId and vm.MEMBER_ID = #{memberId}
    <if test="appSystemId != null and appSystemId !='' " >
      and app.ID = #{appSystemId}
    </if>
    <if test="ids != null and ids.size>0 " >
      and vm.ID in <foreach item="id" index="index" collection="ids" open="(" separator="," close=")"> #{id} </foreach>
    </if>
    <if test="searchKey != null and searchKey !='' " >
      and ( vm.NAME like concat('%', #{searchKey}, '%') or vm.IP like concat('%', #{searchKey}, '%') )
    </if>
  
```
#### querySubSystemPerformanceList
```

    SELECT
    app.ID        appSystemId,
    app.NAME      appSystemName,
    app.CODE      appSystemCode,
    app.DEPT_ID   deptId,
    app.DEPT_NAME deptName,
    app.MEMBER_ID memberId,
    vmApp.*
    FROM CJ_CMP_APP_SYSTEM app INNER JOIN (SELECT
    tempApp.ID                                appId,
    SUM(total.cpus)                           cpus,
    SUM(total.memorySum)                      memorySum,
    SUM(total.diskSum)                        diskSum,
    round(AVG(total.cpuUtilisation), 2)       cpuUtilisation,
    round(AVG(total.cpuUsed), 2)              cpuUsed,
    round(AVG(total.memoryUtilisation), 2)    memoryUtilisation,
    round(AVG(total.diskUtilisation), 2)      diskUtilisation,
    ROUND(SUM(total.memoryFree), 2)           memoryFree,
    ROUND(AVG(total.maxCpuUtilisation), 2)    maxCpuUtilisation,
    ROUND(AVG(total.maxMemoryUtilisation), 2) maxMemoryUtilisation
    FROM CJ_CMP_APP_SYSTEM tempApp
    INNER JOIN CJ_CMP_VMWARE_VM vm ON tempApp.ID = vm.APP_SYSTEM_ID
    , (SELECT
    MAX(dayReport.CPUS)                   cpus,
    CEILING(MAX(dayReport.MEMORY_SUM) /
    1024)                         memorySum,
    MAX(
    dayReport.DISK_SUM)               diskSum,
    sum(dayReport.CPU_UTILIZATION * dayReport.CPUS) / sum(
    dayReport.CPUS)                   cpuUtilisation,
    sum(dayReport.CPU_USED * dayReport.CPUS) / sum(
    dayReport.CPUS)                   cpuUsed,
    sum(dayReport.MEMORY_UTILIZATION * (dayReport.MEMORY_SUM) / 1024) /
    sum(
    dayReport.MEMORY_SUM /
    1024)                             memoryUtilisation,
    avg((1 - dayReport.MEMORY_UTILIZATION / 100) * dayReport.MEMORY_SUM /
    1024)                             memoryFree,
    sum(dayReport.DISK_NUMBER * dayReport.DISK_UTILIZATION) / sum(
    dayReport.DISK_NUMBER)            diskUtilisation,
    avg(dayReport.MAX_CPU_UTILIZATION)    maxCpuUtilisation,
    avg(dayReport.MAX_MEMORY_UTILIZATION) maxMemoryUtilisation,
    dayReport.SERVICE_ACCOUNT_ID,
    dayReport.VM_ENTITY_ID
    FROM CJ_CMP_VM_PERFORMANCE_METRIC_DAY_REPORT dayReport
    WHERE dayReport.TIME &gt;= #{startDate} AND dayReport.TIME &lt;= #{endDate}
    GROUP BY dayReport.SERVICE_ACCOUNT_ID, dayReport.VM_ENTITY_ID) total
    WHERE vm.ENTITY_ID = total.VM_ENTITY_ID AND
    vm.SERVICE_ACCOUNT_ID = total.SERVICE_ACCOUNT_ID
    GROUP BY tempApp.ID) vmApp ON vmApp.appId = app.ID
    WHERE app.MEMBER_ID = #{memberId}
    <if test="deptId != null and deptId !='' " >
      and app.DEPT_ID = #{deptId}
    </if>
    <if test="searchKey != null and searchKey !='' " >
      and ( app.NAME like concat('%', #{searchKey}, '%') or app.CODE like concat('%', #{searchKey}, '%') )
    </if>
  
```
#### selectWeekRecords
```

    select cast(avg(CPU_UTILIZATION) as decimal(10,2)) as CPU_UTILIZATION,cast(avg(MEMORY_UTILIZATION) as decimal(10,2)) as MEMORY_UTILIZATION
    from CJ_CMP_VM_PERFORMANCE_METRIC_DAY_REPORT
    where VM_ENTITY_ID = #{vmEntityId} and SERVICE_ACCOUNT_ID =  #{serviceAccountId} and TIME <![CDATA[>]]> DATE_SUB(curdate(), INTERVAL 8 DAY) and TIME <![CDATA[<=]]>  DATE_SUB(curdate(), INTERVAL 1 DAY);
  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_VM_PERFORMANCE_METRIC_HOT.xml
> sql统计:复杂1个，简单3个
>
> 使用的关键字：cast,DATE,CJ_CMP_VM_PERFORMANCE_METRIC_HOT,now,avg,decimal,DATE_SUB,curdate,date,values
#### selectWeekRecords
```

        select cast(avg(CPU_UTILIZATION) as decimal(10,2)) as CPU_UTILIZATION,cast(avg(MEMORY_UTILIZATION) as decimal(10,2)) as MEMORY_UTILIZATION
        from CJ_CMP_VM_PERFORMANCE_METRIC_HOT
        where VM_ENTITY_ID = #{vmEntityId} and SERVICE_ACCOUNT_ID = #{serviceAccountId} and DATE_SUB(curdate(), INTERVAL 7 DAY) <![CDATA[<]]> date(TIME);
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_VM_SNAPSHOT.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：CONCAT,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_VM_SPEC.xml
> sql统计:复杂1个，简单7个
>
> 使用的关键字：group_concat,NOW,and
#### queryFusionCloudSpec
```

        select spec.*, group_concat(distinct az.NAME) as zoneName, sa.NAME AS serviceAccountName, sa.ID AS serviceAccountId
        FROM CJ_CMP_SERVICE_ACCOUNT sa
        INNER JOIN CJ_CMP_CLOUD_ACCOUNT_DC cdc ON sa.ID = cdc.SERVICE_ACCOUNT_ID AND cdc.IS_DELETED = 0 AND sa.IS_DELETED = 0
        INNER JOIN CJ_CMP_CLOUD_ACCOUNT ca ON cdc.CLOUD_ACCOUNT_ID = ca.ID AND ca.IS_DELETED = 0
        inner join CJ_CMP_FUSION_CLOUD_DC_X_AZ dcx on dcx.LDC_ID=cdc.LDC_ID and cdc.LDC_TYPE='fusionCloud'
        LEFT JOIN CJ_CMP_CLOUD_AZ az on az.ID=dcx.AZ_ID
        inner join CJ_CMP_CLOUD_DC_X_SPEC dxs on dxs.LDC_ID=cdc.LDC_ID and dxs.SERVICE_ACCOUNT_ID=sa.ID
        INNER JOIN CJ_CMP_VM_SPEC spec ON spec.ID=dxs.SPEC_ID
        where spec.IS_DELETED=0
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>
        <if test="id != null and id != ''"> and spec.ID=#{id}</if>
        <if test="serviceAccountId != null and serviceAccountId != ''"> and sa.ID=#{serviceAccountId}</if>
        <if test="cloudAccountId != null and cloudAccountId != ''"> and ca.ID=#{cloudAccountId}</if>
        <if test="ldcId != null and ldcId != ''"> and cdc.LDC_ID=#{ldcId}</if>
        <if test="ldcType != null and ldcType != ''"> and cdc.LDC_TYPE=#{ldcType}</if>
        <if test="azId != null and azId != ''"> and az.ID=#{azId}</if>
        <if test="searchKey != null and searchKey != ''"> and (spec.NAME like #{searchKey} or spec.ENTITY_ID like #{searchKey})</if>
        group by spec.ID, spec.NAME, sa.ID
        order by spec.NAME
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_VM_VIEW.xml
> sql统计:复杂17个，简单22个
>
> 使用的关键字：ifnull,substring_index,join,SUM,to_days,CURDATE,date,JOIN,GROUP_CONCAT,exists,from,date_sub,values,round,concat,count,and,WHEN,where,DATE_SUB,sum,inet_aton,when,DATE,CJ_CMP_TAG_X_OBJECT,CONCAT,convert,now,FROM
#### queryList
```

        select vm.*,app.ID as appSystemId,app.NAME as appSystemName,vl.diskSum ,vl.diskNumber ,vmtag.tag,du.NAME as appDuName,vm.APP_DU_ID as appDuId,iac.SERVICE_INSTANCE_ID as serviceInstanceId,project.NAME AS projectName,project.ID AS projectId,
        case when ifnull(u.ACTIVE,0)=0 then concat(u.NAME,' (已删除)') when ifnull(u.LOCKED_OUT,0)=0 then u.NAME else concat(u.NAME,' (已冻结)') end as owner, depart.`NAME` as dept,
        case when ifnull(uaas.ACTIVE,0)=0 then concat(uaas.NAME,' (已删除)') when ifnull(uaas.LOCKED_OUT,0)=0 then uaas.NAME else concat(uaas.NAME,' (已冻结)') end as assigner 
        from cj_cmp_vm_view vm
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
        left outer join CJ_CMP_PROJECT project on project.ID=vm.PROJECT_ID
        left join (SELECT VM_DEVICE_ID,SERVICE_ACCOUNT_ID, sum( DISK_SPACE ) AS diskSum, count( DISK_SPACE ) AS diskNumber FROM CJ_CMP_VM_VOLUME WHERE IS_DELETED=0 GROUP BY VM_DEVICE_ID, SERVICE_ACCOUNT_ID ) AS vl
        on vl.VM_DEVICE_ID = vm.ID and vl.SERVICE_ACCOUNT_ID = vm.SERVICE_ACCOUNT_ID
        LEFT JOIN (SELECT rel.OBJECT_ID, rel.OBJECT_TYPE, GROUP_CONCAT(tag.`NAME`) as tag from CJ_CMP_TAG tag INNER JOIN CJ_CMP_TAG_X_OBJECT rel on tag.ID = rel.TAG_ID GROUP BY rel.OBJECT_ID, rel.OBJECT_TYPE) as vmtag
        on vm.ID = vmtag.OBJECT_ID and vm.LDC_TYPE = vmtag.OBJECT_TYPE
        LEFT JOIN ydduc.UC_USER u ON vm.OWNED_BY = u.ID
        LEFT JOIN ydduc.UC_USER uaas ON vm.ASSIGNED_TO = uaas.ID
        LEFT JOIN ydduc.UC_DEPARTMENT depart ON u.DEPARTMENT = depart.ID
        left outer join CJ_CMP_SERVICE_INSTANCE_X_RESOURCE iac on iac.SERVICE_ACCOUNT_ID=vm.SERVICE_ACCOUNT_ID and iac.RESOURCE_ID=vm.ID
        LEFT JOIN CJ_CMP_APP_DU du ON vm.APP_DU_ID = du.ID
        where
            vm.MEMBER_ID = #{memberId} and ( 1=1
            <if test="userIds != null and userIds.size >0 ">
                and  vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
                or  vm.ASSIGNED_TO in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
                <if test="appUserId !=null ">
                    or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                    <if test="appDepartmentList != null and appDepartmentList.size != 0">
                        or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                        or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    </if>
                </if>

            </if>
            <if test="appSystemIds != null and appSystemIds.size>0">
                or vm.APP_SYSTEM_ID in
                <foreach collection="appSystemIds" item="appSystemId" open="(" close=")" separator=",">#{appSystemId}</foreach>
            </if>
            )
            <if test="cloudAccountId != null and cloudAccountId != ''">
                and vm.CLOUD_ACCOUNT_ID = #{cloudAccountId}
            </if>
            <if test="ldcId != null and ldcId != ''">
                and vm.LDC_ID = #{ldcId}
            </if>
            <if test="appSystemId != null">
                and vm.APP_SYSTEM_ID = #{appSystemId}
            </if>

            <if test="keywordList != null and keywordList.size==1" >
                <choose>
                    <when test="queryType != null and queryType == 'name'" >
                        and vm.NAME like CONCAT('%',#{keyword},'%')
                    </when>
                    <when test="queryType != null and queryType == 'manageBy'" >
                        <if test="searchUserList != null and searchUserList.size != 0">
                            and ( vm.OWNED_BY in <foreach collection="searchUserList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
                            or u.NAME like concat('%', #{keyword}, '%') )
                        </if>
                        <if test="searchUserList == null or searchUserList.size == 0">
                            and u.NAME like concat('%', #{keyword}, '%')
                        </if>
                    </when>
                    <when test="queryType != null and queryType == 'assigner'" >
                        <if test="searchUserList != null and searchUserList.size != 0">
                            and ( vm.ASSIGNED_TO in <foreach collection="searchUserList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
                            or uaas.NAME like concat('%', #{keyword}, '%') )
                        </if>
                        <if test="searchUserList == null or searchUserList.size == 0">
                            and uaas.NAME like concat('%', #{keyword}, '%')
                        </if>
                    </when>
                    <when test="queryType != null and queryType == 'entityId'" >
                        and vm.ENTITY_ID like concat('%', #{keyword}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'ip'" >
                        and vm.IP like concat('%', #{keyword}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'appSystemName'" >
                        and app.NAME like concat('%', #{keyword}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'projectName'" >
                        and (project.NAME like concat('%', #{keyword}, '%') or project.CODE like concat('%', #{keyword}, '%'))
                    </when>
                    <when test="queryType != null and queryType == 'tag'" >
                        and exists (select rel.ID
                        from CJ_CMP_TAG_X_OBJECT rel
                        where vm.MEMBER_ID = #{memberId}
                        and rel.TAG_ID = #{keyword}
                        and rel.OBJECT_TYPE = vm.LDC_TYPE and rel.OBJECT_ID = vm.ID
                        )
                    </when>
                    <when test="queryType != null and queryType == 'department'" >
                        and depart.`NAME` like concat('%', #{keyword}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'runStatus'" >
                        and vm.RUN_STATUS like concat('%', #{keyword}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'ldcType'" >
                        and vm.LDC_TYPE like concat('%', #{keyword}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'srvNumber'" >
                        and vm.SRV_NO like concat('%', #{keyword}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'os'" >
                        and vm.OS like concat('%', #{keyword}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'userdFor'" >
                        and vm.USED_FOR like concat('%', #{keyword}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'remark'" >
                        and vm.REMARK like concat('%', #{keyword}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'appSystemName'" >
                        and app.NAME like concat('%', #{keyword}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'cloudAccountName'" >
                        and vm.CLOUD_ACCOUNT_NAME like concat('%', #{keyword}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'appDuName'" >
                        and du.NAME like concat('%', #{keyword}, '%')
                    </when>
                    <otherwise>
                        and (
                        vm.NAME like CONCAT('%',#{keyword},'%')
                        <if test="searchUserList != null and searchUserList.size != 0">
                        OR vm.OWNED_BY in <foreach collection="searchUserList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
                        OR vm.ASSIGNED_TO in <foreach collection="searchUserList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
                       </if>
                        OR vm.ENTITY_ID like concat('%', #{keyword}, '%')
                        OR vm.IP like concat('%', #{keyword}, '%')
                        OR app.NAME like concat('%', #{keyword}, '%')
                        OR project.NAME like concat('%', #{keyword}, '%') or project.CODE like concat('%', #{keyword}, '%')
                        OR depart.`NAME` like concat('%', #{keyword}, '%')
                        OR vm.OWNED_BY like concat('%', #{keyword}, '%')
                        OR vm.RUN_STATUS like concat('%', #{keyword}, '%')
                        OR vm.LDC_TYPE like concat('%', #{keyword}, '%')
                        OR vm.SRV_NO like concat('%', #{keyword}, '%')
                        OR vm.OS like concat('%', #{keyword}, '%')
                        OR vm.USED_FOR like concat('%', #{keyword}, '%')
                        OR vm.REMARK like concat('%', #{keyword}, '%')
                        OR vm.CLOUD_ACCOUNT_NAME like concat('%', #{keyword}, '%')
                        OR u.NAME like concat('%', #{keyword}, '%')
                        OR uaas.NAME like concat('%', #{keyword}, '%')
                        )
                    </otherwise>
                </choose>
            </if>
            <if test="keywordList != null and keywordList.size>1" >
                <choose>
                    <when test="queryType != null and queryType == 'name'" >
                        and vm.NAME in <foreach collection="keywordList" item="name" open="(" close=")" separator=",">#{name}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'manageBy'" >
                        <if test="searchUserList != null and searchUserList.size != 0">
                            and ( vm.OWNED_BY in <foreach collection="searchUserList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
                            or u.NAME in <foreach collection="keywordList" item="manageName" open="(" close=")" separator=",">#{manageName}</foreach> )
                        </if>
                        <if test="searchUserList == null or searchUserList.size == 0">
                            and u.NAME in <foreach collection="keywordList" item="manageName" open="(" close=")" separator=",">#{manageName}</foreach>
                        </if>
                    </when>
                    <when test="queryType != null and queryType == 'entityId'" >
                        and vm.ENTITY_ID in <foreach collection="keywordList" item="entityId" open="(" close=")" separator=",">#{entityId}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'ip'" >
                        and vm.IP in <foreach collection="keywordList" item="IP" open="(" close=")" separator=",">#{IP}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'appSystemName'" >
                        and app.NAME in <foreach collection="keywordList" item="appName" open="(" close=")" separator=",">#{appName}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'department'" >
                        and depart.`NAME` in <foreach collection="keywordList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'runStatus'" >
                        and vm.RUN_STATUS in <foreach collection="keywordList" item="runStatus" open="(" close=")" separator=",">#{runStatus}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'ldcType'" >
                        and vm.LDC_TYPE in <foreach collection="keywordList" item="ldcType" open="(" close=")" separator=",">#{ldcType}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'srvNumber'" >
                        and vm.SRV_NO in <foreach collection="keywordList" item="srvNumber" open="(" close=")" separator=",">#{srvNumber}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'os'" >
                        and vm.OS in <foreach collection="keywordList" item="os" open="(" close=")" separator=",">#{os}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'userdFor'" >
                        and vm.USED in <foreach collection="keywordList" item="userdFor" open="(" close=")" separator=",">#{userdFor}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'remark'" >
                        and vm.REMARK in <foreach collection="keywordList" item="remark" open="(" close=")" separator=",">#{remark}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'cloudAccountName'" >
                        and vm.CLOUD_ACCOUNT_NAME in <foreach collection="keywordList" item="cloudAccountName" open="(" close=")" separator=",">#{cloudAccountName}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'appDuName'" >
                        and du.NAME in <foreach collection="keywordList" item="appDuName" open="(" close=")" separator=",">#{appDuName}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'tag'" >
                        and exists (select rel.OBJECT_ID
                        from CJ_CMP_TAG_X_OBJECT rel
                        where vm.MEMBER_ID = #{memberId}
                        and rel.TAG_ID in <foreach collection="keywordList" item="tag" open="(" close=")" separator=",">#{tag}</foreach>
                        and rel.OBJECT_TYPE = vm.LDC_TYPE and rel.OBJECT_ID = vm.ID
                        group by rel.OBJECT_ID
                        having count(1) = ${keywordList.size}
                        )
                    </when>
                    <otherwise>
                        and (
                        vm.NAME in <foreach collection="keywordList" item="name" open="(" close=")" separator=",">#{name}</foreach>
                        <if test="searchUserList != null and searchUserList.size != 0">
                            OR vm.OWNED_BY in <foreach collection="searchUserList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
                        </if>
                        OR vm.ENTITY_ID in <foreach collection="keywordList" item="entityId" open="(" close=")" separator=",">#{entityId}</foreach>
                        OR app.NAME in <foreach collection="keywordList" item="appSystemName" open="(" close=")" separator=",">#{appSystemName}</foreach>
                        OR vm.IP in <foreach collection="keywordList" item="IP" open="(" close=")" separator=",">#{IP}</foreach>
                        OR app.NAME in <foreach collection="keywordList" item="appName" open="(" close=")" separator=",">#{appName}</foreach>
                        OR depart.`NAME` in <foreach collection="keywordList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                        OR vm.RUN_STATUS in <foreach collection="keywordList" item="runStatus" open="(" close=")" separator=",">#{runStatus}</foreach>
                        OR vm.LDC_TYPE in <foreach collection="keywordList" item="ldcType" open="(" close=")" separator=",">#{ldcType}</foreach>
                        OR vm.SRV_NO in <foreach collection="keywordList" item="srvNumber" open="(" close=")" separator=",">#{srvNumber}</foreach>
                        OR vm.OS in <foreach collection="keywordList" item="os" open="(" close=")" separator=",">#{os}</foreach>
                        OR vm.USED_FOR in <foreach collection="keywordList" item="userdFor" open="(" close=")" separator=",">#{userdFor}</foreach>
                        OR vm.REMARK in <foreach collection="keywordList" item="remark" open="(" close=")" separator=",">#{remark}</foreach>
                        OR vm.CLOUD_ACCOUNT_NAME in <foreach collection="keywordList" item="cloudAccountName" open="(" close=")" separator=",">#{cloudAccountName}</foreach>
                        OR u.NAME in <foreach collection="keywordList" item="manageName" open="(" close=")" separator=",">#{manageName}</foreach>
                        )
                    </otherwise>
                </choose>
            </if>
        <choose>
            <when test="sortFieldList != null and sortFieldList.size >= 1 and sortType != ''" >
                ORDER BY  <foreach collection="sortFieldList" item="sortField" separator=",">
                            <if test="sortField =='vm.IP'">inet_aton(substring_index(IP,',',1)) ${sortType},IP</if>
                            <if test="sortField !='vm.IP'">convert(${sortField} USING gbk) ${sortType}</if>
                         </foreach>
            </when>
            <otherwise> ORDER BY vm.CREATE_DATE desc</otherwise>
        </choose>
    
```
#### queryListByExpression
```

        select vm.*,app.ID as appSystemId,app.NAME as appSystemName,vl.diskSum ,vl.diskNumber ,vmtag.tag,du.NAME as appDuName,vm.APP_DU_ID as appDuId,iac.SERVICE_INSTANCE_ID as serviceInstanceId,project.NAME AS projectName,project.ID AS projectId,
        case when ifnull(u.ACTIVE,0)=0 then concat(u.NAME,' (已删除)') when ifnull(u.LOCKED_OUT,0)=0 then u.NAME else concat(u.NAME,' (已冻结)') end as owner, depart.`NAME` as dept,
        case when ifnull(uaas.ACTIVE,0)=0 then concat(uaas.NAME,' (已删除)') when ifnull(uaas.LOCKED_OUT,0)=0 then uaas.NAME else concat(uaas.NAME,' (已冻结)') end as assigner
        from cj_cmp_vm_view vm
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
        left outer join CJ_CMP_PROJECT project on project.ID=vm.PROJECT_ID
        left join (SELECT VM_DEVICE_ID,SERVICE_ACCOUNT_ID, sum( DISK_SPACE ) AS diskSum, count( DISK_SPACE ) AS diskNumber FROM CJ_CMP_VM_VOLUME WHERE IS_DELETED=0 GROUP BY VM_DEVICE_ID, SERVICE_ACCOUNT_ID ) AS vl
        on vl.VM_DEVICE_ID = vm.ID and vl.SERVICE_ACCOUNT_ID = vm.SERVICE_ACCOUNT_ID
        LEFT JOIN (SELECT rel.OBJECT_ID, rel.OBJECT_TYPE, GROUP_CONCAT(tag.`NAME`) as tag from CJ_CMP_TAG tag INNER JOIN CJ_CMP_TAG_X_OBJECT rel on tag.ID = rel.TAG_ID GROUP BY rel.OBJECT_ID, rel.OBJECT_TYPE) as vmtag
        on vm.ID = vmtag.OBJECT_ID and vm.LDC_TYPE = vmtag.OBJECT_TYPE
        LEFT JOIN ydduc.UC_USER u ON vm.OWNED_BY = u.ID
        LEFT JOIN ydduc.UC_USER uaas ON vm.ASSIGNED_TO = uaas.ID
        LEFT JOIN ydduc.UC_DEPARTMENT depart ON u.DEPARTMENT = depart.ID
        left outer join CJ_CMP_SERVICE_INSTANCE_X_RESOURCE iac on  iac.SERVICE_ACCOUNT_ID=vm.SERVICE_ACCOUNT_ID and iac.RESOURCE_ID=vm.ID
        LEFT JOIN CJ_CMP_APP_DU du ON vm.APP_DU_ID = du.ID
        where
        vm.MEMBER_ID = #{memberId} and ( 1=1
        <if test="userIds != null and userIds.size >0 ">
            and  vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            or  vm.ASSIGNED_TO in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
        </if>
        <if test="appSystemIds != null and appSystemIds.size>0">
            or vm.APP_SYSTEM_ID in
            <foreach collection="appSystemIds" item="appSystemId" open="(" close=")" separator=",">#{appSystemId}</foreach>
        </if>
        )
        <if test="cloudAccountId != null and cloudAccountId != ''">
            and vm.CLOUD_ACCOUNT_ID = #{cloudAccountId}
        </if>
        <if test="ldcId != null and ldcId != ''">
            and vm.LDC_ID = #{ldcId}
        </if>
        <if test="appSystemId != null">
            and vm.APP_SYSTEM_ID = #{appSystemId}
        </if>

        <foreach collection="queryExpressionMap" index="queryType" item="keywordList">
            <if test="keywordList != null and keywordList.size == 1" >
                <choose>
                    <when test="queryType != null and queryType == 'name'" >
                        and vm.NAME like CONCAT('%',#{queryExpressionMap.name[0]},'%')
                    </when>
                    <when test="queryType != null and queryType == 'manageBy'" >
                        <if test="searchUserList != null and searchUserList.size != 0">
                            and ( vm.OWNED_BY in <foreach collection="searchUserList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
                            or u.NAME like concat('%', #{queryExpressionMap.manageBy[0]}, '%') )
                        </if>
                        <if test="searchUserList == null or searchUserList.size == 0">
                            and u.NAME like concat('%', #{queryExpressionMap.manageBy[0]}, '%')
                        </if>
                    </when>
                    <when test="queryType != null and queryType == 'assigner'" >
                        <if test="searchUserList != null and searchUserList.size != 0">
                            and ( vm.ASSIGNED_TO in <foreach collection="searchUserList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
                            or uaas.NAME like concat('%', #{queryExpressionMap.assigner[0]}, '%') )
                        </if>
                        <if test="searchUserList == null or searchUserList.size == 0">
                            and uaas.NAME like concat('%', #{queryExpressionMap.assigner[0]}, '%')
                        </if>
                    </when>
                    <when test="queryType != null and queryType == 'entityId'" >
                        and vm.ENTITY_ID like concat('%', #{queryExpressionMap.entityId[0]}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'ip'" >
                        and vm.IP like concat('%', #{queryExpressionMap.ip[0]}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'appSystemName'" >
                        and app.NAME like concat('%', #{queryExpressionMap.appSystemName[0]}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'projectName'" >
                        and (project.NAME like concat('%', #{queryExpressionMap.projectName[0]}, '%') or project.CODE like concat('%', #{queryExpressionMap.projectName[0]}, '%'))
                    </when>
                    <when test="queryType != null and queryType == 'tag'" >
                        and exists (select rel.ID
                        from CJ_CMP_TAG_X_OBJECT rel
                        where vm.MEMBER_ID = #{memberId}
                        and rel.TAG_ID = #{queryExpressionMap.tag[0]}
                        and rel.OBJECT_TYPE = vm.LDC_TYPE and rel.OBJECT_ID = vm.ID
                        )
                    </when>
                    <when test="queryType != null and queryType == 'department'" >
                        and depart.`NAME` like concat('%', #{queryExpressionMap.department[0]}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'runStatus'" >
                        and vm.RUN_STATUS like concat('%', #{queryExpressionMap.runStatus[0]}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'ldcType'" >
                        and vm.LDC_TYPE like concat('%', #{queryExpressionMap.ldcType[0]}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'srvNumber'" >
                        and vm.SRV_NO like concat('%', #{queryExpressionMap.srvNumber[0]}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'os'" >
                        and vm.OS like concat('%', #{queryExpressionMap.os[0]}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'userdFor'" >
                        and vm.USED_FOR like concat('%', #{queryExpressionMap.userdFor[0]}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'remark'" >
                        and vm.REMARK like concat('%', #{queryExpressionMap.remark[0]}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'appSystemName'" >
                        and app.NAME like concat('%', #{queryExpressionMap.appSystemName[0]}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'cloudAccountName'" >
                        and vm.CLOUD_ACCOUNT_NAME like concat('%', #{queryExpressionMap.cloudAccountName[0]}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'appDuName'" >
                        and du.NAME like concat('%', #{queryExpressionMap.appDuName[0]}, '%')
                    </when>
                    <otherwise>
                        and (
                        vm.NAME like CONCAT('%',#{queryExpressionMap.keyword[0]},'%')
                        <if test="searchUserList != null and searchUserList.size != 0">
                            OR vm.OWNED_BY in <foreach collection="searchUserList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
                            OR vm.ASSIGNED_TO in <foreach collection="searchUserList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
                        </if>
                        OR vm.ENTITY_ID like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        OR vm.IP like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        OR app.NAME like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        OR project.NAME like concat('%', #{queryExpressionMap.keyword[0]}, '%') or project.CODE like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        OR depart.`NAME` like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        OR vm.OWNED_BY like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        OR vm.RUN_STATUS like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        OR vm.LDC_TYPE like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        OR vm.SRV_NO like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        OR vm.OS like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        OR vm.USED_FOR like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        OR vm.REMARK like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        OR vm.CLOUD_ACCOUNT_NAME like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        OR u.NAME like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        OR uaas.NAME like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        )
                    </otherwise>
                </choose>
            </if>
            <if test="keywordList != null and keywordList.size > 1" >
                <choose>
                    <when test="queryType != null and queryType == 'name'" >
                        and vm.NAME in <foreach collection="keywordList" item="name" open="(" close=")" separator=",">#{name}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'manageBy'" >
                        <if test="searchUserList != null and searchUserList.size != 0">
                            and ( vm.OWNED_BY in <foreach collection="searchUserList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
                            or u.NAME in <foreach collection="keywordList" item="manageName" open="(" close=")" separator=",">#{manageName}</foreach> )
                        </if>
                        <if test="searchUserList == null or searchUserList.size == 0">
                            and u.NAME in <foreach collection="keywordList" item="manageName" open="(" close=")" separator=",">#{manageName}</foreach>
                        </if>
                    </when>
                    <when test="queryType != null and queryType == 'entityId'" >
                        and vm.ENTITY_ID in <foreach collection="keywordList" item="entityId" open="(" close=")" separator=",">#{entityId}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'ip'" >
                        and vm.IP in <foreach collection="keywordList" item="IP" open="(" close=")" separator=",">#{IP}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'appSystemName'" >
                        and app.NAME in <foreach collection="keywordList" item="appName" open="(" close=")" separator=",">#{appName}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'department'" >
                        and depart.`NAME` in <foreach collection="keywordList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'runStatus'" >
                        and vm.RUN_STATUS in <foreach collection="keywordList" item="runStatus" open="(" close=")" separator=",">#{runStatus}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'ldcType'" >
                        and vm.LDC_TYPE in <foreach collection="keywordList" item="ldcType" open="(" close=")" separator=",">#{ldcType}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'srvNumber'" >
                        and vm.SRV_NO in <foreach collection="keywordList" item="srvNumber" open="(" close=")" separator=",">#{srvNumber}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'os'" >
                        and vm.OS in <foreach collection="keywordList" item="os" open="(" close=")" separator=",">#{os}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'userdFor'" >
                        and vm.USED in <foreach collection="keywordList" item="userdFor" open="(" close=")" separator=",">#{userdFor}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'remark'" >
                        and vm.REMARK in <foreach collection="keywordList" item="remark" open="(" close=")" separator=",">#{remark}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'cloudAccountName'" >
                        and vm.CLOUD_ACCOUNT_NAME in <foreach collection="keywordList" item="cloudAccountName" open="(" close=")" separator=",">#{cloudAccountName}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'appDuName'" >
                        and du.NAME in <foreach collection="keywordList" item="appDuName" open="(" close=")" separator=",">#{appDuName}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'tag'" >
                        and exists (select rel.OBJECT_ID
                        from CJ_CMP_TAG_X_OBJECT rel
                        where vm.MEMBER_ID = #{memberId}
                        and rel.TAG_ID in <foreach collection="keywordList" item="tag" open="(" close=")" separator=",">#{tag}</foreach>
                        and rel.OBJECT_TYPE = vm.LDC_TYPE and rel.OBJECT_ID = vm.ID
                        group by rel.OBJECT_ID
                        having count(1) = ${keywordList.size}
                        )
                    </when>
                    <otherwise>
                        and (
                        vm.NAME in <foreach collection="keywordList" item="name" open="(" close=")" separator=",">#{name}</foreach>
                        <if test="searchUserList != null and searchUserList.size != 0">
                            OR vm.OWNED_BY in <foreach collection="searchUserList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
                        </if>
                        OR vm.ENTITY_ID in <foreach collection="keywordList" item="entityId" open="(" close=")" separator=",">#{entityId}</foreach>
                        OR app.NAME in <foreach collection="keywordList" item="appSystemName" open="(" close=")" separator=",">#{appSystemName}</foreach>
                        OR vm.IP in <foreach collection="keywordList" item="IP" open="(" close=")" separator=",">#{IP}</foreach>
                        OR app.NAME in <foreach collection="keywordList" item="appName" open="(" close=")" separator=",">#{appName}</foreach>
                        OR depart.`NAME` in <foreach collection="keywordList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                        OR vm.RUN_STATUS in <foreach collection="keywordList" item="runStatus" open="(" close=")" separator=",">#{runStatus}</foreach>
                        OR vm.LDC_TYPE in <foreach collection="keywordList" item="ldcType" open="(" close=")" separator=",">#{ldcType}</foreach>
                        OR vm.SRV_NO in <foreach collection="keywordList" item="srvNumber" open="(" close=")" separator=",">#{srvNumber}</foreach>
                        OR vm.OS in <foreach collection="keywordList" item="os" open="(" close=")" separator=",">#{os}</foreach>
                        OR vm.USED_FOR in <foreach collection="keywordList" item="userdFor" open="(" close=")" separator=",">#{userdFor}</foreach>
                        OR vm.REMARK in <foreach collection="keywordList" item="remark" open="(" close=")" separator=",">#{remark}</foreach>
                        OR vm.CLOUD_ACCOUNT_NAME in <foreach collection="keywordList" item="cloudAccountName" open="(" close=")" separator=",">#{cloudAccountName}</foreach>
                        OR u.NAME in <foreach collection="keywordList" item="manageName" open="(" close=")" separator=",">#{manageName}</foreach>
                        )
                    </otherwise>
                </choose>
            </if>
        </foreach>
        <choose>
            <when test="sortFieldList != null and sortFieldList.size >= 1 and sortType != ''" >
                ORDER BY  <foreach collection="sortFieldList" item="sortField" separator=",">
                            <if test="sortField =='vm.IP'">inet_aton(substring_index(IP,',',1)) ${sortType},IP</if>
                            <if test="sortField !='vm.IP'">convert(${sortField} USING gbk) ${sortType}</if>
                         </foreach>
            </when>
            <otherwise> ORDER BY vm.CREATE_DATE desc</otherwise>
        </choose>
    
```
#### queryExpireVmListReport
```

        select distinct vm.*,vm.CREATE_DATE AS createDate,app.ID as appSystemId,app.NAME as appSystemName,project.NAME AS projectName,host.SN AS hostSn,vl.diskSum ,vl.diskNumber ,vmtag.tag
        from (select * from (select * from cj_cmp_vm_view vm
        where vm.due is not null
        and vm.due &gt; now()
        and date_sub(vm.due, interval 30 day) &lt; now()
        order by due desc) as tab1
        union all
        select * from (select * from cj_cmp_vm_view vm
        where vm.due is not null and vm.due &lt;= now()
        order by due) as tab2
        union all
        select * from (select * from cj_cmp_vm_view vm
        where (vm.due is not null and vm.due &gt;= now() and date_sub(vm.due, interval 30 day) &gt;=now())
        order by due desc) as tab3
        union all
        select * from (select * from cj_cmp_vm_view vm
        where vm.due is null) as tab4) vm
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
        left outer join CJ_CMP_PROJECT project on project.ID=vm.PROJECT_ID
        left outer join CJ_CMP_VMWARE_HOST host on host.ID=vm.HOST_ID
        left join (SELECT distinct VM_DEVICE_ID,SERVICE_ACCOUNT_ID, sum( DISK_SPACE ) AS diskSum, count( DISK_SPACE ) AS diskNumber FROM CJ_CMP_VM_VOLUME where IS_DELETED = 0 GROUP BY VM_DEVICE_ID, SERVICE_ACCOUNT_ID ) AS vl
        on vl.VM_DEVICE_ID = vm.ID and vl.SERVICE_ACCOUNT_ID = vm.SERVICE_ACCOUNT_ID
        LEFT JOIN (SELECT rel.OBJECT_ID, rel.OBJECT_TYPE, GROUP_CONCAT(tag.`NAME`) as tag from CJ_CMP_TAG tag INNER JOIN CJ_CMP_TAG_X_OBJECT rel on tag.ID = rel.TAG_ID GROUP BY rel.OBJECT_ID, rel.OBJECT_TYPE) as vmtag
        on vm.ID = vmtag.OBJECT_ID and vm.LDC_TYPE = vmtag.OBJECT_TYPE
        where
        vm.MEMBER_ID = #{memberId}
        <if test="userIds != null and userIds.size >0 ">
            and ( vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
            )
        </if>
        <if test="searchKey != null and searchKey != ''">
            and (vm.IP like concat('%', #{searchKey}, '%') or vm.NAME like concat('%', #{searchKey}, '%') or host.NAME like concat('%', #{searchKey}, '%'))
        </if>

        <if test="startTime != null and startTime != ''">
            and vm.CREATE_DATE between #{startTime} and #{endTime}
        </if>

        <if test="sortField != null and sortField != ''">
            ORDER BY ${sortField} ${sortType}
        </if>
    
```
#### queryExpireVmCountReport
```

        SELECT a.exipreType,ifnull(b.num,0) AS num FROM
        (SELECT '即将过期' AS exipreType
        union all
        SELECT '已过期' AS exipreType
        union all
        SELECT '未过期' AS exipreType) AS a left join  (SELECT tab.exipreType,count(NAME) AS num FROM
        (select
        case
        when ((vm.due is not null and vm.due &gt;= now() and date_sub(vm.due, interval 30 day) &gt;=now()) or vm.due is null) then '未过期'
        when vm.due is not null and vm.due &gt; now() and date_sub(vm.due, interval 30 day) &lt;now() then '即将过期'
        when vm.due is not null and vm.due &lt;= now() then '已过期'
        else '其它' end AS exipreType,vm.NAME
        from cj_cmp_vm_view vm
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
        left outer join CJ_CMP_VMWARE_HOST host on host.ID=vm.HOST_ID
        where
        vm.MEMBER_ID = #{memberId}
        <if test="userIds != null and userIds.size >0 ">
            and ( vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
            )
        </if>
        <if test="searchKey != null and searchKey != ''">
            and (vm.IP like concat('%', #{searchKey}, '%') or vm.NAME like concat('%', #{searchKey}, '%') or host.NAME like concat('%', #{searchKey}, '%'))
        </if>

        <if test="startTime != null and startTime != ''">
            and vm.CREATE_DATE between #{startTime} and #{endTime}
        </if>
        ) AS tab group by tab.exipreType) AS b on a.exipreType = b.exipreType;
    
```
#### queryVmSpecReport
```

        SELECT vmInfo.SPEC AS spec,count(vmInfo.`NAME`) AS num FROM
        (SELECT CASE WHEN (vm.CPUS is null or vm.CPUS = '') and (vm.MEMORY is null or vm.MEMORY = '')
        THEN '其它'
        ELSE concat(vm.CPUS,"C",round(ifnull(vm.MEMORY/1024,0),0),"G") END AS SPEC,vm.`NAME`
        from cj_cmp_vm_view vm
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
        where
        vm.MEMBER_ID = #{memberId}
        <if test="userIds != null and userIds.size >0 ">
            and ( vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
            )
        </if>
        <if test="searchKey != null and searchKey != ''">
            and (vm.IP like concat('%', #{searchKey}, '%') or vm.NAME like concat('%', #{searchKey}, '%'))
        </if>

        <if test="startTime != null and startTime != ''">
            and vm.CREATE_DATE between #{startTime} and #{endTime}
        </if>
        ) AS vmInfo group by vmInfo.SPEC
    
```
#### querySpecGroupByAppTopReport
```

        SELECT vmInfo.name,vmInfo.spec FROM
        (SELECT app.NAME AS name,concat(sum(CPUS),"C",round(ifnull(sum(MEMORY)/1024,0),0),"G") AS spec,sum(CPUS) AS vmCpus,sum(MEMORY) AS vmMemory
        FROM cj_cmp_vm_view vm
        inner join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
        where
        vm.MEMBER_ID = #{memberId} and vm.CPUS is not null and vm.MEMORY is not null
        <if test="userIds != null and userIds.size >0 ">
            and ( vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
            )
        </if>
        <if test="startTime != null and startTime != ''">
            and vm.CREATE_DATE between #{startTime} and #{endTime}
        </if>
        group by app.NAME order by app.NAME) AS vmInfo
        <if test="isList != null and isList != '' ">
            order by vmInfo.vmCpus desc,vmInfo.vmMemory desc limit 10
        </if>
        <if test="sortField != null and sortField != ''">
            ORDER BY vmInfo.vmCpus ${sortType},vmInfo.vmMemory ${sortType}
        </if>

    
```
#### querySpecGroupByDeptTopReport
```

        SELECT vmInfo.name,vmInfo.spec FROM
        (SELECT CASE WHEN (app.DEPT_NAME is null or app.DEPT_NAME = '') THEN '其它' ELSE app.DEPT_NAME END AS name,concat(sum(CPUS),"C",round(ifnull(sum(MEMORY)/1024,0),0),"G") AS spec,sum(CPUS) AS vmCpus,sum(MEMORY) AS vmMemory
        FROM cj_cmp_vm_view vm
        inner join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
        where
        vm.MEMBER_ID = #{memberId} and vm.CPUS is not null and vm.MEMORY is not null
        <if test="userIds != null and userIds.size >0 ">
            and ( vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
            )
        </if>
        <if test="startTime != null and startTime != ''">
            and vm.CREATE_DATE between #{startTime} and #{endTime}
        </if>
        group by app.DEPT_NAME order by app.DEPT_NAME) AS vmInfo
        <if test="isList != null and isList != '' ">
            order by vmInfo.vmCpus desc,vmInfo.vmMemory desc limit 10
        </if>
        <if test="sortField != null and sortField != ''">
            ORDER BY vmInfo.vmCpus ${sortType},vmInfo.vmMemory ${sortType}
        </if>
    
```
#### querySpecGroupByMemberTopReport
```

        SELECT vmInfo.name,vmInfo.spec FROM
        (SELECT vm.MEMBER_ID AS name,concat(sum(CPUS),"C",round(ifnull(sum(MEMORY)/1024,0),0),"G") AS spec,sum(CPUS) AS vmCpus,sum(MEMORY) AS vmMemory
        FROM cj_cmp_vm_view vm
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
        where
        vm.MEMBER_ID = #{memberId} and vm.CPUS is not null and vm.MEMORY is not null
        <if test="userIds != null and userIds.size >0 ">
            and ( vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
            )
        </if>
        <if test="startTime != null and startTime != ''">
            and vm.CREATE_DATE between #{startTime} and #{endTime}
        </if>
        group by vm.MEMBER_ID order by vm.MEMBER_ID) AS vmInfo
        <if test="isList != null and isList != '' ">
            order by vmInfo.vmCpus desc,vmInfo.vmMemory desc limit 10
        </if>
        <if test="sortField != null and sortField != ''">
            ORDER BY vmInfo.vmCpus ${sortType},vmInfo.vmMemory ${sortType}
        </if>

    
```
#### querySpecGroupByAppReport
```

        SELECT CASE WHEN app.NAME is null THEN '其它' ELSE app.NAME END AS name,
        concat(CPUS,"C",round(ifnull(MEMORY/1024,0),0),"G") AS spec,count(1) AS num
        FROM cj_cmp_vm_view vm
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
        where
        vm.MEMBER_ID = #{memberId} and vm.CPUS is not null and vm.MEMORY is not null
        <if test="userIds != null and userIds.size >0 ">
            and ( vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
            )
        </if>
        <if test="startTime != null and startTime != ''">
            and vm.CREATE_DATE between #{startTime} and #{endTime}
        </if>
        group by app.NAME,concat(CPUS,"C",round(ifnull(MEMORY/1024,0),0),"G");
    
```
#### querySpecGroupByDeptReport
```

        SELECT CASE WHEN (app.DEPT_NAME is null or app.DEPT_NAME = '') THEN '其它' ELSE app.DEPT_NAME END AS name,
        concat(CPUS,"C",round(ifnull(MEMORY/1024,0),0),"G") AS spec,count(1) AS num
        FROM cj_cmp_vm_view vm
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
        where
        vm.MEMBER_ID = #{memberId} and vm.CPUS is not null and vm.MEMORY is not null
        <if test="userIds != null and userIds.size >0 ">
            and ( vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
            )
        </if>
        <if test="startTime != null and startTime != ''">
            and vm.CREATE_DATE between #{startTime} and #{endTime}
        </if>
        group by app.DEPT_NAME,concat(CPUS,"C",round(ifnull(MEMORY/1024,0),0),"G");
    
```
#### querySpecGroupByMemberReport
```

        SELECT vm.MEMBER_ID AS name,concat(CPUS,"C",round(ifnull(MEMORY/1024,0),0),"G") AS spec,count(1) AS num
        FROM cj_cmp_vm_view vm
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
        where
        vm.MEMBER_ID = #{memberId} and vm.CPUS is not null and vm.MEMORY is not null
        <if test="userIds != null and userIds.size >0 ">
            and ( vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
            )
        </if>
        <if test="startTime != null and startTime != ''">
            and vm.CREATE_DATE between #{startTime} and #{endTime}
        </if>
        group by vm.MEMBER_ID,concat(CPUS,"C",round(ifnull(MEMORY/1024,0),0),"G");
    
```
#### queryVmGroupByDpetReport
```

        SELECT vmInfo.name,vmInfo.spec FROM
        (SELECT vm.MEMBER_ID AS name,concat(sum(CPUS),"C",round(ifnull(sum(MEMORY)/1024,0),0),"G") AS spec
        FROM cj_cmp_vm_view vm
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
        where
        vm.MEMBER_ID = #{memberId} and vm.CPUS is not null and vm.MEMORY is not null
        <if test="userIds != null and userIds.size >0 ">
            and ( vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
            )
        </if>
        <if test="startTime != null and startTime != ''">
            and vm.CREATE_DATE between #{startTime} and #{endTime}
        </if>
        group by vm.MEMBER_ID order by vm.MEMBER_ID) AS vmInfo order by vmInfo.spec desc limit 10;
    
```
#### countCloudVm
```

        select count(distinct vm.SERVICE_ACCOUNT_ID, vm.ID) as num, SUM(ifnull(vol.DISK_SUM,0)) as diskSum
        from cj_cmp_vm_view vm
            left outer join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
        left outer join (
            select SERVICE_ACCOUNT_ID as saId,VM_DEVICE_ID as vmId,sum(ifnull(DISK_SPACE,0)) DISK_SUM
            from CJ_CMP_VM_VOLUME
            where IS_DELETED=0
            group by SERVICE_ACCOUNT_ID,VM_DEVICE_ID) vol on vol.saId=vm.SERVICE_ACCOUNT_ID and vol.vmId=vm.ID
        where vm.MEMBER_ID = #{memberId}
        <if test="userIds != null and userIds.size >0 ">
            and ( vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
            )
        </if>
        <if test="startTime != null and endTime != null ">
            and (vm.CREATE_DATE &gt;= DATE(#{startTime}) AND vm.CREATE_DATE &lt;= DATE(#{endTime}))
        </if>
    
```
#### queryCapacityUsageOfUser
```

        select sum(ifnull(vm.CPUS,0)) as cpu,sum(ifnull(vm.MEMORY,0)) as memory,SUM(ifnull(vol.DISK_SUM,0)) as diskSum
        from cj_cmp_vm_view vm
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
        left outer join (
        select SERVICE_ACCOUNT_ID as saId,VM_DEVICE_ID as vmId,sum(ifnull(DISK_SPACE,0)) DISK_SUM
        from CJ_CMP_VM_VOLUME
        where IS_DELETED=0
        group by SERVICE_ACCOUNT_ID,VM_DEVICE_ID) vol on vol.saId=vm.SERVICE_ACCOUNT_ID and vol.vmId=vm.ID
        where vm.MEMBER_ID = #{memberId}
        <if test="userIds != null and userIds.size >0 ">
            and ( vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
            )
        </if>
    
```
#### queryCapacityUsage
```

        select sum(ifnull(vm.CPUS, 0))      as cpu,
               sum(ifnull(vm.MEMORY, 0))    as memory,
               SUM(ifnull(vol.DISK_SUM, 0)) as diskSum
        from cj_cmp_vm_view vm
                 left outer join (
            select SERVICE_ACCOUNT_ID as saId, VM_DEVICE_ID as vmId, sum(ifnull(DISK_SPACE, 0)) as DISK_SUM
            from CJ_CMP_VM_VOLUME
            where IS_DELETED = 0 and MEMBER_ID = #{memberId}
            group by SERVICE_ACCOUNT_ID, VM_DEVICE_ID) vol on vol.saId = vm.SERVICE_ACCOUNT_ID and vol.vmId = vm.ID
        <where>
            <if test="memberId != 0 ">
                and vm.MEMBER_ID = #{memberId}
            </if>
        </where>

    
```
#### queryCapacityByCloudAccountId
```

        select sum(vm.CPUS)      as vcpu,
               sum(vm.MEMORY)    as memory,
               sum(vol.DISK_SUM) as storage
        from cj_cmp_vm_view vm
                 left outer join (
            select SERVICE_ACCOUNT_ID as saId, VM_DEVICE_ID as vmId, sum(ifnull(DISK_SPACE, 0)) as DISK_SUM
            from CJ_CMP_VM_VOLUME
            where IS_DELETED = 0
                <if test="memberId != 0 ">
                    and MEMBER_ID = #{memberId}
                </if>
            group by SERVICE_ACCOUNT_ID, VM_DEVICE_ID) vol on vol.saId = vm.SERVICE_ACCOUNT_ID and vol.vmId = vm.ID
        where vm.CLOUD_ACCOUNT_ID = #{cloudAccountId}
            <if test="memberId != 0 ">
                and vm.MEMBER_ID = #{memberId}
            </if>
    
```
#### queryAppTopByColumnSum
```

        SELECT 
            vmInfo.appName,
        <choose>
            <when test="column!=null and column=='cpu'">
                vmInfo.cpus
            </when>
            <when test="column!=null and column=='memory'">
                vmInfo.memoryTotal
            </when>
        </choose>
        FROM (SELECT
                  app.NAME AS appName,
                <choose>
                    <when test="column!=null and column=='cpu'">
                        sum(vm.CPUS) AS cpus
                    </when>
                    <when test="column!=null and column=='memory'">
                        sum(vm.MEMORY) AS memoryTotal
                    </when>
                </choose>
              FROM cj_cmp_vm_view vm
                       inner join CJ_CMP_APP_SYSTEM app on app.ID = vm.APP_SYSTEM_ID
              where vm.MEMBER_ID = #{memberId}
                and DATE_SUB(CURDATE(), INTERVAL #{intervalTime} MONTH ) &lt;= date(vm.CREATE_DATE)
              group by app.NAME
              order by app.NAME) AS vmInfo
              order by
                <choose>
                    <when test="column!=null and column=='cpu'">
                        vmInfo.cpus
                    </when>
                    <when test="column!=null and column=='memory'">
                        vmInfo.memoryTotal
                    </when>
                </choose>
              desc
            limit 10
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_VM_VOLUME.xml
> sql统计:复杂0个，简单12个
>
> 使用的关键字：concat,ceil,sum,count,NOW,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_VPC.xml
> sql统计:复杂1个，简单11个
>
> 使用的关键字：concat,group_concat,join,and,in,from,on,values,count,CONCAT,if
#### selectVpcAndVds
```

    select * from (
    select
        vpc.ID,vpc.MEMBER_ID,vpc.ENTITY_ID,
        vpc.SERVICE_ACCOUNT_ID,
        vpc.NAME,vpc.LDC_ID,vpc.LDC_TYPE,vpc.CIDR_BLOCK,
        vpc.STATUS,vpc.DESCRIPTION,
        "VPC" as cloudWebType, saccount1.TYPE as sAccountType,
        vpc.CREATE_BY,vpc.CREATE_DATE,vpc.LAST_MODIFIED_BY,vpc.LAST_MODIFIED_DATE,
        saccount1.NAME as sAccountName,adc.NAME as ldcName
    from CJ_CMP_VPC vpc
    inner join CJ_CMP_SERVICE_ACCOUNT saccount1 on
    vpc.SERVICE_ACCOUNT_ID = saccount1.ID and saccount1.IS_DELETED=0
    left join CJ_CMP_ALIYUN_DC adc on adc.ID = vpc.LDC_ID and adc.IS_DELETED=0
    left join CJ_CMP_CLOUD_ACCOUNT_DC cdc on cdc.SERVICE_ACCOUNT_ID = vpc.SERVICE_ACCOUNT_ID and cdc.LDC_ID = vpc.LDC_ID and cdc.IS_DELETED = 0
    left join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED = 0
    <where>
      <choose>
        <when test="memberId != 0">
          and ca.MEMBER_ID = #{memberId}
        </when>
        <otherwise>
          and ca.SCOPE = 'public'
        </otherwise>
      </choose>
      <if test="serviceAccountId != 'ALL'">
        and vpc.SERVICE_ACCOUNT_ID = #{serviceAccountId}
      </if>
      <if test="ldcType != 'ALL' and ldcType != '' and ldcType != null">
        and saccount1.DATACENTER_TYPE = #{ldcType}
      </if>
      <if test="cloudAccountId != 'ALL'">
        and vpc.LDC_ID in (
        select cadc.LDC_ID from  CJ_CMP_CLOUD_ACCOUNT_DC cadc where cadc.CLOUD_ACCOUNT_ID = #{cloudAccountId} and cadc.IS_DELETED=0
        )
      </if>
      <if test="ldcId != 'ALL'" >
        and vpc.LDC_ID = #{ldcId}
      </if>
      <if test="queryValue != null" >
        <if test="queryValue != ''" >
          <choose>
            <when test="queryKey == 'ALL'" >
              and (
              vpc.NAME like CONCAT('%',#{queryValue},'%')
              OR vpc.CIDR_BLOCK like CONCAT('%',#{queryValue},'%')
              OR vpc.ENTITY_ID like CONCAT('%',#{queryValue},'%')
              )
            </when>
            <otherwise>
              <if test="queryKey == 'ENTITY_ID'" >
                and vpc.ENTITY_ID like CONCAT('%',#{queryValue},'%')
              </if>
              <if test="queryKey == 'NAME'" >
                and vpc.NAME like CONCAT('%',#{queryValue},'%')
              </if>
              <if test="queryKey == 'CIDR_BLOCK'" >
                and vpc.CIDR_BLOCK like CONCAT('%',#{queryValue},'%')
              </if>
            </otherwise>
          </choose>
        </if>
      </if>
    </where>
    union all
      select * from (select
      vds.ID,vds.MEMBER_ID,vds.ENTITY_ID,
      vds.SERVICE_ACCOUNT_ID,
      if(vds.TYPE = 'VSS',concat(vds.NAME, if(group_concat(vmHost.IP) is null, '', concat('[', group_concat(vmHost.IP), ']'))),vds.NAME) as NAME,
      vds.LDC_ID,vds.LDC_TYPE, "" as CIDR_BLOCK,
      vds.STATUS,vds.DESCRIPTION,
      vds.TYPE as cloudWebType, saccount2.TYPE as sAccountType,
      vds.CREATE_BY,vds.CREATE_DATE,vds.LAST_MODIFIED_BY,vds.LAST_MODIFIED_DATE,
      saccount2.NAME as sAccountName,vdc.NAME as ldcName
    from CJ_CMP_VDS vds
    inner join CJ_CMP_SERVICE_ACCOUNT saccount2 on vds.SERVICE_ACCOUNT_ID = saccount2.ID and saccount2.IS_DELETED=0
    left join CJ_CMP_VMWARE_DC vdc on vdc.ID = vds.LDC_ID  and vdc.IS_DELETED=0
    left join CJ_CMP_VDS_X_HOST vdsRel on vds.ID = vdsRel.VDS_ID
    left join CJ_CMP_VMWARE_HOST vmHost on vdsRel.HOST_ID = vmHost.ID
    left join CJ_CMP_CLOUD_ACCOUNT_DC cdc on cdc.SERVICE_ACCOUNT_ID = vds.SERVICE_ACCOUNT_ID and cdc.LDC_ID = vds.LDC_ID and cdc.IS_DELETED = 0
    left join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED = 0
    <where>
      <choose>
        <when test="memberId != 0">
          and ca.MEMBER_ID = #{memberId}
        </when>
        <otherwise>
          and ca.SCOPE = 'public'
        </otherwise>
      </choose>
      <if test="serviceAccountId != 'ALL'" >
        and vds.SERVICE_ACCOUNT_ID = #{serviceAccountId}
      </if>
    <if test="ldcType != 'ALL' and ldcType != '' and ldcType != null">
      and saccount2.DATACENTER_TYPE = #{ldcType}
    </if>
      <if test="cloudAccountId != 'ALL'" >
        and vds.LDC_ID in (
        select cadc.LDC_ID from  CJ_CMP_CLOUD_ACCOUNT_DC cadc where cadc.CLOUD_ACCOUNT_ID = #{cloudAccountId} and cadc.IS_DELETED=0
        )
      </if>
      <if test="ldcId != 'ALL'" >
        and vds.LDC_ID = #{ldcId}
      </if>
      </where>
      group by vds.ID
      ) t where 1 = 1
      <if test="queryValue != null" >
        <if test="queryValue != ''" >
          <choose>
            <when test="queryKey == 'ALL'" >
              and (
              t.NAME like CONCAT('%',#{queryValue},'%')
              OR t.ENTITY_ID like CONCAT('%',#{queryValue},'%')
              )
            </when>
            <otherwise>
              <if test="queryKey == 'ENTITY_ID'" >
                and t.ENTITY_ID like CONCAT('%',#{queryValue},'%')
              </if>
              <if test="queryKey == 'NAME'" >
                and t.NAME like CONCAT('%',#{queryValue},'%')
              </if>
            </otherwise>
          </choose>
        </if>
      </if>
    union all
      select * from (select
      vds.ID,vds.MEMBER_ID,vds.ENTITY_ID,
      vds.SERVICE_ACCOUNT_ID,
      if(vds.TYPE = 'VSS',concat(vds.NAME, if(group_concat(vmHost.IP) is null, '', concat('[', group_concat(vmHost.IP), ']'))),vds.NAME) as NAME,
      vds.LDC_ID,fcsa.DATACENTER_TYPE, '' as CIDR_BLOCK,
      '',vds.SHORT_DESCRIPTION,
      vds.TYPE as cloudWebType, fcsa.TYPE as sAccountType,
      vds.CREATE_BY,vds.CREATE_DATE,vds.LAST_MODIFIED_BY,vds.LAST_MODIFIED_DATE,
      fcsa.NAME as sAccountName,vdc.NAME as ldcName
    from CJ_CMP_FUSION_COMPUTE_VDS vds
    inner join CJ_CMP_SERVICE_ACCOUNT fcsa on vds.SERVICE_ACCOUNT_ID = fcsa.ID and fcsa.IS_DELETED=0 and vds.IS_DELETED=0
    left join CJ_CMP_FUSION_COMPUTE_DC vdc on vdc.ID = vds.LDC_ID  and vdc.IS_DELETED=0
    left join CJ_CMP_FUSION_COMPUTE_VDS_X_HOST vdsRel on vds.ID = vdsRel.VDS_ID
    left join CJ_CMP_FUSION_COMPUTE_HOST vmHost on vdsRel.HOST_ID = vmHost.ID
    left join CJ_CMP_CLOUD_ACCOUNT_DC cdc on cdc.SERVICE_ACCOUNT_ID = vds.SERVICE_ACCOUNT_ID and cdc.LDC_ID = vds.LDC_ID and cdc.IS_DELETED = 0
    left join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED = 0
    where 1 = 1
    <choose>
      <when test="memberId != 0">
        and ca.MEMBER_ID = #{memberId}
      </when>
      <otherwise>
        and ca.SCOPE = 'public'
      </otherwise>
    </choose>
      <if test="serviceAccountId != 'ALL'" >
        and vds.SERVICE_ACCOUNT_ID = #{serviceAccountId}
      </if>
    <if test="ldcType != 'ALL' and ldcType != '' and ldcType != null">
      and fcsa.DATACENTER_TYPE = #{ldcType}
    </if>
      <if test="cloudAccountId != 'ALL'" >
        and vds.LDC_ID in (
        select cadc.LDC_ID from  CJ_CMP_CLOUD_ACCOUNT_DC cadc where cadc.CLOUD_ACCOUNT_ID = #{cloudAccountId} and cadc.IS_DELETED=0
        )
      </if>
      <if test="ldcId != 'ALL'" >
        and vds.LDC_ID = #{ldcId}
      </if>
      group by vds.ID) t where 1 = 1
      <if test="queryValue != null" >
        <if test="queryValue != ''" >
          <choose>
            <when test="queryKey == 'ALL'" >
              and (
              t.NAME like CONCAT('%',#{queryValue},'%')
              OR t.ENTITY_ID like CONCAT('%',#{queryValue},'%')
              )
            </when>
            <otherwise>
              <if test="queryKey == 'ENTITY_ID'" >
                and t.ENTITY_ID like CONCAT('%',#{queryValue},'%')
              </if>
              <if test="queryKey == 'NAME'" >
                and t.NAME like CONCAT('%',#{queryValue},'%')
              </if>
            </otherwise>
          </choose>
        </if>
      </if>
      union all
        select fvpc.ID,fvpc.MEMBER_ID,fvpc.ENTITY_ID,fvpc.SERVICE_ACCOUNT_ID,fvpc.NAME,fvpc.LDC_ID,fcdc.LDC_TYPE as ldcType,fvpc.CIDR as CIDR_BLOCK,null as STATUS,
          null as DESCRIPTION,'VPC' as cloudWebType,fsa.TYPE as sAccountType,fvpc.CREATE_BY,fvpc.CREATE_DATE,fvpc.LAST_MODIFIED_BY,fvpc.LAST_MODIFIED_DATE,
          fsa.NAME as sAccountName,fdc.NAME as ldcName
        from CJ_CMP_SERVICE_ACCOUNT fsa
        inner join CJ_CMP_FUSION_CLOUD_DC fdc on fdc.SERVICE_ACCOUNT_ID=fsa.ID and fsa.IS_DELETED=0 and fdc.IS_DELETED=0
        left join CJ_CMP_CLOUD_ACCOUNT_DC fcdc on (fcdc.SERVICE_ACCOUNT_ID=fsa.ID or fcdc.SERVICE_ACCOUNT_ID = fsa.PARENT_ID) and fcdc.LDC_ID=fdc.ID and fcdc.IS_DELETED=0
        inner join CJ_CMP_CLOUD_ACCOUNT fca on fcdc.CLOUD_ACCOUNT_ID=fca.ID and fca.IS_DELETED=0
        inner join CJ_CMP_FUSION_CLOUD_VPC fvpc on fvpc.LDC_ID=fdc.ID and fvpc.IS_DELETED=0
        <where>
          <choose>
            <when test="memberId != 0">
              and fca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
              and fca.SCOPE = 'public'
            </otherwise>
          </choose>
        <if test="serviceAccountId != 'ALL'" >
          and (fsa.ID = #{serviceAccountId} or fsa.PARENT_ID = #{serviceAccountId})
        </if>
        <if test="ldcType != 'ALL' and ldcType != '' and ldcType != null">
          and fsa.DATACENTER_TYPE = #{ldcType}
        </if>
        <if test="cloudAccountId != 'ALL'" >
          and fca.ID= #{cloudAccountId}
        </if>
        <if test="ldcId != 'ALL'" >
          and fvpc.LDC_ID = #{ldcId}
        </if>
        <if test="queryValue != null and queryValue != ''" >
            <if test="queryKey == 'ALL'" >
              and ( fvpc.NAME like CONCAT('%',#{queryValue},'%') OR fvpc.ENTITY_ID like CONCAT('%',#{queryValue},'%') )
            </if>
            <if test="queryKey == 'ENTITY_ID'" >
              and fvpc.ENTITY_ID like CONCAT('%',#{queryValue},'%')
            </if>
            <if test="queryKey == 'NAME'" >
              and fvpc.NAME like CONCAT('%',#{queryValue},'%')
            </if>
        </if>
        </where>
    union all
    select
    con.ID,con.MEMBER_ID,con.ENTITY_ID,
    con.SERVICE_ACCOUNT_ID,
    con.NAME,con.LDC_ID, cadc1.LDC_TYPE ldcType, "" as CIDR_BLOCK,
    con.STATUS,con.DESCRIPTION,
    "VPC" as cloudWebType, saccount2.TYPE as sAccountType,
    con.CREATE_BY,con.CREATE_DATE,con.LAST_MODIFIED_BY,con.LAST_MODIFIED_DATE,
    saccount2.NAME as sAccountName, cod.NAME as ldcName
    from CJ_CMP_CLOUDOS_NETWORK con
    inner join CJ_CMP_SERVICE_ACCOUNT saccount2 on con.SERVICE_ACCOUNT_ID = saccount2.ID and saccount2.IS_DELETED=0
    left join CJ_CMP_CLOUD_ACCOUNT_DC cadc1 on cadc1.SERVICE_ACCOUNT_ID = saccount2.ID and cadc1.LDC_ID = con.LDC_ID and cadc1.IS_DELETED=0
    left join CJ_CMP_CLOUDOS_DC cod on cod.ID = con.LDC_ID and cod.IS_DELETED=0
    left join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = cadc1.CLOUD_ACCOUNT_ID and ca.IS_DELETED = 0
    where con.IS_DELETED=0
    <choose>
      <when test="memberId != 0">
        and ca.MEMBER_ID = #{memberId}
      </when>
      <otherwise>
        and ca.SCOPE = 'public'
      </otherwise>
    </choose>
    <if test="serviceAccountId != 'ALL'" >
      and con.SERVICE_ACCOUNT_ID = #{serviceAccountId}
    </if>
    <if test="ldcType != 'ALL' and ldcType != '' and ldcType != null">
      and saccount2.DATACENTER_TYPE = #{ldcType}
    </if>
    <if test="cloudAccountId != 'ALL'" >
      and con.LDC_ID in (
      select cadc.LDC_ID from  CJ_CMP_CLOUD_ACCOUNT_DC cadc where cadc.CLOUD_ACCOUNT_ID = #{cloudAccountId} and cadc.IS_DELETED=0
      )
    </if>
    <if test="ldcId != 'ALL'" >
      and con.LDC_ID = #{ldcId}
    </if>
    <if test="queryValue != null" >
      <if test="queryValue != ''" >
        <choose>
          <when test="queryKey == 'ALL'" >
            and (
            con.NAME like CONCAT('%',#{queryValue},'%')
            OR con.ENTITY_ID like CONCAT('%',#{queryValue},'%')
            )
          </when>
          <otherwise>
            <if test="queryKey == 'ENTITY_ID'" >
              and con.ENTITY_ID like CONCAT('%',#{queryValue},'%')
            </if>
            <if test="queryKey == 'NAME'" >
              and con.NAME like CONCAT('%',#{queryValue},'%')
            </if>
          </otherwise>
        </choose>
      </if>

    </if>
    union all
    select
    region.ID,region.MEMBER_ID,region.ENTITY_ID,
    region.SERVICE_ACCOUNT_ID,
    region.NAME, null as ldcId, "cloudboot" as ldcType, "" as cidrBlock, "available" as status,
    region.DESCRIPTION, "boot交换机" as cloudWebType, saTable.TYPE as sAccountType,
    region.CREATE_BY,region.CREATE_DATE,region.LAST_MODIFIED_BY,region.LAST_MODIFIED_DATE,
    saTable.NAME as sAccountName, null as ldcName
    from CJ_CMDB_CI_SYS_REGION region
    inner join
    (
    SELECT DISTINCT
    sa.ID, sa.TYPE, sa.NAME
    FROM
    CJ_CMP_CLOUD_ACCOUNT ca
    INNER JOIN CJ_CMP_CLOUD_ACCOUNT_DC cdc ON ca.ID = cdc.CLOUD_ACCOUNT_ID
    AND ca.IS_DELETED = 0
    AND cdc.IS_DELETED = 0
    INNER JOIN CJ_CMDB_CI_PHYSICAL_DATACENTER dc ON cdc.LDC_ID = dc.ID
    AND dc.SERVICE_ACCOUNT_ID = cdc.SERVICE_ACCOUNT_ID
    AND dc.IS_DELETED = 0
    INNER JOIN CJ_CMP_SERVICE_ACCOUNT sa ON dc.SERVICE_ACCOUNT_ID = sa.ID
    AND sa.IS_DELETED = 0
    <where>
      <choose>
        <when test="memberId != 0">
          and ca.MEMBER_ID = #{memberId}
        </when>
        <otherwise>
          and ca.SCOPE = 'public'
        </otherwise>
      </choose>
      <if test="cloudAccountId != 'ALL'"> and ca.ID=#{cloudAccountId}</if>
      <if test="serviceAccountId != 'ALL'"> and cdc.SERVICE_ACCOUNT_ID=#{serviceAccountId}</if>
      <if test="ldcType != 'ALL' and ldcType != '' and ldcType != null">
        and sa.DATACENTER_TYPE = #{ldcType}
      </if>
    </where>
    ) saTable ON region.SERVICE_ACCOUNT_ID = saTable.ID
    <where>
    region.IS_DELETED = 0
    <if test="queryValue != null" >
      <if test="queryValue != ''" >
        <choose>
          <when test="queryKey == 'ALL'" >
            and (
            region.NAME like CONCAT('%',#{queryValue},'%')
            OR region.ENTITY_ID like CONCAT('%',#{queryValue},'%')
            )
          </when>
          <otherwise>
            <if test="queryKey == 'ENTITY_ID'" >
              and region.ENTITY_ID like CONCAT('%',#{queryValue},'%')
            </if>
            <if test="queryKey == 'NAME'" >
              and region.NAME like CONCAT('%',#{queryValue},'%')
            </if>
          </otherwise>
        </choose>
      </if>
    </if>
    </where>
    union all
    select
    qvpc.ID,qvpc.MEMBER_ID,qvpc.ENTITY_ID,
    qvpc.SERVICE_ACCOUNT_ID,
    qvpc.NAME,qvpc.LDC_ID, cadc1.LDC_TYPE ldcType, "" as CIDR_BLOCK,
    qvpc.RUN_STATUS as STATUS,qvpc.DESCRIPTION,
    "VPC" as cloudWebType, saccount2.TYPE as sAccountType,
    qvpc.CREATE_BY,qvpc.CREATE_DATE,qvpc.LAST_MODIFIED_BY,qvpc.LAST_MODIFIED_DATE,
    saccount2.NAME as sAccountName, qdc.NAME as ldcName
    from CJ_CMDB_CI_QINGCLOUD_VPC qvpc
    inner join CJ_CMP_SERVICE_ACCOUNT saccount2 on qvpc.SERVICE_ACCOUNT_ID = saccount2.ID and qvpc.IS_DELETED=0
    left join CJ_CMP_CLOUD_ACCOUNT_DC cadc1 on cadc1.SERVICE_ACCOUNT_ID = saccount2.ID and cadc1.LDC_ID = qvpc.LDC_ID  and cadc1.IS_DELETED=0
    left join CJ_CMDB_CI_QINGCLOUD_DATACENTER qdc on qdc.ID = qvpc.LDC_ID and qdc.IS_DELETED=0
    left join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = cadc1.CLOUD_ACCOUNT_ID and ca.IS_DELETED = 0
    where 1 = 1
    and qvpc.IS_DELETED=0
    <choose>
      <when test="memberId != 0">
        and ca.MEMBER_ID = #{memberId}
      </when>
      <otherwise>
        and ca.SCOPE = 'public'
      </otherwise>
    </choose>
    <if test="serviceAccountId != 'ALL'" >
      and qvpc.SERVICE_ACCOUNT_ID = #{serviceAccountId}
    </if>
    <if test="ldcType != 'ALL' and ldcType != '' and ldcType != null">
      and saccount2.DATACENTER_TYPE = #{ldcType}
    </if>
    <if test="cloudAccountId != 'ALL'" >
      and qvpc.LDC_ID in (
      select cadc.LDC_ID from  CJ_CMP_CLOUD_ACCOUNT_DC cadc where cadc.CLOUD_ACCOUNT_ID = #{cloudAccountId}  and cadc.IS_DELETED=0
      )
    </if>
    <if test="ldcId != 'ALL'" >
      and qvpc.LDC_ID = #{ldcId}
    </if>
    <if test="queryValue != null" >
      <if test="queryValue != ''" >
        <choose>
          <when test="queryKey == 'ALL'" >
            and (
            qvpc.NAME like CONCAT('%',#{queryValue},'%')
            OR qvpc.ENTITY_ID like CONCAT('%',#{queryValue},'%')
            )
          </when>
          <otherwise>
            <if test="queryKey == 'ENTITY_ID'" >
              and qvpc.ENTITY_ID like CONCAT('%',#{queryValue},'%')
            </if>
            <if test="queryKey == 'NAME'" >
              and qvpc.NAME like CONCAT('%',#{queryValue},'%')
            </if>
          </otherwise>
        </choose>
      </if>

    </if>
    ) as vpc_vds_network
  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_VPC_SUBNET.xml
> sql统计:复杂0个，简单14个
>
> 使用的关键字：count,and,from,in,values,IF,ISNULL,CONCAT

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_WEB_ACCESS_CONFIG.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：NOW,CJ_CMP_WEB_ACCESS_CONFIG,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_WEB_ACCESS_LOG.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：NOW,CJ_CMP_WEB_ACCESS_LOG,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CMP_WEB_ACCESS_URL.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：CJ_CMP_WEB_ACCESS_URL,values,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CPG_BIZ_API.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CPG_BIZ_API,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CPG_BIZ_INST.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：now,CJ_CPG_BIZ_INST,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CPG_BIZ_MODEL.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：count,concat,CJ_CPG_BIZ_MODEL,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CPG_BIZ_STAGE.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CPG_BIZ_STAGE,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CPG_BIZ_STATE.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CPG_BIZ_STATE,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CPG_RELATION_LIST.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：CJ_CPG_RELATION_LIST,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_CPG_TASK.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CPG_TASK,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_IMPORT_LOG.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：CJ_IMPORT_LOG,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_IMPORT_LOG_RECORD.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：CJ_IMPORT_LOG_RECORD,values,now,count,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_INCIDENT.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：concat,and,in,NOW,CJ_INCIDENT,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_INCIDENT_X_USER.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：CJ_INCIDENT_X_USER,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_ASSET.xml
> sql统计:复杂0个，简单38个
>
> 使用的关键字：values,count,exists,CJ_PAM_ASSET

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_ASSET_OFFLINE.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：CJ_PAM_ASSET_OFFLINE,values,concat,size

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_ASSET_OFFLINE_UNIT.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：NOW,CJ_PAM_ASSET_OFFLINE_UNIT,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_ASSET_SHIFT.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：NOW,CONCAT,CJ_PAM_ASSET_SHIFT,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_ASSET_SHIFT_UNIT.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：NOW,CJ_PAM_ASSET_SHIFT_UNIT,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_ASSET_STAGE_RESULT.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：from,CJ_PAM_ASSET_STAGE_RESULT,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_BATCH.xml
> sql统计:复杂0个，简单12个
>
> 使用的关键字：size,AND,concat,CJ_PAM_BATCH,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_BATCH_X_ASSET.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：CJ_PAM_BATCH_X_ASSET,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_CATEGORY.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：concat,CJ_PAM_CATEGORY,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_CLOUD_ACCOUNT_X_PM_MODEL.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：NOW,CJ_PAM_CLOUD_ACCOUNT_X_PM_MODEL,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_EXPANSION_ENTRY.xml
> sql统计:复杂0个，简单13个
>
> 使用的关键字：values,concat,from,sum,NOW,CJ_PAM_EXPANSION_ENTRY

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_EXPANSION_ENTRY_X_ASSET.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：CJ_PAM_EXPANSION_ENTRY_X_ASSET,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_HARDWARE_TEMPLATE.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：concat,CJ_PAM_HARDWARE_TEMPLATE,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_MODEL_CONFIGURATION.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_PAM_MODEL_CONFIGURATION,values,concat

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_NETWORK_WIRING.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：CJ_PAM_NETWORK_WIRING,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_OS_TEMPLATE.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：concat,CJ_PAM_OS_TEMPLATE,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_PARTS_CPU.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：CJ_PAM_PARTS_CPU,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_PARTS_DISK.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：CJ_PAM_PARTS_DISK,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_PARTS_FAN.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：CJ_PAM_PARTS_FAN,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_PARTS_HBA.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：CJ_PAM_PARTS_HBA,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_PARTS_MEMORY.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：CJ_PAM_PARTS_MEMORY,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_PARTS_NIC.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：values,CJ_PAM_PARTS_NIC

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_PARTS_POWER.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：CJ_PAM_PARTS_POWER,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_PARTS_RAID.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：CJ_PAM_PARTS_RAID,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_PM_MODEL_X_SPEC_CPU.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：CJ_PAM_PM_MODEL_X_SPEC_CPU,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_PM_MODEL_X_SPEC_DISK.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：now,CJ_PAM_PM_MODEL_X_SPEC_DISK,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_PM_MODEL_X_SPEC_GPU.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：values,now,CJ_PAM_PM_MODEL_X_SPEC_GPU

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_PM_MODEL_X_SPEC_MEMORY.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：now,CJ_PAM_PM_MODEL_X_SPEC_MEMORY,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_PRODUCT.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：concat,CJ_PAM_PRODUCT,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_PRODUCTION_BATCH.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：values,NOW,concat,size,now,CJ_PAM_PRODUCTION_BATCH

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_PRODUCTION_SUB_BATCH.xml
> sql统计:复杂0个，简单16个
>
> 使用的关键字：from,count,sum,now,CJ_PAM_PRODUCTION_SUB_BATCH,values,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_PRODUCTION_SUB_X_ASSET.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：values,NOW,now,CJ_PAM_PRODUCTION_SUB_X_ASSET

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_PRODUCT_COMPONENT.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：CJ_PAM_PRODUCT_COMPONENT,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_PURCHASE.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：concat,now,CJ_PAM_PURCHASE,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_PURCHASE_CONFIGURATION.xml
> sql统计:复杂0个，简单12个
>
> 使用的关键字：now,CJ_PAM_PURCHASE_CONFIGURATION,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_PURCHASE_CONFIGURATION_X_SPEC_CPU.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：CJ_PAM_PURCHASE_CONFIGURATION_X_SPEC_CPU,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_PURCHASE_CONFIGURATION_X_SPEC_DISK.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：now,CJ_PAM_PURCHASE_CONFIGURATION_X_SPEC_DISK,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_PURCHASE_CONFIGURATION_X_SPEC_GPU.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：now,CJ_PAM_PURCHASE_CONFIGURATION_X_SPEC_GPU,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_PURCHASE_CONFIGURATION_X_SPEC_HBA.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：now,CJ_PAM_PURCHASE_CONFIGURATION_X_SPEC_HBA,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_PURCHASE_CONFIGURATION_X_SPEC_MEMORY.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：now,CJ_PAM_PURCHASE_CONFIGURATION_X_SPEC_MEMORY,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_PURCHASE_CONFIGURATION_X_SPEC_NIC.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：values,now,CJ_PAM_PURCHASE_CONFIGURATION_X_SPEC_NIC

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_PURCHASE_CONFIGURATION_X_SPEC_RAID.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：now,CJ_PAM_PURCHASE_CONFIGURATION_X_SPEC_RAID,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_PURCHASE_ENTRY_X_ASSET.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：CJ_PAM_PURCHASE_ENTRY_X_ASSET

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_PURCHASE_X_PM_MODEL.xml
> sql统计:复杂0个，简单12个
>
> 使用的关键字：in,now,CJ_PAM_PURCHASE_X_PM_MODEL,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_RACK_UNIT.xml
> sql统计:复杂0个，简单14个
>
> 使用的关键字：now,IN,CJ_PAM_RACK_UNIT,values,concat

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_RESOURCE_POOL_EXPANSION.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_PAM_RESOURCE_POOL_EXPANSION,values,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_RESOURCE_POOL_NODE_CONFIG.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：CJ_PAM_RESOURCE_POOL_NODE_CONFIG,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_RESOURCE_POOL_PLAN.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：and,or,now,CJ_PAM_RESOURCE_POOL_PLAN,values,concat

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_RESOURCE_POOL_PLAN_NODE.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：CJ_PAM_RESOURCE_POOL_PLAN_NODE,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_RESOURCE_POOL_SOURCE.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_PAM_RESOURCE_POOL_SOURCE,values,concat

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_RESOURCE_POOL_X_PRODUCT.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：NOW,CJ_PAM_RESOURCE_POOL_X_PRODUCT,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_SPEC_CPU.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：now,CJ_PAM_SPEC_CPU,values,concat

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_SPEC_DISK.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：CJ_PAM_SPEC_DISK,values,concat,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_SPEC_GPU.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：values,concat,now,CJ_PAM_SPEC_GPU

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_SPEC_HBA.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：concat,now,CJ_PAM_SPEC_HBA,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_SPEC_MEMORY.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：values,concat,now,CJ_PAM_SPEC_MEMORY

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_SPEC_NIC.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：concat,now,CJ_PAM_SPEC_NIC,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_SPEC_RAID.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：now,CJ_PAM_SPEC_RAID,values,concat

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_PAM_TASK_JOB.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_PAM_TASK_JOB,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_SYS_DIC.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：now,CJ_SYS_DIC,VALUES,in

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_SYS_DISPLAY_NAME_CONFIG.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：NOW,CJ_SYS_DISPLAY_NAME_CONFIG,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_SYS_OPER_LOG.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：and,CJ_SYS_OPER_LOG,VALUES,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_SYS_PARAM.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：size,now,CJ_SYS_PARAM,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_SYS_REPORT_CONFIG.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：CJ_SYS_REPORT_CONFIG,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_SYS_REPORT_GROUP.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：now,CJ_SYS_REPORT_GROUP,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CJ_SYS_SCREEN.xml
> sql统计:复杂4个，简单4个
>
> 使用的关键字：ON,from,COUNT,count,concat,date_format,IF,on,ISNULL,ifnull,curdate,FROM,SUM
#### queryHostNumberTrendByRecentYear
```

        SELECT #{cloudType} as cloudType,
        (
            SELECT ifnull(count(DISTINCT ENTITY_ID), 0) FROM
        CJ_CMP_HOST_DAY_REPORT  report WHERE report.STAT_TIME like concat(date_format(curdate(), '%Y-%m') ,'-%')
        AND MEMBER_ID IN
        <foreach item="item" index="index" collection="memberIds" open="(" separator="," close=")">
            #{item}
        </foreach>
            ) AS `total`,
        time.datetime,
        COUNT(DISTINCT report.ENTITY_ID) as num
        FROM (
        <include refid="Time_List"/>
        ) time
        LEFT JOIN CJ_CMP_HOST_DAY_REPORT report
        ON (report.STAT_TIME like concat(time.datetime,'-%')
        AND MEMBER_ID IN
        <foreach item="item" index="index" collection="memberIds" open="(" separator="," close=")">
            #{item}
        </foreach>)
        GROUP BY time.datetime;
    
```
#### queryCloudNativeClusterTrend
```

        SELECT
        #{cloudType} AS cloudNativeType,
        (SELECT ifnull(count(DISTINCT CLUSTER_ID), 0) FROM CJ_CMP_KUBERNETES_NODE_DAY_REPORT) AS `count`,
        time.datetime,
        COUNT(DISTINCT node.CLUSTER_ID) as num
        FROM (
        <include refid="Time_List"/>
        ) time
        LEFT JOIN CJ_CMP_KUBERNETES_NODE_DAY_REPORT node
        ON (node.STAT_TIME like concat(time.datetime,'-%'))
        GROUP BY time.datetime;
    
```
#### queryCloudNativePodTrend
```

        SELECT
        #{cloudType} AS cloudNativeType,
        (
        SELECT ifnull(count(DISTINCT pod.ENTITY_ID), 0)
        FROM CJ_CMP_KUBERNETES_NODE_DAY_REPORT node
        LEFT JOIN CJ_CMP_KUBERNETES_POD pod on (node.ID = pod.NODE_ID)
        ) AS `count`,
        time.datetime AS datetime,
        COUNT(DISTINCT pod.ENTITY_ID) AS num
        FROM (
        <include refid="Time_List"/>
        ) time
        LEFT JOIN CJ_CMP_KUBERNETES_NODE_DAY_REPORT node
        ON (node.STAT_TIME like concat(time.datetime, '-%'))
        LEFT JOIN CJ_CMP_KUBERNETES_POD pod on (node.ID = pod.NODE_ID)
        GROUP BY time.datetime;
    
```
#### queryCloudNativeSystemTrend
```

        SELECT
        #{cloudType} AS cloudNativeType,
        (SELECT ifnull(count(DISTINCT node.APP_SYSTEM_ID), 0)
        FROM CJ_CMP_KUBERNETES_NODE node
        WHERE node.IS_DELETED = 0
        ) AS `count`,
        time.datetime AS datetime,
        COUNT(DISTINCT node.APP_SYSTEM_ID) as num
        FROM (
        <include refid="Time_List"/>
        ) time
        LEFT JOIN CJ_CMP_KUBERNETES_NODE_DAY_REPORT node_re
        ON (node_re.STAT_TIME like concat(time.datetime, '-%'))
        LEFT JOIN CJ_CMP_KUBERNETES_NODE node
        ON (node.ID = node_re.ID)
        GROUP BY time.datetime;
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CidrBlockXBlockMapper.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：NOW,count,now,and,CJ_CMP_CIDR_BLOCK_X_BLOCK,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CidrRelRulerMapper.xml
> sql统计:复杂0个，简单0个
>
> 使用的关键字：

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CloudAccountSyncResultItemMapper.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：now,CJ_CMP_CLOUD_ACCOUNT_SYNC_RESULT_ITEM,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CloudAccountSyncResultMapper.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CMP_CLOUD_ACCOUNT_SYNC_RESULT,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CloudAccountSyncTaskMapper.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：count,from,CJ_CMP_CLOUD_ACCOUNT_SYNC_TASK,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CloudBillMapper.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CAST,DECIMAL,FROM,SUM

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CloudContainerMapper.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：or,and,CONCAT,on,where

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CloudProductTypeMapper.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CloudosPerformanceMetricMapper.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：CJ_CMP_CLOUDOS_PERFORMANCE_METRIC,VALUES,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/ClusterDayReportMapper.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：CJ_CMP_CLUSTER_DAY_REPORT,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CmpCloudEnvMapper.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：concat,CJ_CMP_CLOUD_ENV,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/CmpElasticResourceGroupMapper.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：values,now,CJ_CMP_ELASTIC_RESOURCE_GROUP

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/ContainerResourceDayReport.xml
> sql统计:复杂6个，简单0个
>
> 使用的关键字：ifnull,count,DATE
#### getTKEClusterTotal
```

        SELECT
        ifnull(count( DISTINCT ENTITY_ID, SERVICE_ACCOUNT_ID ),0) as num
        FROM
        CJ_CMDB_CI_TKE_CLUSTER_DAY_REPORT
        WHERE
        STAT_TIME = DATE(#{statTime})
        <if test="memberId != 0">
            and MEMBER_ID = #{memberId}
        </if>
        and
        IS_DELETED = 0
    
```
#### getFusionCCEClusterTotal
```

        SELECT
        ifnull(count( DISTINCT ENTITY_ID, SERVICE_ACCOUNT_ID ),0) as num
        FROM
        CJ_CMP_FUSION_CCE_CLUSTER_DAY_REPORT
        WHERE
        STAT_TIME = DATE(#{statTime})
        <if test="memberId != 0">
            and MEMBER_ID = #{memberId}
        </if>
        and
        IS_DELETED = 0
    
```
#### getKubernetesNodeTotal
```

        SELECT
        ifnull(count( DISTINCT ENTITY_ID, SERVICE_ACCOUNT_ID ),0) as num
        FROM
        CJ_CMP_KUBERNETES_NODE_DAY_REPORT
        WHERE
        STAT_TIME = DATE(#{statTime})
        <if test="memberId != 0">
            and MEMBER_ID = #{memberId}
        </if>
        and
        IS_DELETED = 0
    
```
#### getKubernetesDeploymentTotal
```

        SELECT
        ifnull(count( DISTINCT ENTITY_ID, SERVICE_ACCOUNT_ID ),0) as num
        FROM
        CJ_CMP_KUBERNETES_DEPLOYMENT_DAY_REPORT
        WHERE
        STAT_TIME = DATE(#{statTime})
        <if test="memberId != 0">
            and MEMBER_ID = #{memberId}
        </if>
        and
        IS_DELETED = 0
    
```
#### getKubernetesStatefulSetTotal
```

        SELECT
        ifnull(count( DISTINCT ENTITY_ID, SERVICE_ACCOUNT_ID ),0) as num
        FROM
        CJ_CMP_KUBERNETES_STATEFUL_SET_DAY_REPORT
        WHERE
        STAT_TIME = DATE(#{statTime})
        <if test="memberId != 0">
            and MEMBER_ID = #{memberId}
        </if>
        and
        IS_DELETED = 0
    
```
#### getKubernetesDaemonSetTotal
```

        SELECT
        ifnull(count( DISTINCT ENTITY_ID, SERVICE_ACCOUNT_ID ),0) as num
        FROM
        CJ_CMP_KUBERNETES_DAEMON_SET_DAY_REPORT
        WHERE
        STAT_TIME = DATE(#{statTime})
        <if test="memberId != 0">
            and MEMBER_ID = #{memberId}
        </if>
        and
        IS_DELETED = 0
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/EnvInstanceDOMapper.xml
> sql统计:复杂0个，简单17个
>
> 使用的关键字：IN,from,size,COUNT,and,values,CONCAT,CJ_CMP_SERVICE_INSTANCE,count

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/EnvInstanceResourceDOMapper.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：from

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/EnvUnitJobMapper.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：CJ_CMP_ENV_UNIT_JOB,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/HostDayReportMapper.xml
> sql统计:复杂8个，简单7个
>
> 使用的关键字：CJ_CMP_HOST_DAY_REPORT,values,sum,max,in,FROM,DATE,count,round,from,and,ifnull,DATE_FORMAT,size,group_concat
#### statVmwareHostBycaId
```

    select count(*) as hostSum,sum(CPUS) as cpuSum, sum(CPUS) * 3 as vCpuSum, round(sum(MEMORY_SUM/1024)) as memSum
    from (
           select
             host.ENTITY_ID,
             host.SERVICE_ACCOUNT_ID,
             max(CPUS)       as CPUS,
             max(MEMORY_SUM) as MEMORY_SUM
           from CJ_CMP_HOST_DAY_REPORT host
           left join CJ_CMP_HOST_REL_DAY_REPORT rel on rel.STAT_TIME = host.STAT_TIME and rel.HOST_ID = host.ID and rel.TYPE = host.TYPE
           where host.TYPE = 'vmware' and host.STAT_TIME = #{endTime} and host.MEMBER_ID = #{memberId}
                 and rel.CLOUD_ACCOUNT_ID = #{cloudAccountId}
           group by host.ENTITY_ID,host.SERVICE_ACCOUNT_ID
         ) host;
  
```
#### statFusionCloudHostBycaId
```

    select
      count(*)                      as hostSum,
      sum(CPUS)                     as cpuSum,
      sum(VIRTUAL_CPU_TOTAL)        as vCpuSum,
      round(sum(MEMORY_SUM / 1024)) as memSum
    from (
           select
             host.ENTITY_ID,
             host.SERVICE_ACCOUNT_ID,
             max(CPUS)              as CPUS,
             max(VIRTUAL_CPU_TOTAL) as VIRTUAL_CPU_TOTAL,
             max(MEMORY_SUM)        as MEMORY_SUM
           from CJ_CMP_HOST_DAY_REPORT host
           left join CJ_CMP_HOST_REL_DAY_REPORT rel
               on rel.STAT_TIME = host.STAT_TIME and rel.HOST_ID = host.ID and rel.TYPE = host.TYPE
           where host.TYPE = 'fusionCloud' and host.STAT_TIME = #{endTime} and host.MEMBER_ID = #{memberId}
                 and rel.CLOUD_ACCOUNT_ID = #{cloudAccountId}
           group by host.ENTITY_ID,host.SERVICE_ACCOUNT_ID
         ) host;
  
```
#### statVmwareHostCpuList
```

    select
    host.ID                            as id,
    group_concat(distinct host.NAME)   as hostName,
    group_concat(distinct sa.NAME)     as serviceAccountName,
    group_concat(distinct ca.NAME)     as poolName,
    max(host.CPUS)     as cpuSum,
    max(host.CPUS) * 3 as vCpuSum
    from CJ_CMP_HOST_DAY_REPORT host
    left join CJ_CMP_HOST_REL_DAY_REPORT rel on rel.STAT_TIME = host.STAT_TIME and rel.HOST_ID = host.ID and rel.TYPE = host.TYPE
    join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID = host.SERVICE_ACCOUNT_ID
    join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = rel.CLOUD_ACCOUNT_ID
    where host.TYPE = 'vmware' and host.STAT_TIME = #{endTime} and host.MEMBER_ID = #{memberId}
    and host.ENTITY_ID is not null and host.SERVICE_ACCOUNT_ID is not null
    <if test="condition != null and condition != ''">
      and (host.NAME = #{condition} or sa.NAME = #{condition} or ca.NAME = #{condition})
    </if>
    group by host.ID
  
```
#### statFusioncloudHostCpuList
```

    select
    host.ID                          as id,
    group_concat(distinct host.NAME) as hostName,
    group_concat(distinct sa.NAME)   as serviceAccountName,
    group_concat(distinct ca.NAME)   as poolName,
    max(host.CPUS)                   as cpuSum,
    max(host.VIRTUAL_CPU_TOTAL)      as vCpuSum
    from CJ_CMP_HOST_DAY_REPORT host
    left join CJ_CMP_HOST_REL_DAY_REPORT rel on rel.STAT_TIME = host.STAT_TIME and rel.HOST_ID = host.ID and rel.TYPE = host.TYPE
    left join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID = host.SERVICE_ACCOUNT_ID
    left join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = rel.CLOUD_ACCOUNT_ID
    where host.TYPE = 'fusioncloud' and host.STAT_TIME = #{endTime}  and host.MEMBER_ID = #{memberId}
    and host.ENTITY_ID is not null and host.SERVICE_ACCOUNT_ID is not null
    <if test="condition != null and condition != ''">
      and (host.NAME = #{condition} or sa.NAME = #{condition} or ca.NAME = #{condition})
    </if>
    group by host.ID
  
```
#### statVmwareHostMemList
```

    select
    host.ID                            as id,
    group_concat(distinct host.NAME)   as hostName,
    group_concat(distinct sa.NAME)     as serviceAccountName,
    group_concat(distinct ca.NAME)     as poolName,
    round(max(host.MEMORY_SUM / 1024)) as memSum
    from CJ_CMP_HOST_DAY_REPORT host
    left join CJ_CMP_HOST_REL_DAY_REPORT rel on rel.STAT_TIME = host.STAT_TIME and rel.HOST_ID = host.ID and rel.TYPE = host.TYPE
    join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID = host.SERVICE_ACCOUNT_ID
    join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = rel.CLOUD_ACCOUNT_ID
    where host.TYPE = 'vmware' and host.STAT_TIME = #{endTime} and host.MEMBER_ID = #{memberId}
    and host.ENTITY_ID is not null and host.SERVICE_ACCOUNT_ID is not null
    <if test="condition != null and condition != ''">
      and (host.NAME = #{condition} or sa.NAME = #{condition} or ca.NAME = #{condition})
    </if>
    group by host.ID
  
```
#### statFusionCloudHostMemList
```

    select
    host.ID                            as id,
    group_concat(distinct host.NAME)   as hostName,
    group_concat(distinct sa.NAME)     as serviceAccountName,
    group_concat(distinct ca.NAME)     as poolName,
    round(max(host.MEMORY_SUM / 1024)) as memSum
    from CJ_CMP_HOST_DAY_REPORT host
    left join CJ_CMP_HOST_REL_DAY_REPORT rel on rel.STAT_TIME = host.STAT_TIME and rel.HOST_ID = host.ID and rel.TYPE = host.TYPE
    left join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID = host.SERVICE_ACCOUNT_ID
    left join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = rel.CLOUD_ACCOUNT_ID
    where host.TYPE = 'fusioncloud' and host.STAT_TIME = #{endTime} and host.MEMBER_ID = #{memberId}
    and host.ENTITY_ID is not null and host.SERVICE_ACCOUNT_ID is not null
    <if test="condition != null and condition != ''">
      and (host.NAME = #{condition} or sa.NAME = #{condition} or ca.NAME = #{condition})
    </if>
    group by host.ID
  
```
#### groupBySaAndTime
```

    SELECT
    ifnull(count(DISTINCT ENTITY_ID, SERVICE_ACCOUNT_ID), 0) AS num,
    DATE_FORMAT(host.STAT_TIME, #{dateFormat}) AS days
    FROM (SELECT
    report.STAT_TIME,
    report.TYPE,
    ENTITY_ID,
    report.SERVICE_ACCOUNT_ID
    FROM CJ_CMP_HOST_DAY_REPORT report
    inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc on report.LDC_ID = cdc.LDC_ID and report.SERVICE_ACCOUNT_ID = cdc.SERVICE_ACCOUNT_ID and cdc.IS_DELETED = 0
    inner join CJ_CMP_CLOUD_ACCOUNT ca on cdc.CLOUD_ACCOUNT_ID = ca.ID and ca.IS_DELETED = 0
    <choose>
      <when test="memberId != 0">
        and ca.MEMBER_ID = #{memberId}
      </when>
      <otherwise>
        and ca.SCOPE = 'public'
      </otherwise>
    </choose>
    WHERE report.SERVICE_ACCOUNT_ID in (select ID from CJ_CMP_SERVICE_ACCOUNT where IS_DELETED = 0)
    GROUP BY STAT_TIME, TYPE, ENTITY_ID, SERVICE_ACCOUNT_ID) host
    <where>
      <if test="serviceAccountId != null and serviceAccountId != ''">
        and host.SERVICE_ACCOUNT_ID = #{serviceAccountId}
      </if>
      <if test="type != null and type != ''">
        and host.TYPE=#{type}
      </if>
      <if test="startTime != null and endTime != null ">
        and (host.STAT_TIME &gt;= DATE(#{startTime}) AND host.STAT_TIME &lt;= DATE(#{endTime}))
      </if>
    </where>
    GROUP BY days
    ORDER BY days asc
  
```
#### getTotalBySaAndTime
```

    SELECT
        ifnull(count( DISTINCT report.ENTITY_ID, report.SERVICE_ACCOUNT_ID ), 0) as num
    FROM
    CJ_CMP_HOST_DAY_REPORT report
    INNER JOIN CJ_CMP_SERVICE_ACCOUNT sa ON sa.ID = report.SERVICE_ACCOUNT_ID
    INNER JOIN CJ_CMP_CLOUD_ACCOUNT_DC cdc on report.LDC_ID = cdc.LDC_ID and report.SERVICE_ACCOUNT_ID = cdc.SERVICE_ACCOUNT_ID and cdc.IS_DELETED = 0
    INNER JOIN CJ_CMP_CLOUD_ACCOUNT ca on cdc.CLOUD_ACCOUNT_ID = ca.ID and ca.IS_DELETED = 0
    <choose>
      <when test="memberId != 0">
        and ca.MEMBER_ID = #{memberId}
      </when>
      <otherwise>
        and ca.SCOPE = 'public'
      </otherwise>
    </choose>
    AND sa.IS_DELETED = 0
    WHERE
    STAT_TIME = DATE(#{statTime})
  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/HostRelDayReportMapper.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：CJ_CMP_HOST_REL_DAY_REPORT,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/INSPECTION_HOST_CHECK_RECORD.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/INSPECTION_JOB.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：CJ_INSPECTION_JOB,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/INSPECTION_JOB_RECORD.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：JSON_EXTRACT,now,CJ_INSPECTION_JOB_RECORD,FROM,IFNULL,max,CONCAT,JOIN,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/INSPECTION_RULE.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：concat

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/INSPECTION_RULE_CHECK_RECORD.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：CJ_INSPECTION_RULE_CHECK_RECORD,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/INSPECTION_RULE_GROUP.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：count,concat

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/ImageConfigMapper.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：now,CJ_CMP_IMAGE_CONFIG,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/IpRelMapper.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：CJ_CMP_IP_REL,VALUES,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/KubernetesClusterMapper.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：and,CONCAT

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/KubernetesContainerMapper.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/KubernetesDaemonSetMapper.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：and,now,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/KubernetesDeploymentMapper.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：and,now,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/KubernetesNamespaceMapper.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：and,now,NOW,CONCAT

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/KubernetesNodeMapper.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：CONCAT,now,NOW,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/KubernetesOwnerReferenceMapper.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/KubernetesPersistentVolumeClaimMapper.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/KubernetesPersistentVolumeMapper.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/KubernetesPodMapper.xml
> sql统计:复杂2个，简单7个
>
> 使用的关键字：NOW,in,and,coalesce,CONCAT,now
#### list
```

        select
        pod.ID as ID ,
        pod.MEMBER_ID as MEMBER_ID,
        pod.SERVICE_ACCOUNT_ID as SERVICE_ACCOUNT_ID,
        pod.CLOUD_ACCOUNT_ID as CLOUD_ACCOUNT_ID,
        pod.LDC_ID as LDC_ID,
        pod.SERVICE_ACCOUNT_TYPE as SERVICE_ACCOUNT_TYPE,
        pod.OWNED_BY as OWNED_BY,
        pod.ENTITY_ID as ENTITY_ID,
        pod.NAME as NAME,
        pod.OWNER as OWNER,
        coalesce(deployment.NAME, statefulSet.NAME, daemonSet.NAME) as workloadName,
        coalesce(deployment.USED_FOR, statefulSet.USED_FOR, daemonSet.USED_FOR) as usedFor,
        coalesce(deployment.REMARK, statefulSet.REMARK, daemonSet.REMARK) as remark,
        coalesce(deployment.APP_SYSTEM_ID, statefulSet.APP_SYSTEM_ID, daemonSet.APP_SYSTEM_ID) as appSystemId,
        pod.CLOUD_ACCOUNT as CLOUD_ACCOUNT,
        pod.DEPARTMENT as DEPARTMENT,
        pod.IP as IP,
        pod.NODE_ID as NODE_ID,
        pod.NAMESPACE_ID as NAMESPACE_ID,
        pod.CLUSTER_ID as CLUSTER_ID,
        pod.CREATE_DATE as CREATE_DATE,
        pod.CREATE_BY as CREATE_BY,
        pod.STATUS as STATUS,
        pod.NAMESPACE_NAME as NAMESPACE,
        pod.CLUSTER_NAME as CLUSTER,
        pod.NODE_NAME as NODE
        from CJ_CMP_POD_VIEW pod
        inner join CJ_CMP_KUBERNETES_OWNER_REFERENCE rel on pod.ENTITY_ID = rel.RESOURCE_ENTITY_ID and pod.SERVICE_ACCOUNT_ID = rel.SERVICE_ACCOUNT_ID and rel.RESOURCE_TYPE = 'Pod' and rel.IS_DELETED = 0 and rel.OWNER_TYPE in ('ReplicaSet', 'StatefulSet', 'DaemonSet', 'Deployment')
        left join CJ_CMP_KUBERNETES_REPLICA_SET replicaSet on replicaSet.ENTITY_ID = rel.OWNER_ENTITY_ID and rel.SERVICE_ACCOUNT_ID = replicaSet.SERVICE_ACCOUNT_ID and rel.OWNER_TYPE = 'ReplicaSet' and replicaSet.IS_DELETED = 0
        left join CJ_CMP_KUBERNETES_OWNER_REFERENCE rel1 on replicaSet.ENTITY_ID = rel1.RESOURCE_ENTITY_ID and replicaSet.SERVICE_ACCOUNT_ID = rel1.SERVICE_ACCOUNT_ID and  rel1.RESOURCE_TYPE ='ReplicaSet' and rel1.IS_DELETED = 0
        left join CJ_CMP_KUBERNETES_DEPLOYMENT deployment on deployment.ENTITY_ID = rel1.OWNER_ENTITY_ID and rel1.SERVICE_ACCOUNT_ID = deployment.SERVICE_ACCOUNT_ID and rel1.OWNER_TYPE = 'Deployment' and deployment.IS_DELETED = 0
        left join CJ_CMP_KUBERNETES_STATEFUL_SET statefulSet on statefulSet.ENTITY_ID = rel.OWNER_ENTITY_ID and rel.SERVICE_ACCOUNT_ID = statefulSet.SERVICE_ACCOUNT_ID and rel.OWNER_TYPE = 'StatefulSet' and statefulSet.IS_DELETED = 0
        left join CJ_CMP_KUBERNETES_DAEMON_SET daemonSet on daemonSet.ENTITY_ID = rel.OWNER_ENTITY_ID  and rel.SERVICE_ACCOUNT_ID = daemonSet.SERVICE_ACCOUNT_ID and rel.OWNER_TYPE = 'DaemonSet' and daemonSet.IS_DELETED = 0
        where pod.MEMBER_ID = #{memberId} and pod.ENTITY_ID is not null and (pod.NAMESPACE_NAME != 'kube-system' or pod.NAMESPACE_NAME is null)
        <if test="userIds != null and userIds.size > 0 ">
            and ( pod.OWNED_BY in
            <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
            <if test="departmentList != null and departmentList.size != 0">
                or pod.DEPARTMENT_ID in
                <foreach collection="departmentList" item="department" open="(" close=")" separator=",">#{department}
                </foreach>
            </if>
            )
        </if>
        <if test="name != null and name != ''">
            and pod.NAME like CONCAT('%',#{name},'%')
        </if>
        <if test="ip != null and ip != ''">
            and pod.IP like CONCAT('%',#{ip},'%')
        </if>
        <if test="namespace != null and namespace != ''">
            and pod.NAMESPACE_NAME like CONCAT('%',#{namespace},'%')
        </if>
        <if test="owner != null">
            and pod.OWNER like CONCAT('%',#{owner},'%')
        </if>
        <if test="node != null and node != ''">
            and pod.NODE_NAME like CONCAT('%',#{node},'%')
        </if>
        <if test="cloudAccountId != null">
            and pod.CLOUD_ACCOUNT_ID =#{cloudAccountId}
        </if>
        <if test="ldcId != null">
            and pod.LDC_ID = #{ldcId}
        </if>
        <if test="searchKey != null and searchKey != ''">
            and (pod.NAME like CONCAT('%',#{searchKey},'%') or pod.IP like CONCAT('%',#{searchKey},'%') or
            pod.NAMESPACE_NAME like CONCAT('%',#{searchKey},'%')
            or pod.OWNER like CONCAT('%',#{searchKey},'%') or pod.NODE_NAME like CONCAT('%',#{searchKey},'%'))
        </if>
        order by pod.CREATE_DATE, pod.ID
    
```
#### queryDetailByIdAndType
```

        select
        pod.ID as ID ,
        pod.MEMBER_ID as MEMBER_ID,
        pod.SERVICE_ACCOUNT_ID as SERVICE_ACCOUNT_ID,
        pod.SERVICE_ACCOUNT_TYPE as SERVICE_ACCOUNT_TYPE,
        pod.OWNED_BY as OWNED_BY,
        pod.ENTITY_ID as ENTITY_ID,
        pod.NAME as NAME,
        pod.OWNER as OWNER,
        coalesce(deployment.NAME, statefulSet.NAME, daemonSet.NAME) as workloadName,
        coalesce(deployment.USED_FOR, statefulSet.USED_FOR, daemonSet.USED_FOR) as usedFor,
        coalesce(deployment.REMARK, statefulSet.REMARK, daemonSet.REMARK) as remark,
        coalesce(deployment.APP_SYSTEM_ID, statefulSet.APP_SYSTEM_ID, daemonSet.APP_SYSTEM_ID) as appSystemId,
        pod.CLOUD_ACCOUNT as CLOUD_ACCOUNT,
        pod.DEPARTMENT as DEPARTMENT,
        pod.IP as IP,
        pod.NODE_ID as NODE_ID,
        pod.NAMESPACE_ID as NAMESPACE_ID,
        pod.CLUSTER_ID as CLUSTER_ID,
        pod.CREATE_DATE as CREATE_DATE,
        pod.CREATE_BY as CREATE_BY,
        pod.STATUS as STATUS,
        pod.NAMESPACE_NAME as NAMESPACE,
        pod.CLUSTER_NAME as CLUSTER,
        pod.NODE_NAME as NODE
        from CJ_CMP_POD_VIEW pod
        inner join CJ_CMP_KUBERNETES_OWNER_REFERENCE rel on pod.ENTITY_ID = rel.RESOURCE_ENTITY_ID and pod.SERVICE_ACCOUNT_ID = rel.SERVICE_ACCOUNT_ID and rel.RESOURCE_TYPE = 'Pod' and rel.IS_DELETED = 0 and rel.OWNER_TYPE in ('ReplicaSet', 'StatefulSet', 'DaemonSet', 'Deployment')
        left join CJ_CMP_KUBERNETES_REPLICA_SET replicaSet on replicaSet.ENTITY_ID = rel.OWNER_ENTITY_ID and rel.SERVICE_ACCOUNT_ID = replicaSet.SERVICE_ACCOUNT_ID and rel.OWNER_TYPE = 'ReplicaSet' and replicaSet.IS_DELETED = 0
        left join CJ_CMP_KUBERNETES_OWNER_REFERENCE rel1 on replicaSet.ENTITY_ID = rel1.RESOURCE_ENTITY_ID and replicaSet.SERVICE_ACCOUNT_ID = rel1.SERVICE_ACCOUNT_ID and  rel1.RESOURCE_TYPE ='ReplicaSet' and rel1.IS_DELETED = 0
        left join CJ_CMP_KUBERNETES_DEPLOYMENT deployment on deployment.ENTITY_ID = rel1.OWNER_ENTITY_ID and rel1.SERVICE_ACCOUNT_ID = deployment.SERVICE_ACCOUNT_ID and rel1.OWNER_TYPE = 'Deployment' and deployment.IS_DELETED = 0
        left join CJ_CMP_KUBERNETES_STATEFUL_SET statefulSet on statefulSet.ENTITY_ID = rel.OWNER_ENTITY_ID and rel.SERVICE_ACCOUNT_ID = statefulSet.SERVICE_ACCOUNT_ID and rel.OWNER_TYPE = 'StatefulSet' and statefulSet.IS_DELETED = 0
        left join CJ_CMP_KUBERNETES_DAEMON_SET daemonSet on daemonSet.ENTITY_ID = rel.OWNER_ENTITY_ID  and rel.SERVICE_ACCOUNT_ID = daemonSet.SERVICE_ACCOUNT_ID and rel.OWNER_TYPE = 'DaemonSet' and daemonSet.IS_DELETED = 0
        where pod.ID = #{id} and pod.SERVICE_ACCOUNT_TYPE = #{type} and pod.MEMBER_ID = #{memberId}
        <if test="userIds != null and userIds.size > 0 ">
            and ( pod.OWNED_BY in
            <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
            <if test="departmentList != null and departmentList.size != 0">
                or pod.DEPARTMENT_ID in
                <foreach collection="departmentList" item="department" open="(" close=")" separator=",">#{department}
                </foreach>
            </if>
            )
        </if>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/KubernetesPodVolumeMapper.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/KubernetesProjectViewMapper.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：CONCAT,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/KubernetesReplicaSetMapper.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/KubernetesStatefulSetMapper.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：and,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/KubernetesWorkloadMapper.xml
> sql统计:复杂0个，简单14个
>
> 使用的关键字：and,CONCAT,or

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/LogicSegmentMapper.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：in,CONCAT,NOW,now,CJ_CMP_LOGIC_SEGMENT,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/LogicSegmentXAppSystemMapper.xml
> sql统计:复杂1个，简单9个
>
> 使用的关键字：and,CONCAT,CJ_CMP_LOGIC_SEGMENT_X_APP_SYSTEM,values,now,count,ifnull,join
#### countLogicSegmentAllRelAppSystem
```

        SELECT ifnull(count(DISTINCT rel.LOGIC_SEGMENT_ID), 0)
        FROM CJ_CMP_LOGIC_SEGMENT_X_APP_SYSTEM rel
        inner JOIN CJ_CMP_APP_SYSTEM instance ON rel.APP_SYSTEM_ID = instance.ID AND instance.IS_DELETED = 0
        WHERE rel.ACTIVE =1 and rel.MEMBER_ID = #{memberId} and rel.LOGIC_SEGMENT_ID in <foreach collection="logicSegmentIds" item="logicId" open="(" close=")" separator=",">#{logicId}</foreach>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/ModuleMapper.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：concat,count,CJ_CPG_MODULE,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/ModuleVersionMapper.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：count,CJ_CPG_MODULE_VERSION,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/OracleOvmDcMapper.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/OracleOvmHostMapper.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：and,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/OracleOvmRepositoryMapper.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：and,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/OracleOvmVmMapper.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：and,now,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/PmDayReportMapper.xml
> sql统计:复杂2个，简单1个
>
> 使用的关键字：values,ifnull,count,DATE_FORMAT,in,and,DATE,FROM,CJ_CMP_PM_DAY_REPORT
#### groupBySaAndTime
```

    SELECT
    ifnull(count(DISTINCT ENTITY_ID, SERVICE_ACCOUNT_ID), 0)  AS num,
    DATE_FORMAT(pm.STAT_TIME, #{dateFormat}) AS days
    FROM (SELECT
    STAT_TIME,
    ENTITY_ID,
    SERVICE_ACCOUNT_ID
    FROM CJ_CMP_PM_DAY_REPORT
    WHERE SERVICE_ACCOUNT_ID in (select ID from CJ_CMP_SERVICE_ACCOUNT where IS_DELETED = 0)
    <if test="memberId != 0">
      and MEMBER_ID = #{memberId}
    </if>
    GROUP BY STAT_TIME, ENTITY_ID, SERVICE_ACCOUNT_ID) pm
    <where>
      <if test="serviceAccountId != null and serviceAccountId != '' ">
        and pm.SERVICE_ACCOUNT_ID = #{serviceAccountId}
      </if>
      <if test="startTime != null and endTime != null ">
        and (pm.STAT_TIME &gt;= DATE(#{startTime}) AND pm.STAT_TIME &lt;= DATE(#{endTime}))
      </if>
    </where>
    GROUP BY days
    ORDER BY days asc
  
```
#### getTotalBySaAndTime
```

    SELECT
        ifnull(count( DISTINCT ENTITY_ID, SERVICE_ACCOUNT_ID ),0) as num
    FROM
        CJ_CMP_PM_DAY_REPORT report
    INNER JOIN CJ_CMP_SERVICE_ACCOUNT sa ON sa.ID = report.SERVICE_ACCOUNT_ID
    AND sa.IS_DELETED = 0
    WHERE
      STAT_TIME = DATE(#{statTime})
      <if test="memberId != 0">
        and report.MEMBER_ID = #{memberId}
        <if test="userIds != null and userIds.size >0 ">
          and  report.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
          <if test="departmentList != null and departmentList.size != 0">
            or report.DEPT_ID in <foreach collection="departmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
          </if>
        </if>
      </if>
  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/PmModelMapper.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：CJ_PAM_PM_MODEL,values,concat,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/PolicyExportMapper.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/QingCloudHostMapper.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/QingcloudPerformanceMetricMapper.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：now,CJ_CMP_QINGCLOUD_PERFORMANCE_METRIC,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/RESOURCE_REPORT.xml
> sql统计:复杂5个，简单0个
>
> 使用的关键字：ifnull,in,ceil,sum,length,replace,and,round,join,count,group_concat
#### cloudAccountCpuStat
```

        select ca.ID as cloudAccountId,ca.NAME as name,ca.DATACENTER_TYPE as datacenterType,clu.serviceAccounts,h.hosts,clu.clusters,h.cpus,h.vcpuTotal,
        ifnull(vm.vcpuUsed,0) as vcpuUsed,h.vcpuTotal-ifnull(vm.vcpuUsed,0) as vcpuRemaining,ifnull(case when vm.vcpuUsed &gt;= 0 and h.vcpuTotal &gt; 0 then round(vm.vcpuUsed*100/h.vcpuTotal,1) end,0) as vcpuUsage
        from CJ_CMP_CLOUD_ACCOUNT_DAY_REPORT ca
        inner join (select ldc.CLOUD_ACCOUNT_ID,count(clu.ID)+count(az.ID) as clusters,group_concat(distinct sa.NAME) serviceAccounts from CJ_CMP_LDC_DAY_REPORT ldc
          inner join CJ_CMP_SERVICE_ACCOUNT_DAY_REPORT sa on ldc.STAT_TIME=#{statTime} and sa.STAT_TIME=#{statTime} and sa.ID=ldc.SERVICE_ACCOUNT_ID
          left outer join CJ_CMP_CLUSTER_DAY_REPORT clu on clu.STAT_TIME=#{statTime} and ldc.LDC_TYPE='vmware' and clu.LDC_ID=ldc.LDC_ID
          left outer join CJ_CMP_CLOUD_AZ_DAY_REPORT az on az.STAT_TIME=#{statTime} and ldc.SERVICE_ACCOUNT_ID=az.SERVICE_ACCOUNT_ID and ldc.LDC_ID=az.LDC_ID
          where ldc.STAT_TIME=#{statTime}  group by ldc.CLOUD_ACCOUNT_ID) clu on clu.CLOUD_ACCOUNT_ID=ca.ID and ca.STAT_TIME=#{statTime}
        left outer join (select hr.CLOUD_ACCOUNT_ID,count(*) as hosts,sum(ifnull(hd.CPUS,0)) as cpus,
          sum(ifnull(hd.VIRTUAL_CPU_TOTAL,ifnull(hd.CPUS*3,0))) as vcpuTotal
          from CJ_CMP_HOST_DAY_REPORT hd,CJ_CMP_HOST_REL_DAY_REPORT hr where hd.STAT_TIME=#{statTime} and hr.STAT_TIME=#{statTime}
          and hr.HOST_ID=hd.ID and hr.TYPE=hd.TYPE group by hr.CLOUD_ACCOUNT_ID) h on h.CLOUD_ACCOUNT_ID=ca.ID and ca.DATACENTER_TYPE in('vmware','fusionCloud')
        left outer join (select CLOUD_ACCOUNT_ID,sum(ifnull(vm.CPUS,0)) vcpuUsed from CJ_CMP_VM_DAY_REPORT vm where vm.STAT_TIME=#{statTime} and vm.MEMBER_ID=#{memberId}
            group by CLOUD_ACCOUNT_ID) vm on vm.CLOUD_ACCOUNT_ID=ca.ID
        where ca.MEMBER_ID=#{parentMemberId}
        <if test="datacenterType != null and datacenterType != '' ">
            and ca.DATACENTER_TYPE = #{datacenterType}
        </if>
        <if test="cloudAccountName != null and cloudAccountName != '' ">
            and ca.NAME like #{cloudAccountName}
        </if>
        order by vcpuUsage desc
    
```
#### cloudAccountMemoryStat
```

        select ca.ID as cloudAccountId,ca.NAME as name,ca.DATACENTER_TYPE as datacenterType,clu.serviceAccounts,
          h.hosts,clu.clusters,ceil(h.memoryTotal /1024) as memoryTotal,ceil(ifnull(vm.memoryUsed,0)/1024) as memoryUsed,ceil((h.memoryTotal-ifnull(vm.memoryUsed,0)) /1024) as memoryRemaining,
          case when vm.memoryUsed &gt;= 0 and h.memoryTotal &gt; 0 then round(vm.memoryUsed*100/h.memoryTotal,1) end as memoryUsage
        from CJ_CMP_CLOUD_ACCOUNT_DAY_REPORT ca
        inner join (select ldc.CLOUD_ACCOUNT_ID,count(clu.ID)+count(az.ID) as clusters,group_concat(distinct sa.NAME) serviceAccounts from CJ_CMP_LDC_DAY_REPORT ldc
          inner join CJ_CMP_SERVICE_ACCOUNT_DAY_REPORT sa on ldc.STAT_TIME=#{statTime} and sa.STAT_TIME=#{statTime} and sa.ID=ldc.SERVICE_ACCOUNT_ID
          left outer join CJ_CMP_CLUSTER_DAY_REPORT clu on clu.STAT_TIME=#{statTime} and ldc.LDC_TYPE='vmware' and clu.LDC_ID=ldc.LDC_ID
          left outer join CJ_CMP_CLOUD_AZ_DAY_REPORT az on az.STAT_TIME=#{statTime} and ldc.SERVICE_ACCOUNT_ID=az.SERVICE_ACCOUNT_ID and ldc.LDC_ID=az.LDC_ID
          where ldc.STAT_TIME=#{statTime}  group by ldc.CLOUD_ACCOUNT_ID) clu on clu.CLOUD_ACCOUNT_ID=ca.ID and ca.STAT_TIME=#{statTime}
        left outer join (select hr.CLOUD_ACCOUNT_ID,count(*) as hosts,
          count(DISTINCT ifnull(hd.CLUSTER_ID,hd.ZONE_ID)) as clusters,sum(ifnull(hd.MEMORY_SUM,0)) as memoryTotal
          from CJ_CMP_HOST_DAY_REPORT hd,CJ_CMP_HOST_REL_DAY_REPORT hr where hd.STAT_TIME=#{statTime} and hr.STAT_TIME=#{statTime} 
          and hr.HOST_ID=hd.ID and hr.TYPE=hd.TYPE group by hr.CLOUD_ACCOUNT_ID) h on ca.STAT_TIME=#{statTime} and h.CLOUD_ACCOUNT_ID=ca.ID and ca.DATACENTER_TYPE in('vmware','fusionCloud')
        left outer join (select CLOUD_ACCOUNT_ID,sum(ifnull(vm.MEMORY,0)) memoryUsed from CJ_CMP_VM_DAY_REPORT vm where vm.STAT_TIME=#{statTime} and vm.MEMBER_ID=#{memberId}
            group by CLOUD_ACCOUNT_ID) vm on vm.CLOUD_ACCOUNT_ID=ca.ID
        where ca.MEMBER_ID=#{parentMemberId}
        <if test="datacenterType != null and datacenterType != '' ">
            and ca.DATACENTER_TYPE = #{datacenterType}
        </if>
        <if test="cloudAccountName != null and cloudAccountName != '' ">
            and ca.NAME like #{cloudAccountName}
        </if>
        order by memoryUsage desc
    
```
#### cloudAccountIpTotalStat
```

       select ca.ID as id,ca.NAME,ca.DATACENTER_TYPE,group_concat(distinct sa.NAME) as serviceAccounts,count(distinct cidr.ID) cidrTotal,count(distinct ip.ID) ipTotal,
         count(distinct case when ip.STATUS='unused' then ip.ID end) as ipAvailable,count(distinct case when ip.STATUS='unused' then null else ip.ID end) as ipUsed
         from CJ_CMP_CLOUD_ACCOUNT ca
         left outer join CJ_CMP_CLOUD_ACCOUNT_DC cdc on cdc.CLOUD_ACCOUNT_ID=ca.ID and cdc.IS_DELETED=0
         left outer join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID=cdc.SERVICE_ACCOUNT_ID and sa.IS_DELETED=0
         left outer join CJ_CMP_VDS vds on vds.LDC_ID=cdc.LDC_ID and vds.SERVICE_ACCOUNT_ID=cdc.SERVICE_ACCOUNT_ID
         left outer join CJ_CMP_VDS_PORTGROUP pg on pg.VDS_ID=vds.ID
         left outer join CJ_CMP_FUSION_CLOUD_NETWORK_SUBNET subnet on subnet.LDC_ID=cdc.LDC_ID and subnet.SERVICE_ACCOUNT_ID=cdc.SERVICE_ACCOUNT_ID
         left outer join CJ_CMP_CIDR_BLOCK_X_NETWORK cx on cx.SERVICE_ACCOUNT_ID=cdc.SERVICE_ACCOUNT_ID and cx.NETWORK_ID=ifnull(pg.ID,subnet.ID)
         left outer join CJ_CMP_CIDR_BLOCK cidr on cidr.ID=cx.CIDR_BLOCK_ID and cidr.IP_VERSION='IPv4'
         left outer join CJ_CMP_IP_POOL ip on ip.CIDR_BLOCK_ID=cidr.ID
        where ca.DATACENTER_TYPE in('vmware','fusionCloud') and ca.MEMBER_ID=#{memberId} and ca.IS_DELETED=0
        <if test="datacenterType != null and datacenterType != '' ">
            and ca.DATACENTER_TYPE = #{datacenterType}
        </if>
        <if test="cloudAccountName != null and cloudAccountName != '' ">
            and ca.NAME like #{cloudAccountName}
        </if>
         group by ca.ID
    
```
#### cloudAccountAppStat
```

       select app.ID,app.NAME,app.CODE,count(*) as vmTotal,sum(ifnull(vm.CPUS,0)) as cpuTotal,ceil(sum(ifnull(vm.MEMORY,0))/1024) as memoryTotal,ceil(sum(ifnull(vm.DISK_SUM,0))) as diskTotal,
       sum(ifnull(length(ifnull(vm.IP,''))-length(replace(ifnull(vm.IP,''),',',''))+1,0)) ipTotal
         from CJ_CMP_APP_SYSTEM_DAY_REPORT app,CJ_CMP_VM_DAY_REPORT vm where vm.STAT_TIME=#{statTime} and app.STAT_TIME=#{statTime} and vm.APP_SYSTEM_ID=app.ID 
         and app.MEMBER_ID=#{memberId} and vm.MEMBER_ID=app.MEMBER_ID
         <if test="cloudAccountId != null">
            and vm.CLOUD_ACCOUNT_ID = #{cloudAccountId}
        </if>
       <if test="searchKey != null and searchKey != '' ">
            and (app.NAME like #{searchKey} or app.CODE like #{searchKey})
        </if>
       group by app.ID,app.NAME,app.CODE
    
```
#### cloudAccountProjectStat
```

       select proj.ID,proj.NAME,proj.CODE,count(*) as vmTotal,sum(ifnull(vm.CPUS,0)) as cpuTotal,ceil(sum(ifnull(vm.MEMORY,0))/1024) as memoryTotal,ceil(sum(ifnull(vm.DISK_SUM,0))) as diskTotal,
       sum(ifnull(length(ifnull(vm.IP,''))-length(replace(ifnull(vm.IP,''),',',''))+1,0)) ipTotal
       from CJ_CMP_PROJECT_DAY_REPORT proj,CJ_CMP_VM_DAY_REPORT vm where vm.STAT_TIME=#{statTime} and proj.STAT_TIME=#{statTime} and vm.PROJECT_ID=proj.ID
         and proj.MEMBER_ID=#{memberId} and vm.MEMBER_ID=proj.MEMBER_ID
       <if test="cloudAccountId != null">
            and vm.CLOUD_ACCOUNT_ID = #{cloudAccountId}
        </if>
       <if test="searchKey != null and searchKey != '' ">
            and (proj.NAME like #{searchKey} or proj.CODE like #{searchKey})
        </if>
       group by proj.ID,proj.NAME,proj.CODE
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/SPEC_FOR_QUOTA.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：and,in

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/SamHostGroupMapper.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：and,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/SamHostMapper.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：and,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/SamStorageFsMapper.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：and,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/SamStoragePoolMapper.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：and,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/SamTagMapper.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：and,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/SamVirtualPoolMapper.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：and,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/SendDataJobMapper.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：HEX,now,values,CONCAT,size,NOW,concat,UNIX_TIMESTAMP,CJ_CMP_SEND_DATA_JOB

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/SendDataJobVersionMapper.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：CJ_CMP_SEND_DATA_JOB_VERSION,values,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/SendDataLogMapper.xml
> sql统计:复杂2个，简单2个
>
> 使用的关键字：CJ_CMP_SEND_DATA_LOG,values,if,concat,NOW
#### getById
```

		select log.*,job.NAME as jobName,sc.NAME as scheduleName,if(log.CREATE_BY is null,'定时任务',user.NAME) as createByUser from CJ_CMP_SEND_DATA_LOG log
		left outer join CJ_CMP_SEND_DATA_JOB job on log.JOB_ID=job.ID left outer join CJ_CMP_SEND_DATA_SCHEDULE sc on log.SCHEDULE_ID=sc.ID
		left outer join ydduc.UC_USER user on log.CREATE_BY=user.ID
		where log.ID = #{id}
	
```
#### queryList
```

		select log.*,job.NAME as jobName,sc.NAME as scheduleName,if(log.CREATE_BY is null,'定时任务',user.NAME) as createByUser from CJ_CMP_SEND_DATA_LOG log
		inner join CJ_CMP_SEND_DATA_JOB job on log.JOB_ID=job.ID left outer join CJ_CMP_SEND_DATA_SCHEDULE sc on log.SCHEDULE_ID=sc.ID
		left outer join ydduc.UC_USER user on log.CREATE_BY=user.ID
		<where><trim>
			<if test="jobId!=null"> and log.JOB_ID=#{jobId}</if>
			<if test="jobName!=null"> and job.NAME like concat('%',#{jobName},'%')</if>
			<if test="scheduleId!=null"> and log.SCHEDULE_ID=#{scheduleId}</if>
			<if test="scheduleName!=null"> and sc.NAME like concat('%',#{scheduleName},'%')</if>
			<if test="batchNo!=null"> and log.BATCH_NO=#{batchNo}</if>
			<if test="startTime!=null"> and log.START_TIME &gt;= #{startTime}</if>
			<if test="startTime2!=null"> and log.START_TIME &lt;= #{startTime2}</if>
			<if test="status!=null"> and log.STATUS=#{status}</if>
			<if test="createBy!=null"> and log.CREATE_BY=#{createBy}</if>
		</trim></where>
		order by ${sortField} ${sortType}
	
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/SendDataLogRecordMapper.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：NOW,CJ_CMP_SEND_DATA_LOG_RECORD,values,max

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/SendDataRecordMd5Mapper.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：now,CJ_CMP_SEND_DATA_RECORD_MD5,values,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/SendDataScheduleMapper.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：CONCAT,count,REPLACE,HEX,CJ_CMP_SEND_DATA_SCHEDULE,values,NOW,concat,UNIX_TIMESTAMP,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/ServiceInstanceIntegrationMapper.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：now,CJ_CMP_SERVICE_INSTANCE_INTEGRATION,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/ServiceInstanceMapper.xml
> sql统计:复杂1个，简单27个
>
> 使用的关键字：count,ON,NOW,VALUES,and,in,convert,join,sum,now,CJ_CMP_SERVICE_INSTANCE,or,CONCAT
#### list
```

        select srvInst.*
        from CJ_CMP_SERVICE_INSTANCE srvInst
        <if test="(envInstanceSource != null and envInstanceSource != '') or (envInstanceSourceId != null and envInstanceSourceId != '')">
            join CJ_CMP_APP_INSTANCE appInst on srvInst.APP_INST_ID = appInst.ID and appInst.IS_DELETED = 0
        </if>
        <if test="envInstanceSource != null and envInstanceSource != ''">
            and appInst.SOURCE = #{envInstanceSource}
        </if>
        <if test="envInstanceSourceId != null and envInstanceSourceId != ''">
            and appInst.SOURCE_ID = #{envInstanceSourceId}
        </if>
        where srvInst.IS_DELETED = 0 and srvInst.MEMBER_ID = #{memberId}
        <if test="status != null and status != ''"> and srvInst.STATUS=#{status}</if>
        <if test="status == null or status == ''"> and srvInst.STATUS !='archived'</if>
        <if test="keyword != null and keyword != ''" >
          <choose>
            <when test="queryType != null and queryType == 'name'" >
                and srvInst.`NAME` like CONCAT('%',#{keyword},'%')
            </when>
            <when test="queryType != null and queryType == 'type'" >
                and srvInst.`TYPE` like CONCAT('%',#{keyword},'%')
            </when>
            <when test="queryType != null and queryType == 'status'" >
                and srvInst.STATUS like CONCAT('%',#{keyword},'%')
            </when>
            <when test="queryType != null and queryType == 'entityId'" >
                and srvInst.ENTITY_ID like CONCAT('%',#{keyword},'%')
            </when>
            <when test="queryType != null and queryType == 'srvNo'" >
                and srvInst.SRV_NO like CONCAT('%',#{keyword},'%')
            </when>
            <when test="queryType != null and queryType == 'description'" >
                and srvInst.TYPE like CONCAT('%',#{keyword},'%')
            </when>
          </choose>
        </if>
        <if test="appSystemId != null"> and srvInst.APP_SYSTEM_ID = #{appSystemId}</if>
        <if test="appInstId != null"> and srvInst.APP_INST_ID = #{appInstId}</if>
        <if test="userId != null"> and (srvInst.OWNED_BY=#{userId} or srvInst.APP_SYSTEM_ID in (select ID from CJ_CMP_APP_SYSTEM_X_USER where USER_ID=#{userId}))</if>
        <if test="sortField != null and sortType != ''">
            order by convert(srvInst.${sortField} USING gbk) ${sortType}
        </if>
        <if test="sortField == null or sortType == ''">
            order by srvInst.LAST_MODIFIED_DATE desc
        </if>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/ServiceInstanceResourceDuRelMapper.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：VALUES,NOW,CONCAT,and,now,CJ_CMP_SERVICE_INSTANCE_RESOURCE

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/ServiceInstanceResourcesRelMapper.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CMP_SERVICE_INSTANCE_X_RESOURCE,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/SpotEnvBackupRestoreMapper.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：CJ_CMP_SPOT_ENV_BACKUP_RESTORE,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/SpotEnvElasticGroupMapper.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CMP_SPOT_ENV_ELASTIC_GROUP,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/SpotEnvElasticGroupResourceMapper.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：CJ_CMP_SPOT_ENV_ELASTIC_GROUP_RESOURCE,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/SpotEnvInterruptMapper.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：CJ_CMP_SPOT_ENV_INTERRUPT,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/SpotEnvReqLogMapper.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CMP_SPOT_ENV_REQ_LOG,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/TagMapper.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：now,CJ_CMP_TAG,VALUES,from,COUNT,in,concat,count

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/TagXObjectMapper.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：CJ_CMP_TAG_X_OBJECT,VALUES,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/TencentCvmMapper.xml
> sql统计:复杂0个，简单15个
>
> 使用的关键字：NOW,and,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/TencentDcMapper.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/TencentDisasterRecoverGroupMapper.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：CJ_CMP_TENCENT_DISASTER_RECOVER_GROUP,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/TencentSecurityGroupMapper.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/TencentSecurityGroupPolicyMapper.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/TencentSubnetapper.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：IF,ISNULL,CONCAT,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/TencentVpcDOMapper.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：CJ_CMP_TENCENT_VPC,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/classes/META-INF/mybatis/sqlmap/VmPerformanceChartMapper.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：DATE_FORMAT

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/AliyunAckClusterMapper.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：now,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/AliyunEcsBillMapper.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：CJ_CMP_ALIYUN_BILL,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/AppEnvMapper.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：VALUES,concat,now,CJ_CMP_APP_ENV

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/BizInstChangeRecordMapper.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CPG_BIZ_INST_CHANGE_RECORD,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_APPLICATION_CLUSTER.xml
> sql统计:复杂2个，简单6个
>
> 使用的关键字：ifnull,DATE,and,NOW,AND,now,COUNT,sum,FROM,count
#### querySoftAssignList
```

        SELECT
            temp.name,
            temp.version,
            ifnull(sum(temp.count), 0) assignNum
        FROM ( <foreach collection="appSofts" item="app" separator=" union all ">
            select #{app.name} as name,VERSION as version,SERVER_ID as serverId, SERVER_TYPE as serverType, count(*) as count
            from ${app.table}  where IS_DELETED=0 and MEMBER_ID =#{memberId} and DATE(CREATE_DATE) BETWEEN #{startTime} and #{endTime}  GROUP BY VERSION,SERVER_ID,SERVER_TYPE 
        </foreach>) temp
        JOIN cj_cmp_vm_view vm ON temp.serverId = vm.ID AND temp.serverType = vm.TYPE
        <where>
            <if test="isCatalog">
                and vm.SRV_NO IS NOT NULL
            </if>
        </where>
        GROUP BY temp.version, temp.name ORDER BY temp.name asc
    
```
#### statSoftAssignList
```

        SELECT
            temp.name,
            ifnull(sum(temp.count), 0) num
        FROM ( <foreach collection="appSofts" item="app" separator=" union all ">
            select #{app.name} as name,SERVER_ID as serverId, SERVER_TYPE as serverType, count(*) as count
            from ${app.table}  where IS_DELETED=0 and MEMBER_ID =#{memberId} and DATE(CREATE_DATE) BETWEEN #{startTime} and #{endTime}  GROUP BY SERVER_ID,SERVER_TYPE 
        </foreach>) temp
        JOIN cj_cmp_vm_view vm ON temp.serverId = vm.ID AND temp.serverType = vm.TYPE
        <where>
            <if test="isCatalog">
                and vm.SRV_NO IS NOT NULL
            </if>
        </where>
        GROUP BY temp.name ORDER BY temp.name asc
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_APP_SERVER_TOMCAT.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：NOW,and,AND,size,count,DATE

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_APP_SERVER_WEBLOGIC.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：size,count,DATE,NOW,and,AND

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_APP_SERVER_WEBSPHERE.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：and,AND,size,count,DATE,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_CABINET.xml
> sql统计:复杂0个，简单14个
>
> 使用的关键字：NOW,now,CJ_CMDB_CI_CABINET,values,concat,count,in

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_CLOUDBOOT_PM_RAW_DATA.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CMDB_CI_CLOUDBOOT_PM_RAW_DATA,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_CLOUD_BOOT_SUBNET.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：ISNULL,CONCAT,count,JOIN,NOW,IF

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_COGNOS.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：DATE,NOW,count

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_COMPUTER_ROOM.xml
> sql统计:复杂0个，简单13个
>
> 使用的关键字：count,CONCAT,NOW,CJ_CMDB_CI_COMPUTER_ROOM,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_CONNECT_DIRECT.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：and,AND,size,count,DATE,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_DATASTAGE.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_DB_DB2_INSTANCE.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：NOW,and,AND,size,count,DATE

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_DB_ELASTICSEARCH_INSTANCE.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_DB_GBASE_INSTANCE.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CMDB_CI_DB_GBASE_INSTANCE,values,and,AND,size,count,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_DB_MONGODB_INSTANCE.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_DB_MYSQL_INSTANCE.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：NOW,and,AND,size,count,DATE

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_DB_ORA_INSTANCE.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：size,count,DATE,NOW,and,AND

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_DB_POSTGRESQL_INSTANCE.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_DB_REDIS_INSTANCE.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：AND,size,count,DATE,NOW,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_DB_SQLSERVER_INSTANCE.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：and,AND,size,count,DATE,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_FLUME.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_HADOOP.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：count,DATE,NOW,and,AND,size

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_HARDWARE_CONF_TEMPLATE.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：concat,NOW,join,CONCAT,and,count,JOIN

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_IBM_WMQ.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：and,AND,size,count,DATE,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_IHS_WEB_SERVER.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：NOW,and,AND,size,count,DATE

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_IMAGE_TEMPLATE.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：join,CONCAT,and,count,JOIN,split,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_KAFKA.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_LOGICAL_DISK.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_MYCAT.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_NAS_STORAGE.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：now,CJ_CMDB_CI_NAS_STORAGE,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_NAS_VOLUME.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：now,CJ_CMDB_CI_NAS_VOLUME,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_NAS_VOLUME_EXPORT.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：now,CJ_CMDB_CI_NAS_VOLUME_EXPORT,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_NGINX_WEB_SERVER.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：and,AND,size,count,DATE,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_OPENSHIFT_NODE.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：NOW,and,AND,size,count,DATE

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_PHYSICAL_DATACENTER.xml
> sql统计:复杂0个，简单12个
>
> 使用的关键字：CONCAT,count,NOW,CJ_CMDB_CI_PHYSICAL_DATACENTER,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_PHYSICAL_MACHINE.xml
> sql统计:复杂4个，简单33个
>
> 使用的关键字：from,concat,IFNULL,INSTR,sum,join,if,CONCAT,split,NOW,values,count,in,ifnull,DATE_FORMAT,WHERE,now,and,DATE
#### list
```

      select pm.ID,pm.MEMBER_ID,pm.NAME,pm.CPU_CORE_COUNT as cpus,pm.RAM as memory,pm.DISK_SPACE as disk, pm.SN, pm.ENTITY_ID, pm.OPERATIONAL_STATUS as `status`, pm.RUN_STATUS as runStatus, pm.OOB_IP as ip,pm.BIZ_IP,pm.BIZ_VLAN, 
        pm.label, concat(pm.OS_DOMAIN, IFNULL(pm.OS_VERSION,'')) as os,pm.IS_LOCKED,        pm.OWNED_BY,u.`NAME` as owner, depart.`NAME` as dept, sa.NAME AS serviceAccountName,sa.DATACENTER_TYPE AS datacenterType, cdc.CLOUD_ACCOUNT_ID,
        ca.NAME as CLOUD_ACCOUNT_NAME,app.NAME as appSystemName, du.NAME as appDuName , du.APP_DU_TYPE as appDuType, dc.NAME as dataCenter, room.NAME as serverRoom,pm.U_START as uStart, region.name as region, pm.USED_FOR as `usage`,
        concat(IFNULL(cabinet.PRE_NAME,''), if(cabinet.PRE_NAME is null,'','-'), cabinet.NAME) as serverCabinet
      from CJ_CMDB_CI_PHYSICAL_DATACENTER dc inner join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID=dc.SERVICE_ACCOUNT_ID and sa.IS_DELETED=0 and dc.IS_DELETED=0
      left outer join CJ_CMP_CLOUD_ACCOUNT_DC cdc on cdc.SERVICE_ACCOUNT_ID=dc.SERVICE_ACCOUNT_ID and cdc.LDC_ID=dc.ID and cdc.IS_DELETED=0
      left outer join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID=cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED=0
      inner join CJ_CMDB_CI_PHYSICAL_MACHINE pm on pm.LDC_ID=dc.ID and pm.IS_DELETED=0
      left outer join CJ_CMDB_CI_COMPUTER_ROOM room on pm.COMPUTER_ROOM_ID=room.ID
      left outer join CJ_CMDB_CI_CABINET cabinet on cabinet.ID=pm.CABINET_ID
      left outer join CJ_CMP_APP_SYSTEM app on app.ID=pm.APP_SYSTEM_ID
      left outer join CJ_CMDB_CI_SYS_REGION region on pm.REGION_ID = region.ID and region.IS_DELETED = 0
      left join CJ_CMP_APP_DU du on pm.APP_DU_ID = du.ID and du.IS_DELETED = 0
      left join ydduc.UC_USER u ON pm.OWNED_BY = u.ID
      left join ydduc.UC_DEPARTMENT depart ON u.DEPARTMENT = depart.ID
      where pm.ENTITY_ID is not null and pm.IS_DELETED=0
      <if test="queryParam.cloudAccountId != null and queryParam.cloudAccountId != ''"> and ca.ID=#{queryParam.cloudAccountId}</if>
      <if test="queryParam.serviceAccountId != null and queryParam.serviceAccountId != ''"> and sa.ID=#{queryParam.serviceAccountId}</if>
      <if test="queryParam.ldcId != null and queryParam.ldcId != ''"> and dc.ID=#{queryParam.ldcId}</if>
      <if test="queryParam.azId != null and queryParam.azId != ''"> and room.ID=#{queryParam.azId}</if>
    <if test="queryParam.memberId != 0">  and pm.MEMBER_ID = #{queryParam.memberId}</if>
    <if test="queryParam.appSystemName != null and queryParam.appSystemName != ''"> and app.NAME like CONCAT('%',#{queryParam.appSystemName},'%')</if>
    <if test="queryParam.name != null and queryParam.name != ''"> and pm.NAME like CONCAT('%',#{queryParam.name},'%')</if>
    <if test="queryParam.ip != null and queryParam.ip != ''"> and pm.OOB_IP like CONCAT('%',#{queryParam.ip},'%')</if>
    <if test="queryParam.userIds != null and queryParam.userIds.size >0 ">
     and ( pm.OWNED_BY in <foreach collection="queryParam.userIds" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
       <if test="queryParam.appUserId !=null ">
           or app.SYS_OPR_MANT_OWNER_ID= #{queryParam.appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{queryParam.appUserId} or app.BIZ_OWNER_ID=#{queryParam.appUserId}
           <if test="queryParam.appDepartmentList != null and queryParam.appDepartmentList.size != 0">
             or app.DEPT_ID in <foreach collection="queryParam.appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
             or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="queryParam.appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
           </if>
       </if>
     )
    </if>
    <if test="queryParam.ownedByList != null and queryParam.ownedByList.size != 0">
      and pm.OWNED_BY in <foreach collection="queryParam.ownedByList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
    </if>
    <if test="queryParam.sn != null and queryParam.sn != ''"> and pm.SN like CONCAT('%',#{queryParam.sn},'%')</if>
    <if test="queryParam.runStatus != null and queryParam.runStatus != ''"> and pm.RUN_STATUS = #{queryParam.runStatus}</if>
    <if test="queryParam.status != null and queryParam.status != ''"> and pm.OPERATIONAL_STATUS = #{queryParam.status}</if>
    <if test="queryParam.searchKey != null and queryParam.searchKey != ''">
      and (pm.NAME like CONCAT('%',#{queryParam.searchKey},'%') or pm.OOB_IP like CONCAT('%',#{queryParam.searchKey},'%') or pm.sn like CONCAT('%',#{queryParam.searchKey},'%') or pm.RUN_STATUS = #{queryParam.searchKey} or  pm.OPERATIONAL_STATUS = #{queryParam.searchKey} or pm.BIZ_IP like CONCAT('%', #{queryParam.searchKey}, '%') or app.NAME like CONCAT('%',#{queryParam.searchKey},'%')
      <if test="queryParam.searchKeyList != null and queryParam.searchKeyList.size != 0">
        or pm.OWNED_BY in <foreach collection="queryParam.searchKeyList" item="searchKey" open="(" close=")" separator=",">#{searchKey}</foreach>
      </if>
      )
    </if>
    <if test=" queryParam.bizIps != null and queryParam.bizIps.size >0 ">
      and <foreach collection="queryParam.bizIps" item="ip" open="(" close=")" separator="or">INSTR(pm.BIZ_IP, #{ip})</foreach>
    </if>

    order by pm.NAME
  
```
#### queryDetail
```

    select pm.ID,pm.SERVICE_ACCOUNT_ID,pm.MEMBER_ID,pm.NAME,pm.NAME as hostname,pm.CPU_CORE_COUNT as cpus,pm.RAM as memory,pm.DISK_SPACE as disk, pm.SN, pm.ENTITY_ID, pm.OPERATIONAL_STATUS as `status`,
      pm.RUN_STATUS as runStatus, pm.OOB_IP as ip, pm.BIZ_IP,pm.BIZ_VLAN, pm.label, concat(pm.OS_DOMAIN, IFNULL(pm.OS_VERSION,'')) as os,du.NAME as appDuName ,du.APP_DU_TYPE as appDuType,app.NAME as appSystemName,pm.IS_LOCKED,
      pm.USED_FOR as `usage`,u.`NAME` as owner, depart.`NAME` as dept, pm.BOOTOS_ACTIVE_TIME as bootOSActiveTime, pm.OPERATING_SYSTEM as osType, pm.OWNED_BY, pm.manufacturer, pm.MODEL_ID as model, pm.U_START,
      pm.CREATE_BY, pm.CREATE_DATE, pm.LAST_MODIFIED_BY, pm.LAST_MODIFIED_DATE, sa.NAME AS serviceAccountName, sa.DATACENTER_TYPE as serviceAccountType, cdc.CLOUD_ACCOUNT_ID, ca.NAME as CLOUD_ACCOUNT_NAME,
      concat(IFNULL(cabinet.PRE_NAME,''),if(cabinet.PRE_NAME is null,'','-'), cabinet.NAME) as SERVER_ROOM, room.ID as SERVER_ROOM_ID,cabinet.NAME as serverCabinet, cabinet.ID as serverCabinetId, dc.NAME as dataCenter, region.name as region
    from CJ_CMDB_CI_PHYSICAL_MACHINE pm left outer join CJ_CMDB_CI_CABINET cabinet on cabinet.ID=pm.CABINET_ID
    left outer join CJ_CMDB_CI_COMPUTER_ROOM room on room.ID=pm.COMPUTER_ROOM_ID
    left outer join CJ_CMDB_CI_PHYSICAL_DATACENTER dc on dc.ID=pm.LDC_ID
    left outer join CJ_CMP_CLOUD_ACCOUNT_DC cdc on cdc.SERVICE_ACCOUNT_ID=pm.SERVICE_ACCOUNT_ID and cdc.LDC_ID=pm.LDC_ID and cdc.IS_DELETED=0
    left outer join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID=cdc.CLOUD_ACCOUNT_ID
    left outer join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID=pm.SERVICE_ACCOUNT_ID
    left outer join CJ_CMDB_CI_SYS_REGION region on pm.REGION_ID = region.ID and region.IS_DELETED = 0
    left join CJ_CMP_APP_DU du on pm.APP_DU_ID = du.ID and du.IS_DELETED = 0
    left join  CJ_CMP_APP_SYSTEM app on pm.APP_SYSTEM_ID=app.ID and  app.IS_DELETED=0
    left join ydduc.UC_USER u ON pm.OWNED_BY = u.ID
    left join ydduc.UC_DEPARTMENT depart ON u.DEPARTMENT = depart.ID
    where pm.ID = #{id} and pm.IS_DELETED=0
    <if test="memberId != 0"> and pm.MEMBER_ID = #{memberId}</if>
  
```
#### countByRole
```

    select ifnull(count(*),0)
    from CJ_CMDB_CI_PHYSICAL_MACHINE pm
    left outer join CJ_CMP_APP_SYSTEM app on app.ID=pm.APP_SYSTEM_ID
    where pm.IS_DELETED=0 and pm.MEMBER_ID = #{memberId}
    <if test="userIds != null and userIds.size >0 ">
      and ( pm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
      <if test="appUserId !=null ">
        or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
        <if test="appDepartmentList != null and appDepartmentList.size != 0">
          or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
          or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
        </if>
      </if>
      )
    </if>
    <if test="startTime != null and endTime != null ">
      and (pm.CREATE_DATE &gt;= DATE(#{startTime}) AND pm.CREATE_DATE &lt;= DATE(#{endTime}))
    </if>
  
```
#### groupByTime
```

    SELECT
    ifnull( count( DISTINCT ENTITY_ID, SERVICE_ACCOUNT_ID ), 0 ) AS num,
    DATE_FORMAT(report.CREATE_DATE, #{dateFormat}) AS days
    FROM
    CJ_CMDB_CI_PHYSICAL_MACHINE report
    LEFT OUTER JOIN CJ_CMP_APP_SYSTEM app ON app.ID = report.APP_SYSTEM_ID
    inner join CJ_CMP_SERVICE_ACCOUNT sa on sa.id = report.SERVICE_ACCOUNT_ID and sa.IS_DELETED = 0
    WHERE
    (report.CREATE_DATE &gt;= DATE(#{startTime}) AND report.CREATE_DATE &lt;= DATE(#{endTime}))
    <if test="memberId != 0">
      and report.MEMBER_ID = #{memberId}
    </if>
    <if test="userIds != null and userIds.size >0">
      and ( report.OWNED_BY in
      <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
      <if test="appUserId !=null ">
        or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId}
        or app.BIZ_OWNER_ID=#{appUserId}
        <if test="appDepartmentList != null and appDepartmentList.size != 0">
          or app.DEPT_ID in
          <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">
            #{department}
          </foreach>
          or app.SYS_OPR_MANT_DEPT_ID in
          <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">
            #{department}
          </foreach>
        </if>
      </if>
      )
    </if>
    GROUP BY days
    ORDER BY days asc
  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_PHYSICAL_NIC.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_PHYSICAL_NIC_PORT.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_PXE_TEMPLATE.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：join,CONCAT,and,count,JOIN,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_QINGCLOUD_DATACENTER.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_QINGCLOUD_SUBNET.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：values,IF,ISNULL,CONCAT,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_QINGCLOUD_VM_INSTANCE.xml
> sql统计:复杂0个，简单18个
>
> 使用的关键字：and,now,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_QINGCLOUD_VPC.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：and,CONCAT,NOW,values,in

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_RABBITMQ.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_ROCKETMQ.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：NOW,and,AND,size,count,DATE

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_STORAGE_DISK.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_STORAGE_HBA.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：now,NOW,CJ_CMDB_CI_STORAGE_HBA,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_STORAGE_HBA_PORT.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_STORM.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_SYS_REGION.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_TKE_CLUSTER.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：and,now,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_TKE_NS.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：and,now,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_TKE_PROJECT.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：and,now,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_TKE_PROJECT_X_CLUSTER.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMDB_CI_ZOOKEEPER.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_ALIYUN_DC.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_ALIYUN_ECS.xml
> sql统计:复杂0个，简单21个
>
> 使用的关键字：and,now,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_APP_DU.xml
> sql统计:复杂0个，简单12个
>
> 使用的关键字：and,count,now,CJ_CMP_APP_DU,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_APP_DU_X_RESOURCE.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：count,now,CJ_CMP_APP_DU_X_RESOURCE,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_APP_INSTANCE.xml
> sql统计:复杂0个，简单12个
>
> 使用的关键字：now,CJ_CMP_APP_INSTANCE,VALUES,and,or,count

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_APP_MGR_CONFIG.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：VALUES,now,CJ_CMP_APP_MGR_CONFIG

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_APP_RESOURCE.xml
> sql统计:复杂1个，简单0个
>
> 使用的关键字：ifnull,ceil,and,CONCAT
#### queryResourceList
```

        select vm.ID          id,
        vm.NAME               name,
        vm.IP                 ip,
        vm.OS,
        vm.TYPE               deviceType,
        vm.RUN_STATUS,
        vm.CLUSTER_NAME       clusterName,
        vm.ZONE_NAME          zoneName,
        vm.SERVICE_ACCOUNT_ID,
        vm.CLOUD_ACCOUNT_ID   cloudAccountId,
        vm.CLOUD_ACCOUNT_NAME cloudAccountName,
        vm.LDC_TYPE           ldcType,
        vm.LDC_ID             ldcId,
        vm.LDC_NAME           ldcName,
        vm.SN                 sn,
        app.NAME              appName,
        du.NAME               appDuName,
        du.ID                 appDuId,
        du.APP_DU_TYPE,dt.NAME as appDuTypeName,du.NAME_EN_ABBR,
        vm.APP_SYSTEM_ID      appSystemId,
        CONCAT(ifnull(vm.CPUS,''),'C',ifnull(ceil(vm.MEMORY/1024),''),'G') as spec
        from CJ_CMP_PHYSICAL_VIRTUAL_MACHINE_VIEW vm
        inner join CJ_CMP_APP_SYSTEM app on app.ID =vm.APP_SYSTEM_ID and app.IS_DELETED = 0
        left outer join CJ_CMP_APP_DU du on du.ID = vm.APP_DU_ID and du.IS_DELETED = 0
        left outer join CJ_SYS_DIC dt on dt.TYPE_CODE='APP_DU_TYPE' and dt.CODE=du.APP_DU_TYPE and dt.IS_DELETED=0
        where vm.MEMBER_ID = #{memberId}
        <if test="appSystemId!=null and appSystemId!=''"> and app.ID=#{appSystemId}</if>
        <if test="duId!=null and duId!=''"> and du.ID=#{duId}</if>
        <if test="searchKey != null and searchKey != ''">
            <if test="searchType=='' or searchType==null">
                and (du.NAME like #{searchKey} or dt.NAME like #{searchKey} or du.NAME_EN_ABBR like #{searchKey} or vm.NAME like #{searchKey} or vm.IP like #{searchKey})
            </if>
            <if test="searchType=='appDuName'">and du.NAME like #{searchKey} </if>
            <if test="searchType=='appDuType'">and dt.NAME like #{searchKey}</if>
            <if test="searchType=='appDuNameEnAbbr'">and du.NAME_EN_ABBR like #{searchKey}</if>
            <if test="searchType=='hostName'">and vm.NAME like #{searchKey}</if>
            <if test="searchType=='ip'">and vm.IP like #{searchKey}</if>
         </if>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_APP_SYSTEM.xml
> sql统计:复杂0个，简单28个
>
> 使用的关键字：CJ_CMP_APP_SYSTEM_X_ASSIGNER_USER,and,count,CONCAT,now,CJ_CMP_APP_SYSTEM_X_USER,or,CJ_CMP_APP_SYSTEM,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_ASYNC_TASK.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：VALUES,now,CJ_CMP_ASYNC_TASK

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_ASYNC_TASK_MESSAGE.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：now,CJ_CMP_ASYNC_TASK_MESSAGE,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_BP.xml
> sql统计:复杂1个，简单8个
>
> 使用的关键字：and,or,CONCAT,convert,NOW,CJ_CMP_BP,VALUES,in
#### selectByCondition
```

    select *
    from CJ_CMP_BP
    where IS_DELETED = 0 and (MEMBER_ID = #{memberId} or (MEMBER_ID = 0 and status = 'published'))
    <if test="status != null and status != ''" >
      and `STATUS` = #{status}
    </if>
    <if test="name != null and name != ''" >
        and `NAME` like CONCAT('%',#{name},'%')
    </if>
    ORDER BY convert(${sortField} USING gbk) ${sortType}
  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_BP_OP.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：VALUES,in,NOW,CJ_CMP_BP_OP

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_BP_OP_PARAM.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：in,NOW,CJ_CMP_BP_OP_PARAM,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_BP_OP_STEP.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：in,NOW,CJ_CMP_BP_OP_STEP,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_BP_RB.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：NOW,CJ_CMP_BP_RB,VALUES,in

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_CABINET_CONFIG.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：NOW,CJ_CMP_CABINET_CONFIG,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_CAPACITY.xml
> sql统计:复杂7个，简单7个
>
> 使用的关键字：NOW,CJ_CMP_CAPACITY,values,ifnull,sum,round,count,JOIN
#### queryAppSubsystemCapacityVmUsed
```

    SELECT sub.ID as capacityObjId,sub.NAME as capacityObjName ,ifnull(sum(ifnull(vm.CPUS,0)),0) as vcpuUsed,ifnull(round(sum(ifnull(vm.MEMORY,0))/1024),0) as memoryUsed,count(vm.ID) as vmInstanceUsed,
	ifnull(round(sum(ifnull(vmStorage.DISK_SPACE,0))),0) as storageUsed,ifnull(sum(ifnull(vmStorage.DISKS,0)),0) as diskUsed
	FROM CJ_CMP_APP_SYSTEM sub
	LEFT JOIN cj_cmp_vm_view vm on vm.APP_SYSTEM_ID=sub.ID and sub.IS_DELETED=0
	LEFT JOIN (select SERVICE_ACCOUNT_ID,VM_DEVICE_ID,sum(ifnull(DISK_SPACE,0)) as DISK_SPACE,count(*) as DISKS from CJ_CMP_VM_VOLUME v where v.IS_DELETED=0 group by SERVICE_ACCOUNT_ID,VM_DEVICE_ID) as vmStorage on vmStorage.SERVICE_ACCOUNT_ID=vm.SERVICE_ACCOUNT_ID and vmStorage.VM_DEVICE_ID=vm.ID
	where sub.MEMBER_ID=#{memberId}
	<if test="appSubIds != null and appSubIds.size != 0">
        and sub.ID in <foreach collection="appSubIds" item="objId" open="(" close=")" separator=",">#{objId}</foreach>
    </if>
	group by sub.ID,sub.NAME; 
  
```
#### queryAppSubsystemCapacityPmUsed
```

    SELECT sub.ID as capacityObjId,sub.NAME as capacityObjName,
	count(*) as pmInstanceUsed,
	ifnull(round(sum(ifnull(hdd.storageUsed,0))),0) as storageUsed,
	ifnull(sum(ifnull(hdd.diskUsed,0)),0) as diskUsed,
	ifnull(sum(ifnull(pm.CPU_CORE_COUNT,0)),0) as vcpuUsed,
	ifnull(sum(ifnull(pm.RAM,0)),0) as memoryUsed
	FROM CJ_CMP_APP_SYSTEM sub
	INNER JOIN CJ_CMDB_CI_PHYSICAL_MACHINE pm on pm.APP_SYSTEM_ID=sub.ID and pm.IS_DELETED=0 and sub.IS_DELETED=0
	LEFT JOIN (select SERVER_ID,count(*) as diskUsed,sum(ifnull(DISK_SPACE,0)) as storageUsed from CJ_CMDB_CI_STORAGE_DISK where IS_DELETED=0 group by SERVER_ID) as hdd on hdd.SERVER_ID=pm.ID
	where sub.MEMBER_ID=#{memberId}
	<if test="appSubIds != null and appSubIds.size != 0">
        and sub.ID in <foreach collection="appSubIds" item="objId" open="(" close=")" separator=",">#{objId}</foreach>
    </if>
	group by sub.ID,sub.NAME; 
  
```
#### queryDeptCapacityVmUsed
```

    SELECT ifnull(sum(ifnull(vm.CPUS,0)),0) as vcpuUsed,ifnull(round(sum(ifnull(vm.MEMORY,0))/1024),0) as memoryUsed,count(vm.ID) as vmInstanceUsed,ifnull(round(sum(ifnull(vmStorage.DISK_SPACE,0))),0) as storageUsed,ifnull(sum(ifnull(vmStorage.DISKS,0)),0) as diskUsed
	FROM cj_cmp_vm_view vm 
	LEFT JOIN (select SERVICE_ACCOUNT_ID,VM_DEVICE_ID,sum(ifnull(DISK_SPACE,0)) as DISK_SPACE,count(*) as DISKS from CJ_CMP_VM_VOLUME v where v.IS_DELETED=0 group by SERVICE_ACCOUNT_ID,VM_DEVICE_ID) as vmStorage on vmStorage.SERVICE_ACCOUNT_ID=vm.SERVICE_ACCOUNT_ID and vmStorage.VM_DEVICE_ID=vm.ID
    where vm.OWNED_BY in <foreach collection="userIds" item="objId" open="(" close=")" separator=",">#{objId}</foreach>
  
```
#### queryDeptCapacityPmUsed
```

    select count(*) as pmInstanceUsed,ifnull(round(sum(ifnull(hdd.storageUsed,0))),0) as storageUsed,count(hdd.diskUsed) as diskUsed,ifnull(sum(ifnull(pm.CPU_CORE_COUNT,0)),0) as vcpuUsed,ifnull(sum(ifnull(pm.RAM,0)),0) as memoryUsed
    from CJ_CMDB_CI_PHYSICAL_MACHINE pm LEFT JOIN (select SERVER_ID,count(*) as diskUsed,sum(ifnull(DISK_SPACE,0)) as storageUsed from CJ_CMDB_CI_STORAGE_DISK where IS_DELETED=0 group by SERVER_ID) as hdd on hdd.SERVER_ID=pm.ID
    where pm.IS_DELETED=0 and pm.OWNED_BY in <foreach collection="userIds" item="objId" open="(" close=")" separator=",">#{objId}</foreach>
  
```
#### queryProjectCapacityVmUsed
```

        SELECT ifnull(sum(ifnull(vm.CPUS,0)),0) as vcpuUsed,ifnull(round(sum(ifnull(vm.MEMORY,0))/1024),0) as
        memoryUsed,count(vm.ID) as vmInstanceUsed,
        ifnull(round(sum(ifnull(vmStorage.DISK_SPACE,0))),0) as storageUsed,ifnull(sum(ifnull(vmStorage.DISKS,0)),0) as
        diskUsed
        FROM cj_cmp_vm_view vm
        LEFT JOIN (select SERVICE_ACCOUNT_ID,VM_DEVICE_ID,sum(ifnull(DISK_SPACE,0)) as DISK_SPACE,count(*) as DISKS from
        CJ_CMP_VM_VOLUME v where v.IS_DELETED=0 group by SERVICE_ACCOUNT_ID,VM_DEVICE_ID) as vmStorage on
        vmStorage.SERVICE_ACCOUNT_ID=vm.SERVICE_ACCOUNT_ID and vmStorage.VM_DEVICE_ID=vm.ID
        where vm.PROJECT_ID in
        <foreach collection="projectIds" item="objId" open="(" close=")" separator=",">#{objId}</foreach>
    
```
#### queryProjectCapacityPmUsed
```

        select count(*) as pmInstanceUsed,ifnull(round(sum(ifnull(hdd.storageUsed,0))),0) as
        storageUsed,count(hdd.diskUsed) as diskUsed,ifnull(sum(ifnull(pm.CPU_CORE_COUNT,0)),0) as
        vcpuUsed,ifnull(sum(ifnull(pm.RAM,0)),0) as memoryUsed
        from CJ_CMDB_CI_PHYSICAL_MACHINE pm LEFT JOIN (select SERVER_ID,count(*) as diskUsed,sum(ifnull(DISK_SPACE,0))
        as storageUsed from CJ_CMDB_CI_STORAGE_DISK where IS_DELETED=0 group by SERVER_ID) as hdd on hdd.SERVER_ID=pm.ID
        where pm.IS_DELETED=0 and pm.PROJECT_ID in
        <foreach collection="projectIds" item="objId" open="(" close=")" separator=",">#{objId}</foreach>
    
```
#### queryCloudAccountCapacityVmUsed
```

        SELECT ca.ID as capacityObjId,ca.NAME as capacityObjName ,ifnull(sum(ifnull(vm.CPUS,0)),0) as vcpuUsed,ifnull(round(sum(ifnull(vm.MEMORY,0))/1024),0) as memoryUsed,count(vm.ID) as vmInstanceUsed,
        ifnull(round(sum(ifnull(vmStorage.DISK_SPACE,0))),0) as storageUsed,ifnull(sum(ifnull(vmStorage.DISKS,0)),0) as diskUsed
        FROM CJ_CMP_CLOUD_ACCOUNT ca
        LEFT JOIN cj_cmp_vm_view vm on vm.CLOUD_ACCOUNT_ID=ca.ID and ca.IS_DELETED=0
        LEFT JOIN (select SERVICE_ACCOUNT_ID,VM_DEVICE_ID,sum(ifnull(DISK_SPACE,0)) as DISK_SPACE,count(*) as DISKS from CJ_CMP_VM_VOLUME v where v.IS_DELETED=0 group by SERVICE_ACCOUNT_ID,VM_DEVICE_ID) as vmStorage on vmStorage.SERVICE_ACCOUNT_ID=vm.SERVICE_ACCOUNT_ID and vmStorage.VM_DEVICE_ID=vm.ID
        where ca.ID in <foreach collection="cloudAccountIds" item="objId" open="(" close=")" separator=",">#{objId}</foreach>
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>
        group by ca.ID,ca.NAME;
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_CAS_CLUSTER.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_CAS_DC.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_CAS_HOST.xml
> sql统计:复杂3个，简单7个
>
> 使用的关键字：count,round,NOW,sum,if,group_concat,on,and,in
#### queryHost
```

        select
        host.ID,
        host.NAME,
        host.IP,
        host.ENTITY_ID,
        host.CPU_COUNT as cpus,
        host.CPU_RATE,
        host.MEMORY as memorySum,
        host.MEMORY_RATE,
        host.STORAGE_CAPACITY,
        host.VM_NUM,
        host.VM_RUN_COUNT,
        host.VM_SHUTOFF,
        host.STATUS,
        cdc.LDC_TYPE,
        group_concat(distinct clu.NAME) as clusterName,
        group_concat(distinct dc.NAME) as ldcName,
        ca.ID as cloudAccountId,
        ca.NAME AS cloudAccountName,
        sa.NAME AS serviceAccountName,
        sa.ID AS serviceAccountId
        from
        CJ_CMP_CLOUD_ACCOUNT ca
        inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc on ca.ID = cdc.CLOUD_ACCOUNT_ID
        and ca.IS_DELETED = 0
        and cdc.LDC_TYPE = 'CAS'
        inner join CJ_CMP_CAS_DC dc on cdc.LDC_ID = dc.ID
        and cdc.IS_DELETED = 0
        and dc.IS_DELETED = 0
        INNER JOIN CJ_CMP_SERVICE_ACCOUNT sa ON cdc.SERVICE_ACCOUNT_ID = sa.ID
        AND sa.IS_DELETED = 0
        inner join CJ_CMP_CAS_HOST host on (
        host.SERVICE_ACCOUNT_ID = sa.ID
        or host.SERVICE_ACCOUNT_ID = sa.PARENT_ID
        )
        and host.IS_DELETED = 0
        INNER JOIN CJ_CMP_CAS_CLUSTER as clu ON host.CLUSTER_ENTITY_ID = clu.ENTITY_ID
        <where>
            <choose>
                <when test="memberId != 0">
                    and ca.MEMBER_ID = #{memberId}
                </when>
                <otherwise>
                    and ca.SCOPE = 'public'
                </otherwise>
            </choose>
            <if test="id != null and id != ''">and host.ID=#{id}</if>
            <if test="serviceAccountId != null and serviceAccountId != ''">and
                cdc.SERVICE_ACCOUNT_ID=#{serviceAccountId}
            </if>
            <if test="cloudAccountId != null and cloudAccountId != ''">and ca.ID=#{cloudAccountId}</if>
            <if test="ldcId != null and ldcId != ''">and dc.ID=#{ldcId}</if>
            <if test="name != null and name != ''">and host.NAME like #{name}</if>
            <if test="ip != null and ip != ''">and host.IP like #{ip}</if>
            <if test="searchKey != null and searchKey != ''">and (host.NAME like #{searchKey} or host.IP like
                #{searchKey} or host.ENTITY_ID like #{searchKey})
            </if>
        </where>
        group by
        host.ID,
        host.NAME,
        host.IP,
        host.ENTITY_ID,
        host.CPU_COUNT,
        host.CPU_RATE,
        host.MEMORY,
        host.MEMORY_RATE,
        host.STORAGE_CAPACITY,
        host.VM_NUM,
        host.VM_RUN_COUNT,
        host.VM_SHUTOFF,
        cdc.LDC_TYPE,
        ca.ID,
        ca.NAME,
        sa.NAME,
        sa.ID
    
```
#### statisticHostByServiceAccoutId
```

        select count(0)                                                                                 as hostSum,
               sum(host.CPUS)                                                                           as cpus,
               sum(host.CPU_USED)                                                                       as cpuUsed,
               round(if(sum(host.CPUS) = 0, 0, sum(host.CPU_USED) / sum(host.CPUS)), 2) * 100           as cpuUsage,
               sum(host.VIRTUAL_MEMORY_MB_USED)                                                         as memoryUsed,
               sum(host.VIRTUAL_MEMORY_MB_TOTAL)                                                        as memorySum,
               round(if(sum(host.VIRTUAL_MEMORY_MB_TOTAL) = 0, 0,
                        sum(host.VIRTUAL_MEMORY_MB_USED) / sum(host.VIRTUAL_MEMORY_MB_TOTAL)), 2) * 100 as memoryUsage
        from CJ_CMP_FUSION_CLOUD_HOST host
        where SERVICE_ACCOUNT_ID = #{serviceAccountId}
          AND IS_DELETED = 0;
    
```
#### statisticHostByCloudAccoutId
```

        select
        count(0) as hostSum,
        sum(host.CPUS) as cpus,
        sum(host.CPU_USED) as cpuUsed,
        round(if(sum(host.CPUS) = 0, 0, sum(host.CPU_USED) / sum(host.CPUS)), 2) * 100 as cpuUsage,
        sum(host.VIRTUAL_MEMORY_MB_USED) as memoryUsed,
        sum(host.VIRTUAL_MEMORY_MB_TOTAL) as memorySum,
        round(if(sum(host.VIRTUAL_MEMORY_MB_TOTAL) = 0, 0, sum(host.VIRTUAL_MEMORY_MB_USED) /
        sum(host.VIRTUAL_MEMORY_MB_TOTAL)), 2) * 100 as memoryUsage
        from CJ_CMP_FUSION_CLOUD_HOST host
        where SERVICE_ACCOUNT_ID in(select adc.SERVICE_ACCOUNT_ID
        from CJ_CMP_CLOUD_ACCOUNT_DC adc inner join CJ_CMP_CLOUD_ACCOUNT ca on adc.CLOUD_ACCOUNT_ID = ca.ID
        where adc.CLOUD_ACCOUNT_ID = #{cloudAccountId} AND adc.IS_DELETED = 0
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>
        ) AND IS_DELETED = 0;
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_CAS_RESOURCE.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_CAS_STORAGE.xml
> sql统计:复杂4个，简单7个
>
> 使用的关键字：in,sum,round,if,and,NOW
#### statisticDataStoreByServiceAccoutId
```

        SELECT
        sum(da.DISK_SUM)  as DISK_SUM,
        sum(da.DISK_SUM - da.DISK_FREE) as DISK_USED,
        round(if(sum(da.DISK_SUM) = 0, 0, sum(da.DISK_SUM - da.DISK_FREE) / sum(da.DISK_SUM)), 2) * 100 as DISK_USAGE
        FROM CJ_CMP_FUSION_CLOUD_STORAGE da
        where SERVICE_ACCOUNT_ID = #{serviceAccountId} AND IS_DELETED = 0;
    
```
#### statisticDataStoreByCloudAccoutId
```

        SELECT
        sum(da.DISK_SUM)  as DISK_SUM,
        sum(da.DISK_SUM - da.DISK_FREE) as DISK_USED,
        round(if(sum(da.DISK_SUM) = 0, 0, sum(da.DISK_SUM - da.DISK_FREE) / sum(da.DISK_SUM)), 2) * 100 as DISK_USAGE
        FROM CJ_CMP_FUSION_CLOUD_STORAGE da
        where SERVICE_ACCOUNT_ID in (select adc.SERVICE_ACCOUNT_ID
                                      from CJ_CMP_CLOUD_ACCOUNT_DC adc inner join CJ_CMP_CLOUD_ACCOUNT ca on adc.CLOUD_ACCOUNT_ID = ca.ID
                                      where adc.CLOUD_ACCOUNT_ID = #{cloudAccountId} AND adc.IS_DELETED = 0
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>) AND IS_DELETED = 0;
    
```
#### statisticDataStoreTypeBySaId
```

        select
        TYPE,
        SERVICE_ACCOUNT_ID,
        sum(DISK_SUM)             as DISK_SUM,
        sum(DISK_FREE)            as DISK_FREE,
        sum(DISK_SUM - DISK_FREE) as DISK_USED,
        sum(PROVISIONED)          as PROVISIONED,
        round(if(sum(DISK_SUM) = 0, 0, sum(DISK_SUM - DISK_FREE) / sum(DISK_SUM)), 2) * 100 as DISK_USAGE
        from CJ_CMP_FUSION_CLOUD_STORAGE
        where SERVICE_ACCOUNT_ID = #{serviceAccountId}
        group by TYPE, SERVICE_ACCOUNT_ID, MEMBER_ID
    
```
#### statisticDataStoreTypeByCaId
```

        select
            TYPE,
            SERVICE_ACCOUNT_ID,
            sum(DISK_SUM)                                                                       as DISK_SUM,
            sum(DISK_FREE)                                                                      as DISK_FREE,
            sum(DISK_SUM - DISK_FREE)                                                           as DISK_USED,
            sum(PROVISIONED)                                                                    as PROVISIONED,
            round(if(sum(DISK_SUM) = 0, 0, sum(DISK_SUM - DISK_FREE) / sum(DISK_SUM)), 2) * 100 as DISK_USAGE
        from CJ_CMP_FUSION_CLOUD_STORAGE
        where SERVICE_ACCOUNT_ID in (select adc.SERVICE_ACCOUNT_ID
                                      from CJ_CMP_CLOUD_ACCOUNT_DC adc inner join CJ_CMP_CLOUD_ACCOUNT ca on adc.CLOUD_ACCOUNT_ID = ca.ID
                                      where adc.CLOUD_ACCOUNT_ID = #{cloudAccountId} AND adc.IS_DELETED = 0
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>)
        group by TYPE, SERVICE_ACCOUNT_ID, MEMBER_ID
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_CAS_VDS.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：and,CONCAT,NOW,values,in

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_CAS_VM.xml
> sql统计:复杂1个，简单29个
>
> 使用的关键字：now,NOW,and,GROUP_CONCAT,if,count,in,sum
#### getAllByCondition
```

        select ecs.*,prj.CODE as projectCode,prj.NAME as projectName,prj.PROJECT_SOURCE_ID as projectSourceId,
        app.CODE as appSystemCode,app.NAME as appSystemName,app.SOURCE_ID as appSystemSourceId, GROUP_CONCAT(tag.NAME)
        as tags
        from CJ_CMP_CAS_VM ecs
        <if test="srvCompletionTimeStart!=null or srvCompletionTimeEnd!=null ">
        left outer join CJ_CMP_RITM_COMPLETED_VIEW req on ecs.SRV_NO=req.NUMBER
        </if>
        left outer join CJ_CMP_PROJECT prj on prj.ID=ecs.PROJECT_ID
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=ecs.APP_SYSTEM_ID
        left outer join CJ_CMP_APP_DU du on du.ID=ecs.APP_DU_ID
        left outer join CJ_CMP_TAG_X_OBJECT txo on ecs.ID = txo.OBJECT_ID and txo.OBJECT_TYPE = 'fusionCloud'
        left outer join CJ_CMP_TAG tag on tag.ID = txo.TAG_ID and tag.IS_DELETED = 0
        <where>
            <if test="memberId != 0">and ecs.MEMBER_ID = #{memberId}</if>
            <if test="startTime!=null and  endTime!=null ">
                and ecs.CREATE_DATE between #{startTime,jdbcType= TIMESTAMP} and #{endTime,jdbcType= TIMESTAMP}
            </if>
            <if test="startTime==null   and  endTime!=null ">
                and ecs.CREATE_DATE &lt;= #{endTime,jdbcType= TIMESTAMP}
            </if>
            <if test="startTime!=null  and  endTime==null ">
                and ecs.CREATE_DATE &gt;= #{startTime,jdbcType= TIMESTAMP}
            </if>
            <if test="srvCompletionTimeStart!=null and srvCompletionTimeEnd!=null ">
                and if(ecs.IS_DELETED=1,ecs.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) between
                #{srvCompletionTimeStart,jdbcType= TIMESTAMP} and #{srvCompletionTimeEnd,jdbcType= TIMESTAMP}
            </if>
            <if test="srvCompletionTimeStart==null and srvCompletionTimeEnd!=null ">
                and if(ecs.IS_DELETED=1,ecs.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) &lt;=
                #{srvCompletionTimeEnd,jdbcType= TIMESTAMP}
            </if>
            <if test="srvCompletionTimeStart!=null and srvCompletionTimeEnd==null ">
                and if(ecs.IS_DELETED=1,ecs.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) &gt;=
                #{srvCompletionTimeStart,jdbcType= TIMESTAMP}
            </if>
            <if test="isDeleted != null ">
                <choose>
                    <when test="isDeleted">
                        and ecs.IS_DELETED=1
                    </when>
                    <otherwise>
                        and ecs.IS_DELETED=0
                    </otherwise>
                </choose>
            </if>
        </where>
        GROUP BY ecs.ID
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_CIDR_BLOCK.xml
> sql统计:复杂3个，简单22个
>
> 使用的关键字：convert,on,sum,join,size,CONCAT,from,CJ_CMP_CIDR_BLOCK,VALUES,count,ifnull,NOW,round,concat,and
#### selectByCondition
```

     select distinct cidr.*, area.NAME as NETWORK_AREA_NAME,
                    (CASE WHEN cidr.IP_VERSION="IPv6" THEN null WHEN cidr.IP_VERSION="IPv4" THEN count(ip.CIDR_BLOCK_ID) END) as IP_SUM,
                    (CASE WHEN cidr.IP_VERSION="IPv6" THEN null WHEN cidr.IP_VERSION="IPv4" THEN sum(ip.STATUS != 'unused') END) as IP_USED,
                    (CASE WHEN cidr.IP_VERSION="IPv6" THEN null WHEN cidr.IP_VERSION="IPv4" THEN sum(ip.STATUS = 'unused') END) as IP_UNUSED,
                    (CASE WHEN cidr.IP_VERSION="IPv6" THEN null WHEN cidr.IP_VERSION="IPv4" THEN round((sum(ip.STATUS != 'unused')/count(ip.CIDR_BLOCK_ID) * 100), 2) END) as IP_USAGE
      from CJ_CMP_CIDR_BLOCK cidr
        left join
        (select CIDR_BLOCK_ID,`TYPE` from CJ_CMP_CIDR_BLOCK_X_NETWORK rel
        inner join CJ_CMP_SERVICE_ACCOUNT sa on rel.SERVICE_ACCOUNT_ID = sa.ID
        where sa.TYPE = 'aliyunPublic')
        as al on cidr.ID = al.CIDR_BLOCK_ID
        left join CJ_CMP_NETWORK_AREA area on cidr.NETWORK_AREA_ID = area.ID
        left join CJ_CMP_IP_POOL ip on cidr.ID = ip.CIDR_BLOCK_ID
        where cidr.MEMBER_ID = #{memberId} and al.TYPE is null
        <if test="ids != null and ids.size() > 0" >
          and cidr.ID in <foreach collection="ids" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
        <if test="name != null and name != ''" >
          and cidr.`NAME` like CONCAT('%',#{name},'%')
        </if>
        <if test="type != null and type != ''" >
          and cidr.TYPE = #{type}
        </if>
        <if test="ipVersion != null and ipVersion != ''" >
          and cidr.IP_VERSION = #{ipVersion}
        </if>
        <if test="networkAreaId != null" >
          and cidr.NETWORK_AREA_ID = #{networkAreaId}
        </if>
        <if test="networkAreaName != null and networkAreaName != '' " >
          and area.NAME LIKE concat('%', #{networkAreaName}, '%')
        </if>
        <if test="keyword != null and keyword!= '' ">
          and (cidr.`NAME` like CONCAT('%',#{keyword},'%') or cidr.TYPE like CONCAT('%',#{keyword},'%') or area.NAME LIKE concat('%', #{keyword}, '%') or cidr.IP_VERSION like CONCAT('%',#{keyword},'%') or cidr.CIDR_BLOCK like concat('%', #{keyword}, '%'))
        </if>
        <if test="cidrBlock !=null and cidrBlock !=''">
          and cidr.CIDR_BLOCK like concat('%', #{cidrBlock}, '%')
        </if>
        <if test="networkAreaIds != null and networkAreaIds.size()>0">
             and cidr.NETWORK_AREA_ID IN <foreach collection="networkAreaIds" item="naId" open="(" separator="," close=")"> #{naId} </foreach>
          </if>
        group by cidr.ID
        <if test="sortField != null and sortField!= '' and sortType != null and sortType!= '' ">
          <choose>
            <when test="sortField == 'NAME'">
              ORDER BY convert(cidr.${sortField} USING gbk) ${sortType}
            </when>
            <when test="sortField == 'NETWORK_AREA_NAME'">
              ORDER BY convert(${sortField} USING gbk) ${sortType}
            </when>
            <otherwise>
              ORDER BY ${sortField} ${sortType}
            </otherwise>
          </choose>
        </if>
  
```
#### pageByCondition
```

    select distinct cidr.*, area.NAME as NETWORK_AREA_NAME,
      (CASE WHEN cidr.IP_VERSION='IPv6' THEN null WHEN cidr.IP_VERSION='IPv4' THEN count(ip.CIDR_BLOCK_ID) END) as IP_SUM,
      (CASE WHEN cidr.IP_VERSION='IPv6' THEN null WHEN cidr.IP_VERSION='IPv4' THEN sum(ip.STATUS != 'unused') END) as IP_USED,
      (CASE WHEN cidr.IP_VERSION='IPv6' THEN null WHEN cidr.IP_VERSION='IPv4' THEN sum(ip.STATUS = 'unused') END) as IP_UNUSED,
      (CASE WHEN cidr.IP_VERSION='IPv6' THEN null WHEN cidr.IP_VERSION='IPv4' THEN round((sum(ip.STATUS != 'unused')/count(ip.CIDR_BLOCK_ID) * 100), 2) END) as IP_USAGE
    from (
      select cidrBlock.* from CJ_CMP_CIDR_BLOCK cidrBlock
      left join CJ_CMP_CIDR_BLOCK_X_NETWORK rel on cidrBlock.ID = rel.CIDR_BLOCK_ID
      left join CJ_CMP_SERVICE_ACCOUNT sa on rel.SERVICE_ACCOUNT_ID = sa.ID and sa.TYPE = 'aliyunPublic'
      <where>
        and cidrBlock.MEMBER_ID = #{memberId}
        and sa.TYPE is null
        <if test="ids != null" >
          and cidrBlock.ID in <foreach collection="ids" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
        <if test="name != null" >
          and cidrBlock.`NAME` like CONCAT('%',#{name},'%')
        </if>
        <if test="type != null" >
          and cidrBlock.TYPE = #{type}
        </if>
        <if test="ipVersion != null" >
          and cidrBlock.IP_VERSION = #{ipVersion}
        </if>
        <if test="networkAreaId != null" >
          and cidrBlock.NETWORK_AREA_ID = #{networkAreaId}
        </if>
        <if test="cidrBlock !=null">
          and cidrBlock.CIDR_BLOCK like concat('%', #{cidrBlock}, '%')
        </if>
        <if test="networkAreaIds != null">
          and cidrBlock.NETWORK_AREA_ID IN <foreach collection="networkAreaIds" item="naId" open="(" separator="," close=")"> #{naId} </foreach>
        </if>
      </where>
      group by cidrBlock.ID
      <if test="networkAreaName == null">
        <if test="sortField != null and sortField!= '' and sortType != null and sortType!= '' ">
          <choose>
            <when test="sortField == 'NAME'">
              ORDER BY convert(cidr.${sortField} USING gbk) ${sortType}
            </when>
            <when test="sortField == 'NETWORK_AREA_NAME'">
              ORDER BY convert(${sortField} USING gbk) ${sortType}
            </when>
            <otherwise>
              ORDER BY ${sortField} ${sortType}
            </otherwise>
          </choose>
        </if>
        limit #{offset}, #{limit}
      </if>
    ) cidr
    left join (
      select * from CJ_CMP_NETWORK_AREA
      <where>
        <if test="networkAreaName != null" >
          and `NAME` LIKE concat('%', #{networkAreaName}, '%')
        </if>
      </where>
    ) area on cidr.NETWORK_AREA_ID = area.ID
    left join CJ_CMP_IP_POOL ip on cidr.ID = ip.CIDR_BLOCK_ID
    <where>
      <if test="keyword != null">
        and (cidr.`NAME` like CONCAT('%',#{keyword},'%') or cidr.TYPE like CONCAT('%',#{keyword},'%') or area.NAME LIKE concat('%', #{keyword}, '%') or cidr.IP_VERSION like CONCAT('%',#{keyword},'%') or cidr.CIDR_BLOCK like concat('%', #{keyword}, '%'))
      </if>
    </where>
    group by cidr.ID
    <if test="networkAreaName != null">
      <if test="sortField != null and sortField!= '' and sortType != null and sortType!= '' ">
        <choose>
          <when test="sortField == 'NAME'">
            ORDER BY convert(cidr.${sortField} USING gbk) ${sortType}
          </when>
          <when test="sortField == 'NETWORK_AREA_NAME'">
            ORDER BY convert(${sortField} USING gbk) ${sortType}
          </when>
          <otherwise>
            ORDER BY ${sortField} ${sortType}
          </otherwise>
        </choose>
      </if>
      limit #{offset}, #{limit}
    </if>
  
```
#### countCidrBlockAllRelNetworks
```

    SELECT ifnull(count(DISTINCT rel.CIDR_BLOCK_ID), 0)
    FROM CJ_CMP_CIDR_BLOCK_X_NETWORK rel
           LEFT JOIN CJ_CMP_SERVICE_ACCOUNT sa ON rel.SERVICE_ACCOUNT_ID = sa.ID
           INNER JOIN CJ_CMP_SUBNET_VIEW subnet
                      ON rel.NETWORK_ID = subnet.ID AND rel.SERVICE_ACCOUNT_ID = subnet.SERVICE_ACCOUNT_ID
    WHERE rel.MEMBER_ID =#{memberId} and rel.CIDR_BLOCK_ID in <foreach collection="cidrBlockIds" item="cidrId" open="(" close=")" separator=",">#{cidrId}</foreach>
  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_CIDR_BLOCK_X_APP_INSTANCE.xml
> sql统计:复杂1个，简单9个
>
> 使用的关键字：ifnull,join,and,CONCAT,CJ_CMP_CIDR_BLOCK_X_APP_INSTANCE,values,count
#### countCidrBlockAllRelAppSystem
```

        SELECT ifnull(count(DISTINCT rel.CIDR_BLOCK_ID), 0)
        FROM CJ_CMP_CIDR_BLOCK_X_APP_INSTANCE rel
                 inner JOIN CJ_CMP_APP_SYSTEM instance ON rel.APP_INSTANCE_ID = instance.ID AND instance.IS_DELETED = 0
        WHERE rel.MEMBER_ID = #{memberId} and rel.CIDR_BLOCK_ID in <foreach collection="cidrBlockIds" item="cidrId" open="(" close=")" separator=",">#{cidrId}</foreach>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_CIDR_BLOCK_X_NETWORK.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：CJ_CMP_CIDR_BLOCK_X_NETWORK,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_CIDR_CHECK_IP_LOG.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：in,CJ_CMP_CIDR_CHECK_IP_LOG,VALUES,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_CIDR_LOGIC.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：in,CJ_CMP_CIDR_LOGIC,VALUES,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_CLOUDOS_DC.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：NOW,CJ_CMP_CLOUDOS_DC,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_CLOUDOS_HOST.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：values,and,now,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_CLOUDOS_NETWORK.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：in,and,CONCAT,NOW,count

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_CLOUDOS_SUBNET.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：IF,ISNULL,CONCAT,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_CLOUDOS_VM.xml
> sql统计:复杂0个，简单20个
>
> 使用的关键字：NOW,CJ_CMP_CLOUDOS_VM,values,and,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_CLOUDSINO_COMPUTER_ROOM.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：and,CONCAT

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_CLOUDSINO_FRAME.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：CONCAT,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_CLOUDSINO_PHYSICAL_MACHINE.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：CONCAT,and,now,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_CLOUDSINO_STRATEGY.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：CONCAT,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_CLOUD_ACCOUNT.xml
> sql统计:复杂7个，简单18个
>
> 使用的关键字：VALUES,in,and,sum,round,concat,now,NOW,AND,group_concat,ifnull,CJ_CMP_CLOUD_ACCOUNT
#### getByProvider
```

        select
        vm.LDC_TYPE as type,
        vm.CLOUD_ACCOUNT_ID as id,
        group_concat(distinct ca.NAME) as poolName,
        group_concat(distinct sa.NAME) as serviceAccountName
        from CJ_CMP_VM_DAY_REPORT vm
        left join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = vm.CLOUD_ACCOUNT_ID
        left join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID = vm.SERVICE_ACCOUNT_ID
        where STAT_TIME BETWEEN #{startTime} and #{endTime} and LDC_TYPE = #{provider} and
        vm.CLOUD_ACCOUNT_ID is not null
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>
        <if test="condition!=null">
            and ca.NAME = #{condition}
        </if>
        group BY vm.LDC_TYPE, vm.CLOUD_ACCOUNT_ID
        union
        select
        rel.TYPE as type,
        rel.CLOUD_ACCOUNT_ID as id,
        group_concat(distinct ca.NAME) as poolName,
        group_concat(distinct sa.NAME) as serviceAccountName
        from CJ_CMP_HOST_DAY_REPORT host
        left join CJ_CMP_HOST_REL_DAY_REPORT rel on host.ID = rel.HOST_ID and host.TYPE = rel.TYPE and host.STAT_TIME =
        rel.STAT_TIME
        left join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID = host.SERVICE_ACCOUNT_ID
        left join CJ_CMP_CLOUD_ACCOUNT ca on rel.CLOUD_ACCOUNT_ID = ca.ID
        where host.STAT_TIME BETWEEN #{startTime} and #{endTime} and host.TYPE = #{provider} and
        rel.CLOUD_ACCOUNT_ID is not null
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>
        <if test="condition!=null">
            and ca.NAME = #{condition}
        </if>
        group BY rel.TYPE, rel.CLOUD_ACCOUNT_ID
    
```
#### queryCloudAccountUsage
```

        select  ca.NAME,
                vm.ID as vmId,
                ca.DATACENTER_TYPE AS ldcType,
                ifnull( cap.VCPU_LIMIT, 0 ) AS vcpuLimit,
                ifnull( cap.MEMORY_LIMIT DIV 1024, 0 ) AS memoryLimit,
                ifnull( cap.STORAGE_LIMIT, 0 ) AS storageLimit,
                ifnull( vm.CPUS, 0 ) AS vcpu,
                ifnull( vm.MEMORY, 0 ) AS memory,
                ifnull( vol.DISK_SPACE, 0 ) DIV 1 AS STORAGE
        from CJ_CMP_CLOUD_ACCOUNT ca
            inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc ON ca.ID = cdc.CLOUD_ACCOUNT_ID AND cdc.IS_DELETED = 0
            inner join CJ_CMP_SERVICE_ACCOUNT sa on cdc.SERVICE_ACCOUNT_ID = sa.ID and sa.IS_DELETED = 0
            left join CJ_CMP_CLOUD_ACCOUNT_CAPACITY cap on cap.CLOUD_ACCOUNT_ID = ca.ID
            left join cj_cmp_vm_view vm
                   on vm.CLOUD_ACCOUNT_ID = ca.ID and vm.LDC_ID = cdc.LDC_ID
                   <if test="memberId != 0">and vm.MEMBER_ID = #{memberId}</if>
            left join CJ_CMP_VM_VOLUME vol on vol.SERVICE_ACCOUNT_ID = vm.SERVICE_ACCOUNT_ID and vol.VM_DEVICE_ID = vm.ID
                   and vol.IS_DELETED = 0
        where ca.IS_DELETED = 0
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>
        order by ca.NAME;
    
```
#### queryVMwareResUsageByCaId
```

        select sum(host.CPUS)                                                 as cpuSum,
               sum(host.CPU_USED)                                             as cpuUsed,
               sum(host.MEMORY_SUM) / 1024                                    as memorySum,
               sum(host.MEMORY_USED) / 1024                                   as memoryUsed,
               sum(host.DISK_SUM)                                             as localStorageSum,
               sum(host.DISK_USED)                                            as localStorageUsed,
               round((sum(host.CPU_USED) / sum(host.CPUS)) * 100, 2)          as cpuUsage,
               round((sum(host.MEMORY_USED) / sum(host.MEMORY_SUM)) * 100, 2) as memoryUsage,
               round((sum(host.DISK_USED) / sum(host.DISK_SUM)) * 100, 2)     as localStorageUsage
         FROM CJ_CMP_SERVICE_ACCOUNT sa
         INNER JOIN CJ_CMP_CLOUD_ACCOUNT_DC cdc
                    ON sa.ID = cdc.SERVICE_ACCOUNT_ID AND cdc.IS_DELETED = 0 AND sa.IS_DELETED = 0
         INNER JOIN CJ_CMP_CLOUD_ACCOUNT ca ON cdc.CLOUD_ACCOUNT_ID = ca.ID AND ca.IS_DELETED = 0
         inner join CJ_CMP_VMWARE_DC dc on dc.ID = cdc.LDC_ID and dc.SERVICE_ACCOUNT_ID = sa.ID
         inner join CJ_CMP_VMWARE_HOST host on host.LDC_ID = dc.ID
         where ca.ID = #{cloudAccountId} and ca.MEMBER_ID = #{memberId}
    
```
#### queryVMwareStorageUsageByCaId
```

        select sum(store.DISK_SUM)                                          as sharedStorageSum,
               sum(store.DISK_SUM - store.DISK_FREE)                        as sharedStorageUsed,
               sum(store.PROVISIONED)                                       as storageProvisioned,
               round((sum(store.DISK_SUM - store.DISK_FREE) / sum(store.DISK_SUM)) * 100, 2) as sharedStorageUsage
        FROM CJ_CMP_SERVICE_ACCOUNT sa
        INNER JOIN CJ_CMP_CLOUD_ACCOUNT_DC cdc
                    ON sa.ID = cdc.SERVICE_ACCOUNT_ID AND cdc.IS_DELETED = 0 AND sa.IS_DELETED = 0
        INNER JOIN CJ_CMP_CLOUD_ACCOUNT ca ON cdc.CLOUD_ACCOUNT_ID = ca.ID AND ca.IS_DELETED = 0
        inner join CJ_CMP_VMWARE_DC dc on dc.ID = cdc.LDC_ID and dc.SERVICE_ACCOUNT_ID = sa.ID
        inner join CJ_CMP_VMWARE_DATASTORE store on store.LDC_ID = dc.ID
        where ca.ID = #{cloudAccountId}
        and ca.MEMBER_ID = #{memberId}
    
```
#### queryFusionComputeResUsageByCaId
```

        select sum(clu.CPU_SUM)                                             as cpuSum,
               sum(clu.CPU_USED)                                            as cpuUsed,
               sum(clu.MEMORY_SUM) / 1024                                   as memorySum,
               sum(clu.MEMORY_USED) / 1024                                  as memoryUsed,
               round((sum(clu.CPU_USED) / sum(clu.CPU_SUM)) * 100, 2)       as cpuUsage,
               round((sum(clu.MEMORY_USED) / sum(clu.MEMORY_SUM)) * 100, 2) as memoryUsage
        FROM CJ_CMP_SERVICE_ACCOUNT sa
         INNER JOIN CJ_CMP_CLOUD_ACCOUNT_DC cdc
                    ON sa.ID = cdc.SERVICE_ACCOUNT_ID AND cdc.IS_DELETED = 0 AND sa.IS_DELETED = 0
         INNER JOIN CJ_CMP_CLOUD_ACCOUNT ca ON cdc.CLOUD_ACCOUNT_ID = ca.ID AND ca.IS_DELETED = 0
         inner join CJ_CMP_FUSION_COMPUTE_DC dc on dc.ID = cdc.LDC_ID and dc.SERVICE_ACCOUNT_ID = sa.ID
         inner join CJ_CMP_FUSION_COMPUTE_CLUSTER clu on clu.LDC_ID = dc.ID
         where ca.ID = #{cloudAccountId}
            and ca.MEMBER_ID = #{memberId}
    
```
#### queryFusionComputeStorageUsageByCaId
```

        select sum(store.CAPACITY_GB)                                             as sharedStorageSum,
               sum(store.USED_SIZE_GB)                                            as sharedStorageUsed,
               round((sum(store.USED_SIZE_GB) / sum(store.CAPACITY_GB)) * 100, 2) as sharedStorageUsage
        FROM CJ_CMP_SERVICE_ACCOUNT sa
                 INNER JOIN CJ_CMP_CLOUD_ACCOUNT_DC cdc
                            ON sa.ID = cdc.SERVICE_ACCOUNT_ID AND cdc.IS_DELETED = 0 AND sa.IS_DELETED = 0
                 INNER JOIN CJ_CMP_CLOUD_ACCOUNT ca ON cdc.CLOUD_ACCOUNT_ID = ca.ID AND ca.IS_DELETED = 0
                 inner join CJ_CMP_FUSION_COMPUTE_DC dc on dc.ID = cdc.LDC_ID and dc.SERVICE_ACCOUNT_ID = sa.ID
                 inner join CJ_CMP_FUSION_COMPUTE_DATASTORE store on store.LDC_ID = dc.ID
        where ca.ID = #{cloudAccountId}
        and ca.MEMBER_ID = #{memberId}
    
```
#### queryFusionCloudResUsageByCaId
```

        select sum(host.CPUS)                                                 as cpuSum,
               sum(host.CPU_USED)                                             as cpuUsed,
               sum(host.MEMORY_SUM) / 1024                                    as memorySum,
               sum(host.MEMORY_USED) / 1024                                   as memoryUsed,
               round((sum(host.CPU_USED) / sum(host.CPUS)) * 100, 2)          as cpuUsage,
               round((sum(host.MEMORY_USED) / sum(host.MEMORY_SUM)) * 100, 2) as memoryUsage
        FROM CJ_CMP_SERVICE_ACCOUNT sa
         inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc
                    ON sa.ID = cdc.SERVICE_ACCOUNT_ID AND cdc.IS_DELETED = 0 AND sa.IS_DELETED = 0
         inner join CJ_CMP_CLOUD_ACCOUNT ca ON cdc.CLOUD_ACCOUNT_ID = ca.ID AND ca.IS_DELETED = 0
         inner join CJ_CMP_FUSION_CLOUD_DC_X_AZ rel on rel.SERVICE_ACCOUNT_ID = sa.ID and rel.LDC_ID = cdc.LDC_ID
         left outer join CJ_CMP_FUSION_CLOUD_DC fdc on fdc.ID = rel.LDC_ID and fdc.IS_DELETED = 0 and
                                                       fdc.SERVICE_ACCOUNT_ID = rel.SERVICE_ACCOUNT_ID
         left outer join CJ_CMP_CLOUD_AZ az on rel.AZ_ID = az.ID and az.LDC_TYPE = cdc.LDC_TYPE and az.IS_DELETED = 0
         left outer join CJ_CMP_FUSION_CLOUD_HOST host on host.ZONE_ID = az.ID
        where ca.ID = #{cloudAccountId}
        and ca.MEMBER_ID = #{memberId}
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_CLOUD_ACCOUNT_CAPACITY.xml
> sql统计:复杂19个，简单33个
>
> 使用的关键字：count,in,now,CJ_CMP_CLOUD_ACCOUNT_CAPACITY,VALUES,sum,ifnull
#### sumAliyunCapacityByLdcIds
```

        select sum(ifnull(ecs.CPUS,0)) as vcpu,sum(ifnull(ecs.MEMORY,0)) as memory,count(*) as vmInstance
        from CJ_CMP_ALIYUN_DC dc inner join CJ_CMP_ALIYUN_ECS ecs on ecs.LDC_ID=dc.ID
        where ecs.IS_DELETED=0 and dc.IS_DELETED=0 and ecs.ENTITY_ID is not null
        <if test="memberId != 0">AND ecs.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
             and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumVmwareCapacityByLdcIds
```

        select sum(ifnull(vm.CPUS,0)) as vcpu,sum(ifnull(vm.MEMORY,0)) as memory,count(*) as vmInstance
        from CJ_CMP_VMWARE_DC dc inner join CJ_CMP_VMWARE_VM vm on vm.LDC_ID=dc.ID
        where vm.IS_DELETED=0 AND vm.IS_RECYCLED = 0 and vm.ENTITY_ID is not null
        <if test="memberId != 0">AND vm.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size != 0">
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumFusionCloudCapacityByLdcIds
```

        select sum(ifnull(ecs.CPUS,0)) as vcpu,sum(ifnull(ecs.MEMORY,0)) as memory,count(*) as vmInstance
        from CJ_CMP_FUSION_CLOUD_DC dc inner join CJ_CMP_FUSION_CLOUD_ECS ecs on ecs.LDC_ID=dc.ID
        where ecs.IS_DELETED=0 and ecs.IS_RECYCLED = 0 and dc.IS_DELETED=0 AND ecs.ENTITY_ID is not null
        <if test="memberId != 0">AND ecs.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumCloudosCapacityByLdcIds
```

        select sum(ifnull(ecs.CPUS,0)) as vcpu,sum(ifnull(ecs.MEMORY,0)) as memory,count(*) as vmInstance
        from CJ_CMP_CLOUDOS_DC dc inner join CJ_CMP_CLOUDOS_VM ecs on ecs.LDC_ID=dc.ID
        where ecs.IS_DELETED=0 and ecs.IS_RECYCLED = 0 and dc.IS_DELETED=0 and ecs.ENTITY_ID is not null
        <if test="memberId != 0">AND ecs.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumQingCloudCapacityByLdcIds
```

        select sum(ifnull(vm.CPUS,0)) as vcpu,sum(ifnull(vm.MEMORY,0)) as memory,count(*) as vmInstance
        from CJ_CMDB_CI_QINGCLOUD_DATACENTER dc inner join CJ_CMDB_CI_QINGCLOUD_VM_INSTANCE vm on vm.LDC_ID=dc.ID
        where vm.IS_DELETED=0 and vm.IS_RECYCLED = 0 and dc.IS_DELETED=0 and vm.ENTITY_ID is not null
        <if test="memberId != 0">AND vm.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumQingCloudEcsVolumeByLdcIds
```

        select sum(ifnull(vol.DISK_SPACE,0))
        from CJ_CMDB_CI_QINGCLOUD_DATACENTER dc inner join CJ_CMDB_CI_QINGCLOUD_VM_INSTANCE vm on vm.LDC_ID=dc.ID and vm.IS_DELETED=0
        inner join CJ_CMP_VM_VOLUME vol on vol.VM_DEVICE_ID=vm.ID and vol.SERVICE_ACCOUNT_ID=dc.SERVICE_ACCOUNT_ID
        where vol.IS_DELETED=0
          AND vm.IS_RECYCLED = 0
        <if test="memberId != 0">AND vol.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumFusionAccessCapacityByLdcIds
```

        select sum(ifnull(vm.CPUS,0)) as vcpu,sum(ifnull(vm.MEMORY,0)) as memory,count(*) as vmInstance
        from CJ_CMP_FUSION_ACCESS_DC dc inner join CJ_CMP_FUSION_ACCESS_VM_INSTANCE vm on vm.LDC_ID=dc.ID
        where vm.IS_DELETED=0 and dc.IS_DELETED=0 and vm.ENTITY_ID is not null
        <if test="memberId != 0">AND vm.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumFusionComputeCapacityByLdcIds
```

        select sum(ifnull(vm.CPUS,0)) as vcpu,sum(ifnull(vm.MEMORY,0)) as memory,count(*) as vmInstance
        from CJ_CMP_FUSION_COMPUTE_DC dc inner join CJ_CMP_FUSION_COMPUTE_VM vm on vm.LDC_ID=dc.ID
        where vm.IS_DELETED=0 and dc.IS_DELETED=0 and vm.ENTITY_ID is not null and vm.IS_RECYCLED = 0
        <if test="memberId != 0">AND vm.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumFusionAccessEcsVolumeByLdcIds
```

        select sum(ifnull(vol.DISK_SPACE,0))
        from CJ_CMP_FUSION_ACCESS_DC dc inner join CJ_CMP_FUSION_ACCESS_VM_INSTANCE vm on vm.LDC_ID=dc.ID and vm.IS_DELETED=0
        inner join CJ_CMP_VM_VOLUME vol on vol.VM_DEVICE_ID=vm.ID and vol.SERVICE_ACCOUNT_ID=dc.SERVICE_ACCOUNT_ID
        where vol.IS_DELETED=0
        <if test="memberId != 0">AND vol.MEMBER_ID =#{memberId}</if>
        <if test="memberId != 0">AND vm.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumFusionComputeEcsVolumeByLdcIds
```

        select sum(ifnull(vol.DISK_SPACE,0))
        from CJ_CMP_FUSION_COMPUTE_DC dc inner join CJ_CMP_FUSION_COMPUTE_VM vm on vm.LDC_ID=dc.ID and vm.IS_DELETED=0
        inner join CJ_CMP_VM_VOLUME vol on vol.VM_DEVICE_ID=vm.ID and vol.SERVICE_ACCOUNT_ID=dc.SERVICE_ACCOUNT_ID
        where vol.IS_DELETED=0 and vm.IS_RECYCLED = 0
        <if test="memberId != 0">AND vol.MEMBER_ID =#{memberId}</if>
        <if test="memberId != 0">AND vm.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumAliyunEcsVolumeByLdcIds
```

        select sum(ifnull(vol.DISK_SPACE,0))
        from CJ_CMP_ALIYUN_DC dc inner join CJ_CMP_ALIYUN_ECS ecs on ecs.LDC_ID=dc.ID and ecs.IS_DELETED=0
        inner join CJ_CMP_VM_VOLUME vol on vol.VM_DEVICE_ID=ecs.ID and vol.SERVICE_ACCOUNT_ID=dc.SERVICE_ACCOUNT_ID
        where vol.IS_DELETED=0
        <if test="memberId != 0">AND vol.MEMBER_ID =#{memberId}</if>
        <if test="memberId != 0">AND ecs.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
             and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumVmwareVmVolumeByLdcIds
```

        select sum(ifnull(vol.DISK_SPACE,0))
        from CJ_CMP_VMWARE_DC dc
        inner join CJ_CMP_VMWARE_VM vm on vm.LDC_ID=dc.ID and dc.IS_DELETED=0 and vm.IS_DELETED=0
        inner join CJ_CMP_VM_VOLUME vol on vol.VM_DEVICE_ID=vm.ID and vol.SERVICE_ACCOUNT_ID=dc.SERVICE_ACCOUNT_ID
        where vol.IS_DELETED=0
        AND vm.IS_RECYCLED = 0
        <if test="memberId != 0">AND vol.MEMBER_ID =#{memberId}</if>
        <if test="memberId != 0">AND vm.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size != 0">
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumFusionCloudEcsVolumeByLdcIds
```

        select sum(ifnull(vol.DISK_SPACE,0))
        from CJ_CMP_FUSION_CLOUD_DC dc inner join CJ_CMP_FUSION_CLOUD_ECS ecs on ecs.LDC_ID=dc.ID and ecs.IS_DELETED=0
        inner join CJ_CMP_VM_VOLUME vol on vol.VM_DEVICE_ID=ecs.ID and vol.SERVICE_ACCOUNT_ID=dc.SERVICE_ACCOUNT_ID
        where vol.IS_DELETED=0
          AND ecs.IS_RECYCLED = 0
        <if test="memberId != 0">AND vol.MEMBER_ID =#{memberId}</if>
        <if test="memberId != 0">AND ecs.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumCloudosEcsVolumeByLdcIds
```

        select sum(ifnull(vol.DISK_SPACE,0))
        from CJ_CMP_CLOUDOS_DC dc inner join CJ_CMP_CLOUDOS_VM ecs on ecs.LDC_ID=dc.ID and ecs.IS_DELETED=0
        inner join CJ_CMP_VM_VOLUME vol on vol.VM_DEVICE_ID=ecs.ID and vol.SERVICE_ACCOUNT_ID=dc.SERVICE_ACCOUNT_ID
        where vol.IS_DELETED=0
          AND ecs.IS_RECYCLED = 0
        <if test="memberId != 0">AND vol.MEMBER_ID =#{memberId}</if>
        <if test="memberId != 0">AND ecs.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumOracleOvmCapacityByLdcIds
```

        select sum(ifnull(vm.CPUS,0)) as vcpu,sum(ifnull(vm.MEMORY,0)) as memory,count(*) as vmInstance
        from CJ_CMP_ORACLE_OVM_DC dc inner join CJ_CMP_ORACLE_OVM_VM vm on vm.LDC_ID=dc.ID
        where vm.IS_DELETED=0 and dc.IS_DELETED=0 and vm.ENTITY_ID is not null
        <if test="memberId != 0">AND vm.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumTencentCapacityByLdcIds
```

        select sum(ifnull(cvm.CPU,0)) as vcpu,sum(ifnull(cvm.MEMORY_MB,0)) as memory,count(*) as vmInstance
        from CJ_CMP_TENCENT_DC dc inner join CJ_CMP_TENCENT_CVM cvm on cvm.LDC_ID=dc.ID
        where cvm.IS_DELETED=0 and dc.IS_DELETED=0 and cvm.ENTITY_ID is not null
        <if test="memberId != 0">AND cvm.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumTencentCvmVolumeByLdcIds
```

        select sum(ifnull(vol.DISK_SPACE,0))
        from CJ_CMP_TENCENT_DC dc inner join CJ_CMP_TENCENT_CVM cvm on cvm.LDC_ID=dc.ID and cvm.IS_DELETED=0
        inner join CJ_CMP_VM_VOLUME vol on vol.VM_DEVICE_ID=cvm.ID and vol.SERVICE_ACCOUNT_ID=dc.SERVICE_ACCOUNT_ID
        where vol.IS_DELETED=0
        <if test="memberId != 0">AND vol.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
#### sumCASCapacityByLdcIds
```

        select
            sum(ifnull(vm.CPU, 0)) as vcpu,
            sum(ifnull(vm.MEMORY, 0)) as memory,
            count(*) as vmInstance
        from
            CJ_CMP_CAS_VM vm
            left join CJ_CMP_CAS_DC ldc ON ldc.ID = vm.LDC_ID
            left join CJ_CMP_CLOUD_ACCOUNT_DC cdc ON cdc.LDC_ID = ldc.ID
            left join CJ_CMP_CLOUD_ACCOUNT ca ON ca.ID = cdc.CLOUD_ACCOUNT_ID
        where
            vm.IS_DELETED = 0
            and ldc.IS_DELETED = 0
            and cdc.SERVICE_ACCOUNT_ID = ldc.SERVICE_ACCOUNT_ID
            and cdc.IS_DELETED = 0
            and ca.IS_DELETED = 0
            and vm.IS_RECYCLED = 0
            AND vm.ENTITY_ID is not null
            <if test="memberId != 0">AND ca.MEMBER_ID =#{memberId}</if>
            <if test="ldcIds != null and ldcIds.size >0" >
                and ldc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
            </if>
    
```
#### sumCASEcsVolumeByLdcIds
```

        select
               sum(ifnull(vol.DISK_SPACE,0))
        from CJ_CMP_CAS_DC dc inner join CJ_CMP_CAS_VM ecs on ecs.LDC_ID=dc.ID
                                                                  and ecs.IS_DELETED=0
        inner join CJ_CMP_VM_VOLUME vol on vol.VM_DEVICE_ID=ecs.ID
                                               and vol.SERVICE_ACCOUNT_ID=dc.SERVICE_ACCOUNT_ID
        where vol.IS_DELETED=0
          AND ecs.IS_RECYCLED = 0
        <if test="memberId != 0">AND vol.MEMBER_ID =#{memberId}</if>
        <if test="memberId != 0">AND ecs.MEMBER_ID =#{memberId}</if>
        <if test="ldcIds != null and ldcIds.size >0" >
            and dc.ID in <foreach collection="ldcIds" item="id" open="(" close=")" separator=",">#{id}</foreach>
        </if>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_CLOUD_ACCOUNT_DC.xml
> sql统计:复杂1个，简单31个
>
> 使用的关键字：concat,and,now,CJ_CMP_CLOUD_ACCOUNT_DC,VALUES,on,if
#### getDcList
```

        <choose>
            <when test="ldcType != null and ldcType == 'fusionCloud'">
                select if(sa.PARENT_ID is null, sa.ID, sa.PARENT_ID) AS serviceAccountId, if(parentSa.NAME is not null, parentSa.NAME, sa.NAME) AS serviceAccountName, ca.ID as cloudAccountId,ca.NAME as cloudAccountName,
                dc.ID as ldcId, if(vdc.NAME is null, dc.NAME, concat(dc.NAME, '(', vdc.NAME, ')')) as ldcName, dc.ENTITY_ID as ldcEntityId,dc.LAST_DISCOVERED as lastDiscovered
                from CJ_CMP_SERVICE_ACCOUNT sa
                left join CJ_CMP_SERVICE_ACCOUNT parentSa on parentSa.ID = sa.PARENT_ID and parentSa.IS_DELETED = 0
                inner join CJ_CMP_DC_VIEW dc on dc.SERVICE_ACCOUNT_ID = sa.ID
                left join CJ_CMP_CLOUD_ACCOUNT_DC cdc on cdc.LDC_ID = dc.ID and cdc.LDC_TYPE = dc.LDC_TYPE and cdc.IS_DELETED=0
                left join CJ_CMP_FUSION_CLOUD_VDC vdc on dc.VDC_ID = vdc.ID and vdc.IS_DELETED = 0
                left join CJ_CMP_CLOUD_ACCOUNT ca on cdc.CLOUD_ACCOUNT_ID=ca.ID and ca.IS_DELETED=0
            </when>
            <when test="ldcType != null and ldcType == 'huaweiObs'">
                select sa.ID AS serviceAccountId, sa.NAME AS serviceAccountName, ca.ID as cloudAccountId,ca.NAME as cloudAccountName,
                cdc.LDC_ID as ldcId,'-' as ldcName, '-' as ldcEntityId,cdc.CREATE_DATE as lastDiscovered
                from CJ_CMP_SERVICE_ACCOUNT sa
                inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc on cdc.SERVICE_ACCOUNT_ID=sa.ID and cdc.IS_DELETED=0 and sa.DATACENTER_TYPE='huaweiObs'
                left outer join CJ_CMP_CLOUD_ACCOUNT ca on cdc.CLOUD_ACCOUNT_ID=ca.ID and ca.IS_DELETED=0
            </when>
            <otherwise>
                select sa.ID AS serviceAccountId, sa.NAME AS serviceAccountName, ca.ID as cloudAccountId,ca.NAME as cloudAccountName,
                dc.ID as ldcId,dc.NAME as ldcName, dc.ENTITY_ID as ldcEntityId,dc.LAST_DISCOVERED as lastDiscovered
                from CJ_CMP_SERVICE_ACCOUNT sa
                inner join CJ_CMP_DC_VIEW dc on dc.SERVICE_ACCOUNT_ID=sa.ID and sa.IS_DELETED=0
                left outer join CJ_CMP_CLOUD_ACCOUNT_DC cdc on cdc.SERVICE_ACCOUNT_ID=sa.ID and cdc.IS_DELETED=0 and cdc.LDC_ID=dc.ID
                left outer join CJ_CMP_CLOUD_ACCOUNT ca on cdc.CLOUD_ACCOUNT_ID=ca.ID and ca.IS_DELETED=0
            </otherwise>
        </choose>
        <where>
        <if test="ids != null and ids.size > 0 ">
            and (sa.ID in <foreach collection="ids" item="id" open="(" close=")" separator=",">#{id}</foreach>
            or sa.PARENT_ID in <foreach collection="ids" item="id" open="(" close=")" separator=",">#{id}</foreach>)
        </if>
        <if test="cloudAccountId != null and cloudAccountId != ''"> and ca.ID=#{cloudAccountId}</if>
        <if test="vdcId != null and vdcId != ''"> and dc.VDC_ID=#{vdcId}</if>
        </where>
        order by serviceAccountName, ldcName
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_CLOUD_ACCOUNT_DISCOVERY.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：now,CJ_CMP_CLOUD_ACCOUNT_DISCOVERY,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_CLOUD_AZ.xml
> sql统计:复杂2个，简单13个
>
> 使用的关键字：if,concat,in,now,NOW,CJ_CMP_CLOUD_AZ,COALESCE,GROUP_CONCAT,sum,round,VALUES,and,size
#### queryAz
```

        select distinct az.ID, az.NAME, az.ENTITY_ID, az.SHORT_DESCRIPTION,
        null,
        cdc.LDC_TYPE,
        COALESCE(alidc.ENTITY_ID, sdc.ENTITY_ID, qdc.ENTITY_ID, tdc.ENTITY_ID) as ldcEntityId,
        COALESCE(alidc.NAME, sdc.NAME, qdc.NAME,tdc.NAME) as ldcName,
        sa.NAME      as serviceAccountName,
        sa.ID        as serviceAccountId,
        null as cpuSum,
        null as cpuUsed,
        null as memorySum,
        null as memoryUsed,
        null as cpuUsage,
        null as memoryUsage
        from CJ_CMP_SERVICE_ACCOUNT sa
        inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc on sa.ID = cdc.SERVICE_ACCOUNT_ID and sa.IS_DELETED = 0 and cdc.IS_DELETED = 0 and sa.DATACENTER_TYPE != 'fusionCloud'
        inner join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED = 0
        left outer join CJ_CMP_ALIYUN_DC alidc on cdc.LDC_ID = alidc.ID and alidc.IS_DELETED = 0 and alidc.SERVICE_ACCOUNT_ID=sa.ID
        left outer join CJ_CMP_TENCENT_DC tdc on cdc.LDC_ID = tdc.ID and tdc.IS_DELETED = 0 and tdc.SERVICE_ACCOUNT_ID=sa.ID
        left outer join CJ_CMP_CLOUDOS_DC sdc on sdc.ID = cdc.LDC_ID and sdc.IS_DELETED = 0 and sdc.SERVICE_ACCOUNT_ID=sa.ID
        left outer join CJ_CMDB_CI_QINGCLOUD_DATACENTER qdc on qdc.ID = cdc.LDC_ID and qdc.IS_DELETED = 0 and qdc.SERVICE_ACCOUNT_ID=sa.ID
        inner join CJ_CMP_CLOUD_AZ az on cdc.LDC_ID = az.LDC_ID and az.LDC_TYPE = cdc.LDC_TYPE and az.IS_DELETED = 0
        where az.IS_DELETED=0
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>
        <if test="azId != null and azId != ''"> and az.ID=#{azId}</if>
        <if test="serviceAccountId != null and serviceAccountId != ''"> and sa.ID=#{serviceAccountId}</if>
        <if test="cloudAccountId != null and cloudAccountId != ''"> and ca.ID=#{cloudAccountId}</if>
        <if test="ldcId != null and ldcId != ''"> and cdc.LDC_ID=#{ldcId}</if>
        <if test="ldcType != null and ldcType != ''"> and cdc.LDC_TYPE=#{ldcType}</if>
        <if test="searchKey != null and searchKey != ''"> and (az.NAME like #{searchKey} or az.ENTITY_ID like #{searchKey})</if>
        <if test="name != null and name != ''"> and az.NAME like #{name}</if>
        <if test="ldcIds != null and ldcIds.size()>0">
           and cdc.LDC_ID IN <foreach collection="ldcIds" item="ldc" open="(" separator="," close=")"> #{ldc} </foreach>
        </if>
        union all
        select az.ID, az.NAME, az.ENTITY_ID, az.SHORT_DESCRIPTION,
        null,
        cdc.LDC_TYPE,
        GROUP_CONCAT(distinct fdc.ENTITY_ID) as ldcEntityId,
        GROUP_CONCAT(distinct fdc.NAME) as ldcName,
        sa.NAME      as serviceAccountName,
        sa.ID        as serviceAccountId,
        sum(host.CPUS)                                as cpuSum,
        sum(host.CPU_USED)                            as cpuUsed,
        sum(host.MEMORY_SUM) / 1024                   as memorySum,
        sum(host.MEMORY_USED) / 1024                  as memoryUsed,
        round((sum(host.CPU_USED) / sum(host.CPUS)) * 100 , 2) as cpuUsage,
        round((sum(host.MEMORY_USED) / sum(host.MEMORY_SUM)) * 100, 2)  as memoryUsage
        from CJ_CMP_SERVICE_ACCOUNT sa
        inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc on sa.ID = cdc.SERVICE_ACCOUNT_ID and sa.IS_DELETED = 0 and cdc.IS_DELETED = 0
        inner join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED = 0 and cdc.LDC_TYPE='fusionCloud'
        inner join CJ_CMP_FUSION_CLOUD_DC fdc on fdc.ID = cdc.LDC_ID and fdc.IS_DELETED = 0
        inner join CJ_CMP_FUSION_CLOUD_DC_X_AZ rel on rel.LDC_ID = fdc.ID
        left outer join CJ_CMP_CLOUD_AZ az on rel.AZ_ID = az.ID and az.LDC_TYPE ='fusionCloud' and az.IS_DELETED = 0
        left outer join CJ_CMP_FUSION_CLOUD_HOST host on host.ZONE_ID = az.ID
        where az.IS_DELETED=0
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>
        <if test="azId != null and azId != ''"> and az.ID=#{azId}</if>
        <if test="serviceAccountId != null and serviceAccountId != ''"> and sa.ID=#{serviceAccountId}</if>
        <if test="cloudAccountId != null and cloudAccountId != ''"> and ca.ID=#{cloudAccountId}</if>
        <if test="ldcId != null and ldcId != ''"> and cdc.LDC_ID=#{ldcId}</if>
        <if test="ldcType != null and ldcType != ''"> and cdc.LDC_TYPE=#{ldcType}</if>
        <if test="searchKey != null and searchKey != ''"> and (az.NAME like #{searchKey} or az.ENTITY_ID like #{searchKey})</if>
        <if test="name != null and name != ''"> and az.NAME like #{name}</if>
        <if test="ldcIds != null and ldcIds.size()>0">
           and cdc.LDC_ID IN <foreach collection="ldcIds" item="ldc" open="(" separator="," close=")"> #{ldc} </foreach>
        </if>
        group by az.ID, sa.ID
        <if test="sortField != null and sortField!= '' and sortType != null and sortType!= '' ">
            <choose>
                <when test="sortField == 'cpuUsage' or sortField == 'memoryUsage' or sortField == 'localStorageUsage'">
                    ORDER BY ${sortField} ${sortType}
                </when>
                <otherwise>
                    order by NAME
                </otherwise>
            </choose>
        </if>
        <if test="sortField == null or sortType == null ">
            order by NAME
        </if>
    
```
#### queryFusionCloudRegionAz
```

        select az.ID,
        az.NAME,
        az.ENTITY_ID,az.CPU_ARCH,az.TYPE,
        cdc.LDC_ID,
        cdc.LDC_TYPE,
        dc.ENTITY_ID as ldcEntityId,
        if(vdc.NAME is null, dc.NAME, concat(dc.NAME, '(', vdc.NAME, ')')) as ldcName,
        sa.NAME      as serviceAccountName,
        sa.ID        as serviceAccountId
        from CJ_CMP_SERVICE_ACCOUNT sa
        inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc on sa.ID = cdc.SERVICE_ACCOUNT_ID and sa.IS_DELETED = 0 and cdc.IS_DELETED = 0
        inner join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED = 0 and cdc.LDC_TYPE='fusionCLoud'
        left join CJ_CMP_FUSION_CLOUD_DC dc on cdc.LDC_ID = dc.ID and dc.IS_DELETED = 0
        left join CJ_CMP_FUSION_CLOUD_VDC vdc on dc.VDC_ID = vdc.ID and vdc.IS_DELETED = 0
        inner join CJ_CMP_FUSION_CLOUD_DC_X_AZ rel on rel.LDC_ID = cdc.LDC_ID
        inner join CJ_CMP_CLOUD_AZ az on rel.AZ_ID=az.ID
        where dc.IS_DELETED=0 and cdc.CLOUD_ACCOUNT_ID=#{cloudAccountId} and az.NAME != 'manage-az'
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>
        <if test="azNotNull != null and azNotNull"> and az.ID is not null</if>
        order by dc.NAME,az.NAME
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_CLOUD_AZ_GROUP.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：CONCAT,NOW,CJ_CMP_CLOUD_AZ_GROUP,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_CLOUD_AZ_GROUP_MANAGE.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：NOW,CJ_CMP_CLOUD_AZ_GROUP_MANAGE,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_CLUSTER_AZ_VIEW.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_DATASTORE_DAY_REPORT.xml
> sql统计:复杂2个，简单2个
>
> 使用的关键字：ifnull,DATE_FORMAT,FROM,in,CJ_CMP_DATASTORE_DAY_REPORT,sum,and,DATE,values
#### groupBySaAndTime
```

        SELECT
        ifnull(sum(store.DISK_SUM), 0)           AS num,
        DATE_FORMAT(store.STAT_TIME, #{dateFormat}) AS days
        FROM (SELECT
        report.DISK_SUM,
        report.STAT_TIME,
        report.PROVIDER,
        report.ID,
        report.SERVICE_ACCOUNT_ID
        FROM CJ_CMP_DATASTORE_DAY_REPORT report
        inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc on report.LDC_ID = cdc.LDC_ID and report.SERVICE_ACCOUNT_ID = cdc.SERVICE_ACCOUNT_ID and cdc.IS_DELETED = 0
        inner join CJ_CMP_CLOUD_ACCOUNT ca on cdc.CLOUD_ACCOUNT_ID = ca.ID and ca.IS_DELETED = 0
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>
        WHERE report.SERVICE_ACCOUNT_ID in (select ID from CJ_CMP_SERVICE_ACCOUNT where IS_DELETED = 0)
        GROUP BY STAT_TIME, PROVIDER, ID, SERVICE_ACCOUNT_ID) store
        <where>
            <if test="serviceAccountId != null and serviceAccountId != ''">
               and store.SERVICE_ACCOUNT_ID = #{serviceAccountId}
            </if>
            <if test="provider != null and provider != ''">
                and store.PROVIDER=#{provider}
            </if>
            <if test="startTime != null and endTime != null ">
                and (store.STAT_TIME &gt;= DATE(#{startTime}) AND store.STAT_TIME &lt;= DATE(#{endTime}))
            </if>
        </where>
        GROUP BY days
        ORDER BY days asc
    
```
#### getTotalBySaAndTime
```

        SELECT
            ifnull(sum( DISK_SUM ),0) as num
        FROM
        CJ_CMP_DATASTORE_DAY_REPORT report
        INNER JOIN CJ_CMP_SERVICE_ACCOUNT sa ON sa.ID = report.SERVICE_ACCOUNT_ID
        INNER JOIN CJ_CMP_CLOUD_ACCOUNT_DC cdc on report.LDC_ID = cdc.LDC_ID and report.SERVICE_ACCOUNT_ID = cdc.SERVICE_ACCOUNT_ID and cdc.IS_DELETED = 0
        INNER JOIN CJ_CMP_CLOUD_ACCOUNT ca on cdc.CLOUD_ACCOUNT_ID = ca.ID and ca.IS_DELETED = 0
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>
        AND sa.IS_DELETED = 0
        WHERE
        STAT_TIME = DATE(#{statTime})
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_DAY_REPORT.xml
> sql统计:复杂1个，简单15个
>
> 使用的关键字：CJ_CMP_VM_DAY_REPORT,join,CJ_CMP_SERVICE_ACCOUNT_DAY_REPORT,CJ_CMP_LDC_DAY_REPORT,CJ_CMP_KUBERNETES_DEPLOYMENT_DAY_REPORT,CJ_CMP_KUBERNETES_STATEFUL_SET_DAY_REPORT,CJ_CMP_FUSION_CLOUD_DC_X_AZ_DAY_REPORT,CJ_CMP_PROJECT_DAY_REPORT,CJ_CMP_PM_DAY_REPORT,CJ_CMP_KUBERNETES_NODE_DAY_REPORT,ifnull,CJ_CMP_CLOUD_ACCOUNT_DAY_REPORT,in,CJ_CMP_FUSION_CCE_CLUSTER_DAY_REPORT,CJ_CMP_KUBERNETES_DAEMON_SET_DAY_REPORT,sum,CJ_CMP_CLOUD_AZ_DAY_REPORT,CJ_CMP_APP_SYSTEM_DAY_REPORT,CJ_CMDB_CI_TKE_CLUSTER_DAY_REPORT
#### batchInsertVmDayReport
```

        INSERT INTO CJ_CMP_VM_DAY_REPORT (STAT_TIME, VM_ID, MEMBER_ID, CPUS, DUE, IP, SPEC_ID, MANAGED_BY, MEMORY, DISK_SUM, NAME, PROJECT_ID, APP_SYSTEM_ID, APP_SUB_SYSTEM_ID, APP_DU_ID, SERVICE_ACCOUNT_ID, OWNED_BY, SN, INSTALL_STATUS, ENTITY_ID, OS, OS_FAMILY, HOST_ID, RUN_STATUS, HOSTNAME, CLOUD_ACCOUNT_ID, CLOUD_ACCOUNT_NAME, LDC_TYPE, LDC_ID, LDC_NAME, LDC_ENTITY_ID, CLUSTER_NAME, CLUSTER_ENTITY_ID, ZONE_NAME, ZONE_ENTITY_ID, IMAGE_NAME, IMAGE_ENTITY_ID, HOST_ENTITY_NAME, HOST_ENTITY_ID, HOST_IP, SPEC_ENTITY_ID, SPEC_NAME, TYPE, CREATE_BY, CREATE_DATE, LAST_MODIFIED_BY, LAST_MODIFIED_DATE)
          select #{statTime},ID, MEMBER_ID, CPUS, DUE, IP, SPEC_ID, MANAGED_BY, MEMORY,vol.DISK_SUM ,NAME, PROJECT_ID, APP_SYSTEM_ID, APP_SUB_SYSTEM_ID, APP_DU_ID, SERVICE_ACCOUNT_ID, OWNED_BY, SN, INSTALL_STATUS, ENTITY_ID, OS, OS_FAMILY, HOST_ID, RUN_STATUS, HOSTNAME, CLOUD_ACCOUNT_ID, CLOUD_ACCOUNT_NAME, LDC_TYPE, LDC_ID, LDC_NAME, LDC_ENTITY_ID, CLUSTER_NAME, CLUSTER_ENTITY_ID, ZONE_NAME, ZONE_ENTITY_ID, IMAGE_NAME, IMAGE_ENTITY_ID, HOST_ENTITY_NAME, HOST_ENTITY_ID, HOST_IP, SPEC_ENTITY_ID, SPEC_NAME, TYPE, null, CREATE_DATE, null, LAST_MODIFIED_DATE from cj_cmp_vm_view vm left outer join (select SERVICE_ACCOUNT_ID as saId,VM_DEVICE_ID as vmId,sum(ifnull(DISK_SPACE,0)) DISK_SUM from CJ_CMP_VM_VOLUME where IS_DELETED=0 group by SERVICE_ACCOUNT_ID,VM_DEVICE_ID) vol on vol.saId=SERVICE_ACCOUNT_ID and vol.vmId=vm.ID;
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_DC_VIEW.xml
> sql统计:复杂1个，简单4个
>
> 使用的关键字：if,concat,AND
#### getDataCenterByServiceAccountId
```

        select dc.ID, if(vdc.NAME is null, dc.NAME, concat(dc.NAME, '(', vdc.NAME, ')')) as NAME, dc.SERVICE_ACCOUNT_ID, dc.ENTITY_ID,
               account.ID AS CLOUD_ACCOUNT_DC_ID, account.CLOUD_ACCOUNT_ID,dc.ID as LDC_ID, sa.DATACENTER_TYPE as LDC_TYPE
        from CJ_CMP_DC_VIEW dc inner join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID=dc.SERVICE_ACCOUNT_ID and sa.IS_DELETED=0
        left join CJ_CMP_FUSION_CLOUD_VDC vdc on dc.VDC_ID = vdc.ID and vdc.IS_DELETED = 0
        left outer join CJ_CMP_CLOUD_ACCOUNT_DC account ON dc.ID = account.LDC_ID and sa.ID=account.SERVICE_ACCOUNT_ID and account.IS_DELETED=0
        WHERE sa.DATACENTER_TYPE  =#{dcType} AND (sa.ID =#{serviceAccountId} or sa.PARENT_ID = #{serviceAccountId})
        <if test="cloudAccountId!='' and cloudAccountId != null">
            AND account.CLOUD_ACCOUNT_ID = #{cloudAccountId}
        </if>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_DEV_X_NETWORK.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_ENV_BACKUP_INFO.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：CJ_CMP_ENV_BACKUP_INFO,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_ENV_BACKUP_RECORD.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：now,CJ_CMP_ENV_BACKUP_RECORD,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_ENV_BACKUP_RECORD_DM.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：CONCAT

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_F5_DEVICE.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：CJ_CMP_F5_DEVICE,values,CONCAT,now,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_F5_DEVICE_GROUP.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：NOW,CJ_CMP_F5_DEVICE_GROUP,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_F5_MONITOR.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：now,CJ_CMP_F5_MONITOR,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_F5_NODE.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：NOW,CJ_CMP_F5_NODE,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_F5_PARTITION.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：now,NOW,CJ_CMP_F5_PARTITION,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_F5_POOL.xml
> sql统计:复杂1个，简单6个
>
> 使用的关键字：where,in,group_concat,now,NOW,CJ_CMP_F5_POOL,values
#### queryList
```

        select pool.*, sa.DATACENTER_TYPE as serviceAccountType ,part.NAME as partitionName, device.NAME as deviceName, group_concat(deviceGroup.NAME) as deviceGroupName
        from CJ_CMP_F5_POOL pool LEFT JOIN CJ_CMP_F5_PARTITION part on pool.PARTITION_ID = part.ID AND pool.SERVICE_ACCOUNT_ID = part.SERVICE_ACCOUNT_ID and part.IS_DELETED = 0
        and pool.MEMBER_ID = part.MEMBER_ID
        inner join CJ_CMP_F5_DEVICE device on pool.DEVICE_ID = device.ID
        inner join CJ_CMP_SERVICE_ACCOUNT sa on pool.SERVICE_ACCOUNT_ID = sa.ID
        left join CJ_CMP_F5_DEVICE_GROUP_X_DEVICE rel on pool.DEVICE_ID = rel.DEVICE_ID
        left join CJ_CMP_F5_DEVICE_GROUP deviceGroup on rel.DEVICE_GROUP_ID = deviceGroup.ID
        WHERE pool.IS_DELETED = 0
        <if test="id != null and id !=''">
            and  pool.ID =#{id}
        </if>
        <if test="serviceAccountId != null and serviceAccountId !=''">
            and  pool.SERVICE_ACCOUNT_ID =#{serviceAccountId}
        </if>
        <if test="deviceId != null and deviceId !=''">
            and  pool.DEVICE_ID =#{deviceId}
        </if>
        <if test="partitionId != null and partitionId !=''">
            and  pool.PARTITION_ID =#{partitionId}
        </if>
        group by pool.ID, part.NAME, device.NAME
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_F5_POOL_MEMBER.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CMP_F5_POOL_MEMBER,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_F5_PROFILE.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：values,now,CJ_CMP_F5_PROFILE

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_F5_SNAT_POOL.xml
> sql统计:复杂1个，简单6个
>
> 使用的关键字：values,group_concat,now,CJ_CMP_F5_SNAT_POOL
#### list
```

    select pool.*, part.NAME as partitionName, device.NAME as deviceName, group_concat(deviceGroup.NAME) as deviceGroupName from CJ_CMP_F5_SNAT_POOL pool
      left join CJ_CMP_F5_PARTITION part on pool.PARTITION_ID = part.ID
      inner join CJ_CMP_F5_DEVICE device on pool.DEVICE_ID = device.ID
      left join CJ_CMP_F5_DEVICE_GROUP_X_DEVICE rel on pool.DEVICE_ID = rel.DEVICE_ID
      left join CJ_CMP_F5_DEVICE_GROUP deviceGroup on rel.DEVICE_GROUP_ID = deviceGroup.ID
    where pool.IS_DELETED = 0
    <if test="serviceAccountId != null and serviceAccountId !=''">
      and  pool.SERVICE_ACCOUNT_ID =#{serviceAccountId}
    </if>
    <if test="deviceId != null and deviceId !=''">
      and  pool.DEVICE_ID =#{deviceId}
    </if>
    group by pool.ID, part.NAME, device.NAME
  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_F5_SNAT_POOL_MEMBER.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：now,CJ_CMP_F5_SNAT_POOL_MEMBER,values,in

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_F5_VS.xml
> sql统计:复杂1个，简单11个
>
> 使用的关键字：group_concat,count,DATE,NOW,where,now,CJ_CMP_F5_VS,values,in
#### queryList
```

        select vs.*, ip.IP as ip, part.NAME as partitionName, device.NAME as deviceName, group_concat(deviceGroup.NAME) as deviceGroupName
        from CJ_CMP_F5_VS vs INNER JOIN CJ_CMP_F5_VS_IP ip ON vs.ID = ip.VIRTUAL_SERVER_ID LEFT JOIN CJ_CMP_F5_PARTITION part on part.ID = vs.PARTITION_ID
        inner join CJ_CMP_F5_DEVICE device on vs.DEVICE_ID = device.ID
        left join CJ_CMP_F5_DEVICE_GROUP_X_DEVICE rel on vs.DEVICE_ID = rel.DEVICE_ID
        left join CJ_CMP_F5_DEVICE_GROUP deviceGroup on rel.DEVICE_GROUP_ID = deviceGroup.ID
        WHERE  vs.IS_DELETED = 0
        <if test="serviceAccountId != null and serviceAccountId !=''">
          and  vs.SERVICE_ACCOUNT_ID =#{serviceAccountId}
        </if>
        <if test="deviceId != null and deviceId !=''">
          and  vs.DEVICE_ID =#{deviceId}
        </if>
        <if test="snatPoolId != null and snatPoolId !=''">
            and  vs.SNAT_POOL_ID =#{snatPoolId}
        </if>
        group by vs.ID, ip.ip, part.NAME, device.NAME
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_FROZEN_RESOURCE_MAPPER.xml
> sql统计:复杂1个，简单4个
>
> 使用的关键字：sum,now,CJ_CMP_FROZEN_RESOURCE,values,ifnull
#### selectByFrozenResourceByType
```

    select
    ifnull(sum(ifnull(frozen.CPU,0)),0) as cpu,
    ifnull(sum(ifnull(frozen.MEMORY,0)),0) as memory,
    ifnull(sum(ifnull(frozen.STORAGE,0)),0) as storage,
    ifnull(sum(ifnull(frozen.VM_INSTANCE,0)),0) as vmInstance,
    ifnull(sum(ifnull(frozen.PM_INSTANCE,0)),0) as pmInstance
    from CJ_CMP_FROZEN_RESOURCE frozen where FROZEN_RESOURCE_ID = #{frozenResourceId} and FROZEN_RESOURCE_TYPE = #{frozenResourceType} and MEMBER_ID = #{memberId} and IS_DELETED = 0
  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSIONCLOUD_DC.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_ACCESS_CLUSTER.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：and,size,now,CJ_CMP_FUSION_ACCESS_CLUSTER,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_ACCESS_DATASTORE.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：and,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_ACCESS_DC.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：CJ_CMP_FUSION_ACCESS_DC,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_ACCESS_DESKTOP.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：now,CJ_CMP_FUSION_ACCESS_DESKTOP,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_ACCESS_DESKTOP_GROUP.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：count,and,now,CJ_CMP_FUSION_ACCESS_DESKTOP_GROUP,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_ACCESS_DOMAIN.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：count,now,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_ACCESS_DOMAIN_OU.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：values,now,CJ_CMP_FUSION_ACCESS_DOMAIN_OU

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_ACCESS_PORT_GROUP.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：and,now,CJ_CMP_FUSION_ACCESS_PORT_GROUP,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_ACCESS_RESOURCE_GROUP.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：and,now,CJ_CMP_FUSION_ACCESS_RESOURCE_GROUP,values,count

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_ACCESS_SECURITY_GROUP.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：now,CJ_CMP_FUSION_ACCESS_SECURITY_GROUP,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_ACCESS_VMNAME_POLICY.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：now,CJ_CMP_FUSION_ACCESS_VMNAME_POLICY,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_ACCESS_VM_INSTANCE.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：sum,now,CJ_CMP_FUSION_ACCESS_VM_INSTANCE,values,from,and,in,JOIN,count,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_ACCESS_VM_USER.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：now,CJ_CMP_FUSION_ACCESS_VM_USER,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CCE_CLUSTER.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：and,now,NOW,CJ_CMP_FUSION_CCE_CLUSTER,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CCE_DC.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：now,NOW,CJ_CMP_FUSION_CCE_DC,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CLOUD_BMS_FLAVOR.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：now,CJ_CMP_FUSION_CLOUD_BMS_FLAVOR,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CLOUD_BMS_INSTANCE.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：now,CJ_CMP_FUSION_CLOUD_BMS_INSTANCE,VALUES,on,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CLOUD_ECS.xml
> sql统计:复杂1个，简单30个
>
> 使用的关键字：GROUP_CONCAT,if,count,in,sum,now,NOW,and
#### getAllByCondition
```

        select ecs.*,prj.CODE as projectCode,prj.NAME as projectName,prj.PROJECT_SOURCE_ID as projectSourceId,
        app.CODE as appSystemCode,app.NAME as appSystemName,app.SOURCE_ID as appSystemSourceId, GROUP_CONCAT(tag.NAME) as tags
        from CJ_CMP_FUSION_CLOUD_ECS ecs
          <if test="srvCompletionTimeStart!=null or srvCompletionTimeEnd!=null ">
          left outer join CJ_CMP_RITM_COMPLETED_VIEW req on ecs.SRV_NO=req.NUMBER
          </if>
          left outer join CJ_CMP_PROJECT prj on prj.ID=ecs.PROJECT_ID
          left outer join CJ_CMP_APP_SYSTEM app on app.ID=ecs.APP_SYSTEM_ID
          left outer join CJ_CMP_APP_DU du on du.ID=ecs.APP_DU_ID
          left outer join CJ_CMP_TAG_X_OBJECT txo on ecs.ID = txo.OBJECT_ID and txo.OBJECT_TYPE = 'fusionCloud'
          left outer join CJ_CMP_TAG tag on tag.ID = txo.TAG_ID and tag.IS_DELETED = 0
        <where>
            <if test="memberId != 0"> and ecs.MEMBER_ID = #{memberId}</if>
            <if test="startTime!=null and  endTime!=null ">
                and ecs.CREATE_DATE between #{startTime,jdbcType= TIMESTAMP} and  #{endTime,jdbcType= TIMESTAMP}
            </if>
            <if test="startTime==null   and  endTime!=null ">
                and ecs.CREATE_DATE &lt;=  #{endTime,jdbcType= TIMESTAMP}
            </if>
            <if test="startTime!=null  and  endTime==null ">
                and ecs.CREATE_DATE &gt;=  #{startTime,jdbcType= TIMESTAMP}
            </if>
            <if test="srvCompletionTimeStart!=null and srvCompletionTimeEnd!=null ">
                and if(ecs.IS_DELETED=1,ecs.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) between #{srvCompletionTimeStart,jdbcType= TIMESTAMP} and  #{srvCompletionTimeEnd,jdbcType= TIMESTAMP}
            </if>
            <if test="srvCompletionTimeStart==null and srvCompletionTimeEnd!=null ">
                and if(ecs.IS_DELETED=1,ecs.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) &lt;=  #{srvCompletionTimeEnd,jdbcType= TIMESTAMP}
            </if>
            <if test="srvCompletionTimeStart!=null and srvCompletionTimeEnd==null ">
                and if(ecs.IS_DELETED=1,ecs.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) &gt;=  #{srvCompletionTimeStart,jdbcType= TIMESTAMP}
            </if>
            <if  test="isDeleted != null ">
                <choose>
                    <when test="isDeleted">
                        and ecs.IS_DELETED=1
                    </when>
                    <otherwise>
                        and ecs.IS_DELETED=0
                    </otherwise>
                </choose>
            </if>
        </where>
        GROUP BY ecs.ID
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CLOUD_HOST.xml
> sql统计:复杂3个，简单7个
>
> 使用的关键字：and,in,count,sum,round,if,NOW,group_concat
#### queryHost
```

        select host.ID,host.NAME ,host.IP,host.ENTITY_ID,host.CPUS,host.CPU_USED,host.SN,host.VIRTUAL_CPU_TOTAL,host.VIRTUAL_MEMORY_MB_TOTAL,host.MEMORY_SUM, host.MEMORY_USED,host.VIRTUAL_MEMORY_MB_USED, host.MEMORY_PROVISIONED, host.DISK_PROVISIONED,host.DISK_SUM,host.DISK_USED,host.STATUS,host.RUN_STATUS , group_concat(distinct az.NAME) as zoneName, cdc.LDC_TYPE, group_concat(distinct dc.NAME) as ldcName, ca.ID as cloudAccountId,ca.NAME AS cloudAccountName,sa.NAME AS serviceAccountName, sa.ID AS serviceAccountId
        from CJ_CMP_CLOUD_ACCOUNT ca
        inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc on ca.ID=cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED=0 and cdc.LDC_TYPE='fusionCloud'
        inner join CJ_CMP_FUSION_CLOUD_DC dc on cdc.LDC_ID=dc.ID and cdc.IS_DELETED=0 and dc.IS_DELETED=0
        INNER JOIN CJ_CMP_SERVICE_ACCOUNT sa ON cdc.SERVICE_ACCOUNT_ID = sa.ID AND sa.IS_DELETED=0
        inner join CJ_CMP_FUSION_CLOUD_DC_X_AZ rel on rel.LDC_ID = cdc.LDC_ID 
        inner join CJ_CMP_CLOUD_AZ az on az.ID=rel.AZ_ID and az.IS_DELETED = 0 and az.NAME != 'manage-az'
        inner join CJ_CMP_FUSION_CLOUD_HOST host on host.ZONE_ID=az.ID and host.IS_DELETED=0
        <where>
            <choose>
                <when test="memberId != 0">
                    and ca.MEMBER_ID = #{memberId}
                </when>
                <otherwise>
                    and ca.SCOPE = 'public'
                </otherwise>
            </choose>
            <if test="id != null and id != ''"> and host.ID=#{id}</if>
            <if test="serviceAccountId != null and serviceAccountId != ''"> and cdc.SERVICE_ACCOUNT_ID=#{serviceAccountId}</if>
            <if test="cloudAccountId != null and cloudAccountId != ''"> and ca.ID=#{cloudAccountId}</if>
            <if test="ldcId != null and ldcId != ''"> and dc.ID=#{ldcId}</if>
            <if test="name != null and name != ''"> and host.NAME like #{name}</if>
            <if test="ip != null and ip != ''"> and host.IP like #{ip}</if>
            <if test="searchKey != null and searchKey != ''"> and (host.NAME like #{searchKey} or host.IP like #{searchKey} or host.ENTITY_ID like #{searchKey})</if>
        </where>
        group by host.ID,host.NAME,host.IP,host.ENTITY_ID,host.CPUS,host.CPU_USED,host.VIRTUAL_MEMORY_MB_TOTAL,host.MEMORY_SUM, host.MEMORY_USED,host.VIRTUAL_MEMORY_MB_USED,host.DISK_SUM,host.DISK_USED,host.STATUS,host.RUN_STATUS, cdc.LDC_TYPE,ca.ID,ca.NAME,sa.NAME, sa.ID
    
```
#### statisticHostByServiceAccoutId
```

        select
            count(0)                                                                                      as hostSum,
            sum(host.CPUS)                                                                                as cpus,
            sum(host.CPU_USED)                                                                            as cpuUsed,
            round(if(sum(host.CPUS) = 0, 0, sum(host.CPU_USED) / sum(host.CPUS)), 2) * 100                as cpuUsage,
            sum(host.VIRTUAL_MEMORY_MB_USED)                                                                         as memoryUsed,
            sum(host.VIRTUAL_MEMORY_MB_TOTAL)                                                                          as memorySum,
            round(if(sum(host.VIRTUAL_MEMORY_MB_TOTAL) = 0, 0, sum(host.VIRTUAL_MEMORY_MB_USED) / sum(host.VIRTUAL_MEMORY_MB_TOTAL)), 2) * 100 as memoryUsage
        from CJ_CMP_FUSION_CLOUD_HOST host
        where SERVICE_ACCOUNT_ID = #{serviceAccountId} AND IS_DELETED = 0;
    
```
#### statisticHostByCloudAccoutId
```

        select
            count(0)                                                                                      as hostSum,
            sum(host.CPUS)                                                                                as cpus,
            sum(host.CPU_USED)                                                                            as cpuUsed,
            round(if(sum(host.CPUS) = 0, 0, sum(host.CPU_USED) / sum(host.CPUS)), 2) * 100                as cpuUsage,
            sum(host.VIRTUAL_MEMORY_MB_USED)                                                                         as memoryUsed,
            sum(host.VIRTUAL_MEMORY_MB_TOTAL)                                                                          as memorySum,
            round(if(sum(host.VIRTUAL_MEMORY_MB_TOTAL) = 0, 0, sum(host.VIRTUAL_MEMORY_MB_USED) / sum(host.VIRTUAL_MEMORY_MB_TOTAL)), 2) * 100 as memoryUsage
        from CJ_CMP_FUSION_CLOUD_HOST host
        where SERVICE_ACCOUNT_ID in(select adc.SERVICE_ACCOUNT_ID
                                    from CJ_CMP_CLOUD_ACCOUNT_DC adc inner join CJ_CMP_CLOUD_ACCOUNT ca on adc.CLOUD_ACCOUNT_ID = ca.ID
                                    where adc.CLOUD_ACCOUNT_ID = #{cloudAccountId} AND adc.IS_DELETED = 0
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>) AND IS_DELETED = 0;
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CLOUD_NETWORK.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：values,count,and,in,CONCAT,NOW,where

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CLOUD_NETWORK_PORT.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：NOW,where

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CLOUD_NETWORK_SUBNET.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：ISNULL,CONCAT,NOW,where,values,IF

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CLOUD_OBS_BUCKET.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CMP_FUSION_CLOUD_OBS_BUCKET,VALUES,on,and,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CLOUD_SECURITY_GROUP.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CLOUD_SFS_SHARE.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：and,now,CJ_CMP_FUSION_CLOUD_SFS_SHARE,VALUES,on

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CLOUD_SFS_SHARE_ACL.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：now,CJ_CMP_FUSION_CLOUD_SFS_SHARE_ACL,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CLOUD_STORAGE.xml
> sql统计:复杂4个，简单7个
>
> 使用的关键字：sum,round,if,and,NOW,in
#### statisticDataStoreByServiceAccoutId
```

        SELECT
        sum(da.DISK_SUM)  as DISK_SUM,
        sum(da.DISK_SUM - da.DISK_FREE) as DISK_USED,
        round(if(sum(da.DISK_SUM) = 0, 0, sum(da.DISK_SUM - da.DISK_FREE) / sum(da.DISK_SUM)), 2) * 100 as DISK_USAGE
        FROM CJ_CMP_FUSION_CLOUD_STORAGE da
        where SERVICE_ACCOUNT_ID = #{serviceAccountId} AND IS_DELETED = 0;
    
```
#### statisticDataStoreByCloudAccoutId
```

        SELECT
        sum(da.DISK_SUM)  as DISK_SUM,
        sum(da.DISK_SUM - da.DISK_FREE) as DISK_USED,
        round(if(sum(da.DISK_SUM) = 0, 0, sum(da.DISK_SUM - da.DISK_FREE) / sum(da.DISK_SUM)), 2) * 100 as DISK_USAGE
        FROM CJ_CMP_FUSION_CLOUD_STORAGE da
        where SERVICE_ACCOUNT_ID in (select adc.SERVICE_ACCOUNT_ID
                                      from CJ_CMP_CLOUD_ACCOUNT_DC adc inner join CJ_CMP_CLOUD_ACCOUNT ca on adc.CLOUD_ACCOUNT_ID = ca.ID
                                      where adc.CLOUD_ACCOUNT_ID = #{cloudAccountId} AND adc.IS_DELETED = 0
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>) AND IS_DELETED = 0;
    
```
#### statisticDataStoreTypeBySaId
```

        select
        TYPE,
        SERVICE_ACCOUNT_ID,
        sum(DISK_SUM)             as DISK_SUM,
        sum(DISK_FREE)            as DISK_FREE,
        sum(DISK_SUM - DISK_FREE) as DISK_USED,
        sum(PROVISIONED)          as PROVISIONED,
        round(if(sum(DISK_SUM) = 0, 0, sum(DISK_SUM - DISK_FREE) / sum(DISK_SUM)), 2) * 100 as DISK_USAGE
        from CJ_CMP_FUSION_CLOUD_STORAGE
        where SERVICE_ACCOUNT_ID = #{serviceAccountId}
        group by TYPE, SERVICE_ACCOUNT_ID, MEMBER_ID
    
```
#### statisticDataStoreTypeByCaId
```

        select
            TYPE,
            SERVICE_ACCOUNT_ID,
            sum(DISK_SUM)                                                                       as DISK_SUM,
            sum(DISK_FREE)                                                                      as DISK_FREE,
            sum(DISK_SUM - DISK_FREE)                                                           as DISK_USED,
            sum(PROVISIONED)                                                                    as PROVISIONED,
            round(if(sum(DISK_SUM) = 0, 0, sum(DISK_SUM - DISK_FREE) / sum(DISK_SUM)), 2) * 100 as DISK_USAGE
        from CJ_CMP_FUSION_CLOUD_STORAGE
        where SERVICE_ACCOUNT_ID in (select adc.SERVICE_ACCOUNT_ID
                                      from CJ_CMP_CLOUD_ACCOUNT_DC adc inner join CJ_CMP_CLOUD_ACCOUNT ca on adc.CLOUD_ACCOUNT_ID = ca.ID
                                      where adc.CLOUD_ACCOUNT_ID = #{cloudAccountId} AND adc.IS_DELETED = 0
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>)
        group by TYPE, SERVICE_ACCOUNT_ID, MEMBER_ID
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CLOUD_VDC.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_CLOUD_VPC.xml
> sql统计:复杂1个，简单4个
>
> 使用的关键字：CONCAT,NOW,where,in,if,group_concat,on,and
#### selectDetailById
```

     select fvpc.ID,fvpc.MEMBER_ID,fvpc.ENTITY_ID,fvpc.SERVICE_ACCOUNT_ID,fvpc.NAME,fvpc.LDC_ID,fcdc.LDC_TYPE,fvpc.CIDR as CIDR_BLOCK,'可用' as statusName,
     fsa.TYPE as sAccountType,fvpc.CREATE_BY,fvpc.CREATE_DATE,fvpc.LAST_MODIFIED_BY,fvpc.LAST_MODIFIED_DATE,
     fsa.NAME as sAccountName,fdc.NAME as ldcName,if(EXTERNAL_GATEWAY_NETWORK_ENTITY_ID is null,0,1) as isExternal,
     (select group_concat(az.NAME) from CJ_CMP_FUSION_CLOUD_VPC_X_AZ x,CJ_CMP_CLOUD_AZ az where x.AZ_ID=az.ID and az.IS_DELETED=0 and x.VPC_ID=#{id}) as azNames
     from CJ_CMP_SERVICE_ACCOUNT fsa
     inner join CJ_CMP_FUSION_CLOUD_DC fdc on fdc.SERVICE_ACCOUNT_ID=fsa.ID and fsa.IS_DELETED=0 and fdc.IS_DELETED=0
     inner join CJ_CMP_CLOUD_ACCOUNT_DC fcdc on fcdc.LDC_TYPE = 'fusionCloud' and fcdc.LDC_ID=fdc.ID and fcdc.IS_DELETED=0
     inner join CJ_CMP_CLOUD_ACCOUNT fca on fcdc.CLOUD_ACCOUNT_ID=fca.ID and fca.IS_DELETED=0
     inner join CJ_CMP_FUSION_CLOUD_VPC fvpc on fvpc.LDC_ID=fdc.ID and fvpc.IS_DELETED=0
     where fvpc.ID=#{id}
      <choose>
          <when test="memberId != 0">
              and fca.MEMBER_ID = #{memberId}
          </when>
          <otherwise>
              and fca.SCOPE = 'public'
          </otherwise>
      </choose>
  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_COMPUTE_CLUSTER.xml
> sql统计:复杂1个，简单6个
>
> 使用的关键字：values,round,ceil,ifnull,and,size,NOW,CJ_CMP_FUSION_COMPUTE_CLUSTER
#### queryCluster
```

    select clu.ID,
    clu.NAME,
    clu.ENTITY_ID,
    clu.CPU_SUM,
    clu.CPU_USED,
    round((clu.CPU_USED / clu.CPU_SUM) * 100, 2)                                                       as cpuUsage,
    ceil(ifnull(clu.MEMORY_SUM, 0) / 1024)                                                             as memorySum,
    ceil(ifnull(clu.MEMORY_USED, 0) / 1024)                                                            as memoryUsed,
    round((ceil(ifnull(clu.MEMORY_USED, 0) / 1024) / ceil(ifnull(clu.MEMORY_SUM, 0) / 1024)) * 100,
    2)                                                                                           as memoryUsage,
    cdc.LDC_ID,
    cdc.LDC_TYPE,
    dc.ENTITY_ID                                                                                       as ldcEntityId,
    dc.NAME                                                                                            as ldcName,
    sa.NAME                                                                                            as serviceAccountName,
    sa.ID                                                                                              as serviceAccountId
    from CJ_CMP_SERVICE_ACCOUNT sa
    inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc on sa.ID = cdc.SERVICE_ACCOUNT_ID and sa.IS_DELETED = 0 AND cdc.IS_DELETED=0
    inner join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED = 0
    inner join CJ_CMP_FUSION_COMPUTE_DC dc on cdc.LDC_ID = dc.ID and dc.IS_DELETED = 0 and dc.SERVICE_ACCOUNT_ID=sa.ID
    left outer join CJ_CMP_FUSION_COMPUTE_CLUSTER clu on dc.ID = clu.LDC_ID
    left outer join CJ_CMP_FUSION_COMPUTE_HOST host on host.CLUSTER_ID = clu.ID
    where dc.IS_DELETED=0 and clu.IS_DELETED = 0
    <choose>
      <when test="memberId != 0">
        and ca.MEMBER_ID = #{memberId}
      </when>
      <otherwise>
        and ca.SCOPE = 'public'
      </otherwise>
    </choose>
    <if test="clusterId != null and clusterId != ''"> and clu.ID=#{clusterId}</if>
    <if test="serviceAccountId != null and serviceAccountId != ''"> and sa.ID=#{serviceAccountId}</if>
    <if test="cloudAccountId != null and cloudAccountId != ''"> and ca.ID=#{cloudAccountId}</if>
    <if test="ldcId != null and ldcId != ''"> and cdc.LDC_ID=#{ldcId}</if>
    <if test="ldcType != null and ldcType != ''"> and cdc.LDC_TYPE=#{ldcType}</if>
    <if test="searchKey != null and searchKey != ''"> and (clu.NAME like #{searchKey} or clu.ENTITY_ID like #{searchKey})</if>
    <if test="name != null and name != ''"> and clu.NAME like #{name} </if>
    <if test="ldcIds != null and ldcIds.size()>0">
      and cdc.LDC_ID IN <foreach collection="ldcIds" item="ldc" open="(" separator="," close=")"> #{ldc} </foreach>
    </if>
    group by clu.ID, clu.NAME, clu.ENTITY_ID, clu.CPU_SUM, clu.CPU_USED, round((clu.CPU_USED / clu.CPU_SUM) * 100, 2), ceil(ifnull(clu.MEMORY_SUM, 0) / 1024), ceil(ifnull(clu.MEMORY_USED, 0) / 1024), round((ceil(ifnull(clu.MEMORY_USED, 0) / 1024) / ceil(ifnull(clu.MEMORY_SUM, 0) / 1024)) * 100,
    2), cdc.LDC_ID, cdc.LDC_TYPE, dc.ENTITY_ID, dc.NAME, sa.NAME, sa.ID
    <if test="sortField != null and sortField!= '' and sortType != null and sortType!= '' ">
      <choose>
        <when test="sortField == 'cpuUsage' or sortField == 'memoryUsage' or sortField == 'localStorageUsage'">
          ORDER BY ${sortField} ${sortType}
        </when>
        <otherwise>
          order by clu.NAME
        </otherwise>
      </choose>
    </if>
    <if test="sortField == null or sortType == null ">
      order by clu.NAME
    </if>

  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_COMPUTE_DATASTORE.xml
> sql统计:复杂1个，简单6个
>
> 使用的关键字：values,join,group_concat,and,NOW,CJ_CMP_FUSION_COMPUTE_DATASTORE
#### queryDatastore
```

        SELECT ds.ID,ds.SERVICE_ACCOUNT_ID,ds.STATUS,ds.NAME,ds.ENTITY_ID,ds.CAPACITY_GB as DISK_SUM,ds.USED_SIZE_GB as
        DISK_USED,ds.FREE_SIZE_GB as DISK_FREE,ds.STORAGE_TYPE,cdc.LDC_TYPE,cdc.LDC_ID,dc.NAME as ldcName,dc.ENTITY_ID
        as ldcEntityId, sa.NAME as serviceAccountName, store.*
        FROM CJ_CMP_CLOUD_ACCOUNT ca
        inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc on ca.ID=cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED=0 and
        cdc.LDC_TYPE='fusionCompute' AND cdc.IS_DELETED=0
        inner join CJ_CMP_FUSION_COMPUTE_DC dc on cdc.LDC_ID=dc.ID and cdc.IS_DELETED=0 and dc.IS_DELETED=0
        inner join CJ_CMP_SERVICE_ACCOUNT sa on dc.SERVICE_ACCOUNT_ID = sa.ID and sa.IS_DELETED=0
        inner join CJ_CMP_FUSION_COMPUTE_DATASTORE ds ON ds.LDC_ID= dc.ID and
        ds.SERVICE_ACCOUNT_ID=dc.SERVICE_ACCOUNT_ID
        left join
        (
        SELECT group_concat(clu.ID) as CLUSTER_ID, group_concat(host.ID) as HOST_ID, group_concat(clu.NAME) AS
        clusterName , group_concat(clu.ENTITY_ID) clusterEntityId, group_concat(host.NAME) as hostName,
        group_concat(host.ENTITY_ID) as hostEntityId, group_concat(host.IP)as hostIp,dt.ID AS dsId
        FROM CJ_CMP_FUSION_COMPUTE_HOST host LEFT JOIN CJ_CMP_FUSION_COMPUTE_CLUSTER clu ON host.CLUSTER_ID = clu.ID
        inner join CJ_CMP_FUSION_COMPUTE_DATASTORE_X_HOST mou on mou.HOST_ID=host.ID
        inner join CJ_CMP_FUSION_COMPUTE_DATASTORE dt on dt.ID=mou.DATASTORE_ID
        GROUP BY dsId
        ) store ON dsId= ds.ID
        <where>
            <choose>
                <when test="memberId != 0">
                    and ca.MEMBER_ID = #{memberId}
                </when>
                <otherwise>
                    and ca.SCOPE = 'public'
                </otherwise>
            </choose>
            <if test="id != null and id != ''">and ds.ID=#{id}</if>
            <if test="serviceAccountId != null and serviceAccountId != ''">and
                cdc.SERVICE_ACCOUNT_ID=#{serviceAccountId}
            </if>
            <if test="cloudAccountId != null and cloudAccountId != ''">and ca.ID=#{cloudAccountId}</if>
            <if test="ldcId != null and ldcId != ''">and dc.ID=#{ldcId}</if>
            <if test="name != null and name != ''">and ds.NAME like #{name}</if>
            <if test="clusterId != null and clusterId != ''">and store.CLUSTER_ID=#{clusterId}</if>
            <if test="hostId != null and hostId != ''">and store.HOST_ID=#{hostId}</if>
            <if test="entityId != null and entityId != ''">and ds.ENTITY_ID like #{entityId}</if>
            <if test="searchKey != null and searchKey != ''">and (ds.NAME like #{searchKey} or ds.ENTITY_ID like
                #{searchKey} or hostIp like #{searchKey})
            </if>
            <if test="hostIp != null and hostIp != ''">and hostIp like #{hostIp}</if>
        </where>

    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_COMPUTE_DC.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：NOW,CJ_CMP_FUSION_COMPUTE_DC,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_COMPUTE_HOST.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：NOW,CJ_CMP_FUSION_COMPUTE_HOST,values,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_COMPUTE_PORT_GROUP.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：and,CONCAT,IF,ISNULL,NOW,CJ_CMP_FUSION_COMPUTE_PORT_GROUP,values,count

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_COMPUTE_VDS.xml
> sql统计:复杂1个，简单7个
>
> 使用的关键字：CJ_CMP_FUSION_COMPUTE_VDS,from,if,concat,group_concat,and,NOW,count,in,CONCAT,values
#### selectByKeyValueAndServiceAccount
```

    select * from (select  vds.ID,vds.MEMBER_ID,vds.ENTITY_ID,vds.SERVICE_ACCOUNT_ID,
    if(vds.TYPE = 'VSS',concat(vds.NAME, if(group_concat(vmHost.IP) is null, '', concat('[', group_concat(vmHost.IP), ']'))),vds.NAME) as NAME,
           vds.TYPE, vds.LDC_ID,saccount.DATACENTER_TYPE as LDC_TYPE,vds.SHORT_DESCRIPTION as DESCRIPTION, group_concat(vmHost.NAME) as hostName,
    (select count(0) from CJ_CMP_FUSION_COMPUTE_PORT_GROUP vpg where vds.ID = vpg.VDS_ID and vpg.IS_DELETED=0)  as PORT_GROUP_NUM,
    dc.name as ldcName, saccount.NAME as sAccountName
    from CJ_CMP_FUSION_COMPUTE_VDS vds
    inner join CJ_CMP_FUSION_COMPUTE_DC dc on vds.LDC_ID = dc.ID
    inner join CJ_CMP_SERVICE_ACCOUNT saccount on vds.SERVICE_ACCOUNT_ID = saccount.ID
    inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc on cdc.SERVICE_ACCOUNT_ID=saccount.ID and cdc.IS_DELETED=0 and dc.ID = cdc.LDC_ID
    inner join CJ_CMP_CLOUD_ACCOUNT ca on cdc.CLOUD_ACCOUNT_ID = ca.ID and ca.IS_DELETED = 0
    left join CJ_CMP_FUSION_COMPUTE_VDS_X_HOST vdsRel on vds.ID = vdsRel.VDS_ID
    left join CJ_CMP_FUSION_COMPUTE_HOST vmHost on vdsRel.HOST_ID = vmHost.ID
    where vds.IS_DELETED=0
    <choose>
      <when test="memberId != 0">
        and ca.MEMBER_ID = #{memberId}
      </when>
      <otherwise>
        and ca.SCOPE = 'public'
      </otherwise>
    </choose>
    <if test="id != null" >
      and vds.ID = #{id}
    </if>
    <if test="serviceAccountId!=null and serviceAccountId != 'ALL'" >
      and vds.SERVICE_ACCOUNT_ID = #{serviceAccountId}
    </if>
    <if test="cloudAccountId !=null and cloudAccountId != 'ALL'" >
      and vds.LDC_ID in (
      select cadc.LDC_ID from  CJ_CMP_CLOUD_ACCOUNT_DC cadc where cadc.CLOUD_ACCOUNT_ID = #{cloudAccountId}
      )
    </if>
    <if test="ldcId != '' and ldcId != null" >
      and vds.LDC_ID = #{ldcId}
    </if>
    group by vds.ID) t where 1 = 1
    <if test="queryValue != null" >
      <if test="queryValue != ''" >
      <choose>
          <when test="queryKey == 'ALL'" >
              and (
              t.NAME like CONCAT('%',#{queryValue},'%')
              OR t.ENTITY_ID like CONCAT('%',#{queryValue},'%')
              )
          </when>
          <otherwise>
              <if test="queryKey == 'ENTITY_ID'" >
                  and t.ENTITY_ID like CONCAT('%',#{queryValue},'%')
              </if>
              <if test="queryKey == 'NAME'" >
                  and t.NAME like CONCAT('%',#{queryValue},'%')
              </if>
          </otherwise>
      </choose>
      </if>
    </if>

  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_FUSION_COMPUTE_VM.xml
> sql统计:复杂1个，简单19个
>
> 使用的关键字：sum,GROUP_CONCAT,if,now,NOW,CJ_CMP_FUSION_COMPUTE_VM,values,and
#### getAllByCondition
```

      select vm.*,prj.CODE as projectCode,prj.NAME as projectName,prj.PROJECT_SOURCE_ID as projectSourceId,
      app.CODE as appSystemCode,app.NAME as appSystemName,app.SOURCE_ID as appSystemSourceId, GROUP_CONCAT(tag.NAME) as tags
      from CJ_CMP_FUSION_COMPUTE_VM vm
      <if test="srvCompletionTimeStart!=null or srvCompletionTimeEnd!=null ">
      left outer join CJ_CMP_RITM_COMPLETED_VIEW req on vm.SRV_NO=req.NUMBER
      </if>
      left outer join CJ_CMP_PROJECT prj on prj.ID=vm.PROJECT_ID
      left outer join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
      left outer join CJ_CMP_APP_DU du on du.ID=vm.APP_DU_ID
      left outer join CJ_CMP_TAG_X_OBJECT txo on vm.ID = txo.OBJECT_ID and txo.OBJECT_TYPE = 'fusionCompute'
      left outer join CJ_CMP_TAG tag on tag.ID = txo.TAG_ID and tag.IS_DELETED = 0
      <where>
        <if test="memberId != 0"> and vm.MEMBER_ID = #{memberId}</if>
        <if test="startTime!=null and endTime!=null ">
          and vm.CREATE_DATE between #{startTime,jdbcType= TIMESTAMP} and  #{endTime,jdbcType= TIMESTAMP}
        </if>
        <if test="startTime==null and endTime!=null ">
          and vm.CREATE_DATE &lt;=  #{endTime,jdbcType= TIMESTAMP}
        </if>
        <if test="startTime!=null and endTime==null ">
          and vm.CREATE_DATE &gt;=  #{startTime,jdbcType= TIMESTAMP}
        </if>

        <if test="srvCompletionTimeStart!=null and srvCompletionTimeEnd!=null ">
          and if(vm.IS_DELETED=1,vm.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) between #{srvCompletionTimeStart,jdbcType= TIMESTAMP} and  #{srvCompletionTimeEnd,jdbcType= TIMESTAMP}
        </if>
        <if test="srvCompletionTimeStart==null and srvCompletionTimeEnd!=null ">
          and if(vm.IS_DELETED=1,vm.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) &lt;=  #{srvCompletionTimeEnd,jdbcType= TIMESTAMP}
        </if>
        <if test="srvCompletionTimeStart!=null and srvCompletionTimeEnd==null ">
          and if(vm.IS_DELETED=1,vm.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) &gt;=  #{srvCompletionTimeStart,jdbcType= TIMESTAMP}
        </if>

        <if  test="isDeleted != null ">
          <choose>
            <when test="isDeleted">
              and vm.IS_DELETED=1
            </when>
            <otherwise>
              and vm.IS_DELETED=0
            </otherwise>
          </choose>
        </if>
      </where>
      GROUP BY vm.ID
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_IP_OPER_LOG.xml
> sql统计:复杂1个，简单4个
>
> 使用的关键字：if,and,or,CJ_CMP_IP_OPER_LOG,values,now,CONCAT,from
#### queryMemberIpLog
```

    select * from (select ipLog.ID, ipLog.IP_ID, ipLog.IP, ipLog.STATUS, ipLog.USAGE_INFO, ipLog.REMARK, ipLog.DEV_INFO,
    ipLog.OPER_TYPE, ipLog.CREATE_DATE, `member`.NAME as memberName, if(user.name is not null, user.name,
    ipLog.CREATE_BY) as operator, cidr.CIDR_BLOCK, cidr.NAME as cidrBlockName,
    null as devId, null as devType, null as devName, null as appSystemName
    from CJ_CMP_IP_OPER_LOG ipLog
    inner join CJ_CMP_CIDR_BLOCK cidr on ipLog.CIDR_BLOCK_ID = cidr.ID
    inner join ydduc.UC_MEMBER `member` on ipLog.MEMBER_ID = `member`.ID
    left join ydduc.UC_USER user on ipLog.CREATE_BY = user.ID
    <where>
      and `member`.STATUS = 'ENABLED'
      <if test="memberId !=null and memberId !=0">and ipLog.MEMBER_ID = #{memberId}</if>
      <if test="ip != null and ip != ''">and ipLog.IP = #{ip}</if>
      <if test="status != null and status != ''">and ipLog.STATUS = #{status}</if>
      <if test="operator != null and operator != ''">and (user.NAME like CONCAT('%',#{operator},'%') or (ipLog.CREATE_BY = 'sys' and #{showSysLog} = true))</if>
      <if test="startTime != null and startTime != ''">and ipLog.CREATE_DATE &gt;= #{startTime}</if>
      <if test="endTime != null and endTime != ''">and ipLog.CREATE_DATE &lt;= #{endTime}</if>
    </where>
    <if test="sortField != '' and sortField != null">
      order by ipLog.${sortField} ${sortType}
    </if>
    <if test="sortField == '' or sortField == null">
      order by ipLog.ID desc
    </if>) operLog
    <if test="(status == null or status == '') and (operator == null or operator == '')">
      union all
      select devIp.ID, null, devIp.IP, 'unmanage', null, null, null, null, devIp.CREATE_DATE, `member`.NAME as memberName, if(user.name is not null, user.name, devIp.CREATE_BY) as operator, null, null,
      devIp.ID as devId, devIp.TYPE as devType, devIp.NAME as devName, appSystem.NAME as appSystemName
      from CJ_CMP_DEV_IP_VIEW devIp
      left join CJ_CMP_APP_SYSTEM appSystem on devIp.APP_SYSTEM_ID = appSystem.ID and appSystem.IS_DELETED = 0
      inner join ydduc.UC_MEMBER `member` on devIp.MEMBER_ID = `member`.ID
      left join ydduc.UC_USER user on devIp.CREATE_BY = user.ID
      left join CJ_CMP_IP_X_DEV rel on devIp.ID = rel.DEV_ID and devIp.TYPE = rel.DEV_TYPE and devIp.SERVICE_ACCOUNT_ID = rel.SERVICE_ACCOUNT_ID
      where rel.ID is null
      <if test="memberId !=null and memberId !=0">and devIp.MEMBER_ID = #{memberId}</if>
      <if test="ip != '' and ip != null" > and devIp.IP like CONCAT('%',#{ip},'%')</if>
      <if test="startTime != null and startTime != ''">and devIp.CREATE_DATE &gt;= #{startTime}</if>
      <if test="endTime != null and endTime != ''">and devIp.CREATE_DATE &lt;= #{endTime}</if>
    </if>

  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_IP_POOL.xml
> sql统计:复杂12个，简单32个
>
> 使用的关键字：CJ_CMP_IP_POOL,values,FROM,group_concat,from,select,join,and,JOIN,sum,now,inet_aton,round,HEX,INET6_ATON,CONCAT,count,IF,INET_ATON
#### selectInCidrBlock
```

    select * from CJ_CMP_IP_POOL where CIDR_BLOCK_ID = #{cidrBlockId} and MEMBER_ID = #{memberId}
    <if test="ip != '' and ip != null" >
      and IP like CONCAT('%',#{ip},'%')
    </if>
    <if test="status != '' and status != null" >
      and `STATUS` = #{status}
    </if>
    <if test="ipVersion != null and ipVersion == 'IPv6'">order by IP</if>
    <if test="ipVersion != null and ipVersion == 'IPv4'">order by inet_aton(IP)</if>
  
```
#### selectByCidrBlockAndStatus
```

    select ipPool.*,cidr.CIDR_BLOCK as cidrBlock,cidr.DNS as dns,
    cidr.NETMASK as netmask,cidr.GATEWAY as gateway from CJ_CMP_IP_POOL ipPool
    INNER join CJ_CMP_CIDR_BLOCK cidr on ipPool.CIDR_BLOCK_ID = cidr.ID  where ipPool.CIDR_BLOCK_ID = #{cidrBlockId} and ipPool.MEMBER_ID = #{memberId} and ipPool.STATUS = #{status}
    <if test="startIp != null and startIp != ''">
       and inet_aton(ipPool.IP) > inet_aton(#{startIp})
    </if>
    order by inet_aton(ipPool.IP)
    <if test="num != null and num != 0">
      limit #{num}
    </if>
  
```
#### selectByCidrBlockAndStatusFromAvaliableLogicSegment
```

    select ipPool.*,
           cidr.CIDR_BLOCK as cidrBlock,
           cidr.DNS as dns,
           cidr.NETMASK as netmask,
           cidr.GATEWAY as gateway
    from CJ_CMP_IP_POOL ipPool
    inner join CJ_CMP_CIDR_BLOCK cidr on ipPool.CIDR_BLOCK_ID = cidr.ID
    where ipPool.CIDR_BLOCK_ID = #{cidrBlockId}
      and ipPool.MEMBER_ID = #{memberId}
      and ipPool.STATUS = #{status}
      and ipPool.LOGIC_SEGMENT_ID is not null
    <if test="startIp != null and startIp != ''">
      and inet_aton(ipPool.IP) > inet_aton(#{startIp})
    </if>
    order by inet_aton(ipPool.IP)
    <if test="num != null and num != 0">
      limit #{num}
    </if>
  
```
#### selectByLogicSegmentAndStatus
```

    select ipPool.*,cidr.CIDR_BLOCK as cidrBlock,cidr.DNS as dns,
    cidr.NETMASK as netmask,cidr.GATEWAY as gateway from CJ_CMP_IP_POOL ipPool
    INNER join CJ_CMP_CIDR_BLOCK cidr on ipPool.CIDR_BLOCK_ID = cidr.ID
    INNER join CJ_CMP_LOGIC_SEGMENT ls on ipPool.LOGIC_SEGMENT_ID = ls.ID
    where ipPool.LOGIC_SEGMENT_ID = #{logicSegmentId} and ipPool.MEMBER_ID = #{memberId} and ipPool.STATUS = #{status}
    <if test="startIp != null and startIp != ''">
      and inet_aton(ipPool.IP) > inet_aton(#{startIp})
    </if>
    order by inet_aton(ipPool.IP)
    <if test="num != null and num != 0">
      limit #{num}
    </if>
  
```
#### selectIpByCidrBlockId
```

    select * from CJ_CMP_IP_POOL where CIDR_BLOCK_ID = #{cidrBlockId} and MEMBER_ID = #{memberId}
    <if test="ipVersion == 'IPv4'">
      <if test="startIp != null"> and inet_aton(IP) &gt;= inet_aton(#{startIp})</if>
      <if test="endIp != null"> and inet_aton(IP) &lt;= inet_aton(#{endIp})</if>
      order by ID
    </if>
    <if test="ipVersion == 'IPv6'">
      <if test="startIp != null"> and IP &gt;= #{startIp}</if>
      <if test="endIp != null"> and IP &lt;= #{endIp}</if>
      order by IP
    </if>

  
```
#### listIps
```

    SELECT* FROM  (
      SELECT
      ip.ID,
      ip.IP,
      ip.CIDR_BLOCK_ID,
      ip.USAGE_INFO,
      ip.REMARK,
      cidr.CIDR_BLOCK,
      ip.STATUS,
      group_concat( ip.IP_TYPE )as ipType,
      group_concat( rel.DEV_ID ) AS devId,
      group_concat( rel.DEV_TYPE ) AS devType,
      group_concat( dev.NAME ) AS devName,
      group_concat( appSystem.NAME ) AS appSystemName,
      ip.CREATE_BY,
      ip.CREATE_DATE,
      ip.LAST_MODIFIED_BY,
      ip.LAST_MODIFIED_DATE,
      ip.FROZEN_DATE,
      ip.LOGIC_SEGMENT_ID
    FROM CJ_CMP_CIDR_BLOCK cidr
      INNER JOIN CJ_CMP_IP_POOL ip ON ip.CIDR_BLOCK_ID = cidr.ID
      LEFT JOIN CJ_CMP_IP_X_DEV rel ON ip.ID = rel.IP_ID
      LEFT JOIN CJ_CMP_DEV_VIEW dev ON rel.DEV_ID = dev.ID
      AND rel.SERVICE_ACCOUNT_ID = dev.SERVICE_ACCOUNT_ID
      LEFT JOIN CJ_CMP_APP_SYSTEM appSystem ON dev.APP_SYSTEM_ID = appSystem.ID  AND appSystem.IS_DELETED = 0
    <where>
      and ip.MEMBER_ID = #{memberId}
      <if test="ip != '' and ip != null" >
        and ip.IP like CONCAT('%',#{ip},'%')
      </if>
      <if test="cidrBlockId != null" >
        and ip.CIDR_BLOCK_ID = #{cidrBlockId}
      </if>
      <if test="logicSegmentId != null" >
        and ip.LOGIC_SEGMENT_ID = #{logicSegmentId}
      </if>
      <if test="status != '' and status != null" >
        and ip.STATUS = #{status}
      </if>
      <if test="devType != '' and devType != null" >
        and rel.DEV_TYPE = #{devType}
      </if>
      <if test="devName != '' and devName != null" >
        and dev.NAME like CONCAT('%',#{dev.NAME},'%')
      </if>
      <if test="usageInfo != '' and usageInfo != null" >
        and ip.USAGE_INFO like CONCAT('%',#{usageInfo},'%')
      </if>
    </where>
    group by ip.ID order by
    <if test="sortField != '' and sortField != null">
      ip.${sortField} ${sortType},
    </if>
    <if test="orderByIp != null and orderByIp == true">
      inet_aton(ip.IP),
    </if>
    ip.ID) ipPool
    <if test="(status == null or status == '') and (usageInfo == null or usageInfo == '') and cidrBlockId == null and logicSegmentId == null">
      union all
      select devIp.ID, devIp.IP, null, null, null, null, 'unmanage',null, devIp.ID as devId, devIp.TYPE as devType, devIp.NAME as devName, appSystem.NAME as appSystemName,
      devIp.CREATE_BY, devIp.CREATE_DATE, devIp.LAST_MODIFIED_BY, devIp.LAST_MODIFIED_DATE, null,null
      from CJ_CMP_DEV_IP_VIEW devIp
      left join CJ_CMP_APP_SYSTEM appSystem on devIp.APP_SYSTEM_ID = appSystem.ID and appSystem.IS_DELETED = 0
      left join CJ_CMP_IP_X_DEV rel on devIp.ID = rel.DEV_ID and devIp.TYPE = rel.DEV_TYPE and devIp.SERVICE_ACCOUNT_ID = rel.SERVICE_ACCOUNT_ID
      where rel.ID is null and devIp.MEMBER_ID = #{memberId}
      <if test="ip != '' and ip != null" >
        and devIp.IP like CONCAT('%',#{ip},'%')
      </if>
      <if test="devName != '' and devName != null" >
        and devIp.NAME like CONCAT('%',#{dev.NAME},'%')
      </if>
    </if>
  
```
#### pagePoolIps
```

    SELECT
      ip.ID,
      ip.IP,
      ip.CIDR_BLOCK_ID,
      ip.USAGE_INFO,
      ip.REMARK,
      cidr.CIDR_BLOCK,
      ip.STATUS,
      group_concat( ip.IP_TYPE )as ipType,
      group_concat( rel.DEV_ID ) AS devId,
      group_concat( rel.DEV_TYPE ) AS devType,
      group_concat( dev.NAME ) AS devName,
      group_concat( appSystem.NAME ) AS appSystemName,
      ip.CREATE_BY,
      ip.CREATE_DATE,
      ip.LAST_MODIFIED_BY,
      ip.LAST_MODIFIED_DATE,
      ip.FROZEN_DATE,
      ip.LOGIC_SEGMENT_ID,
      CONCAT('poolIP-', ip.ID) uniqueIndex,
      'poolIP' AS ipSource
    FROM (select * from CJ_CMP_IP_POOL ipPool
          <where>
            <if test="ip != null" >
              and ipPool.IP like CONCAT('%',#{ip},'%')
            </if>
            <if test="cidrBlockId != null" >
              and ipPool.CIDR_BLOCK_ID = #{cidrBlockId}
            </if>
            <if test="logicSegmentId != null" >
              and ipPool.LOGIC_SEGMENT_ID = #{logicSegmentId}
            </if>
            <if test="status != null" >
              and ipPool.STATUS = #{status}
            </if>
            <if test="ipType != null" >
              and ipPool.IP_TYPE = #{ipType}
            </if>
            <if test="usageInfo != null" >
              and ipPool.USAGE_INFO like CONCAT('%',#{usageInfo},'%')
            </if>
            and ipPool.MEMBER_ID = #{memberId}
          </where>
          <if test="ip == null and cidrBlockId == null and logicSegmentId == null and status == null and usageInfo == null and devType == null and devName == null" >
            order by
            <if test="sortField != '' and sortField != null">
              ipPool.${sortField} ${sortType},
            </if>
            <if test="orderByIp != null and orderByIp == true">
              inet_aton(ipPool.IP),
            </if>
            ipPool.ID
            <if test="offset != 0 or limit != 0">
                limit #{offset}, #{limit}
            </if>
          </if>
    ) ip
    LEFT JOIN CJ_CMP_CIDR_BLOCK cidr ON ip.CIDR_BLOCK_ID = cidr.ID
    LEFT JOIN (select * from CJ_CMP_IP_X_DEV ipDev
                <where>
                  <if test="devType != null" >
                    and ipDev.DEV_TYPE = #{devType}
                  </if>
                </where>
    ) rel ON ip.ID = rel.IP_ID
    LEFT JOIN (select * from CJ_CMP_DEV_VIEW devView
                <where>
                  <if test="devName != '' and devName != null" >
                    and devView.NAME like CONCAT('%',#{dev.NAME},'%')
                  </if>
                </where>
    ) dev ON rel.DEV_ID = dev.ID AND rel.SERVICE_ACCOUNT_ID = dev.SERVICE_ACCOUNT_ID
    LEFT JOIN CJ_CMP_APP_SYSTEM appSystem ON dev.APP_SYSTEM_ID = appSystem.ID AND appSystem.IS_DELETED = 0
    group by ip.ID
    <if test="ip != null or cidrBlockId != null or logicSegmentId != null or status != null or usageInfo != null or devType != null or devName != null" >
      order by
      <if test="sortField != '' and sortField != null">
        ip.${sortField} ${sortType},
      </if>
      <if test="orderByIp != null and orderByIp == true">
        inet_aton(ip.IP),
      </if>
      ip.ID
      <if test="offset != 0 or limit != 0">
        limit #{offset}, #{limit}
      </if>
    </if>
  
```
#### pageDevIps
```

      select devIp.ID, devIp.IP, null, null, null, null, 'unmanage',null, devIp.ID as devId, devIp.TYPE as devType,
      devIp.NAME as devName, appSystem.NAME as appSystemName,
      devIp.CREATE_BY, devIp.CREATE_DATE, devIp.LAST_MODIFIED_BY, devIp.LAST_MODIFIED_DATE, null, null, CONCAT('devIP-', devIp.uniqueIndex) uniqueIndex, 'devIP' as ipSource
      from (
        select @index := @index + 1 as `uniqueIndex`, devView.* from
        (select * from CJ_CMP_DEV_IP_VIEW) devView,
        (select @index := 0) indexId
      ) devIp
      left join CJ_CMP_APP_SYSTEM appSystem on devIp.APP_SYSTEM_ID = appSystem.ID and appSystem.IS_DELETED = 0
      left join CJ_CMP_IP_X_DEV rel on devIp.ID = rel.DEV_ID and devIp.TYPE = rel.DEV_TYPE and devIp.SERVICE_ACCOUNT_ID = rel.SERVICE_ACCOUNT_ID
      where rel.ID is null and devIp.MEMBER_ID = #{memberId}
      <if test="ip != '' and ip != null">
        and devIp.IP like CONCAT('%',#{ip},'%')
      </if>
      <if test="devName != '' and devName != null">
        and devIp.NAME like CONCAT('%',#{dev.NAME},'%')
      </if>
      order by
      <if test="sortField != '' and sortField != null">
        devIp.${sortField} ${sortType},
      </if>
      <if test="orderByIp != null and orderByIp == true">
        inet_aton(devIp.IP),
      </if>
      devIp.ID
      <if test="offset != 0 or limit != 0">
        limit #{offset}, #{limit}
      </if>
  
```
#### pageIpCount
```

    SELECT * FROM (
        SELECT count(ip1.ID) FROM (SELECT ip.ID
        FROM (select * from CJ_CMP_IP_POOL ipPool
              <where>and ipPool.MEMBER_ID = #{memberId}
                <if test="ip != null" >
                and ipPool.IP like CONCAT('%',#{ip},'%')
                </if>
                <if test="cidrBlockId != null" >
                  and ipPool.CIDR_BLOCK_ID = #{cidrBlockId}
                </if>
                <if test="logicSegmentId != null" >
                  and ipPool.LOGIC_SEGMENT_ID = #{logicSegmentId}
                </if>
                <if test="status != null" >
                  and ipPool.STATUS = #{status}
                </if>
                <if test="ipType != null" >
                  and ipPool.IP_TYPE = #{ipType}
                </if>
                <if test="usageInfo != null" >
                  and ipPool.USAGE_INFO like CONCAT('%',#{usageInfo},'%')
                </if>
              </where>
              order by ipPool.ID
        ) ip
        LEFT JOIN CJ_CMP_CIDR_BLOCK cidr ON ip.CIDR_BLOCK_ID = cidr.ID
        <if test="devType != null" >
          LEFT JOIN (select * from CJ_CMP_IP_X_DEV ipDev
                    <where>
                      <if test="devType != null" >
                        and ipDev.DEV_TYPE = #{devType}
                      </if>
                    </where>
          ) rel ON ip.ID = rel.IP_ID
        </if>
        <if test="devName != '' and devName != null" >
          LEFT JOIN (select * from CJ_CMP_DEV_VIEW devView
                    <where>
                      <if test="devName != '' and devName != null" >
                        and devView.NAME like CONCAT('%',#{dev.NAME},'%')
                      </if>
                    </where>
          ) dev ON rel.DEV_ID = dev.ID AND rel.SERVICE_ACCOUNT_ID = dev.SERVICE_ACCOUNT_ID
        </if>
        group by ip.ID order by
        <if test="sortField != '' and sortField != null">
          ip.${sortField} ${sortType},
        </if>
        <if test="orderByIp != null and orderByIp == true">
          inet_aton(ip.IP),
        </if>
        ip.ID) ip1
      <if test="(status == null or status == '') and (ipType == null or ipType == '') and (usageInfo == null or usageInfo == '') and cidrBlockId == null and logicSegmentId == null">
        union all
        SELECT count(ip2.ID) FROM (select devIp.ID
        from CJ_CMP_DEV_IP_VIEW devIp
        left join CJ_CMP_APP_SYSTEM appSystem on devIp.APP_SYSTEM_ID = appSystem.ID and appSystem.IS_DELETED = 0
        left join CJ_CMP_IP_X_DEV rel on devIp.ID = rel.DEV_ID and devIp.TYPE = rel.DEV_TYPE and devIp.SERVICE_ACCOUNT_ID = rel.SERVICE_ACCOUNT_ID
        where rel.ID is null and devIp.MEMBER_ID = #{memberId}
        <if test="ip != '' and ip != null">
          and devIp.IP like CONCAT('%',#{ip},'%')
        </if>
        <if test="devName != '' and devName != null">
          and devIp.NAME like CONCAT('%',#{dev.NAME},'%')
        </if>
        ) ip2
      </if>
    ) ipPool
  
```
#### listIpInfo
```

    select ip.ID, ip.IP, ip.CIDR_BLOCK_ID, ip.USAGE_INFO, ip.REMARK, cidr.CIDR_BLOCK, ip.STATUS, group_concat(rel.DEV_ID) as devId, group_concat(rel.DEV_TYPE) as devType, group_concat(dev.NAME) as devName, group_concat(appSystem.NAME) as appSystemName,
    ip.CREATE_BY, ip.CREATE_DATE, ip.LAST_MODIFIED_BY, ip.LAST_MODIFIED_DATE, ip.FROZEN_DATE
    from CJ_CMP_CIDR_BLOCK cidr
    inner join CJ_CMP_IP_POOL ip on ip.CIDR_BLOCK_ID = cidr.ID
    left join CJ_CMP_IP_X_DEV rel on ip.ID = rel.IP_ID
    left join CJ_CMP_DEV_VIEW dev on rel.DEV_ID = dev.ID and  rel.SERVICE_ACCOUNT_ID = dev.SERVICE_ACCOUNT_ID
    left join CJ_CMP_APP_SYSTEM appSystem on dev.APP_SYSTEM_ID = appSystem.ID and appSystem.IS_DELETED = 0
    <where>
      and ip.MEMBER_ID = #{memberId}
      <if test="id != '' and id != null" >
        and ip.ID = #{id}
      </if>
    </where>
    group by ip.ID order by ip.ID
  
```
#### queryAllIpUsage
```

    select (CASE
            WHEN cidr.IP_VERSION = 'IPv6' THEN null
            WHEN cidr.IP_VERSION = 'IPv4' THEN count(ip.CIDR_BLOCK_ID) END)    as ipSum,
       (CASE
            WHEN cidr.IP_VERSION = 'IPv6' THEN null
            WHEN cidr.IP_VERSION = 'IPv4' THEN sum(ip.STATUS != 'unused') END) as ipUsed,
       (CASE
            WHEN cidr.IP_VERSION = 'IPv6' THEN null
            WHEN cidr.IP_VERSION = 'IPv4' THEN sum(ip.STATUS = 'unused') END)  as ipUnused,
       (CASE
            WHEN cidr.IP_VERSION = 'IPv6' THEN null
            WHEN cidr.IP_VERSION = 'IPv4' THEN round((sum(ip.STATUS != 'unused') / count(ip.CIDR_BLOCK_ID) * 100),
                                                     2) END)                   as ipUsage,cidr.IP_VERSION
from CJ_CMP_CIDR_BLOCK cidr
         left join
     (select CIDR_BLOCK_ID, `TYPE`
      from CJ_CMP_CIDR_BLOCK_X_NETWORK rel
               inner join CJ_CMP_SERVICE_ACCOUNT sa on rel.SERVICE_ACCOUNT_ID = sa.ID
      where sa.TYPE = 'aliyunPublic')
         as al on cidr.ID = al.CIDR_BLOCK_ID
         left join CJ_CMP_IP_POOL ip on cidr.ID = ip.CIDR_BLOCK_ID
      where al.TYPE is  null and cidr.IP_VERSION = 'IPV4' and cidr.MEMBER_ID = #{memberId}
      group by cidr.IP_VERSION

  
```
#### deleteBatchByIpAndCidr
```

    delete from CJ_CMP_IP_POOL
    where MEMBER_ID = #{memberId}
    and CIDR_BLOCK_ID = #{cidrBlockId}
    and inet_aton(IP) &gt;= inet_aton(#{startIp})
    and inet_aton(ip) &lt;= inet_aton(#{endIp})
  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_IP_X_DEV.xml
> sql统计:复杂0个，简单14个
>
> 使用的关键字：NOW,CJ_CMP_IP_X_DEV,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_KUBESPHERE_CLUSTER.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：and,now,CJ_CMP_KUBESPHERE_CLUSTER,values,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_MAIN_MEMBER_GRANT.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：now,CJ_CMP_MAIN_MEMBER_GRANT,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_MID_SERVER_JOB.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：max,CJ_CMP_MID_SERVER_JOB,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_NETWORK_AREA.xml
> sql统计:复杂1个，简单7个
>
> 使用的关键字：count,sum,IF,join,CJ_CMP_NETWORK_AREA,round,CONCAT,NOW,values
#### selectAllPage
```

    select  area.ID,
            area.NAME,
            area.CODE,
            area.create_by,
            area.description,
            area.NODE_AREA,
            area.DATACENTER_ID,
            area.create_date,
            area.last_modified_by,
            area.last_modified_date,
    count(case when cidr.IP_VERSION = 'IPv6' then 0 when cidr.IP_VERSION = 'IPv4' then ip.IP end)  as IP_SUM,
    sum(case when cidr.IP_VERSION = 'IPv6' then 0 when cidr.IP_VERSION = 'IPv4' then IF(ip.STATUS = 'used', 1, 0) end)   as IP_USED,
    sum(case when cidr.IP_VERSION = 'IPv6' then 0 when cidr.IP_VERSION = 'IPv4' then IF(ip.STATUS = 'unused', 1, 0) end)   as IP_UNUSED,
    round(sum(case when cidr.IP_VERSION = 'IPv6' then 0 when cidr.IP_VERSION = 'IPv4' then IF(ip.STATUS = 'used', 1, 0) end)/ sum(case when cidr.IP_VERSION = 'IPv6' then 0 when cidr.IP_VERSION = 'IPv4' then ip.IP end)* 100,2) as IP_USAGE
    from CJ_CMP_NETWORK_AREA area
    left join CJ_CMP_CIDR_BLOCK cidr on cidr.NETWORK_AREA_ID = area.ID
    left join
    (select CIDR_BLOCK_ID, `TYPE`
    from CJ_CMP_CIDR_BLOCK_X_NETWORK rel
    inner join CJ_CMP_SERVICE_ACCOUNT sa on rel.SERVICE_ACCOUNT_ID = sa.ID
    where sa.TYPE = 'aliyunPublic')
    as al on cidr.ID = al.CIDR_BLOCK_ID
    left join CJ_CMP_IP_POOL ip on cidr.ID = ip.CIDR_BLOCK_ID
    WHERE area.MEMBER_ID = #{memberId} and area.IS_DELETED = 0
    <if test="name != null and name != ''" >
      and area.`NAME` like CONCAT('%',#{name},'%')
    </if>
    <if test="searchKey != null and searchKey != ''" >
      and area.`NAME` like CONCAT('%',#{searchKey},'%')
    </if>
    group by area.ID, area.NAME, area.CODE
    <if test="sortField != null and sortField!= '' and sortType != null and sortType!= '' ">
      ORDER BY ${sortField} ${sortType}
    </if>

  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_OBSERVABILITY_REPORT.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：count,date_add,COUNT,and,in

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_OS.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：in,and,now,CJ_CMP_OS,values,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_OS_X_IMAGE.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：values,NOW,count,from,join,CJ_CMP_OS_X_IMAGE

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_PHYSICAL_VIRTUAL_MACHINE_VIEW.xml
> sql统计:复杂1个，简单1个
>
> 使用的关键字：concat,and,from,SUM,ceil,COUNT,DISTINCT,ifnull
#### queryCloudComputerList
```

        select v.ID,v.SERVICE_ACCOUNT_ID,v.CLOUD_ACCOUNT_ID,v.LDC_ID,v.LDC_TYPE,v.TYPE,v.ENTITY_ID, v.NAME,sa.NAME as serviceAccountName,v.MEMBER_ID as memberId, um.`NAME` AS memberName,v.CLOUD_ACCOUNT_NAME,v.LDC_NAME,
        ifnull(v.CLUSTER_NAME,v.ZONE_NAME) as clusterName,v.RUN_STATUS,v.IP,concat(v.CPUS,'C/',ceil(v.MEMORY/1024),'G') as spec,v.HOST_ENTITY_NAME,v.HOST_SN,v.HOST_IP,app.NAME as appSystemName,
        v.OWNED_BY,uu.USER_NAME as ownedByName,project.NAME AS projectName,depart.NAME as dept,uaas.USER_NAME as assigner,v.ASSIGNED_TO
        from cj_cmp_vm_view v
        inner join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID=v.SERVICE_ACCOUNT_ID and sa.IS_DELETED=0
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=v.APP_SYSTEM_ID
        left outer join CJ_CMP_PROJECT project on project.ID=v.PROJECT_ID
        left join ydduc.UC_MEMBER um on um.ID = v.MEMBER_ID
        left join ydduc.UC_USER uu on uu.ID = v.OWNED_BY
        LEFT JOIN ydduc.UC_USER uaas ON v.ASSIGNED_TO = uaas.ID
        LEFT JOIN ydduc.UC_DEPARTMENT depart ON uu.DEPARTMENT = depart.ID
        <where>
        <if test="memberId != 0">and v.MEMBER_ID = #{memberId}</if>
        <if test="searchKey != null ">
            <choose>
                <when test="searchType == 'name'">
                    and v.NAME like #{searchKey}
                </when>
                <when test="searchType == 'serviceAccount'">
                    and sa.NAME like #{searchKey}
                </when>
                <when test="searchType == 'cloudAccount'">
                    and v.CLOUD_ACCOUNT_NAME like #{searchKey}
                </when>
                <when test="searchType == 'ldc'">
                    and v.LDC_NAME like #{searchKey}
                </when>
                <when test="searchType == 'cluster'">
                    and ifnull(v.CLUSTER_NAME,v.ZONE_NAME) like #{searchKey}
                </when>
                <when test="searchType == 'ip'">
                    and v.IP like #{searchKey}
                </when>
                <when test="searchType == 'app'">
                    and app.NAME like #{searchKey}
                </when>
                <when test="searchType == 'owner'">
                    and v.OWNED_BY in<foreach collection="ownerIds" item="id" open="(" close=")" separator=","> #{id} </foreach>
                </when>
                <otherwise>
                and ( v.NAME like #{searchKey}
                    or sa.NAME like #{searchKey}
                    or v.CLOUD_ACCOUNT_NAME like #{searchKey}
                    or v.LDC_NAME like #{searchKey}
                    or ifnull(v.CLUSTER_NAME,v.ZONE_NAME) like #{searchKey}
                    or v.IP like #{searchKey}
                    or app.NAME like #{searchKey}
                    or v.HOST_ENTITY_NAME like #{searchKey}
                    or concat(v.CPUS,'C/',ceil(v.MEMORY/1024),'G') like #{searchKey}
                    or v.OWNED_BY in<foreach collection="ownerIds" item="id" open="(" close=")" separator=","> #{id} </foreach>
                )
                </otherwise>
            </choose>
        </if>
        </where>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_PM_HARDWARE_TEMPLATE.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：values,NOW,and,CONCAT,now,CJ_CMP_PM_HARDWARE_TEMPLATE

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_PM_INSTANCE.xml
> sql统计:复杂1个，简单0个
>
> 使用的关键字：ifnull,concat,IFNULL,INSTR,LOWER,REPLACE,join,CONCAT,and,SUBSTRING_INDEX
#### list
```

    select pm.ID,pm.MEMBER_ID,pm.NAME,pm.CPU_CORE_COUNT as cpus,pm.RAM as memory,pm.DISK_SPACE as disk, pm.SN, pm.ENTITY_ID, pm.OPERATIONAL_STATUS as `status`, pm.RUN_STATUS as runStatus, pm.OOB_IP as ip,pm.BIZ_IP, pm.label, concat(pm.OS_DOMAIN, IFNULL(pm.OS_VERSION,'')) as os,pm.IS_LOCKED,
    pm.OWNED_BY, depart.`NAME` as dept, sa.NAME AS serviceAccountName, cdc.CLOUD_ACCOUNT_ID, ca.NAME asCLOUD_ACCOUNT_NAME,app.NAME as appSystemName, du.NAME as appDuName , du.APP_DU_TYPE as appDuType, dc.NAME as dataCenter,room.NAME as serverRoom,cabinet.NAME as serverCabinet,
    pm.U_START as uStart, region.NAME as region, pm.USED_FOR as `usage`,sa.DATACENTER_TYPE, pm.MANUFACTURER, pm.MODEL_ID as model
    from CJ_CMDB_CI_PHYSICAL_DATACENTER dc inner join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID=dc.SERVICE_ACCOUNT_ID and sa.IS_DELETED=0 and dc.IS_DELETED=0
    left outer join CJ_CMP_CLOUD_ACCOUNT_DC cdc on cdc.SERVICE_ACCOUNT_ID=dc.SERVICE_ACCOUNT_ID and cdc.LDC_ID=dc.ID and cdc.IS_DELETED=0
    left outer join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID=cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED=0
    inner join CJ_CMDB_CI_PHYSICAL_MACHINE pm on pm.LDC_ID=dc.ID and pm.IS_DELETED=0
    left outer join CJ_CMDB_CI_COMPUTER_ROOM room on pm.COMPUTER_ROOM_ID=room.ID
    left outer join CJ_CMDB_CI_CABINET cabinet on cabinet.ID=pm.CABINET_ID
     left outer join CJ_CMP_APP_SYSTEM app on app.ID=pm.APP_SYSTEM_ID
     left outer join CJ_CMDB_CI_SYS_REGION region on pm.REGION_ID = region.ID and region.IS_DELETED = 0
     left join CJ_CMP_APP_DU du on pm.APP_DU_ID = du.ID and du.IS_DELETED = 0
     LEFT JOIN ydduc.UC_USER u ON pm.OWNED_BY = u.ID
     LEFT JOIN ydduc.UC_DEPARTMENT depart ON u.DEPARTMENT = depart.ID
     where pm.ENTITY_ID is not null and pm.IS_DELETED=0
      <if test="queryParam.cloudAccountId != null and queryParam.cloudAccountId != ''"> and ca.ID=#{queryParam.cloudAccountId}</if>
      <if test="queryParam.serviceAccountId != null and queryParam.serviceAccountId != ''"> and sa.ID=#{queryParam.serviceAccountId}</if>
      <if test="queryParam.ldcId != null and queryParam.ldcId != ''"> and dc.ID=#{queryParam.ldcId}</if>
      <if test="queryParam.azId != null and queryParam.azId != ''"> and room.ID=#{queryParam.azId}</if>
    <if test="queryParam.memberId != 0">  and pm.MEMBER_ID = #{queryParam.memberId}</if>
    <if test="queryParam.appSystemName != null and queryParam.appSystemName != ''"> and app.NAME like CONCAT('%',#{queryParam.appSystemName},'%')</if>
    <if test="queryParam.name != null and queryParam.name != ''"> and pm.NAME like CONCAT('%',#{queryParam.name},'%')</if>
    <if test="queryParam.ip != null and queryParam.ip != ''"> and pm.OOB_IP like CONCAT('%',#{queryParam.ip},'%')</if>
    <if test="queryParam.userIds != null and queryParam.userIds.size >0 ">
     and ( pm.OWNED_BY in <foreach collection="queryParam.userIds" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
       <if test="queryParam.appUserId !=null ">
           or app.SYS_OPR_MANT_OWNER_ID= #{queryParam.appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{queryParam.appUserId} or app.BIZ_OWNER_ID=#{queryParam.appUserId}
           <if test="queryParam.appDepartmentList != null and queryParam.appDepartmentList.size != 0">
             or app.DEPT_ID in <foreach collection="queryParam.appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
             or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="queryParam.appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
           </if>
       </if>
     )
    </if>
    <if test="queryParam.ownedByList != null and queryParam.ownedByList.size != 0">
      and pm.OWNED_BY in <foreach collection="queryParam.ownedByList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
    </if>
    <if test="queryParam.sn != null and queryParam.sn != ''"> and pm.SN like CONCAT('%',#{queryParam.sn},'%')</if>
    <if test="queryParam.runStatus != null and queryParam.runStatus != ''"> and pm.RUN_STATUS = #{queryParam.runStatus}</if>
    <if test="queryParam.status != null and queryParam.status != ''"> and pm.OPERATIONAL_STATUS = #{queryParam.status}</if>
    <if test="queryParam.searchKey != null and queryParam.searchKey != ''">
      and (pm.NAME like CONCAT('%',#{queryParam.searchKey},'%') or pm.OOB_IP like CONCAT('%',#{queryParam.searchKey},'%') or pm.sn like CONCAT('%',#{queryParam.searchKey},'%') or pm.RUN_STATUS = #{queryParam.searchKey} 
           or pm.OPERATIONAL_STATUS = #{queryParam.searchKey} or pm.BIZ_IP like CONCAT('%', #{queryParam.searchKey}, '%') or app.NAME like CONCAT('%',#{queryParam.searchKey},'%')
           or dc.NAME like CONCAT('%',#{queryParam.searchKey},'%') or room.NAME like CONCAT('%',#{queryParam.searchKey},'%') or cabinet.NAME like CONCAT('%',#{queryParam.searchKey},'%')
      <if test="queryParam.searchKeyList != null and queryParam.searchKeyList.size != 0">
        or pm.OWNED_BY in <foreach collection="queryParam.searchKeyList" item="searchKey" open="(" close=")" separator=",">#{searchKey}</foreach>
      </if>
      )
    </if>
    <if test=" queryParam.bizIps != null and queryParam.bizIps.size >0 ">
      and <foreach collection="queryParam.bizIps" item="ip" open="(" close=")" separator="or">INSTR(pm.BIZ_IP, #{ip})</foreach>
    </if>
    union all
    select  cpm.ID,cpm.MEMBER_ID,cpm.DEVICE_NAME as NAME,SUBSTRING_INDEX(LOWER(cpm.SPEC),'c',1) as cpus, REPLACE(SUBSTRING_INDEX(LOWER(cpm.SPEC),'c',-1),'g','')*1024 as memory,'' as disk ,cpm.SERVICE_TAG as SN, cpm.ENTITY_ID, cpm.OPERATIONAL_STATUS as `status`, cpm.RUN_STATUS as runStatus, cpm.IP as ip,'' as BIZ_IP,cpm.MANUFACTURER as label,cpm.OS as os,cpm.IS_LOCKED,
        cpm.OWNED_BY, depart.`NAME` as dept, sbTable.NAME AS serviceAccountName, sbTable.CLOUD_ACCOUNT_ID, sbTable.CLOUD_ACCOUNT_NAME,app.NAME as appSystemName, du.NAME as appDuName , du.APP_DU_TYPE as appDuType, sbTable.DATACENTER as dataCenter, cpm.ROOM_NAME as serverRoom,cpm.FRAME_CODE as serverCabinet,
        cpm.START_U as uStart,'' as region, cpm.DESCRIPTION as `usage`,sbTable.DATACENTER_TYPE, cpm.MANUFACTURER, cpm.MODEL
        from CJ_CMP_CLOUDSINO_PHYSICAL_MACHINE cpm inner join
        ( select distinct
        `sa`.ID as SERVICE_ACCOUNT_ID,
        `sa`.NAME,
        `sa`.DATACENTER_TYPE,
        '' as DATACENTER,
        `ca`.ID as CLOUD_ACCOUNT_ID,
        `ca`.NAME as CLOUD_ACCOUNT_NAME
        from
        `CJ_CMP_SERVICE_ACCOUNT` `sa`
        INNER JOIN `CJ_CMP_CLOUD_ACCOUNT_DC` `cdc` ON `cdc`.SERVICE_ACCOUNT_ID = `sa`.ID and `cdc`.IS_DELETED = 0
        INNER JOIN `CJ_CMP_CLOUD_ACCOUNT` `ca` ON `ca`.ID = `cdc`.CLOUD_ACCOUNT_ID and `ca`.IS_DELETED = 0
        inner join `CJ_CMP_CLOUDSINO_PHYSICAL_MACHINE` `dc` on `dc`.SERVICE_ACCOUNT_ID = `sa`.ID and `dc`.IS_DELETED = 0
        <where>
          <if test="queryParam.memberId != null and queryParam.memberId != ''">  and `dc`.MEMBER_ID = #{queryParam.memberId}</if>
        </where>
        ) sbTable on cpm.SERVICE_ACCOUNT_ID = sbTable.SERVICE_ACCOUNT_ID
        left outer join CJ_CMP_APP_SYSTEM app on app.ID = cpm.APP_SYSTEM_ID
        LEFT JOIN ydduc.UC_USER u ON cpm.OWNED_BY = u.ID
        LEFT JOIN ydduc.UC_DEPARTMENT depart ON u.DEPARTMENT = depart.ID
        left join CJ_CMP_APP_DU du on cpm.APP_DU_ID = du.ID
        and du.IS_DELETED = 0
        where  cpm.IS_DELETED = 0
        <if test="queryParam.memberId != null and queryParam.memberId != ''">  and cpm.MEMBER_ID = #{queryParam.memberId}</if>
        <if test="queryParam.appSystemName != null and queryParam.appSystemName != ''"> and app.NAME like CONCAT('%',#{queryParam.appSystemName},'%')</if>
        <if test="queryParam.name != null and queryParam.name != ''"> and cpm.DEVICE_NAME like CONCAT('%',#{queryParam.name},'%')</if>
        <if test="queryParam.ip != null and queryParam.ip != ''"> and cpm.IP like CONCAT('%',#{queryParam.ip},'%')</if>
        <if test="queryParam.userIds != null and queryParam.userIds.size >0 ">
            and ( cpm.OWNED_BY in <foreach collection="queryParam.userIds" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
            <if test="queryParam.appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{queryParam.appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{queryParam.appUserId} or app.BIZ_OWNER_ID=#{queryParam.appUserId}
                <if test="queryParam.appDepartmentList != null and queryParam.appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="queryParam.appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="queryParam.appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
            )
        </if>
        <if test="queryParam.ownedByList != null and queryParam.ownedByList.size != 0">
            and cpm.OWNED_BY in <foreach collection="queryParam.ownedByList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
        </if>
        <if test="queryParam.sn != null and queryParam.sn != ''"> and cpm.SERVICE_TAG like CONCAT('%',#{queryParam.sn},'%')</if>
        <if test="queryParam.runStatus != null and queryParam.runStatus != ''"> and cpm.RUN_STATUS = #{queryParam.runStatus}</if>
        <if test="queryParam.status != null and queryParam.status != ''"> and cpm.OPERATIONAL_STATUS = #{queryParam.status}</if>
        <if test="queryParam.searchKey != null and queryParam.searchKey != ''">
            and (cpm.DEVICE_NAME like CONCAT('%',#{queryParam.searchKey},'%') or cpm.IP like CONCAT('%',#{queryParam.searchKey},'%') or cpm.SERVICE_TAG like CONCAT('%',#{queryParam.searchKey},'%') 
                  or cpm.RUN_STATUS = #{queryParam.searchKey} or  cpm.OPERATIONAL_STATUS = #{queryParam.searchKey} or app.NAME like CONCAT('%',#{queryParam.searchKey},'%')
                  or sbTable.DATACENTER like CONCAT('%',#{queryParam.searchKey},'%') or cpm.ROOM_NAME like CONCAT('%',#{queryParam.searchKey},'%') or cpm.FRAME_CODE like CONCAT('%',#{queryParam.searchKey},'%')
            <if test="queryParam.searchKeyList != null and queryParam.searchKeyList.size != 0">
                or cpm.OWNED_BY in <foreach collection="queryParam.searchKeyList" item="searchKey" open="(" close=")" separator=",">#{searchKey}</foreach>
            </if>
            )
        </if>
    union all
    select pm.ID,pm.MEMBER_ID,pm.NAME,pm.CPU_CORE_COUNT as cpus,pm.RAM as memory,
    pm.DISK_SPACE as disk, pm.SN, pm.ENTITY_ID, pm.OPERATIONAL_STATUS as `status`,
    pm.RUN_STATUS as runStatus, pm.OOB_IP as ip,pm.BIZ_IP, pm.label,
    concat(pm.OS_DOMAIN, IFNULL(pm.OS_VERSION,'')) as os,pm.IS_LOCKED,
    pm.OWNED_BY, depart.`NAME` as dept, sa.NAME AS serviceAccountName,
    ca.ID as CLOUD_ACCOUNT_ID, ca.NAME as CLOUD_ACCOUNT_NAME,null,
    null , null as appDuType, dc.NAME as dataCenter,
    az.NAME as serverRoom,cabinet.NAME as serverCabinet,
    pm.U_START as uStart,null, pm.USED_FOR as `usage`,
    sa.DATACENTER_TYPE, pm.MANUFACTURER, pm.MODEL_ID as model
    from CJ_CMDB_CI_PHYSICAL_MACHINE pm
    inner join CJ_PAM_ASSET ass on pm.ID = ass.PM_ID
    LEFT JOIN CJ_CMDB_CI_CABINET cabinet on cabinet.ID=pm.CABINET_ID and cabinet.IS_DELETED=0
    LEFT JOIN CJ_CMDB_CI_COMPUTER_ROOM az on az.ID = cabinet.COMPUTER_ROOM_ID and az.IS_DELETED = 0
    LEFT JOIN CJ_CMDB_CI_PHYSICAL_DATACENTER dc on dc.ID = az.DATACENTER_ID and dc.IS_DELETED = 0
    LEFT JOIN CJ_CMP_SERVICE_ACCOUNT sa on sa.ID = pm.SERVICE_ACCOUNT_ID
    LEFT JOIN CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = ass.CLOUD_ACCOUNT_ID and ca.id
    LEFT JOIN ydduc.UC_USER u ON pm.OWNED_BY = u.ID
    LEFT JOIN ydduc.UC_DEPARTMENT depart ON u.DEPARTMENT = depart.ID
    where pm.ENTITY_ID is not null and pm.IS_DELETED=0
    <if test="queryParam.sn != null and queryParam.sn != ''">  and pm.SN like CONCAT('%',#{queryParam.sn},'%')</if>
    union all
    select bms.ID,bms.MEMBER_ID,bms.SERVICE_ACCOUNT_ID,spec.VCPUS,spec.RAM,spec.DISK,bms.SN,bms.ENTITY_ID,bms.STATUS,null,null,ifnull(bms.IPV4,bms.IPV6),null,img.NAME,0,bms.OWNED_BY,depart.`NAME` as dept, sa.NAME,cdc.CLOUD_ACCOUNT_ID,ca.NAME,app.NAME,null,null,null,null,null,null,dc.NAME,bms.USED_FOR,sa.DATACENTER_TYPE,null,null
    from CJ_CMP_FUSION_CLOUD_BMS_INSTANCE bms inner join CJ_CMP_FUSION_CLOUD_DC dc on bms.LDC_ID=dc.ID
    inner join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID=bms.SERVICE_ACCOUNT_ID
    inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc on cdc.LDC_ID=dc.ID and bms.SERVICE_ACCOUNT_ID=cdc.SERVICE_ACCOUNT_ID and cdc.IS_DELETED=0
    inner join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID=cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED=0
    <choose> <when test="queryParam.mainMemberId != 0"> and ca.MEMBER_ID = #{queryParam.mainMemberId} </when> <otherwise> and ca.SCOPE = 'public' </otherwise> </choose>
    left outer join CJ_CMP_FUSION_CLOUD_BMS_FLAVOR spec on spec.ID=bms.SPEC_ID
    left outer join CJ_CMP_VM_IMAGE img on img.ID=bms.IMAGE_ID
    LEFT JOIN ydduc.UC_USER u ON bms.OWNED_BY = u.ID
    LEFT JOIN ydduc.UC_DEPARTMENT depart ON u.DEPARTMENT = depart.ID
    left outer join CJ_CMP_APP_SYSTEM app on app.ID=bms.APP_SYSTEM_ID
    where bms.IS_DELETED=0 and bms.ENTITY_ID is not null
    <if test="queryParam.cloudAccountId != null and queryParam.cloudAccountId != ''"> and ca.ID=#{queryParam.cloudAccountId}</if>
    <if test="queryParam.serviceAccountId != null and queryParam.serviceAccountId != ''"> and sa.ID=#{queryParam.serviceAccountId}</if>
    <if test="queryParam.ldcId != null and queryParam.ldcId != ''"> and dc.ID=#{queryParam.ldcId}</if>
    <if test="queryParam.azId != null and queryParam.azId != ''"> and bms.ZONE_ID=#{queryParam.azId}</if>

    <if test="queryParam.memberId != 0">  and bms.MEMBER_ID = #{queryParam.memberId}</if>
    <if test="queryParam.appSystemName != null and queryParam.appSystemName != ''"> and app.NAME like CONCAT('%',#{queryParam.appSystemName},'%')</if>
    <if test="queryParam.name != null and queryParam.name != ''"> and bms.NAME like CONCAT('%',#{queryParam.name},'%')</if>
    <if test="queryParam.ip != null and queryParam.ip != ''"> and (bms.IPV4 like CONCAT('%',#{queryParam.ip},'%') or bms.IPV6 like CONCAT('%',#{queryParam.ip},'%'))</if>
    <if test="queryParam.userIds != null and queryParam.userIds.size >0 ">
     and ( bms.OWNED_BY in <foreach collection="queryParam.userIds" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
       <if test="queryParam.appUserId !=null ">
           or app.SYS_OPR_MANT_OWNER_ID= #{queryParam.appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{queryParam.appUserId} or app.BIZ_OWNER_ID=#{queryParam.appUserId}
           <if test="queryParam.appDepartmentList != null and queryParam.appDepartmentList.size != 0">
             or app.DEPT_ID in <foreach collection="queryParam.appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
             or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="queryParam.appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
           </if>
       </if>
     )
    </if>
    <if test="queryParam.ownedByList != null and queryParam.ownedByList.size != 0">
      and bms.OWNED_BY in <foreach collection="queryParam.ownedByList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
    </if>
    <if test="queryParam.sn != null and queryParam.sn != ''"> and bms.SN like CONCAT('%',#{queryParam.sn},'%')</if>
    <if test="queryParam.status != null and queryParam.status != ''"> and bms.STATUS = #{queryParam.status}</if>
    <if test="queryParam.searchKey != null and queryParam.searchKey != ''">
      and (bms.NAME like CONCAT('%',#{queryParam.searchKey},'%') or bms.IPV4 like CONCAT('%',#{queryParam.searchKey},'%') or bms.IPV6 like CONCAT('%',#{queryParam.searchKey},'%') or bms.SN like CONCAT('%',#{queryParam.searchKey},'%') 
          or bms.STATUS = #{queryParam.searchKey} or app.NAME like CONCAT('%',#{queryParam.searchKey},'%')
      <if test="queryParam.searchKeyList != null and queryParam.searchKeyList.size != 0">
        or bms.OWNED_BY in <foreach collection="queryParam.searchKeyList" item="searchKey" open="(" close=")" separator=",">#{searchKey}</foreach>
      </if>
      )
    </if>
    <if test=" queryParam.bizIps != null and queryParam.bizIps.size >0 ">
      and <foreach collection="queryParam.bizIps" item="ip" open="(" close=")" separator="or">INSTR(bms.IPV4, #{ip})</foreach>
    </if>
    order by 3
  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_PM_OR_HOST_VIEW.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：exists,and,IN

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_PM_TYPE.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：CJ_CMP_PM_TYPE,values,count,concat,NOW,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_PM_TYPE_X_PM.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：NOW,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_POLICY.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：and,or,in,now,CJ_CMP_POLICY,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_POLICY_RULE.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：now,CJ_CMP_POLICY_RULE,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_POLICY_SCRIPT.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：OR,now,CJ_CMP_POLICY_SCRIPT,VALUES,WHERE,concat,AND

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_POLICY_X_CATALOG_ITEM.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：now,CJ_CMP_POLICY_X_CATALOG_ITEM,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_PROJECT.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：concat,or,AND,IN,NOW,CJ_CMP_PROJECT,VALUES,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_PROJECT_X_APP_SYSTEM.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：CJ_CMP_PROJECT_X_APP_SYSTEM,VALUES,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_PROJECT_X_USER.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：NOW,CJ_CMP_PROJECT_X_USER,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_QUOTA.xml
> sql统计:复杂0个，简单38个
>
> 使用的关键字：and,toUpperCase,CJ_CMP_QUOTA_RESOURCE_ATTR,VALUES,split,substring,concat,CJ_CMP_QUOTA_CONFIGURATION,values,indexOf,from,startsWith,CJ_CMP_QUOTA_DEFINITION,CJ_CMP_QUOTA_RESOURCE_TYPE,contains,isEmpty,CJ_CMP_QUOTA_CONSUMPTION,CJ_CMP_QUOTA_RESOURCE_CODE

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_RB.xml
> sql统计:复杂1个，简单10个
>
> 使用的关键字：VALUES,and,or,CONCAT,convert,concat,NOW,CJ_CMP_RB
#### selectByCondition
```

    select *
    from CJ_CMP_RB
    where IS_DELETED = 0 and (MEMBER_ID = #{memberId} or (MEMBER_ID = 0 and status = 'published'))
      <if test="status != null and status != ''" >
          and `STATUS` = #{status}
      </if>
      <if test="keyword != null and keyword != ''" >
          <choose>
              <when test="queryType != null and queryType == 'name'" >
                  and `NAME` like CONCAT('%',#{keyword},'%')
              </when>
              <when test="queryType != null and queryType == 'layer'" >
                  and (LAYER like CONCAT('%',#{keyword},'%') OR LAYER_NAME like CONCAT('%',#{keyword},'%'))
              </when>
              <otherwise>
                  and (
                  `NAME` like CONCAT('%',#{keyword},'%')
                  OR LAYER like CONCAT('%',#{keyword},'%')
                  OR LAYER_NAME like CONCAT('%',#{keyword},'%')
                  )
              </otherwise>
          </choose>
      </if>
      ORDER BY convert(${sortField} USING gbk) ${sortType}
  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_RB_CAPI_PROVIDER.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_RB_OP.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：NOW,CJ_CMP_RB_OP,VALUES,and,where

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_RB_OP_PARAM.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：NOW,CJ_CMP_RB_OP_PARAM,VALUES,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_RB_OP_STEP.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：and,NOW,CJ_CMP_RB_OP_STEP,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_RECYCLE_RESOURCE.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：CJ_CMP_RECYCLE_RESOURCE,values,CONCAT,concat,and,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_RESOURCE_ATTRIBUTE.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_RESOURCE_AUTHORIZATION.xml
> sql统计:复杂2个，简单6个
>
> 使用的关键字：and,now,CJ_CMP_RESOURCE_AUTHORIZATION,values,size,NOW,ifnull
#### findList
```

        select * from CJ_CMP_RESOURCE_AUTHORIZATION where MEMBER_ID = #{memberId} and IS_DELETED = 0 and BIZ_FUNCTION=#{bizFunction}
        <if test="authObjType!=null">
            and AUTH_OBJ_TYPE=#{authObjType}
            <if test="authObjIds == null || authObjIds.size() == 0">and false</if>
            <if test="authObjIds != null and authObjIds.size() > 0">
                and AUTH_OBJ_ID in <foreach collection="authObjIds" item="authObjId" open="(" separator="," close=")">#{authObjId}</foreach>
            </if>
            and NOW() between ifnull(START_TIME,NOW()) and ifnull(END_TIME,NOW())
        </if>
    
```
#### updateExpireNotify
```

        update CJ_CMP_RESOURCE_AUTHORIZATION set EXPIRE_NOTIFY=ifnull(EXPIRE_NOTIFY,0)|#{notifyTimeType} where ID in <foreach collection="ids" item="id" open="(" close=")" separator=",">#{id}</foreach>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_RESOURCE_AUTH_ENV_CONDITION.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CMP_RESOURCE_AUTH_ENV_CONDITION,VALUES,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_RESOURCE_AUTH_OBJECT.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：CJ_CMP_RESOURCE_AUTH_OBJECT,VALUES,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_RESOURCE_AUTH_RECORD.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：CJ_CMP_RESOURCE_AUTH_RECORD,VALUES,now,FROM,concat,WHERE,isEmpty,FIND_IN_SET

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_RESOURCE_AUTH_SUBJECT.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CMP_RESOURCE_AUTH_SUBJECT,VALUES,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_RESOURCE_OPERATION.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：VALUES,isEmpty,now,CJ_CMP_RESOURCE_OPERATION

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_RESOURCE_OPERATION_APPLICABLE_PAGE.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：NOW,CJ_CMP_RESOURCE_OPERATION_APPLICABLE_PAGE,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_RESOURCE_OPERATION_CONTROL.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：now,CJ_CMP_RESOURCE_OPERATION_CONTROL,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_RESOURCE_OPERATION_METHOD.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：NOW,CJ_CMP_RESOURCE_OPERATION_METHOD,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_RESOURCE_OPER_LOG.xml
> sql统计:复杂2个，简单5个
>
> 使用的关键字：max,ifnull,CONCAT,join,values,now,min,if,group_concat,and,GROUP_CONCAT,CJ_CMP_RESOURCE_OPER_LOG
#### queryResourceOperLog
```

      select min(log.ID) as ID, log.MEMBER_ID, if(log.MEMBER_ID=0, '平台租户', `member`.NAME) as memberName, log.SERVICE_ACCOUNT_ID, log.RESOURCE_ID,
      log.RESOURCE_TYPE, log.RESOURCE_ENTITY_ID, log.RESOURCE_NAME, log.RESOURCE_IP, log.ACTION, log.SOURCE, log.CREATE_BY, max(log.CREATE_DATE) as CREATE_DATE,
      group_concat(CHANGE_TYPE, '####', CHANGE_FIELD, '####', ifnull(OLD_VALUE, '-'), '####', ifnull(NEW_VALUE, '-') SEPARATOR '######') as changeContext
      from CJ_CMP_RESOURCE_OPER_LOG log
      left join ydduc.UC_MEMBER `member` on log.MEMBER_ID = `member`.ID
     <where>
        log.RESOURCE_TYPE = 'vm'
       <if test="queryType != null and queryType != '' and keyword != null and keyword != ''">
         <if test="queryType == 'resourceName'"> and log.RESOURCE_NAME like CONCAT('%',#{keyword},'%')</if>
         <if test="queryType == 'resourceIp'"> and log.RESOURCE_IP like CONCAT('%',#{keyword},'%')</if>
         <if test="queryType == 'resourceEntityId'"> and RESOURCE_ENTITY_ID like CONCAT('%',#{keyword},'%')</if>
         <if test="queryType == 'all'">
          and (log.RESOURCE_NAME like CONCAT('%',#{keyword},'%')
          or log.RESOURCE_IP like CONCAT('%',#{keyword},'%')
          or log.RESOURCE_ENTITY_ID like CONCAT('%',#{keyword},'%')
          or `member`.name like CONCAT('%',#{keyword},'%')
         )
         </if>
       </if>
       <if test="startTime != null and startTime != ''"> and log.CREATE_DATE &gt;= #{startTime}</if>
       <if test="endTime != null and endTime != ''"> and log.CREATE_DATE &lt;= #{endTime}</if>
     </where>
      group by log.TRACE_ID, log.RESOURCE_ID, log.MEMBER_ID, log.SERVICE_ACCOUNT_ID,
      log.RESOURCE_TYPE, log.RESOURCE_ENTITY_ID, log.RESOURCE_NAME, log.RESOURCE_IP, log.ACTION,  log.SOURCE, log.CREATE_BY
      order by min(log.ID) desc
  
```
#### getChangedVm
```

        select distinct vm.*,prj.CODE as projectCode,prj.NAME as projectName,prj.PROJECT_SOURCE_ID as projectSourceId,
        app.CODE as appSystemCode,app.NAME as appSystemName,app.SOURCE_ID as appSystemSourceId, vmtag.tags
        from CJ_CMP_RESOURCE_OPER_LOG op
        inner join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID = op.SERVICE_ACCOUNT_ID and sa.IS_DELETED = 0
        <if test="ldcType != null">
            <choose>
                <when test="ldcType == 'vmware'">
                    inner join CJ_CMP_VMWARE_VM vm on vm.SERVICE_ACCOUNT_ID = sa.ID and vm.ENTITY_ID = op.RESOURCE_ENTITY_ID
                    and vm.MEMBER_ID = op.MEMBER_ID
                </when>
                <when test="ldcType == 'fusionCloud'">
                    inner join CJ_CMP_FUSION_CLOUD_ECS vm on vm.SERVICE_ACCOUNT_ID = sa.ID and vm.ENTITY_ID = op.RESOURCE_ENTITY_ID
                    and vm.MEMBER_ID = op.MEMBER_ID
                </when>
            </choose>
        </if>
        <if test="srvCompletionTimeStart!=null or srvCompletionTimeEnd!=null ">
        left outer join CJ_CMP_RITM_COMPLETED_VIEW req on vm.SRV_NO=req.NUMBER
        </if>
        left outer join CJ_CMP_PROJECT prj on prj.ID = vm.PROJECT_ID
        left outer join CJ_CMP_APP_SYSTEM app on app.ID = vm.APP_SYSTEM_ID
        left outer join CJ_CMP_APP_DU du on du.ID = vm.APP_DU_ID
        left outer join (SELECT rel.OBJECT_ID, rel.OBJECT_TYPE, GROUP_CONCAT(tag.`NAME`) as tags
        from CJ_CMP_TAG tag
        INNER JOIN CJ_CMP_TAG_X_OBJECT rel on tag.ID = rel.TAG_ID
        GROUP BY rel.OBJECT_ID, rel.OBJECT_TYPE) as vmtag
        on vm.ID = vmtag.OBJECT_ID and vmtag.OBJECT_TYPE = #{ldcType}
        where vm.MEMBER_ID = #{memberId}
        and sa.DATACENTER_TYPE = #{ldcType}
        and RESOURCE_TYPE = 'vm'
        <if test="updateDateStart != null and updateDateEnd != null">
            and op.CREATE_DATE between #{updateDateStart,jdbcType= TIMESTAMP} and #{updateDateEnd,jdbcType= TIMESTAMP}
        </if>
        <if test="updateDateStart==null   and  updateDateEnd!=null ">
            and op.CREATE_DATE &lt;=  #{updateDateEnd,jdbcType= TIMESTAMP}
        </if>
        <if test="updateDateStart!=null  and  updateDateEnd==null ">
            and op.CREATE_DATE &gt;=  #{updateDateStart,jdbcType= TIMESTAMP}
        </if>
        <if test="startTime!=null and  endTime!=null ">
            and vm.CREATE_DATE between #{startTime,jdbcType= TIMESTAMP} and  #{endTime,jdbcType= TIMESTAMP}
        </if>
        <if test="startTime==null   and  endTime!=null ">
            and vm.CREATE_DATE &lt;=  #{endTime,jdbcType= TIMESTAMP}
        </if>
        <if test="startTime!=null  and  endTime==null ">
            and vm.CREATE_DATE &gt;=  #{startTime,jdbcType= TIMESTAMP}
        </if>
        <if test="srvCompletionTimeStart!=null and srvCompletionTimeEnd!=null ">
            and if(vm.IS_DELETED=1,vm.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) between #{srvCompletionTimeStart,jdbcType= TIMESTAMP} and  #{srvCompletionTimeEnd,jdbcType= TIMESTAMP}
        </if>
        <if test="srvCompletionTimeStart==null and srvCompletionTimeEnd!=null ">
            and if(vm.IS_DELETED=1,vm.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) &lt;=  #{srvCompletionTimeEnd,jdbcType= TIMESTAMP}
        </if>
        <if test="srvCompletionTimeStart!=null and srvCompletionTimeEnd==null ">
            and if(vm.IS_DELETED=1,vm.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) &gt;=  #{srvCompletionTimeStart,jdbcType= TIMESTAMP}
        </if>
        <if test="deleted != null ">
            <choose>
                <when test="deleted">
                    and vm.IS_DELETED=1
                </when>
                <otherwise>
                    and vm.IS_DELETED=0
                </otherwise>
            </choose>
        </if>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_RESOURCE_POOL.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：VALUES,IN,concat,NOW,CJ_CMP_RESOURCE_POOL

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_RESOURCE_TYPE.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：CJ_CMP_RESOURCE_TYPE,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_SCRIPT.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：values,count,in,CONCAT,NOW,CJ_CMP_SCRIPT

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_SCRIPT_CATEGORY.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：in,NOW,CJ_CMP_SCRIPT_CATEGORY,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_SERVICE_ACCOUNT.xml
> sql统计:复杂0个，简单17个
>
> 使用的关键字：in,CONCAT,now,CJ_CMP_SERVICE_ACCOUNT,VALUES,concat,size,NOW,and,count

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_SERVICE_INSTANCE_CHANGE.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：in,NOW,CJ_CMP_SERVICE_INSTANCE_CHANGE,VALUES,on,AND,OR

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_SERVICE_INSTANCE_OPERATE.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：NOW,CJ_CMP_SERVICE_INSTANCE_OPERATE,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_SERVICE_POOL.xml
> sql统计:复杂6个，简单8个
>
> 使用的关键字：and,exists,select,count,join,size,sum,round,now,CJ_CMP_SERVICE_POOL,VALUES
#### queryIpStatisticsBySpId
```

        select (CASE
            WHEN cidr.IP_VERSION = 'IPv6' THEN null
            WHEN cidr.IP_VERSION = 'IPv4' THEN count(ip.CIDR_BLOCK_ID) END)    as ipSum,
       (CASE
            WHEN cidr.IP_VERSION = 'IPv6' THEN null
            WHEN cidr.IP_VERSION = 'IPv4' THEN sum(ip.STATUS != 'unused') END) as ipUsed,
       (CASE
            WHEN cidr.IP_VERSION = 'IPv6' THEN null
            WHEN cidr.IP_VERSION = 'IPv4' THEN sum(ip.STATUS = 'unused') END)  as ipUnused,
       (CASE
            WHEN cidr.IP_VERSION = 'IPv6' THEN null
            WHEN cidr.IP_VERSION = 'IPv4' THEN round((sum(ip.STATUS != 'unused') / count(ip.CIDR_BLOCK_ID) * 100),
                                                     2) END)                   as ipUsage
        from CJ_CMP_CIDR_BLOCK cidr
         inner join CJ_CMP_SERVICE_POOL_X_GRANT_RES res
                    on res.GRANT_RESOURCE_TYPE = 'CIDR' and res.GRANT_RESOURCE_ID = cidr.ID and
                       res.SERVICE_POOL_ID = #{servicePoolId}
         left join
         (select CIDR_BLOCK_ID, `TYPE`
          from CJ_CMP_CIDR_BLOCK_X_NETWORK rel
                   inner join CJ_CMP_SERVICE_ACCOUNT sa on rel.SERVICE_ACCOUNT_ID = sa.ID
          where sa.TYPE = 'aliyunPublic')
         as al on cidr.ID = al.CIDR_BLOCK_ID
         left join CJ_CMP_NETWORK_AREA area on cidr.NETWORK_AREA_ID = area.ID
         left join CJ_CMP_IP_POOL ip on cidr.ID = ip.CIDR_BLOCK_ID
        where cidr.MEMBER_ID = #{memberId}
          and al.TYPE is null
          and cidr.IP_VERSION = 'IPv4'
        group by cidr.IP_VERSION
    
```
#### queryVMwareClusterResBySpId
```

        select sum(host.CPUS)                                                 as cpuSum,
               sum(host.CPU_USED)                                             as cpuUsed,
               sum(host.MEMORY_SUM) / 1024                                    as memorySum,
               sum(host.MEMORY_USED) / 1024                                   as memoryUsed,
               sum(host.DISK_SUM)                                             as localStorageSum,
               sum(host.DISK_USED)                                            as localStorageUsed,
               round((sum(host.CPU_USED) / sum(host.CPUS)) * 100, 2)          as cpuUsage,
               round((sum(host.MEMORY_USED) / sum(host.MEMORY_SUM)) * 100, 2) as memoryUsage,
               round((sum(host.DISK_USED) / sum(host.DISK_SUM)) * 100, 2)     as localStorageUsage
        from CJ_CMP_SERVICE_POOL_X_GRANT_RES res
                 left join CJ_CMP_VMWARE_CLUSTER clu
                           on res.GRANT_RESOURCE_TYPE = 'CLUSTER' and res.GRANT_RESOURCE_ID = clu.ID and
                              res.SERVICE_POOL_ID = #{servicePoolId} and res.MEMBER_ID = #{memberId}
                 left join CJ_CMP_VMWARE_HOST host on host.CLUSTER_ID = clu.ID
    
```
#### queryVMwareStorageBySpId
```

        select sum(store.DISK_SUM)                                          as sharedStorageSum,
       sum(store.DISK_SUM - store.DISK_FREE)                        as sharedStorageUsed,
       sum(store.PROVISIONED)                                       as storageProvisioned,
       round((sum(store.DISK_SUM - store.DISK_FREE) / sum(store.DISK_SUM)) * 100, 2) as sharedStorageUsage
        from CJ_CMP_SERVICE_POOL_X_GRANT_RES res
         left join CJ_CMP_VMWARE_DATASTORE store
                   on res.GRANT_RESOURCE_TYPE = 'STORAGE' and res.GRANT_RESOURCE_ID = store.ID and
                      res.SERVICE_POOL_ID = #{servicePoolId} and res.MEMBER_ID = #{memberId}

    
```
#### queryFusionCloudAzResBySpId
```

        select sum(host.CPUS)                                                 as cpuSum,
               sum(host.CPU_USED)                                             as cpuUsed,
               sum(host.MEMORY_SUM) / 1024                                    as memorySum,
               sum(host.MEMORY_USED) / 1024                                   as memoryUsed,
               sum(host.DISK_SUM)                                             as localStorageSum,
               sum(host.DISK_USED)                                            as localStorageUsed,
               round((sum(host.CPU_USED) / sum(host.CPUS)) * 100, 2)          as cpuUsage,
               round((sum(host.MEMORY_USED) / sum(host.MEMORY_SUM)) * 100, 2) as memoryUsage,
               round((sum(host.DISK_USED) / sum(host.DISK_SUM)) * 100, 2)     as localStorageUsage
        from CJ_CMP_SERVICE_POOL_X_GRANT_RES res
                 left join CJ_CMP_CLOUD_AZ az
                           on res.GRANT_RESOURCE_TYPE = 'AZ' and res.GRANT_RESOURCE_ID = az.ID and
                              res.SERVICE_POOL_ID = #{servicePoolId} and res.MEMBER_ID = #{memberId}
                 left join CJ_CMP_FUSION_CLOUD_HOST host on host.ZONE_ID = az.ID
    
```
#### queryFusionComputeClusterResBySpId
```

        select sum(clu.CPU_SUM)                                       as cpuSum,
               sum(clu.CPU_USED)                                       as cpuUsed,
               sum(clu.MEMORY_SUM / 1024)                              as memorySum,
               sum(clu.MEMORY_USED / 1024)                             as memoryUsed,
               round((sum(clu.CPU_USED) / sum(clu.CPU_SUM)) * 100, 2)       as cpuUsage,
               round((sum(clu.MEMORY_USED) / sum(clu.MEMORY_SUM)) * 100, 2) as memoryUsage
         from CJ_CMP_SERVICE_POOL_X_GRANT_RES res
         left join CJ_CMP_FUSION_COMPUTE_CLUSTER clu
                   on res.GRANT_RESOURCE_TYPE = 'CLUSTER' and res.GRANT_RESOURCE_ID = clu.ID and
                      res.SERVICE_POOL_ID = #{servicePoolId} and res.MEMBER_ID = #{memberId}
    
```
#### queryFusionComputeStorageBySpId
```

        select sum(store.CAPACITY_GB)                                          as sharedStorageSum,
               sum(store.USED_SIZE_GB)                        as sharedStorageUsed,
               round((sum(store.USED_SIZE_GB) / sum(store.CAPACITY_GB)) * 100, 2) as sharedStorageUsage
        from CJ_CMP_SERVICE_POOL_X_GRANT_RES res
        left join CJ_CMP_FUSION_COMPUTE_DATASTORE store
                   on res.GRANT_RESOURCE_TYPE = 'STORAGE' and res.GRANT_RESOURCE_ID = store.ID and
                      res.SERVICE_POOL_ID = #{servicePoolId} and res.MEMBER_ID = #{memberId}
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_SERVICE_POOL_X_GRANT_RES.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：now,size,CJ_CMP_SERVICE_POOL_X_GRANT_RES,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_SOFTWARE_ASSIGN.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：count,DATE

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_SOFTWARE_INSTANCE.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：count

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_SOFTWARE_RESOURCE.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：values,concat,and,CONCAT,NOW,now,CJ_CMP_SOFTWARE_RESOURCE

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_SPEC.xml
> sql统计:复杂1个，简单13个
>
> 使用的关键字：and,in,CONCAT,group_concat,now,CJ_CMP_SPEC,values
#### queryWithPmType
```

        select spec.*, group_concat(pmType.NAME) pmType from CJ_CMP_SPEC spec
        left join CJ_CMP_SPEC_X_PM_TYPE rel on spec.ID = rel.SPEC_ID
        left join CJ_CMP_PM_TYPE pmType on rel.PM_TYPE_ID = pmType.ID and pmType.IS_DELETED=0
        where spec.IS_DELETED = 0
        <if test="name != null and name != ''">
            and spec.NAME like CONCAT('%',#{name},'%')
        </if>
        <if test="needCustom != null and needCustom == false">
            and spec.NAME != '自定义规格'
        </if>
        group by spec.ID
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_SPEC_CATAGORY.xml
> sql统计:复杂1个，简单8个
>
> 使用的关键字：CJ_CMP_SPEC_CATAGORY,values,ifnull,JOIN,count,in,now
#### queryAll
```

        SELECT catagory.ID AS id,catagory.NAME AS name,ifnull(spec.num,0) num 
        FROM CJ_CMP_SPEC_CATAGORY catagory 
        LEFT JOIN (
            select SPEC_CATAGORY_ID,count(distinct s.ID) as num from CJ_CMP_SPEC s
            <if test="memberId != null and memberId != 0">
                inner join CJ_CMP_SPEC_X_MEMBER xm on xm.SPEC_ID=s.ID and xm.IS_DELETED=0 and xm.MEMBER_ID=#{memberId}
            </if>
            where s.IS_DELETED = 0 group by SPEC_CATAGORY_ID
        ) spec ON catagory.ID = spec.SPEC_CATAGORY_ID
        WHERE  catagory.IS_DELETED = 0;
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_SPEC_X_MEMBER.xml
> sql统计:复杂1个，简单7个
>
> 使用的关键字：NOW,ceil,ifnull,exists,CJ_CMP_SPEC_X_MEMBER,values,concat,and,now
#### queryUnRelList
```

        select distinct sat.CODE as SERVICE_ACCOUNT_TYPE,sat.NAME as SERVICE_ACCOUNT_TYPE_NAME,s.ID as specId,s.NAME,s.CPU,s.MEMORY,sc.NAME as CATAGORY
        from CJ_CMP_SPEC s
        INNER JOIN CJ_SYS_DIC sat on sat.TYPE_CODE='SERVICE_ACCOUNT_TYPE'
        LEFT JOIN CJ_CMP_SPEC_CATAGORY sc on sc.ID=s.SPEC_CATAGORY_ID
        LEFT JOIN CJ_CMP_SPEC_X_PM_TYPE xp on xp.SPEC_ID=s.ID
        LEFT JOIN CJ_CMP_SPEC_X_MEMBER x on s.ID=x.SPEC_ID and x.IS_DELETED=0 and x.MEMBER_ID=#{memberId} and x.SERVICE_ACCOUNT_TYPE=sat.CODE and ifnull(x.PM_TYPE_ID,0) =ifnull(xp.PM_TYPE_ID,0)
        where s.IS_DELETED=0 and x.ID is null
        and exists (select xs.SPEC_ID from CJ_CMP_SPEC_X_VM_SPEC xs, CJ_CMP_SERVICE_ACCOUNT sa where xs.SERVICE_ACCOUNT_ID=sa.ID and xs.SPEC_ID=s.ID and sa.TYPE=sat.CODE)
        <if test="searchKey!='' and searchKey != null">
            <choose>
                <when test="searchType=='serviceAccountType'">
                    and sat.NAME like concat('%',#{searchKey},'%')
                </when>
                <when test="searchType=='spec'">
                    and s.NAME like concat('%',#{searchKey},'%')
                </when>
                <when test="searchType=='catagory'">
                    and sc.NAME like concat('%',#{searchKey},'%')
                </when>
                <otherwise>
                    and (sat.NAME like concat('%',#{searchKey},'%') or s.NAME like concat('%',#{searchKey},'%') or sc.NAME like concat('%',#{searchKey},'%'))
                </otherwise>
            </choose>
        </if>
        order by sat.NAME,CPU,MEMORY
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_SPEC_X_PM_TYPE.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：join,IN,now,CJ_CMP_SPEC_X_PM_TYPE,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_SPEC_X_VM_SPEC.xml
> sql统计:复杂1个，简单10个
>
> 使用的关键字：now,coalesce,and,in,CJ_CMP_SPEC_X_VM_SPEC,values
#### queryBySpecId
```

      SELECT xSpec.ID as id,sa.ID as serviceAccountId,sa.NAME,sa.DATACENTER_TYPE, vmSpec.ENTITY_ID,vmSpec.NAME AS entityName,
		  dc.ID as ldcId,dc.NAME as datacenter,coalesce(az.NAME,clu.NAME,fcClu.NAME) as azName,xSpec.AZ_ID as azId
		FROM CJ_CMP_SPEC_X_VM_SPEC xSpec
		join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID=xSpec.SERVICE_ACCOUNT_ID
		LEFT JOIN CJ_CMP_VM_SPEC vmSpec ON xSpec.VM_SPEC_ID = vmSpec.ID
		left outer join CJ_CMP_VMWARE_CLUSTER clu on clu.SERVICE_ACCOUNT_ID=sa.ID and clu.ID=xSpec.AZ_ID
        left outer join CJ_CMP_FUSION_COMPUTE_CLUSTER fcClu on fcClu.SERVICE_ACCOUNT_ID=sa.ID and fcClu.ID=xSpec.AZ_ID
		left outer join CJ_CMP_CLOUD_AZ az on az.SERVICE_ACCOUNT_ID=sa.ID and az.ID=xSpec.AZ_ID
		JOIN CJ_CMP_DC_VIEW dc on dc.LDC_TYPE=sa.DATACENTER_TYPE and dc.ID=xSpec.LDC_ID
        WHERE xSpec.SPEC_ID = #{id} 
        <if test="serviceAccountId != null">
            and xSpec.SERVICE_ACCOUNT_ID=#{serviceAccountId}
        </if>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_STORAGE_ARRAY.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：and,from,count,now,CJ_CMP_STORAGE_ARRAY,values,concat

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_STORAGE_ARRAY_X_DATASTORE.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：and,CONCAT,in,CJ_CMP_STORAGE_ARRAY_X_DATASTORE,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_STORAGE_VIEW.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_TASK_OPERATION_HISTORY.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：CJ_CMP_TASK_OPERATION_HISTORY,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_USER_PROFILE.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：CJ_CMP_USER_PROFILE,VALUES,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_VDS.xml
> sql统计:复杂2个，简单7个
>
> 使用的关键字：group_concat,if,CONCAT,values,count,from,concat,in,and
#### selectById
```

    select
      vds.ID,vds.MEMBER_ID,vds.ENTITY_ID,vds.SERVICE_ACCOUNT_ID,vds.NAME,vds.LDC_ID,vds.LDC_TYPE,vds.STATUS,vds.DESCRIPTION, vds.TYPE as cloudWebType, group_concat(vmHost.NAME) as hostName,
      dc.name  as ldcName,
       saccount.DATACENTER_TYPE as sAccountType,
      saccount.ACCOUNT_ID as sAccountEntityId,
      saccount.NAME as sAccountName,
      (select count(0) from CJ_CMP_VDS_PORTGROUP where VDS_ID = #{id} )  as PORT_GROUP_NUM
    from CJ_CMP_VDS vds
    inner join CJ_CMP_VMWARE_DC dc on vds.LDC_ID = dc.ID
    inner join CJ_CMP_SERVICE_ACCOUNT saccount on vds.SERVICE_ACCOUNT_ID = saccount.ID
    left join CJ_CMP_CLOUD_ACCOUNT_DC cdc on dc.SERVICE_ACCOUNT_ID = cdc.SERVICE_ACCOUNT_ID and dc.ID = cdc.LDC_ID and cdc.IS_DELETED = 0
    left join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED = 0
    left join CJ_CMP_VDS_X_HOST vdsRel on vds.ID = vdsRel.VDS_ID
    left join CJ_CMP_VMWARE_HOST vmHost on vdsRel.HOST_ID = vmHost.ID
    where vds.ID = #{id,jdbcType=BIGINT}
    <choose>
      <when test="memberId != 0">
        and ca.MEMBER_ID = #{memberId}
      </when>
      <otherwise>
        and ca.SCOPE = 'public'
      </otherwise>
    </choose>
    group by vds.ID
  
```
#### selectByKeyValueAndServiceAccount
```

    select * from (select  vds.ID,vds.MEMBER_ID,vds.ENTITY_ID,vds.SERVICE_ACCOUNT_ID,
    if(vds.TYPE = 'VSS',concat(vds.NAME, if(group_concat(vmHost.IP) is null, '', concat('[', group_concat(vmHost.IP), ']'))),vds.NAME) as NAME,
           vds.TYPE, vds.LDC_ID,vds.LDC_TYPE,vds.STATUS,vds.DESCRIPTION, group_concat(vmHost.NAME) as hostName,
    (select count(0) from CJ_CMP_VDS_PORTGROUP vpg where vds.ID = vpg.VDS_ID )  as PORT_GROUP_NUM,
    dc.name as ldcName, saccount.NAME as sAccountName
    from CJ_CMP_VDS vds
    inner join CJ_CMP_VMWARE_DC dc on vds.LDC_ID = dc.ID
    inner join CJ_CMP_SERVICE_ACCOUNT saccount on vds.SERVICE_ACCOUNT_ID = saccount.ID
    left join CJ_CMP_CLOUD_ACCOUNT_DC cdc on dc.SERVICE_ACCOUNT_ID = cdc.SERVICE_ACCOUNT_ID and dc.ID = cdc.LDC_ID and cdc.IS_DELETED = 0
    left join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED = 0
    left join CJ_CMP_VDS_X_HOST vdsRel on vds.ID = vdsRel.VDS_ID
    left join CJ_CMP_VMWARE_HOST vmHost on vdsRel.HOST_ID = vmHost.ID
    <where>
      <choose>
        <when test="memberId != 0">
          and ca.MEMBER_ID = #{memberId}
        </when>
        <otherwise>
          and ca.SCOPE = 'public'
        </otherwise>
      </choose>
    <if test="serviceAccountId != 'ALL'" >
      and vds.SERVICE_ACCOUNT_ID = #{serviceAccountId}
    </if>
    <if test="cloudAccountId != 'ALL'" >
      and vds.LDC_ID in (
      select cadc.LDC_ID from  CJ_CMP_CLOUD_ACCOUNT_DC cadc where cadc.CLOUD_ACCOUNT_ID = #{cloudAccountId}
      )
    </if>
    <if test="ldcId != '' and ldcId != null" >
      and vds.LDC_ID = #{ldcId}
    </if>
    </where>
    group by vds.ID) t where 1 = 1
    <if test="queryValue != null" >
      <if test="queryValue != ''" >
      <choose>
          <when test="queryKey == 'ALL'" >
              and (
              t.NAME like CONCAT('%',#{queryValue},'%')
              OR t.ENTITY_ID like CONCAT('%',#{queryValue},'%')
              )
          </when>
          <otherwise>
              <if test="queryKey == 'ENTITY_ID'" >
                  and t.ENTITY_ID like CONCAT('%',#{queryValue},'%')
              </if>
              <if test="queryKey == 'NAME'" >
                  and t.NAME like CONCAT('%',#{queryValue},'%')
              </if>
          </otherwise>
      </choose>
      </if>
    </if>

  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_VDS_PORTGROUP.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：count,values,IF,ISNULL,and,CONCAT

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_VMWARE_CLUSTER.xml
> sql统计:复杂1个，简单6个
>
> 使用的关键字：sum,round,and,size,in
#### queryCluster
```

        select clu.ID,
        clu.NAME,
        clu.ENTITY_ID,
        cdc.LDC_ID,
        cdc.LDC_TYPE,
        dc.ENTITY_ID                                  as ldcEntityId,
        dc.NAME                                       as ldcName,
        sa.NAME                                       as serviceAccountName,
        sa.ID                                         as serviceAccountId,
        sum(host.CPUS)                                as cpuSum,
        sum(host.CPU_USED)                            as cpuUsed,
        sum(host.MEMORY_SUM) / 1024                   as memorySum,
        sum(host.MEMORY_USED) / 1024                  as memoryUsed,
        sum(host.DISK_SUM)                            as localStorageSum,
        sum(host.DISK_USED)                           as localStorageUsed,
        round((sum(host.CPU_USED) / sum(host.CPUS)) * 100 , 2) as cpuUsage,
        round((sum(host.MEMORY_USED) / sum(host.MEMORY_SUM)) * 100, 2)  as memoryUsage,
        round((sum(host.DISK_USED) / sum(host.DISK_SUM)) * 100, 2) as localStorageUsage
        from CJ_CMP_SERVICE_ACCOUNT sa
        inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc
        on sa.ID = cdc.SERVICE_ACCOUNT_ID and sa.IS_DELETED = 0 AND cdc.IS_DELETED = 0
        inner join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED = 0
        inner join CJ_CMP_VMWARE_DC dc on cdc.LDC_ID = dc.ID and dc.IS_DELETED = 0 and dc.SERVICE_ACCOUNT_ID = sa.ID
        inner join CJ_CMP_VMWARE_CLUSTER clu on dc.ID = clu.LDC_ID
        left join CJ_CMP_VMWARE_HOST host on host.CLUSTER_ID = clu.ID
        where dc.IS_DELETED=0
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>
        <if test="clusterId != null and clusterId != ''"> and clu.ID=#{clusterId}</if>
        <if test="serviceAccountId != null and serviceAccountId != ''"> and sa.ID=#{serviceAccountId}</if>
        <if test="cloudAccountId != null and cloudAccountId != ''"> and ca.ID=#{cloudAccountId}</if>
        <if test="ldcId != null and ldcId != ''"> and cdc.LDC_ID=#{ldcId}</if>
        <if test="ldcType != null and ldcType != ''"> and cdc.LDC_TYPE=#{ldcType}</if>
        <if test="searchKey != null and searchKey != ''"> and (clu.NAME like #{searchKey} or clu.ENTITY_ID like #{searchKey})</if>
        <if test="name != null and name != ''"> and clu.NAME like #{name} </if>
        <if test="ldcIds != null and ldcIds.size()>0">
           and cdc.LDC_ID IN <foreach collection="ldcIds" item="ldc" open="(" separator="," close=")"> #{ldc} </foreach>
        </if>
        group by clu.ID, clu.NAME, clu.ENTITY_ID, cdc.LDC_ID, cdc.LDC_TYPE, dc.ENTITY_ID, dc.NAME, sa.NAME, sa.ID
        <if test="sortField != null and sortField!= '' and sortType != null and sortType!= '' ">
            <choose>
                <when test="sortField == 'cpuUsage' or sortField == 'memoryUsage' or sortField == 'localStorageUsage'">
                    ORDER BY ${sortField} ${sortType}
                </when>
                <otherwise>
                    order by clu.NAME
                </otherwise>
            </choose>
        </if>
        <if test="sortField == null or sortType == null ">
            order by clu.NAME
        </if>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_VMWARE_DATASTORE.xml
> sql统计:复杂5个，简单10个
>
> 使用的关键字：sum,if,IN,and,in,round,join,group_concat,size
#### queryDatastore
```

        SELECT ds.ID,ds.SERVICE_ACCOUNT_ID,ds.NAME,ds.ENTITY_ID,ds.IS_DISABLED,ds.DISK_SUM,ds.DISK_FREE,ds.PROVISIONED,ds.TYPE,ds.IS_CLUSTERED,cdc.LDC_TYPE,cdc.LDC_ID,dc.NAME as ldcName,dc.ENTITY_ID as ldcEntityId, store.*,
        ((ds.DISK_SUM - DISK_FREE) / DISK_SUM) as diskUsage,  ((ds.PROVISIONED) / DISK_SUM) as provisionUsage
        FROM CJ_CMP_CLOUD_ACCOUNT ca
        inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc on ca.ID=cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED=0 and cdc.LDC_TYPE='vmware' AND cdc.IS_DELETED=0
        inner join CJ_CMP_VMWARE_DC dc on cdc.LDC_ID=dc.ID and cdc.IS_DELETED=0 and dc.IS_DELETED=0
        inner join CJ_CMP_VMWARE_DATASTORE ds ON ds.LDC_ID= dc.ID and ds.SERVICE_ACCOUNT_ID=dc.SERVICE_ACCOUNT_ID
        left join
        (
        SELECT group_concat(clu.ID) as CLUSTER_ID, group_concat(host.ID) as HOST_ID, group_concat(clu.NAME) AS clusterName , group_concat(clu.ENTITY_ID) clusterEntityId, group_concat(host.NAME) as hostName, group_concat(host.ENTITY_ID) as hostEntityId, group_concat(host.IP)as hostIp,dt.ID AS dsId
        FROM CJ_CMP_VMWARE_HOST host LEFT JOIN CJ_CMP_VMWARE_CLUSTER clu ON host.CLUSTER_ID = clu.ID
        inner join CJ_CMP_VMWARE_DATASTORE_HOSTMOUNT mou on mou.VMWARE_HOST_ID=host.ID
        inner join CJ_CMP_VMWARE_DATASTORE dt on dt.ID=mou.VMWARE_DATASTORE_ID
        <where>
            <if test="clusterIds != null and clusterIds.size()>0">
                and clu.ID IN <foreach collection="clusterIds" item="clu" open="(" separator="," close=")"> #{clu} </foreach>
            </if>
            <if test="hostId != null and hostId != ''"> and host.ID=#{hostId}</if>
        </where>
        GROUP BY dsId
        ) store ON dsId= ds.ID
        <where>
            <choose>
                <when test="memberId != 0">
                    and ca.MEMBER_ID = #{memberId}
                </when>
                <otherwise>
                    and ca.SCOPE = 'public'
                </otherwise>
            </choose>
            <if test="id != null and id != ''"> and ds.ID=#{id}</if>
            <if test="serviceAccountId != null and serviceAccountId != ''"> and cdc.SERVICE_ACCOUNT_ID=#{serviceAccountId}</if>
            <if test="cloudAccountId != null and cloudAccountId != ''"> and ca.ID=#{cloudAccountId}</if>
            <if test="ldcId != null and ldcId != ''"> and dc.ID=#{ldcId}</if>
            <if test="name != null and name != ''"> and ds.NAME like #{name}</if>
            <if test="clusterId != null and clusterId != ''"> and store.CLUSTER_ID=#{clusterId}</if>
            <if test="hostId != null and hostId != ''"> and store.HOST_ID=#{hostId}</if>
            <if test="entityId != null and entityId != ''"> and ds.ENTITY_ID like #{entityId}</if>
            <if test="searchKey != null and searchKey != ''"> and (ds.NAME like #{searchKey} or ds.ENTITY_ID like #{searchKey} or hostIp like #{searchKey})</if>
            <if test="hostIp != null and hostIp != ''"> and hostIp like #{hostIp}</if>
            <if test="ldcIds != null and ldcIds.size()>0">
                and dc.ID IN <foreach collection="ldcIds" item="ldc" open="(" separator="," close=")"> #{ldc} </foreach>
            </if>
            <if test="clusterIds != null and clusterIds.size()>0">
                and store.CLUSTER_ID IN <foreach collection="clusterIds" item="clu" open="(" separator="," close=")"> #{clu} </foreach>
            </if>
        </where>
        <if test="sortField != null and sortField!= '' and sortType != null and sortType!= '' ">
            ORDER BY ${sortField} ${sortType}
        </if>
                   
    
```
#### statisticDataStoreByServiceAccoutId
```

        SELECT
            sum(da.DISK_SUM)  as DISK_SUM,
            sum(da.DISK_SUM - da.DISK_FREE) as DISK_USED,
            round(if(sum(da.DISK_SUM) = 0, 0, sum(da.DISK_SUM - da.DISK_FREE) / sum(da.DISK_SUM)), 2) * 100 as DISK_USAGE
        FROM CJ_CMP_VMWARE_DATASTORE da
        where SERVICE_ACCOUNT_ID = #{serviceAccountId};
    
```
#### statisticDataStoreByCloudAccoutId
```

        SELECT
        sum(da.DISK_SUM)  as DISK_SUM,
        sum(da.DISK_SUM - da.DISK_FREE) as DISK_USED,
        round(if(sum(da.DISK_SUM) = 0, 0, sum(da.DISK_SUM - da.DISK_FREE) / sum(da.DISK_SUM)), 2) * 100 as DISK_USAGE
        FROM CJ_CMP_VMWARE_DATASTORE da
        where LDC_ID IN (select adc.LDC_ID
                                    from CJ_CMP_CLOUD_ACCOUNT_DC adc inner join CJ_CMP_CLOUD_ACCOUNT ca on adc.CLOUD_ACCOUNT_ID = ca.ID
                                    where adc.CLOUD_ACCOUNT_ID = #{cloudAccountId} AND adc.IS_DELETED = 0
                                    <choose>
                                        <when test="memberId != 0">
                                            and ca.MEMBER_ID = #{memberId}
                                        </when>
                                        <otherwise>
                                            and ca.SCOPE = 'public'
                                        </otherwise>
                                    </choose>);
    
```
#### statisticDataStoreTypeBySaId
```

        select
            TYPE,
            SERVICE_ACCOUNT_ID,
            sum(DISK_SUM)             as DISK_SUM,
            sum(DISK_FREE)            as DISK_FREE,
            sum(DISK_SUM - DISK_FREE) as DISK_USED,
            sum(PROVISIONED)          as PROVISIONED,
            round(if(sum(DISK_SUM) = 0, 0, sum(DISK_SUM - DISK_FREE) / sum(DISK_SUM)), 2) * 100 as DISK_USAGE
        from CJ_CMP_VMWARE_DATASTORE where SERVICE_ACCOUNT_ID = #{serviceAccountId}
        group by TYPE, SERVICE_ACCOUNT_ID, MEMBER_ID
    
```
#### statisticDataStoreTypeByCaId
```

        select
            TYPE,
            LDC_ID,
            sum(DISK_SUM)                                                                       as DISK_SUM,
            sum(DISK_FREE)                                                                      as DISK_FREE,
            sum(DISK_SUM - DISK_FREE)                                                           as DISK_USED,
            sum(PROVISIONED)                                                                    as PROVISIONED,
            round(if(sum(DISK_SUM) = 0, 0, sum(DISK_SUM - DISK_FREE) / sum(DISK_SUM)), 2) * 100 as DISK_USAGE
        from CJ_CMP_VMWARE_DATASTORE where LDC_ID in (select adc.LDC_ID from CJ_CMP_CLOUD_ACCOUNT_DC adc inner join CJ_CMP_CLOUD_ACCOUNT ca on adc.CLOUD_ACCOUNT_ID = ca.ID
                                                            where adc.CLOUD_ACCOUNT_ID = #{cloudAccountId} AND adc.IS_DELETED = 0
                                                            <choose>
                                                                <when test="memberId != 0">
                                                                    and ca.MEMBER_ID = #{memberId}
                                                                </when>
                                                                <otherwise>
                                                                    and ca.SCOPE = 'public'
                                                                </otherwise>
                                                            </choose>)
        group by TYPE, LDC_ID, MEMBER_ID
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_VMWARE_DC.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：VALUES,now,NOW,CJ_CMP_VMWARE_DC

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_VMWARE_FOLDER.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_VMWARE_HOST.xml
> sql统计:复杂3个，简单11个
>
> 使用的关键字：count,and,round,if,in,sum,select,group_concat,size
#### queryByServiceAccountId
```

        select
        host.ID,
        host.NAME,
        host.CPUS,
        host.CPU_USED,
        round(if(host.MEMORY_SUM is not null ,host.MEMORY_SUM/1024,0),2)                              as MEMORY_SUM,
        round(if(host.MEMORY_USED is not null ,host.MEMORY_USED/1024,0),2)                              as MEMORY_USED,
        host.DISK_SUM,
        host.DISK_USED,
        host.SERVICE_ACCOUNT_ID
        from CJ_CMP_VMWARE_HOST host
        <where>
            <if test="serviceAccountId != null and serviceAccountId != ''"> and host.SERVICE_ACCOUNT_ID=#{serviceAccountId}</if>
        </where>
    
```
#### queryByCloudAccountId
```

        select
            host.ID,
            host.NAME,
            host.CPUS,
            host.CPU_USED,
            round(if(host.MEMORY_SUM is not null ,host.MEMORY_SUM/1024,0),2)                              as MEMORY_SUM,
            round(if(host.MEMORY_USED is not null ,host.MEMORY_USED/1024,0),2)                              as MEMORY_USED,
            host.DISK_SUM,
            host.DISK_USED,
            host.SERVICE_ACCOUNT_ID
        from CJ_CMP_VMWARE_HOST host
        where host.LDC_ID in (select adc.LDC_ID
        from CJ_CMP_CLOUD_ACCOUNT_DC adc inner join CJ_CMP_CLOUD_ACCOUNT ca on adc.CLOUD_ACCOUNT_ID = ca.ID
        where adc.CLOUD_ACCOUNT_ID = #{cloudAccountId} AND adc.IS_DELETED = 0
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>)
    
```
#### queryHostAndDataStoreIDByHostIdList
```

        select (select group_concat(VMWARE_DATASTORE_ID) from CJ_CMP_VMWARE_DATASTORE_HOSTMOUNT where VMWARE_HOST_ID=host.ID) as datastoreIds,host.* from CJ_CMP_VMWARE_HOST host
        where  host.ID in
         <foreach collection="list" open="(" close=")" item="id">
             #{id}
         </foreach>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_VMWARE_VC.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：NOW,in

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_VMWARE_VM.xml
> sql统计:复杂3个，简单42个
>
> 使用的关键字：size,if,in,sum,AND,VALUES,and,JOIN,FROM,round,ON,now,GROUP_CONCAT,count,ifnull,NOW,CJ_CMP_VMWARE_VM
#### getAllByCondition
```

        select vm.*,prj.CODE as projectCode,prj.NAME as projectName,prj.PROJECT_SOURCE_ID as projectSourceId,
        app.CODE as appSystemCode,app.NAME as appSystemName,app.SOURCE_ID as appSystemSourceId, vmtag.tags
        from CJ_CMP_VMWARE_VM vm
          <if test="srvCompletionTimeStart!=null or srvCompletionTimeEnd!=null ">
          left outer join CJ_CMP_RITM_COMPLETED_VIEW req on vm.SRV_NO=req.NUMBER
          </if>
          left outer join CJ_CMP_PROJECT prj on prj.ID=vm.PROJECT_ID
          left outer join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
          left outer join CJ_CMP_APP_DU du on du.ID=vm.APP_DU_ID
          LEFT JOIN (SELECT rel.OBJECT_ID, rel.OBJECT_TYPE, GROUP_CONCAT(tag.`NAME`) as tags from CJ_CMP_TAG tag INNER JOIN CJ_CMP_TAG_X_OBJECT rel on tag.ID = rel.TAG_ID GROUP BY rel.OBJECT_ID, rel.OBJECT_TYPE) as vmtag
          on vm.ID = vmtag.OBJECT_ID and vmtag.OBJECT_TYPE = 'vmware'
        <where>
            <if test="memberId != 0"> and vm.MEMBER_ID = #{memberId}</if>
            <if test="startTime!=null and endTime!=null ">
                and vm.CREATE_DATE between #{startTime,jdbcType= TIMESTAMP} and  #{endTime,jdbcType= TIMESTAMP}
            </if>
            <if test="startTime==null and endTime!=null ">
                and vm.CREATE_DATE &lt;=  #{endTime,jdbcType= TIMESTAMP}
            </if>
            <if test="startTime!=null and endTime==null ">
                and vm.CREATE_DATE &gt;=  #{startTime,jdbcType= TIMESTAMP}
            </if>

            <if test="srvCompletionTimeStart!=null and srvCompletionTimeEnd!=null ">
                and if(vm.IS_DELETED=1,vm.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) between #{srvCompletionTimeStart,jdbcType= TIMESTAMP} and  #{srvCompletionTimeEnd,jdbcType= TIMESTAMP}
            </if>
            <if test="srvCompletionTimeStart==null and srvCompletionTimeEnd!=null ">
                and if(vm.IS_DELETED=1,vm.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) &lt;=  #{srvCompletionTimeEnd,jdbcType= TIMESTAMP}
            </if>
            <if test="srvCompletionTimeStart!=null and srvCompletionTimeEnd==null ">
                and if(vm.IS_DELETED=1,vm.LAST_MODIFIED_DATE,req.LAST_MODIFIED_DATE) &gt;=  #{srvCompletionTimeStart,jdbcType= TIMESTAMP}
            </if>

            <if  test="isDeleted != null ">
                <choose>
                    <when test="isDeleted">
                        and vm.IS_DELETED=1
                    </when>
                    <otherwise>
                        and vm.IS_DELETED=0
                    </otherwise>
                </choose>
            </if>
        </where>
    
```
#### getAppSystemVmPmStatistics
```

        SELECT app.NAME AS name,app.MEMBER_ID AS memberId,info.* FROM (SELECT  vmPm.appSystemId,
        round(ifnull(sum(vmPm.cpu),0),0) AS cpu,
        round(ifnull(sum(vmPm.memory),0),0) AS memory,
        round(ifnull(sum(vmPm.disk),0),0) AS disk,
        sum(vmPm.pmNum) AS pmNum,
        sum(vmPm.vmNum) AS vmNum
        FROM
        (SELECT
        vm.APP_SYSTEM_ID AS appSystemId,
        ifnull(sum(vm.CPUS),0) AS cpu,
        ifnull(sum(vm.MEMORY),0)/1024 AS memory,
        ifnull(sum(vmDisk.DISK_SPACE),0) AS disk,
        0 AS pmNum,
        count(DISTINCT vm.ID) AS vmNum
        FROM cj_cmp_vm_view vm LEFT JOIN(
        SELECT vol.SERVICE_ACCOUNT_ID,vol.VM_DEVICE_ID,sum(vol.DISK_SPACE) DISK_SPACE from CJ_CMP_VM_VOLUME vol where vol.IS_DELETED = 0 group BY vol.SERVICE_ACCOUNT_ID,vol.VM_DEVICE_ID
        )vmDisk ON vmDisk.SERVICE_ACCOUNT_ID = vm.SERVICE_ACCOUNT_ID AND vmDisk.VM_DEVICE_ID=vm.ID
        <if test="memberId!=null and memberId!= 0 ">
            WHERE vm.MEMBER_ID = #{memberId}
        </if>
        GROUP BY vm.APP_SYSTEM_ID
        UNION ALL
        SELECT
        pm.APP_SYSTEM_ID AS appSystemId,
        ifnull(sum(pm.CPU_CORE_COUNT),0) AS cpu,
        ifnull(sum(pm.RAM),0) AS memory,
        ifnull(sum(pm.DISK_SPACE),0) AS disk,
        count(DISTINCT pm.ID) AS pmNum,
        0 AS vmNum
        FROM CJ_CMDB_CI_PHYSICAL_MACHINE pm
        WHERE pm.IS_DELETED = 0
        <if test="memberId!=null and memberId!= 0 ">
            AND pm.MEMBER_ID = #{memberId}
        </if>
        GROUP BY pm.APP_SYSTEM_ID) AS vmPm group by vmPm.appSystemId) AS info
        INNER JOIN CJ_CMP_APP_SYSTEM app ON info.appSystemId = app.ID
        <if test="appSystemId!=null and appSystemId!= '' ">
            WHERE app.ID =  #{appSystemId}
        </if>
    
```
#### getProjectVmPmStatistics
```

        SELECT info.*, project.NAME as name, project.MEMBER_ID AS memberId
        FROM
        (SELECT  vmPm.projectId,
        round(ifnull(sum(vmPm.cpu),0),0) AS cpu,
        round(ifnull(sum(vmPm.memory),0),0) AS memory,
        round(ifnull(sum(vmPm.disk),0),0) AS disk,
        sum(vmPm.pmNum) AS pmNum,
        sum(vmPm.vmNum) AS vmNum
        FROM
        (SELECT
        vm.PROJECT_ID AS projectId,
        ifnull(sum(vm.CPUS),0) AS cpu,
        ifnull(sum(vm.MEMORY),0)/1024 AS memory,
        ifnull(sum(vmDisk.DISK_SPACE),0) AS disk,
        0 AS pmNum,
        count(DISTINCT vm.ID) AS vmNum
        FROM cj_cmp_vm_view vm  LEFT JOIN(
        SELECT vol.SERVICE_ACCOUNT_ID,vol.VM_DEVICE_ID,sum(vol.DISK_SPACE) DISK_SPACE from CJ_CMP_VM_VOLUME vol where vol.IS_DELETED = 0 group BY vol.SERVICE_ACCOUNT_ID,vol.VM_DEVICE_ID
        )vmDisk ON vmDisk.SERVICE_ACCOUNT_ID = vm.SERVICE_ACCOUNT_ID AND vmDisk.VM_DEVICE_ID=vm.ID
        <if test="memberId != null and memberId != 0 ">
            WHERE vm.MEMBER_ID = #{memberId}
        </if>
        GROUP BY vm.PROJECT_ID
        UNION ALL
        SELECT
        pm.PROJECT_ID AS projectId,
        ifnull(sum(pm.CPU_CORE_COUNT),0) AS cpu,
        ifnull(sum(pm.RAM),0) AS memory,
        ifnull(sum(pm.DISK_SPACE),0) AS disk,
        count(DISTINCT pm.ID) AS pmNum,
        0 AS vmNum
        FROM CJ_CMDB_CI_PHYSICAL_MACHINE pm
        WHERE pm.IS_DELETED = 0
        <if test="memberId != null and memberId != 0 ">
            AND pm.MEMBER_ID = #{memberId}
        </if>
        GROUP BY pm.PROJECT_ID) AS vmPm group by vmPm.projectId) as info
        INNER JOIN CJ_CMP_PROJECT project ON info.projectId = project.ID AND project.IS_DELETED=0
        <if test="projectId != null and projectId != '' ">
            and project.ID = #{projectId}
        </if>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_VM_APP_SYSTEM_DAY_REPORT.xml
> sql统计:复杂1个，简单1个
>
> 使用的关键字：and,CJ_CMP_VM_APP_SYSTEM_DAY_REPORT,VALUES,ifnull,count,DATE
#### getTotalBySaAndTime
```

        SELECT
        ifnull(count( DISTINCT report.`NAME`),0) as num
        FROM CJ_CMP_VM_APP_SYSTEM_DAY_REPORT report
        left join CJ_CMP_APP_SYSTEM app on app.ID = report.APP_SYSTEM_ID
        WHERE
        STAT_TIME = DATE(#{statTime})
        <if test="memberId != 0">
            and report.MEMBER_ID = #{memberId}
            <if test="userIds != null and userIds.size >0 ">
                and (app.SYS_OPR_MANT_OWNER_ID in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
                or app.SYS_OPR_MANT_OWNER2_ID in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
                <if test="departmentList != null and departmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="departmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="departmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>)
            </if>
        </if>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_VM_DAY_REPORT.xml
> sql统计:复杂7个，简单10个
>
> 使用的关键字：DATE_FORMAT,DATE,sum,if,SUM,ifnull,round,and,size,max,min,CJ_CMP_VM_DAY_REPORT,VALUES,count,FROM,in,WHERE,concat,from
#### groupBySaAndTime
```

        SELECT
        ifnull(count(DISTINCT ENTITY_ID, SERVICE_ACCOUNT_ID), 0)                   AS num,
        DATE_FORMAT(vm.STAT_TIME, #{dateFormat}) AS days
        FROM (SELECT
        STAT_TIME,
        TYPE,
        ENTITY_ID,
        SERVICE_ACCOUNT_ID
        FROM CJ_CMP_VM_DAY_REPORT
        WHERE SERVICE_ACCOUNT_ID in (select ID from CJ_CMP_SERVICE_ACCOUNT where IS_DELETED = 0)
        <if test="memberId != 0">
            and MEMBER_ID = #{memberId}
        </if>
        AND LDC_TYPE in <foreach collection="ldcTypeList" item="ldcType" open="(" close=")" separator=",">#{ldcType}</foreach>
        GROUP BY STAT_TIME, TYPE, ENTITY_ID, SERVICE_ACCOUNT_ID) vm
        <where>
            <if test="serviceAccountId != null and serviceAccountId != ''">
                and vm.SERVICE_ACCOUNT_ID = #{serviceAccountId}
            </if>
            <if test="type != null and type != ''">
                and vm.TYPE=#{type}
            </if>
            <if test="startTime != null and endTime != null ">
                and (vm.STAT_TIME &gt;= DATE(#{startTime}) AND vm.STAT_TIME &lt;= DATE(#{endTime}))
            </if>
        </where>
        GROUP BY days
        ORDER BY days asc
    
```
#### getTotalBySaAndTime
```

        SELECT
            ifnull(count( DISTINCT ENTITY_ID, SERVICE_ACCOUNT_ID ),0) as num
        FROM
            CJ_CMP_VM_DAY_REPORT report
        INNER JOIN CJ_CMP_SERVICE_ACCOUNT sa ON sa.ID = report.SERVICE_ACCOUNT_ID
        AND sa.IS_DELETED = 0
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=report.APP_SYSTEM_ID  AND app.IS_DELETED = 0
        WHERE
            STAT_TIME = DATE(#{statTime})
            <if test="memberId != 0">
                and report.MEMBER_ID = #{memberId}
                <if test="userIds != null and userIds.size >0 ">
                    and  (
                    report.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
                    <if test="appUserId !=null ">
                        or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                        <if test="departmentList != null and departmentList.size != 0">
                            or app.DEPT_ID in <foreach collection="departmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                            or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="departmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                        </if>
                    </if>
                    )
                </if>
            </if>
    
```
#### getTotalDiskSumBySaAndTime
```

        select sum(if(DISK_SUM is null ,0,DISK_SUM)) as num
        from (SELECT DISTINCT report.ENTITY_ID, report.SERVICE_ACCOUNT_ID,report.DISK_SUM DISK_SUM
        FROM
        CJ_CMP_VM_DAY_REPORT report
        INNER JOIN CJ_CMP_SERVICE_ACCOUNT sa ON sa.ID = report.SERVICE_ACCOUNT_ID AND sa.IS_DELETED = 0
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=report.APP_SYSTEM_ID  AND app.IS_DELETED = 0
        WHERE
        STAT_TIME = DATE(#{statTime})
        <if test="memberId != 0">
            and report.MEMBER_ID = #{memberId}
            <if test="userIds != null and userIds.size >0 ">
                and  (
                report.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
                <if test="appUserId !=null ">
                    or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                    <if test="departmentList != null and departmentList.size != 0">
                        or app.DEPT_ID in <foreach collection="departmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                        or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="departmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    </if>
                </if>
                )
            </if>
        </if>) a
    
```
#### statPowerOnVmMemByHostId
```

        select
            count(*)    as powerOnVmSum,
            sum(MEMORY) as powerOnVmProvisionedMem
        from (select
                  round(max(MEMORY / 1024)) MEMORY
              from CJ_CMP_VM_DAY_REPORT
              where HOST_ID = #{hostId} and STAT_TIME = #{endTime} and RUN_STATUS = 'running' and MEMBER_ID = #{memberId}
              group by ENTITY_ID,SERVICE_ACCOUNT_ID) vm;
    
```
#### statAllocateMemByHostId
```

        select sum(MEMORY) as provisionedMem
        from (select round(max(MEMORY / 1024)) MEMORY
              from CJ_CMP_VM_DAY_REPORT
              where HOST_ID = #{hostId} and STAT_TIME = #{endTime} and MEMBER_ID = #{memberId}
              group by ENTITY_ID,SERVICE_ACCOUNT_ID) vm;
    
```
#### countCloudVm
```

        select count(*) as num, SUM(ifnull(vm.DISK_SUM,0)) as diskSum
        from CJ_CMP_VM_DAY_REPORT vm
        left outer join CJ_CMP_APP_SYSTEM app on app.ID = vm.APP_SYSTEM_ID
        where vm.MEMBER_ID = #{memberId}
        <if test="userIds != null and userIds.size >0">
            and ( vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
            )
        </if>
        <if test="startTime != null and endTime != null ">
            and (vm.CREATE_DATE &gt;= DATE(#{startTime}) AND vm.CREATE_DATE &lt;= DATE(#{endTime}))
        </if>
    
```
#### groupByTime
```

        SELECT
        ifnull( count( DISTINCT ENTITY_ID, SERVICE_ACCOUNT_ID ), 0 ) AS num,
        DATE_FORMAT(report.STAT_TIME, #{dateFormat}) AS days
        FROM
        CJ_CMP_VM_DAY_REPORT report
        LEFT OUTER JOIN CJ_CMP_APP_SYSTEM app ON app.ID = report.APP_SYSTEM_ID
        inner join CJ_CMP_SERVICE_ACCOUNT sa on sa.id = report.SERVICE_ACCOUNT_ID and sa.IS_DELETED = 0
        WHERE
        (report.STAT_TIME &gt;= DATE(#{startTime}) AND report.STAT_TIME &lt;= DATE(#{endTime}))
        <if test="memberId != 0">
            and report.MEMBER_ID = #{memberId}
        </if>
        <if test="userIds != null and userIds.size >0">
            and ( report.OWNED_BY in
            <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId}
                or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in
                    <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">
                        #{department}
                    </foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in
                    <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">
                        #{department}
                    </foreach>
                </if>
            </if>
            )
        </if>
        GROUP BY days
        ORDER BY days asc
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_VM_DEPT_DAY_REPORT.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：CJ_CMP_VM_DEPT_DAY_REPORT,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_VM_IMAGE.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：and,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_VM_ISSUE_VIEW.xml
> sql统计:复杂1个，简单0个
>
> 使用的关键字：CURDATE,date,FROM,count,DATE_SUB
#### queryAppTopByIssue
```

    SELECT vmInfo.appName, vmInfo.num
        FROM (SELECT
        app.NAME AS appName,
        count(1) AS num
        FROM cj_cmp_vm_issue_view vm
        inner join CJ_CMP_APP_SYSTEM app on app.ID = vm.APP_SYSTEM_ID
        where vm.MEMBER_ID = #{memberId} and DATE_SUB(CURDATE(), INTERVAL #{intervalTime} MONTH ) &lt;= date(vm.CREATE_DATE)
        group by app.NAME
        order by app.NAME) AS vmInfo
    order by vmInfo.num desc
    limit 10;
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_VM_PERFORMANCE_METRIC_DAY_REPORT.xml
> sql统计:复杂3个，简单3个
>
> 使用的关键字：decimal,now,ifnull,JOIN,curdate,concat,sum,avg,AVG,SUM,cast,DATE_SUB,CEILING,ROUND,round,MAX,DATE,CJ_CMP_VM_PERFORMANCE_METRIC_DAY_REPORT,values,max,and
#### queryEcsPerformanceList
```

    SELECT
    vm.`NAME`           vmName,
    vm.MEMBER_ID        memberId,
    vm.ID               vmId,
    vm.APP_DU_ID        appUnitId,
    app.ID              appSystemId,
    app.NAME            appSystemName,
    vm.IP               ip,
    vm.LDC_ID           ldcId,
    vm.OWNED_BY         ownedBy,
    table_total.*
    FROM CJ_CMP_VMWARE_VM vm LEFT JOIN CJ_CMP_APP_SYSTEM app ON vm.APP_SYSTEM_ID=app.ID AND app.IS_DELETED=0
    , (SELECT
    CEILING(max(day_report.CPUS))                                                           cpus,
    ROUND(avg(day_report.CPU_UTILIZATION), 2)                                               cpuUtilisation,
    ROUND(avg(day_report.CPU_USED), 2)                                                      cpuUsed,
    ROUND(avg(day_report.MEMORY_UTILIZATION), 2)                                            memoryUtilisation,
    ROUND(avg(day_report.DISK_UTILIZATION), 2)                                              diskUtilisation,
    CEILING(max(day_report.MEMORY_SUM) / 1024)                                              memorySum,
    ROUND(AVG((1 - day_report.MEMORY_UTILIZATION / 100) * day_report.MEMORY_SUM / 1024), 2) memoryFree,
    CEILING(max(day_report.DISK_SUM))                                                       diskSum,
    ROUND(avg(day_report.MAX_CPU_USED), 2)                                                  maxCpuUsed,
    ROUND(max(day_report.MAX_CPU_UTILIZATION), 2)                                           maxCpuUtilisation,
    ROUND(max(day_report.MAX_MEMORY_UTILIZATION), 2)                                        maxMemoryUtilisation,
    day_report.SERVICE_ACCOUNT_ID                                                           serviceAccountId,
    day_report.VM_ENTITY_ID                                                                 vmEntityId
    FROM CJ_CMP_VM_PERFORMANCE_METRIC_DAY_REPORT day_report
    WHERE day_report.TIME &gt;= #{startDate} AND day_report.TIME &lt;= #{endDate}
    GROUP BY day_report.SERVICE_ACCOUNT_ID, day_report.VM_ENTITY_ID) table_total
    WHERE table_total.vmEntityId = vm.ENTITY_ID AND vm.ENTITY_ID is NOT NULL AND vm.SERVICE_ACCOUNT_ID = table_total.serviceAccountId and vm.MEMBER_ID = #{memberId}
    <if test="appSystemId != null and appSystemId !='' " >
      and app.ID = #{appSystemId}
    </if>
    <if test="userIds != null and userIds.size>0 " >
      and vm.OWNED_BY in <foreach item="userId" index="index" collection="userIds" open="(" separator="," close=")"> #{userId} </foreach>
    </if>
    <if test="ids != null and ids.size>0 " >
      and vm.ID in <foreach item="id" index="index" collection="ids" open="(" separator="," close=")"> #{id} </foreach>
    </if>
    <if test="searchKey != null and searchKey !='' " >
      and ( vm.NAME like concat('%', #{searchKey}, '%') or vm.IP like concat('%', #{searchKey}, '%') )
    </if>
    UNION ALL
    SELECT
    vm.`NAME`           vmName,
    vm.MEMBER_ID        memberId,
    vm.ID               vmId,
    vm.APP_DU_ID        appUnitId,
    app.ID              appSystemId,
    app.NAME            appSystemName,
    vm.IP               ip,
    vm.LDC_ID           ldcId,
    ''                  ownedBy,
    table_total.*
    FROM CJ_CMDB_CI_QINGCLOUD_VM_INSTANCE vm LEFT JOIN CJ_CMP_APP_SYSTEM app ON vm.APP_SYSTEM_ID=app.ID AND app.IS_DELETED=0
    , (SELECT
    CEILING(max(day_report.CPUS))                                                           cpus,
    ROUND(avg(ifnull(day_report.CPU_UTILIZATION,0.00)), 2)                                  cpuUtilisation,
    ROUND(avg(day_report.CPU_USED), 2)                                                      cpuUsed,
    ROUND(avg(ifnull(day_report.MEMORY_UTILIZATION,0.00)), 2)                               memoryUtilisation,
    ROUND(avg(day_report.DISK_UTILIZATION), 2)                                              diskUtilisation,
    CEILING(max(day_report.MEMORY_SUM) / 1024)                                              memorySum,
    ROUND(AVG((1 - day_report.MEMORY_UTILIZATION / 100) * day_report.MEMORY_SUM / 1024), 2) memoryFree,
    CEILING(max(day_report.DISK_SUM))                                                       diskSum,
    ROUND(max(day_report.CPU_USED), 2)                                                      maxCpuUsed,
    ROUND(max(day_report.CPU_UTILIZATION), 2)                                               maxCpuUtilisation,
    ROUND(max(day_report.MEMORY_UTILIZATION), 2)                                            maxMemoryUtilisation,
    day_report.SERVICE_ACCOUNT_ID                                                           serviceAccountId,
    day_report.VM_ENTITY_ID                                                                 vmEntityId
    FROM CJ_CMP_VM_PERFORMANCE_METRIC_DAY_REPORT day_report
    WHERE day_report.TIME &gt;= #{startDate} AND day_report.TIME &lt;= #{endDate}
    GROUP BY day_report.SERVICE_ACCOUNT_ID, day_report.VM_ENTITY_ID) table_total
    WHERE table_total.vmEntityId = vm.ENTITY_ID AND vm.ENTITY_ID is NOT NULL AND vm.SERVICE_ACCOUNT_ID = table_total.serviceAccountId and vm.MEMBER_ID = #{memberId}
    <if test="appSystemId != null and appSystemId !='' " >
      and app.ID = #{appSystemId}
    </if>
    <if test="ids != null and ids.size>0 " >
      and vm.ID in <foreach item="id" index="index" collection="ids" open="(" separator="," close=")"> #{id} </foreach>
    </if>
    <if test="searchKey != null and searchKey !='' " >
      and ( vm.NAME like concat('%', #{searchKey}, '%') or vm.IP like concat('%', #{searchKey}, '%') )
    </if>
    UNION ALL
    SELECT
    vm.`NAME`           vmName,
    vm.MEMBER_ID        memberId,
    vm.ID               vmId,
    vm.APP_DU_ID        appUnitId,
    app.ID              appSystemId,
    app.NAME            appSystemName,
    vm.IP               ip,
    vm.LDC_ID           ldcId,
    ''                  ownedBy,
    table_total.*
    FROM CJ_CMP_CLOUDOS_VM vm LEFT JOIN CJ_CMP_APP_SYSTEM app ON vm.APP_SYSTEM_ID=app.ID AND app.IS_DELETED=0
    , (SELECT
    CEILING(max(day_report.CPUS))                                                           cpus,
    ROUND(avg(ifnull(day_report.CPU_UTILIZATION,0.00)), 2)                                  cpuUtilisation,
    ROUND(avg(day_report.CPU_USED), 2)                                                      cpuUsed,
    ROUND(avg(ifnull(day_report.MEMORY_UTILIZATION,0.00)), 2)                               memoryUtilisation,
    ROUND(avg(day_report.DISK_UTILIZATION), 2)                                              diskUtilisation,
    CEILING(max(day_report.MEMORY_SUM) / 1024)                                              memorySum,
    ROUND(AVG((1 - day_report.MEMORY_UTILIZATION / 100) * day_report.MEMORY_SUM / 1024), 2) memoryFree,
    CEILING(max(day_report.DISK_SUM))                                                       diskSum,
    ROUND(max(day_report.CPU_USED), 2)                                                      maxCpuUsed,
    ROUND(max(day_report.CPU_UTILIZATION), 2)                                               maxCpuUtilisation,
    ROUND(max(day_report.MEMORY_UTILIZATION), 2)                                            maxMemoryUtilisation,
    day_report.SERVICE_ACCOUNT_ID                                                           serviceAccountId,
    day_report.VM_ENTITY_ID                                                                 vmEntityId
    FROM CJ_CMP_VM_PERFORMANCE_METRIC_DAY_REPORT day_report
    WHERE day_report.TIME &gt;= #{startDate} AND day_report.TIME &lt;= #{endDate}
    GROUP BY day_report.SERVICE_ACCOUNT_ID, day_report.VM_ENTITY_ID) table_total
    WHERE table_total.vmEntityId = vm.ENTITY_ID AND vm.ENTITY_ID is NOT NULL AND vm.SERVICE_ACCOUNT_ID = table_total.serviceAccountId and vm.MEMBER_ID = #{memberId}
    <if test="appSystemId != null and appSystemId !='' " >
      and app.ID = #{appSystemId}
    </if>
    <if test="ids != null and ids.size>0 " >
      and vm.ID in <foreach item="id" index="index" collection="ids" open="(" separator="," close=")"> #{id} </foreach>
    </if>
    <if test="searchKey != null and searchKey !='' " >
      and ( vm.NAME like concat('%', #{searchKey}, '%') or vm.IP like concat('%', #{searchKey}, '%') )
    </if>
  
```
#### querySubSystemPerformanceList
```

    SELECT
    app.ID        appSystemId,
    app.NAME      appSystemName,
    app.CODE      appSystemCode,
    app.DEPT_ID   deptId,
    app.DEPT_NAME deptName,
    app.MEMBER_ID memberId,
    vmApp.*
    FROM CJ_CMP_APP_SYSTEM app INNER JOIN (SELECT
    tempApp.ID                                appId,
    SUM(total.cpus)                           cpus,
    SUM(total.memorySum)                      memorySum,
    SUM(total.diskSum)                        diskSum,
    round(AVG(total.cpuUtilisation), 2)       cpuUtilisation,
    round(AVG(total.cpuUsed), 2)              cpuUsed,
    round(AVG(total.memoryUtilisation), 2)    memoryUtilisation,
    round(AVG(total.diskUtilisation), 2)      diskUtilisation,
    ROUND(SUM(total.memoryFree), 2)           memoryFree,
    ROUND(AVG(total.maxCpuUtilisation), 2)    maxCpuUtilisation,
    ROUND(AVG(total.maxMemoryUtilisation), 2) maxMemoryUtilisation
    FROM CJ_CMP_APP_SYSTEM tempApp
    INNER JOIN CJ_CMP_VMWARE_VM vm ON tempApp.ID = vm.APP_SYSTEM_ID
    , (SELECT
    MAX(dayReport.CPUS)                   cpus,
    CEILING(MAX(dayReport.MEMORY_SUM) /
    1024)                         memorySum,
    MAX(
    dayReport.DISK_SUM)               diskSum,
    sum(dayReport.CPU_UTILIZATION * dayReport.CPUS) / sum(
    dayReport.CPUS)                   cpuUtilisation,
    sum(dayReport.CPU_USED * dayReport.CPUS) / sum(
    dayReport.CPUS)                   cpuUsed,
    sum(dayReport.MEMORY_UTILIZATION * (dayReport.MEMORY_SUM) / 1024) /
    sum(
    dayReport.MEMORY_SUM /
    1024)                             memoryUtilisation,
    avg((1 - dayReport.MEMORY_UTILIZATION / 100) * dayReport.MEMORY_SUM /
    1024)                             memoryFree,
    sum(dayReport.DISK_NUMBER * dayReport.DISK_UTILIZATION) / sum(
    dayReport.DISK_NUMBER)            diskUtilisation,
    avg(dayReport.MAX_CPU_UTILIZATION)    maxCpuUtilisation,
    avg(dayReport.MAX_MEMORY_UTILIZATION) maxMemoryUtilisation,
    dayReport.SERVICE_ACCOUNT_ID,
    dayReport.VM_ENTITY_ID
    FROM CJ_CMP_VM_PERFORMANCE_METRIC_DAY_REPORT dayReport
    WHERE dayReport.TIME &gt;= #{startDate} AND dayReport.TIME &lt;= #{endDate}
    GROUP BY dayReport.SERVICE_ACCOUNT_ID, dayReport.VM_ENTITY_ID) total
    WHERE vm.ENTITY_ID = total.VM_ENTITY_ID AND
    vm.SERVICE_ACCOUNT_ID = total.SERVICE_ACCOUNT_ID
    GROUP BY tempApp.ID) vmApp ON vmApp.appId = app.ID
    WHERE app.MEMBER_ID = #{memberId}
    <if test="deptId != null and deptId !='' " >
      and app.DEPT_ID = #{deptId}
    </if>
    <if test="searchKey != null and searchKey !='' " >
      and ( app.NAME like concat('%', #{searchKey}, '%') or app.CODE like concat('%', #{searchKey}, '%') )
    </if>
  
```
#### selectWeekRecords
```

    select cast(avg(CPU_UTILIZATION) as decimal(10,2)) as CPU_UTILIZATION,cast(avg(MEMORY_UTILIZATION) as decimal(10,2)) as MEMORY_UTILIZATION
    from CJ_CMP_VM_PERFORMANCE_METRIC_DAY_REPORT
    where VM_ENTITY_ID = #{vmEntityId} and SERVICE_ACCOUNT_ID =  #{serviceAccountId} and TIME <![CDATA[>]]> DATE_SUB(curdate(), INTERVAL 8 DAY) and TIME <![CDATA[<=]]>  DATE_SUB(curdate(), INTERVAL 1 DAY);
  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_VM_PERFORMANCE_METRIC_HOT.xml
> sql统计:复杂1个，简单3个
>
> 使用的关键字：cast,avg,curdate,now,decimal,DATE_SUB,date,DATE,CJ_CMP_VM_PERFORMANCE_METRIC_HOT,values
#### selectWeekRecords
```

        select cast(avg(CPU_UTILIZATION) as decimal(10,2)) as CPU_UTILIZATION,cast(avg(MEMORY_UTILIZATION) as decimal(10,2)) as MEMORY_UTILIZATION
        from CJ_CMP_VM_PERFORMANCE_METRIC_HOT
        where VM_ENTITY_ID = #{vmEntityId} and SERVICE_ACCOUNT_ID = #{serviceAccountId} and DATE_SUB(curdate(), INTERVAL 7 DAY) <![CDATA[<]]> date(TIME);
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_VM_SNAPSHOT.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：CONCAT,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_VM_SPEC.xml
> sql统计:复杂1个，简单7个
>
> 使用的关键字：NOW,and,group_concat
#### queryFusionCloudSpec
```

        select spec.*, group_concat(distinct az.NAME) as zoneName, sa.NAME AS serviceAccountName, sa.ID AS serviceAccountId
        FROM CJ_CMP_SERVICE_ACCOUNT sa
        INNER JOIN CJ_CMP_CLOUD_ACCOUNT_DC cdc ON sa.ID = cdc.SERVICE_ACCOUNT_ID AND cdc.IS_DELETED = 0 AND sa.IS_DELETED = 0
        INNER JOIN CJ_CMP_CLOUD_ACCOUNT ca ON cdc.CLOUD_ACCOUNT_ID = ca.ID AND ca.IS_DELETED = 0
        inner join CJ_CMP_FUSION_CLOUD_DC_X_AZ dcx on dcx.LDC_ID=cdc.LDC_ID and cdc.LDC_TYPE='fusionCloud'
        LEFT JOIN CJ_CMP_CLOUD_AZ az on az.ID=dcx.AZ_ID
        inner join CJ_CMP_CLOUD_DC_X_SPEC dxs on dxs.LDC_ID=cdc.LDC_ID and dxs.SERVICE_ACCOUNT_ID=sa.ID
        INNER JOIN CJ_CMP_VM_SPEC spec ON spec.ID=dxs.SPEC_ID
        where spec.IS_DELETED=0
        <choose>
            <when test="memberId != 0">
                and ca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
                and ca.SCOPE = 'public'
            </otherwise>
        </choose>
        <if test="id != null and id != ''"> and spec.ID=#{id}</if>
        <if test="serviceAccountId != null and serviceAccountId != ''"> and sa.ID=#{serviceAccountId}</if>
        <if test="cloudAccountId != null and cloudAccountId != ''"> and ca.ID=#{cloudAccountId}</if>
        <if test="ldcId != null and ldcId != ''"> and cdc.LDC_ID=#{ldcId}</if>
        <if test="ldcType != null and ldcType != ''"> and cdc.LDC_TYPE=#{ldcType}</if>
        <if test="azId != null and azId != ''"> and az.ID=#{azId}</if>
        <if test="searchKey != null and searchKey != ''"> and (spec.NAME like #{searchKey} or spec.ENTITY_ID like #{searchKey})</if>
        group by spec.ID, spec.NAME, sa.ID
        order by spec.NAME
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_VM_VIEW.xml
> sql统计:复杂17个，简单22个
>
> 使用的关键字：where,to_days,sum,count,SUM,DATE_SUB,JOIN,GROUP_CONCAT,exists,convert,now,date_sub,FROM,when,join,and,date,concat,substring_index,round,CURDATE,from,WHEN,DATE,values,ifnull,inet_aton,CONCAT,CJ_CMP_TAG_X_OBJECT
#### queryList
```

        select vm.*,app.ID as appSystemId,app.NAME as appSystemName,vl.diskSum ,vl.diskNumber ,vmtag.tag,du.NAME as appDuName,vm.APP_DU_ID as appDuId,iac.SERVICE_INSTANCE_ID as serviceInstanceId,project.NAME AS projectName,project.ID AS projectId,
        case when ifnull(u.ACTIVE,0)=0 then concat(u.NAME,' (已删除)') when ifnull(u.LOCKED_OUT,0)=0 then u.NAME else concat(u.NAME,' (已冻结)') end as owner, depart.`NAME` as dept,
        case when ifnull(uaas.ACTIVE,0)=0 then concat(uaas.NAME,' (已删除)') when ifnull(uaas.LOCKED_OUT,0)=0 then uaas.NAME else concat(uaas.NAME,' (已冻结)') end as assigner 
        from cj_cmp_vm_view vm
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
        left outer join CJ_CMP_PROJECT project on project.ID=vm.PROJECT_ID
        left join (SELECT VM_DEVICE_ID,SERVICE_ACCOUNT_ID, sum( DISK_SPACE ) AS diskSum, count( DISK_SPACE ) AS diskNumber FROM CJ_CMP_VM_VOLUME WHERE IS_DELETED=0 GROUP BY VM_DEVICE_ID, SERVICE_ACCOUNT_ID ) AS vl
        on vl.VM_DEVICE_ID = vm.ID and vl.SERVICE_ACCOUNT_ID = vm.SERVICE_ACCOUNT_ID
        LEFT JOIN (SELECT rel.OBJECT_ID, rel.OBJECT_TYPE, GROUP_CONCAT(tag.`NAME`) as tag from CJ_CMP_TAG tag INNER JOIN CJ_CMP_TAG_X_OBJECT rel on tag.ID = rel.TAG_ID GROUP BY rel.OBJECT_ID, rel.OBJECT_TYPE) as vmtag
        on vm.ID = vmtag.OBJECT_ID and vm.LDC_TYPE = vmtag.OBJECT_TYPE
        LEFT JOIN ydduc.UC_USER u ON vm.OWNED_BY = u.ID
        LEFT JOIN ydduc.UC_USER uaas ON vm.ASSIGNED_TO = uaas.ID
        LEFT JOIN ydduc.UC_DEPARTMENT depart ON u.DEPARTMENT = depart.ID
        left outer join CJ_CMP_SERVICE_INSTANCE_X_RESOURCE iac on iac.SERVICE_ACCOUNT_ID=vm.SERVICE_ACCOUNT_ID and iac.RESOURCE_ID=vm.ID
        LEFT JOIN CJ_CMP_APP_DU du ON vm.APP_DU_ID = du.ID
        where
            vm.MEMBER_ID = #{memberId} and ( 1=1
            <if test="userIds != null and userIds.size >0 ">
                and  vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
                or  vm.ASSIGNED_TO in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
                <if test="appUserId !=null ">
                    or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                    <if test="appDepartmentList != null and appDepartmentList.size != 0">
                        or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                        or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    </if>
                </if>

            </if>
            <if test="appSystemIds != null and appSystemIds.size>0">
                or vm.APP_SYSTEM_ID in
                <foreach collection="appSystemIds" item="appSystemId" open="(" close=")" separator=",">#{appSystemId}</foreach>
            </if>
            )
            <if test="cloudAccountId != null and cloudAccountId != ''">
                and vm.CLOUD_ACCOUNT_ID = #{cloudAccountId}
            </if>
            <if test="ldcId != null and ldcId != ''">
                and vm.LDC_ID = #{ldcId}
            </if>
            <if test="appSystemId != null">
                and vm.APP_SYSTEM_ID = #{appSystemId}
            </if>

            <if test="keywordList != null and keywordList.size==1" >
                <choose>
                    <when test="queryType != null and queryType == 'name'" >
                        and vm.NAME like CONCAT('%',#{keyword},'%')
                    </when>
                    <when test="queryType != null and queryType == 'manageBy'" >
                        <if test="searchUserList != null and searchUserList.size != 0">
                            and ( vm.OWNED_BY in <foreach collection="searchUserList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
                            or u.NAME like concat('%', #{keyword}, '%') )
                        </if>
                        <if test="searchUserList == null or searchUserList.size == 0">
                            and u.NAME like concat('%', #{keyword}, '%')
                        </if>
                    </when>
                    <when test="queryType != null and queryType == 'assigner'" >
                        <if test="searchUserList != null and searchUserList.size != 0">
                            and ( vm.ASSIGNED_TO in <foreach collection="searchUserList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
                            or uaas.NAME like concat('%', #{keyword}, '%') )
                        </if>
                        <if test="searchUserList == null or searchUserList.size == 0">
                            and uaas.NAME like concat('%', #{keyword}, '%')
                        </if>
                    </when>
                    <when test="queryType != null and queryType == 'entityId'" >
                        and vm.ENTITY_ID like concat('%', #{keyword}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'ip'" >
                        and vm.IP like concat('%', #{keyword}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'appSystemName'" >
                        and app.NAME like concat('%', #{keyword}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'projectName'" >
                        and (project.NAME like concat('%', #{keyword}, '%') or project.CODE like concat('%', #{keyword}, '%'))
                    </when>
                    <when test="queryType != null and queryType == 'tag'" >
                        and exists (select rel.ID
                        from CJ_CMP_TAG_X_OBJECT rel
                        where vm.MEMBER_ID = #{memberId}
                        and rel.TAG_ID = #{keyword}
                        and rel.OBJECT_TYPE = vm.LDC_TYPE and rel.OBJECT_ID = vm.ID
                        )
                    </when>
                    <when test="queryType != null and queryType == 'department'" >
                        and depart.`NAME` like concat('%', #{keyword}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'runStatus'" >
                        and vm.RUN_STATUS like concat('%', #{keyword}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'ldcType'" >
                        and vm.LDC_TYPE like concat('%', #{keyword}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'srvNumber'" >
                        and vm.SRV_NO like concat('%', #{keyword}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'os'" >
                        and vm.OS like concat('%', #{keyword}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'userdFor'" >
                        and vm.USED_FOR like concat('%', #{keyword}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'remark'" >
                        and vm.REMARK like concat('%', #{keyword}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'appSystemName'" >
                        and app.NAME like concat('%', #{keyword}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'cloudAccountName'" >
                        and vm.CLOUD_ACCOUNT_NAME like concat('%', #{keyword}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'appDuName'" >
                        and du.NAME like concat('%', #{keyword}, '%')
                    </when>
                    <otherwise>
                        and (
                        vm.NAME like CONCAT('%',#{keyword},'%')
                        <if test="searchUserList != null and searchUserList.size != 0">
                        OR vm.OWNED_BY in <foreach collection="searchUserList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
                        OR vm.ASSIGNED_TO in <foreach collection="searchUserList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
                       </if>
                        OR vm.ENTITY_ID like concat('%', #{keyword}, '%')
                        OR vm.IP like concat('%', #{keyword}, '%')
                        OR app.NAME like concat('%', #{keyword}, '%')
                        OR project.NAME like concat('%', #{keyword}, '%') or project.CODE like concat('%', #{keyword}, '%')
                        OR depart.`NAME` like concat('%', #{keyword}, '%')
                        OR vm.OWNED_BY like concat('%', #{keyword}, '%')
                        OR vm.RUN_STATUS like concat('%', #{keyword}, '%')
                        OR vm.LDC_TYPE like concat('%', #{keyword}, '%')
                        OR vm.SRV_NO like concat('%', #{keyword}, '%')
                        OR vm.OS like concat('%', #{keyword}, '%')
                        OR vm.USED_FOR like concat('%', #{keyword}, '%')
                        OR vm.REMARK like concat('%', #{keyword}, '%')
                        OR vm.CLOUD_ACCOUNT_NAME like concat('%', #{keyword}, '%')
                        OR u.NAME like concat('%', #{keyword}, '%')
                        OR uaas.NAME like concat('%', #{keyword}, '%')
                        )
                    </otherwise>
                </choose>
            </if>
            <if test="keywordList != null and keywordList.size>1" >
                <choose>
                    <when test="queryType != null and queryType == 'name'" >
                        and vm.NAME in <foreach collection="keywordList" item="name" open="(" close=")" separator=",">#{name}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'manageBy'" >
                        <if test="searchUserList != null and searchUserList.size != 0">
                            and ( vm.OWNED_BY in <foreach collection="searchUserList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
                            or u.NAME in <foreach collection="keywordList" item="manageName" open="(" close=")" separator=",">#{manageName}</foreach> )
                        </if>
                        <if test="searchUserList == null or searchUserList.size == 0">
                            and u.NAME in <foreach collection="keywordList" item="manageName" open="(" close=")" separator=",">#{manageName}</foreach>
                        </if>
                    </when>
                    <when test="queryType != null and queryType == 'entityId'" >
                        and vm.ENTITY_ID in <foreach collection="keywordList" item="entityId" open="(" close=")" separator=",">#{entityId}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'ip'" >
                        and vm.IP in <foreach collection="keywordList" item="IP" open="(" close=")" separator=",">#{IP}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'appSystemName'" >
                        and app.NAME in <foreach collection="keywordList" item="appName" open="(" close=")" separator=",">#{appName}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'department'" >
                        and depart.`NAME` in <foreach collection="keywordList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'runStatus'" >
                        and vm.RUN_STATUS in <foreach collection="keywordList" item="runStatus" open="(" close=")" separator=",">#{runStatus}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'ldcType'" >
                        and vm.LDC_TYPE in <foreach collection="keywordList" item="ldcType" open="(" close=")" separator=",">#{ldcType}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'srvNumber'" >
                        and vm.SRV_NO in <foreach collection="keywordList" item="srvNumber" open="(" close=")" separator=",">#{srvNumber}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'os'" >
                        and vm.OS in <foreach collection="keywordList" item="os" open="(" close=")" separator=",">#{os}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'userdFor'" >
                        and vm.USED in <foreach collection="keywordList" item="userdFor" open="(" close=")" separator=",">#{userdFor}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'remark'" >
                        and vm.REMARK in <foreach collection="keywordList" item="remark" open="(" close=")" separator=",">#{remark}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'cloudAccountName'" >
                        and vm.CLOUD_ACCOUNT_NAME in <foreach collection="keywordList" item="cloudAccountName" open="(" close=")" separator=",">#{cloudAccountName}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'appDuName'" >
                        and du.NAME in <foreach collection="keywordList" item="appDuName" open="(" close=")" separator=",">#{appDuName}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'tag'" >
                        and exists (select rel.OBJECT_ID
                        from CJ_CMP_TAG_X_OBJECT rel
                        where vm.MEMBER_ID = #{memberId}
                        and rel.TAG_ID in <foreach collection="keywordList" item="tag" open="(" close=")" separator=",">#{tag}</foreach>
                        and rel.OBJECT_TYPE = vm.LDC_TYPE and rel.OBJECT_ID = vm.ID
                        group by rel.OBJECT_ID
                        having count(1) = ${keywordList.size}
                        )
                    </when>
                    <otherwise>
                        and (
                        vm.NAME in <foreach collection="keywordList" item="name" open="(" close=")" separator=",">#{name}</foreach>
                        <if test="searchUserList != null and searchUserList.size != 0">
                            OR vm.OWNED_BY in <foreach collection="searchUserList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
                        </if>
                        OR vm.ENTITY_ID in <foreach collection="keywordList" item="entityId" open="(" close=")" separator=",">#{entityId}</foreach>
                        OR app.NAME in <foreach collection="keywordList" item="appSystemName" open="(" close=")" separator=",">#{appSystemName}</foreach>
                        OR vm.IP in <foreach collection="keywordList" item="IP" open="(" close=")" separator=",">#{IP}</foreach>
                        OR app.NAME in <foreach collection="keywordList" item="appName" open="(" close=")" separator=",">#{appName}</foreach>
                        OR depart.`NAME` in <foreach collection="keywordList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                        OR vm.RUN_STATUS in <foreach collection="keywordList" item="runStatus" open="(" close=")" separator=",">#{runStatus}</foreach>
                        OR vm.LDC_TYPE in <foreach collection="keywordList" item="ldcType" open="(" close=")" separator=",">#{ldcType}</foreach>
                        OR vm.SRV_NO in <foreach collection="keywordList" item="srvNumber" open="(" close=")" separator=",">#{srvNumber}</foreach>
                        OR vm.OS in <foreach collection="keywordList" item="os" open="(" close=")" separator=",">#{os}</foreach>
                        OR vm.USED_FOR in <foreach collection="keywordList" item="userdFor" open="(" close=")" separator=",">#{userdFor}</foreach>
                        OR vm.REMARK in <foreach collection="keywordList" item="remark" open="(" close=")" separator=",">#{remark}</foreach>
                        OR vm.CLOUD_ACCOUNT_NAME in <foreach collection="keywordList" item="cloudAccountName" open="(" close=")" separator=",">#{cloudAccountName}</foreach>
                        OR u.NAME in <foreach collection="keywordList" item="manageName" open="(" close=")" separator=",">#{manageName}</foreach>
                        )
                    </otherwise>
                </choose>
            </if>
        <choose>
            <when test="sortFieldList != null and sortFieldList.size >= 1 and sortType != ''" >
                ORDER BY  <foreach collection="sortFieldList" item="sortField" separator=",">
                            <if test="sortField =='vm.IP'">inet_aton(substring_index(IP,',',1)) ${sortType},IP</if>
                            <if test="sortField !='vm.IP'">convert(${sortField} USING gbk) ${sortType}</if>
                         </foreach>
            </when>
            <otherwise> ORDER BY vm.CREATE_DATE desc</otherwise>
        </choose>
    
```
#### queryListByExpression
```

        select vm.*,app.ID as appSystemId,app.NAME as appSystemName,vl.diskSum ,vl.diskNumber ,vmtag.tag,du.NAME as appDuName,vm.APP_DU_ID as appDuId,iac.SERVICE_INSTANCE_ID as serviceInstanceId,project.NAME AS projectName,project.ID AS projectId,
        case when ifnull(u.ACTIVE,0)=0 then concat(u.NAME,' (已删除)') when ifnull(u.LOCKED_OUT,0)=0 then u.NAME else concat(u.NAME,' (已冻结)') end as owner, depart.`NAME` as dept,
        case when ifnull(uaas.ACTIVE,0)=0 then concat(uaas.NAME,' (已删除)') when ifnull(uaas.LOCKED_OUT,0)=0 then uaas.NAME else concat(uaas.NAME,' (已冻结)') end as assigner
        from cj_cmp_vm_view vm
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
        left outer join CJ_CMP_PROJECT project on project.ID=vm.PROJECT_ID
        left join (SELECT VM_DEVICE_ID,SERVICE_ACCOUNT_ID, sum( DISK_SPACE ) AS diskSum, count( DISK_SPACE ) AS diskNumber FROM CJ_CMP_VM_VOLUME WHERE IS_DELETED=0 GROUP BY VM_DEVICE_ID, SERVICE_ACCOUNT_ID ) AS vl
        on vl.VM_DEVICE_ID = vm.ID and vl.SERVICE_ACCOUNT_ID = vm.SERVICE_ACCOUNT_ID
        LEFT JOIN (SELECT rel.OBJECT_ID, rel.OBJECT_TYPE, GROUP_CONCAT(tag.`NAME`) as tag from CJ_CMP_TAG tag INNER JOIN CJ_CMP_TAG_X_OBJECT rel on tag.ID = rel.TAG_ID GROUP BY rel.OBJECT_ID, rel.OBJECT_TYPE) as vmtag
        on vm.ID = vmtag.OBJECT_ID and vm.LDC_TYPE = vmtag.OBJECT_TYPE
        LEFT JOIN ydduc.UC_USER u ON vm.OWNED_BY = u.ID
        LEFT JOIN ydduc.UC_USER uaas ON vm.ASSIGNED_TO = uaas.ID
        LEFT JOIN ydduc.UC_DEPARTMENT depart ON u.DEPARTMENT = depart.ID
        left outer join CJ_CMP_SERVICE_INSTANCE_X_RESOURCE iac on  iac.SERVICE_ACCOUNT_ID=vm.SERVICE_ACCOUNT_ID and iac.RESOURCE_ID=vm.ID
        LEFT JOIN CJ_CMP_APP_DU du ON vm.APP_DU_ID = du.ID
        where
        vm.MEMBER_ID = #{memberId} and ( 1=1
        <if test="userIds != null and userIds.size >0 ">
            and  vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            or  vm.ASSIGNED_TO in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
        </if>
        <if test="appSystemIds != null and appSystemIds.size>0">
            or vm.APP_SYSTEM_ID in
            <foreach collection="appSystemIds" item="appSystemId" open="(" close=")" separator=",">#{appSystemId}</foreach>
        </if>
        )
        <if test="cloudAccountId != null and cloudAccountId != ''">
            and vm.CLOUD_ACCOUNT_ID = #{cloudAccountId}
        </if>
        <if test="ldcId != null and ldcId != ''">
            and vm.LDC_ID = #{ldcId}
        </if>
        <if test="appSystemId != null">
            and vm.APP_SYSTEM_ID = #{appSystemId}
        </if>

        <foreach collection="queryExpressionMap" index="queryType" item="keywordList">
            <if test="keywordList != null and keywordList.size == 1" >
                <choose>
                    <when test="queryType != null and queryType == 'name'" >
                        and vm.NAME like CONCAT('%',#{queryExpressionMap.name[0]},'%')
                    </when>
                    <when test="queryType != null and queryType == 'manageBy'" >
                        <if test="searchUserList != null and searchUserList.size != 0">
                            and ( vm.OWNED_BY in <foreach collection="searchUserList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
                            or u.NAME like concat('%', #{queryExpressionMap.manageBy[0]}, '%') )
                        </if>
                        <if test="searchUserList == null or searchUserList.size == 0">
                            and u.NAME like concat('%', #{queryExpressionMap.manageBy[0]}, '%')
                        </if>
                    </when>
                    <when test="queryType != null and queryType == 'assigner'" >
                        <if test="searchUserList != null and searchUserList.size != 0">
                            and ( vm.ASSIGNED_TO in <foreach collection="searchUserList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
                            or uaas.NAME like concat('%', #{queryExpressionMap.assigner[0]}, '%') )
                        </if>
                        <if test="searchUserList == null or searchUserList.size == 0">
                            and uaas.NAME like concat('%', #{queryExpressionMap.assigner[0]}, '%')
                        </if>
                    </when>
                    <when test="queryType != null and queryType == 'entityId'" >
                        and vm.ENTITY_ID like concat('%', #{queryExpressionMap.entityId[0]}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'ip'" >
                        and vm.IP like concat('%', #{queryExpressionMap.ip[0]}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'appSystemName'" >
                        and app.NAME like concat('%', #{queryExpressionMap.appSystemName[0]}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'projectName'" >
                        and (project.NAME like concat('%', #{queryExpressionMap.projectName[0]}, '%') or project.CODE like concat('%', #{queryExpressionMap.projectName[0]}, '%'))
                    </when>
                    <when test="queryType != null and queryType == 'tag'" >
                        and exists (select rel.ID
                        from CJ_CMP_TAG_X_OBJECT rel
                        where vm.MEMBER_ID = #{memberId}
                        and rel.TAG_ID = #{queryExpressionMap.tag[0]}
                        and rel.OBJECT_TYPE = vm.LDC_TYPE and rel.OBJECT_ID = vm.ID
                        )
                    </when>
                    <when test="queryType != null and queryType == 'department'" >
                        and depart.`NAME` like concat('%', #{queryExpressionMap.department[0]}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'runStatus'" >
                        and vm.RUN_STATUS like concat('%', #{queryExpressionMap.runStatus[0]}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'ldcType'" >
                        and vm.LDC_TYPE like concat('%', #{queryExpressionMap.ldcType[0]}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'srvNumber'" >
                        and vm.SRV_NO like concat('%', #{queryExpressionMap.srvNumber[0]}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'os'" >
                        and vm.OS like concat('%', #{queryExpressionMap.os[0]}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'userdFor'" >
                        and vm.USED_FOR like concat('%', #{queryExpressionMap.userdFor[0]}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'remark'" >
                        and vm.REMARK like concat('%', #{queryExpressionMap.remark[0]}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'appSystemName'" >
                        and app.NAME like concat('%', #{queryExpressionMap.appSystemName[0]}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'cloudAccountName'" >
                        and vm.CLOUD_ACCOUNT_NAME like concat('%', #{queryExpressionMap.cloudAccountName[0]}, '%')
                    </when>
                    <when test="queryType != null and queryType == 'appDuName'" >
                        and du.NAME like concat('%', #{queryExpressionMap.appDuName[0]}, '%')
                    </when>
                    <otherwise>
                        and (
                        vm.NAME like CONCAT('%',#{queryExpressionMap.keyword[0]},'%')
                        <if test="searchUserList != null and searchUserList.size != 0">
                            OR vm.OWNED_BY in <foreach collection="searchUserList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
                            OR vm.ASSIGNED_TO in <foreach collection="searchUserList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
                        </if>
                        OR vm.ENTITY_ID like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        OR vm.IP like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        OR app.NAME like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        OR project.NAME like concat('%', #{queryExpressionMap.keyword[0]}, '%') or project.CODE like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        OR depart.`NAME` like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        OR vm.OWNED_BY like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        OR vm.RUN_STATUS like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        OR vm.LDC_TYPE like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        OR vm.SRV_NO like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        OR vm.OS like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        OR vm.USED_FOR like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        OR vm.REMARK like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        OR vm.CLOUD_ACCOUNT_NAME like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        OR u.NAME like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        OR uaas.NAME like concat('%', #{queryExpressionMap.keyword[0]}, '%')
                        )
                    </otherwise>
                </choose>
            </if>
            <if test="keywordList != null and keywordList.size > 1" >
                <choose>
                    <when test="queryType != null and queryType == 'name'" >
                        and vm.NAME in <foreach collection="keywordList" item="name" open="(" close=")" separator=",">#{name}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'manageBy'" >
                        <if test="searchUserList != null and searchUserList.size != 0">
                            and ( vm.OWNED_BY in <foreach collection="searchUserList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
                            or u.NAME in <foreach collection="keywordList" item="manageName" open="(" close=")" separator=",">#{manageName}</foreach> )
                        </if>
                        <if test="searchUserList == null or searchUserList.size == 0">
                            and u.NAME in <foreach collection="keywordList" item="manageName" open="(" close=")" separator=",">#{manageName}</foreach>
                        </if>
                    </when>
                    <when test="queryType != null and queryType == 'entityId'" >
                        and vm.ENTITY_ID in <foreach collection="keywordList" item="entityId" open="(" close=")" separator=",">#{entityId}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'ip'" >
                        and vm.IP in <foreach collection="keywordList" item="IP" open="(" close=")" separator=",">#{IP}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'appSystemName'" >
                        and app.NAME in <foreach collection="keywordList" item="appName" open="(" close=")" separator=",">#{appName}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'department'" >
                        and depart.`NAME` in <foreach collection="keywordList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'runStatus'" >
                        and vm.RUN_STATUS in <foreach collection="keywordList" item="runStatus" open="(" close=")" separator=",">#{runStatus}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'ldcType'" >
                        and vm.LDC_TYPE in <foreach collection="keywordList" item="ldcType" open="(" close=")" separator=",">#{ldcType}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'srvNumber'" >
                        and vm.SRV_NO in <foreach collection="keywordList" item="srvNumber" open="(" close=")" separator=",">#{srvNumber}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'os'" >
                        and vm.OS in <foreach collection="keywordList" item="os" open="(" close=")" separator=",">#{os}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'userdFor'" >
                        and vm.USED in <foreach collection="keywordList" item="userdFor" open="(" close=")" separator=",">#{userdFor}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'remark'" >
                        and vm.REMARK in <foreach collection="keywordList" item="remark" open="(" close=")" separator=",">#{remark}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'cloudAccountName'" >
                        and vm.CLOUD_ACCOUNT_NAME in <foreach collection="keywordList" item="cloudAccountName" open="(" close=")" separator=",">#{cloudAccountName}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'appDuName'" >
                        and du.NAME in <foreach collection="keywordList" item="appDuName" open="(" close=")" separator=",">#{appDuName}</foreach>
                    </when>
                    <when test="queryType != null and queryType == 'tag'" >
                        and exists (select rel.OBJECT_ID
                        from CJ_CMP_TAG_X_OBJECT rel
                        where vm.MEMBER_ID = #{memberId}
                        and rel.TAG_ID in <foreach collection="keywordList" item="tag" open="(" close=")" separator=",">#{tag}</foreach>
                        and rel.OBJECT_TYPE = vm.LDC_TYPE and rel.OBJECT_ID = vm.ID
                        group by rel.OBJECT_ID
                        having count(1) = ${keywordList.size}
                        )
                    </when>
                    <otherwise>
                        and (
                        vm.NAME in <foreach collection="keywordList" item="name" open="(" close=")" separator=",">#{name}</foreach>
                        <if test="searchUserList != null and searchUserList.size != 0">
                            OR vm.OWNED_BY in <foreach collection="searchUserList" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
                        </if>
                        OR vm.ENTITY_ID in <foreach collection="keywordList" item="entityId" open="(" close=")" separator=",">#{entityId}</foreach>
                        OR app.NAME in <foreach collection="keywordList" item="appSystemName" open="(" close=")" separator=",">#{appSystemName}</foreach>
                        OR vm.IP in <foreach collection="keywordList" item="IP" open="(" close=")" separator=",">#{IP}</foreach>
                        OR app.NAME in <foreach collection="keywordList" item="appName" open="(" close=")" separator=",">#{appName}</foreach>
                        OR depart.`NAME` in <foreach collection="keywordList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                        OR vm.RUN_STATUS in <foreach collection="keywordList" item="runStatus" open="(" close=")" separator=",">#{runStatus}</foreach>
                        OR vm.LDC_TYPE in <foreach collection="keywordList" item="ldcType" open="(" close=")" separator=",">#{ldcType}</foreach>
                        OR vm.SRV_NO in <foreach collection="keywordList" item="srvNumber" open="(" close=")" separator=",">#{srvNumber}</foreach>
                        OR vm.OS in <foreach collection="keywordList" item="os" open="(" close=")" separator=",">#{os}</foreach>
                        OR vm.USED_FOR in <foreach collection="keywordList" item="userdFor" open="(" close=")" separator=",">#{userdFor}</foreach>
                        OR vm.REMARK in <foreach collection="keywordList" item="remark" open="(" close=")" separator=",">#{remark}</foreach>
                        OR vm.CLOUD_ACCOUNT_NAME in <foreach collection="keywordList" item="cloudAccountName" open="(" close=")" separator=",">#{cloudAccountName}</foreach>
                        OR u.NAME in <foreach collection="keywordList" item="manageName" open="(" close=")" separator=",">#{manageName}</foreach>
                        )
                    </otherwise>
                </choose>
            </if>
        </foreach>
        <choose>
            <when test="sortFieldList != null and sortFieldList.size >= 1 and sortType != ''" >
                ORDER BY  <foreach collection="sortFieldList" item="sortField" separator=",">
                            <if test="sortField =='vm.IP'">inet_aton(substring_index(IP,',',1)) ${sortType},IP</if>
                            <if test="sortField !='vm.IP'">convert(${sortField} USING gbk) ${sortType}</if>
                         </foreach>
            </when>
            <otherwise> ORDER BY vm.CREATE_DATE desc</otherwise>
        </choose>
    
```
#### queryExpireVmListReport
```

        select distinct vm.*,vm.CREATE_DATE AS createDate,app.ID as appSystemId,app.NAME as appSystemName,project.NAME AS projectName,host.SN AS hostSn,vl.diskSum ,vl.diskNumber ,vmtag.tag
        from (select * from (select * from cj_cmp_vm_view vm
        where vm.due is not null
        and vm.due &gt; now()
        and date_sub(vm.due, interval 30 day) &lt; now()
        order by due desc) as tab1
        union all
        select * from (select * from cj_cmp_vm_view vm
        where vm.due is not null and vm.due &lt;= now()
        order by due) as tab2
        union all
        select * from (select * from cj_cmp_vm_view vm
        where (vm.due is not null and vm.due &gt;= now() and date_sub(vm.due, interval 30 day) &gt;=now())
        order by due desc) as tab3
        union all
        select * from (select * from cj_cmp_vm_view vm
        where vm.due is null) as tab4) vm
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
        left outer join CJ_CMP_PROJECT project on project.ID=vm.PROJECT_ID
        left outer join CJ_CMP_VMWARE_HOST host on host.ID=vm.HOST_ID
        left join (SELECT distinct VM_DEVICE_ID,SERVICE_ACCOUNT_ID, sum( DISK_SPACE ) AS diskSum, count( DISK_SPACE ) AS diskNumber FROM CJ_CMP_VM_VOLUME where IS_DELETED = 0 GROUP BY VM_DEVICE_ID, SERVICE_ACCOUNT_ID ) AS vl
        on vl.VM_DEVICE_ID = vm.ID and vl.SERVICE_ACCOUNT_ID = vm.SERVICE_ACCOUNT_ID
        LEFT JOIN (SELECT rel.OBJECT_ID, rel.OBJECT_TYPE, GROUP_CONCAT(tag.`NAME`) as tag from CJ_CMP_TAG tag INNER JOIN CJ_CMP_TAG_X_OBJECT rel on tag.ID = rel.TAG_ID GROUP BY rel.OBJECT_ID, rel.OBJECT_TYPE) as vmtag
        on vm.ID = vmtag.OBJECT_ID and vm.LDC_TYPE = vmtag.OBJECT_TYPE
        where
        vm.MEMBER_ID = #{memberId}
        <if test="userIds != null and userIds.size >0 ">
            and ( vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
            )
        </if>
        <if test="searchKey != null and searchKey != ''">
            and (vm.IP like concat('%', #{searchKey}, '%') or vm.NAME like concat('%', #{searchKey}, '%') or host.NAME like concat('%', #{searchKey}, '%'))
        </if>

        <if test="startTime != null and startTime != ''">
            and vm.CREATE_DATE between #{startTime} and #{endTime}
        </if>

        <if test="sortField != null and sortField != ''">
            ORDER BY ${sortField} ${sortType}
        </if>
    
```
#### queryExpireVmCountReport
```

        SELECT a.exipreType,ifnull(b.num,0) AS num FROM
        (SELECT '即将过期' AS exipreType
        union all
        SELECT '已过期' AS exipreType
        union all
        SELECT '未过期' AS exipreType) AS a left join  (SELECT tab.exipreType,count(NAME) AS num FROM
        (select
        case
        when ((vm.due is not null and vm.due &gt;= now() and date_sub(vm.due, interval 30 day) &gt;=now()) or vm.due is null) then '未过期'
        when vm.due is not null and vm.due &gt; now() and date_sub(vm.due, interval 30 day) &lt;now() then '即将过期'
        when vm.due is not null and vm.due &lt;= now() then '已过期'
        else '其它' end AS exipreType,vm.NAME
        from cj_cmp_vm_view vm
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
        left outer join CJ_CMP_VMWARE_HOST host on host.ID=vm.HOST_ID
        where
        vm.MEMBER_ID = #{memberId}
        <if test="userIds != null and userIds.size >0 ">
            and ( vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
            )
        </if>
        <if test="searchKey != null and searchKey != ''">
            and (vm.IP like concat('%', #{searchKey}, '%') or vm.NAME like concat('%', #{searchKey}, '%') or host.NAME like concat('%', #{searchKey}, '%'))
        </if>

        <if test="startTime != null and startTime != ''">
            and vm.CREATE_DATE between #{startTime} and #{endTime}
        </if>
        ) AS tab group by tab.exipreType) AS b on a.exipreType = b.exipreType;
    
```
#### queryVmSpecReport
```

        SELECT vmInfo.SPEC AS spec,count(vmInfo.`NAME`) AS num FROM
        (SELECT CASE WHEN (vm.CPUS is null or vm.CPUS = '') and (vm.MEMORY is null or vm.MEMORY = '')
        THEN '其它'
        ELSE concat(vm.CPUS,"C",round(ifnull(vm.MEMORY/1024,0),0),"G") END AS SPEC,vm.`NAME`
        from cj_cmp_vm_view vm
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
        where
        vm.MEMBER_ID = #{memberId}
        <if test="userIds != null and userIds.size >0 ">
            and ( vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
            )
        </if>
        <if test="searchKey != null and searchKey != ''">
            and (vm.IP like concat('%', #{searchKey}, '%') or vm.NAME like concat('%', #{searchKey}, '%'))
        </if>

        <if test="startTime != null and startTime != ''">
            and vm.CREATE_DATE between #{startTime} and #{endTime}
        </if>
        ) AS vmInfo group by vmInfo.SPEC
    
```
#### querySpecGroupByAppTopReport
```

        SELECT vmInfo.name,vmInfo.spec FROM
        (SELECT app.NAME AS name,concat(sum(CPUS),"C",round(ifnull(sum(MEMORY)/1024,0),0),"G") AS spec,sum(CPUS) AS vmCpus,sum(MEMORY) AS vmMemory
        FROM cj_cmp_vm_view vm
        inner join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
        where
        vm.MEMBER_ID = #{memberId} and vm.CPUS is not null and vm.MEMORY is not null
        <if test="userIds != null and userIds.size >0 ">
            and ( vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
            )
        </if>
        <if test="startTime != null and startTime != ''">
            and vm.CREATE_DATE between #{startTime} and #{endTime}
        </if>
        group by app.NAME order by app.NAME) AS vmInfo
        <if test="isList != null and isList != '' ">
            order by vmInfo.vmCpus desc,vmInfo.vmMemory desc limit 10
        </if>
        <if test="sortField != null and sortField != ''">
            ORDER BY vmInfo.vmCpus ${sortType},vmInfo.vmMemory ${sortType}
        </if>

    
```
#### querySpecGroupByDeptTopReport
```

        SELECT vmInfo.name,vmInfo.spec FROM
        (SELECT CASE WHEN (app.DEPT_NAME is null or app.DEPT_NAME = '') THEN '其它' ELSE app.DEPT_NAME END AS name,concat(sum(CPUS),"C",round(ifnull(sum(MEMORY)/1024,0),0),"G") AS spec,sum(CPUS) AS vmCpus,sum(MEMORY) AS vmMemory
        FROM cj_cmp_vm_view vm
        inner join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
        where
        vm.MEMBER_ID = #{memberId} and vm.CPUS is not null and vm.MEMORY is not null
        <if test="userIds != null and userIds.size >0 ">
            and ( vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
            )
        </if>
        <if test="startTime != null and startTime != ''">
            and vm.CREATE_DATE between #{startTime} and #{endTime}
        </if>
        group by app.DEPT_NAME order by app.DEPT_NAME) AS vmInfo
        <if test="isList != null and isList != '' ">
            order by vmInfo.vmCpus desc,vmInfo.vmMemory desc limit 10
        </if>
        <if test="sortField != null and sortField != ''">
            ORDER BY vmInfo.vmCpus ${sortType},vmInfo.vmMemory ${sortType}
        </if>
    
```
#### querySpecGroupByMemberTopReport
```

        SELECT vmInfo.name,vmInfo.spec FROM
        (SELECT vm.MEMBER_ID AS name,concat(sum(CPUS),"C",round(ifnull(sum(MEMORY)/1024,0),0),"G") AS spec,sum(CPUS) AS vmCpus,sum(MEMORY) AS vmMemory
        FROM cj_cmp_vm_view vm
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
        where
        vm.MEMBER_ID = #{memberId} and vm.CPUS is not null and vm.MEMORY is not null
        <if test="userIds != null and userIds.size >0 ">
            and ( vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
            )
        </if>
        <if test="startTime != null and startTime != ''">
            and vm.CREATE_DATE between #{startTime} and #{endTime}
        </if>
        group by vm.MEMBER_ID order by vm.MEMBER_ID) AS vmInfo
        <if test="isList != null and isList != '' ">
            order by vmInfo.vmCpus desc,vmInfo.vmMemory desc limit 10
        </if>
        <if test="sortField != null and sortField != ''">
            ORDER BY vmInfo.vmCpus ${sortType},vmInfo.vmMemory ${sortType}
        </if>

    
```
#### querySpecGroupByAppReport
```

        SELECT CASE WHEN app.NAME is null THEN '其它' ELSE app.NAME END AS name,
        concat(CPUS,"C",round(ifnull(MEMORY/1024,0),0),"G") AS spec,count(1) AS num
        FROM cj_cmp_vm_view vm
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
        where
        vm.MEMBER_ID = #{memberId} and vm.CPUS is not null and vm.MEMORY is not null
        <if test="userIds != null and userIds.size >0 ">
            and ( vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
            )
        </if>
        <if test="startTime != null and startTime != ''">
            and vm.CREATE_DATE between #{startTime} and #{endTime}
        </if>
        group by app.NAME,concat(CPUS,"C",round(ifnull(MEMORY/1024,0),0),"G");
    
```
#### querySpecGroupByDeptReport
```

        SELECT CASE WHEN (app.DEPT_NAME is null or app.DEPT_NAME = '') THEN '其它' ELSE app.DEPT_NAME END AS name,
        concat(CPUS,"C",round(ifnull(MEMORY/1024,0),0),"G") AS spec,count(1) AS num
        FROM cj_cmp_vm_view vm
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
        where
        vm.MEMBER_ID = #{memberId} and vm.CPUS is not null and vm.MEMORY is not null
        <if test="userIds != null and userIds.size >0 ">
            and ( vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
            )
        </if>
        <if test="startTime != null and startTime != ''">
            and vm.CREATE_DATE between #{startTime} and #{endTime}
        </if>
        group by app.DEPT_NAME,concat(CPUS,"C",round(ifnull(MEMORY/1024,0),0),"G");
    
```
#### querySpecGroupByMemberReport
```

        SELECT vm.MEMBER_ID AS name,concat(CPUS,"C",round(ifnull(MEMORY/1024,0),0),"G") AS spec,count(1) AS num
        FROM cj_cmp_vm_view vm
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
        where
        vm.MEMBER_ID = #{memberId} and vm.CPUS is not null and vm.MEMORY is not null
        <if test="userIds != null and userIds.size >0 ">
            and ( vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
            )
        </if>
        <if test="startTime != null and startTime != ''">
            and vm.CREATE_DATE between #{startTime} and #{endTime}
        </if>
        group by vm.MEMBER_ID,concat(CPUS,"C",round(ifnull(MEMORY/1024,0),0),"G");
    
```
#### queryVmGroupByDpetReport
```

        SELECT vmInfo.name,vmInfo.spec FROM
        (SELECT vm.MEMBER_ID AS name,concat(sum(CPUS),"C",round(ifnull(sum(MEMORY)/1024,0),0),"G") AS spec
        FROM cj_cmp_vm_view vm
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
        where
        vm.MEMBER_ID = #{memberId} and vm.CPUS is not null and vm.MEMORY is not null
        <if test="userIds != null and userIds.size >0 ">
            and ( vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
            )
        </if>
        <if test="startTime != null and startTime != ''">
            and vm.CREATE_DATE between #{startTime} and #{endTime}
        </if>
        group by vm.MEMBER_ID order by vm.MEMBER_ID) AS vmInfo order by vmInfo.spec desc limit 10;
    
```
#### countCloudVm
```

        select count(distinct vm.SERVICE_ACCOUNT_ID, vm.ID) as num, SUM(ifnull(vol.DISK_SUM,0)) as diskSum
        from cj_cmp_vm_view vm
            left outer join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
        left outer join (
            select SERVICE_ACCOUNT_ID as saId,VM_DEVICE_ID as vmId,sum(ifnull(DISK_SPACE,0)) DISK_SUM
            from CJ_CMP_VM_VOLUME
            where IS_DELETED=0
            group by SERVICE_ACCOUNT_ID,VM_DEVICE_ID) vol on vol.saId=vm.SERVICE_ACCOUNT_ID and vol.vmId=vm.ID
        where vm.MEMBER_ID = #{memberId}
        <if test="userIds != null and userIds.size >0 ">
            and ( vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
            )
        </if>
        <if test="startTime != null and endTime != null ">
            and (vm.CREATE_DATE &gt;= DATE(#{startTime}) AND vm.CREATE_DATE &lt;= DATE(#{endTime}))
        </if>
    
```
#### queryCapacityUsageOfUser
```

        select sum(ifnull(vm.CPUS,0)) as cpu,sum(ifnull(vm.MEMORY,0)) as memory,SUM(ifnull(vol.DISK_SUM,0)) as diskSum
        from cj_cmp_vm_view vm
        left outer join CJ_CMP_APP_SYSTEM app on app.ID=vm.APP_SYSTEM_ID
        left outer join (
        select SERVICE_ACCOUNT_ID as saId,VM_DEVICE_ID as vmId,sum(ifnull(DISK_SPACE,0)) DISK_SUM
        from CJ_CMP_VM_VOLUME
        where IS_DELETED=0
        group by SERVICE_ACCOUNT_ID,VM_DEVICE_ID) vol on vol.saId=vm.SERVICE_ACCOUNT_ID and vol.vmId=vm.ID
        where vm.MEMBER_ID = #{memberId}
        <if test="userIds != null and userIds.size >0 ">
            and ( vm.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
            <if test="appUserId !=null ">
                or app.SYS_OPR_MANT_OWNER_ID= #{appUserId} or app.SYS_OPR_MANT_OWNER2_ID=#{appUserId} or app.BIZ_OWNER_ID=#{appUserId}
                <if test="appDepartmentList != null and appDepartmentList.size != 0">
                    or app.DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                    or app.SYS_OPR_MANT_DEPT_ID in <foreach collection="appDepartmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
                </if>
            </if>
            )
        </if>
    
```
#### queryCapacityUsage
```

        select sum(ifnull(vm.CPUS, 0))      as cpu,
               sum(ifnull(vm.MEMORY, 0))    as memory,
               SUM(ifnull(vol.DISK_SUM, 0)) as diskSum
        from cj_cmp_vm_view vm
                 left outer join (
            select SERVICE_ACCOUNT_ID as saId, VM_DEVICE_ID as vmId, sum(ifnull(DISK_SPACE, 0)) as DISK_SUM
            from CJ_CMP_VM_VOLUME
            where IS_DELETED = 0 and MEMBER_ID = #{memberId}
            group by SERVICE_ACCOUNT_ID, VM_DEVICE_ID) vol on vol.saId = vm.SERVICE_ACCOUNT_ID and vol.vmId = vm.ID
        <where>
            <if test="memberId != 0 ">
                and vm.MEMBER_ID = #{memberId}
            </if>
        </where>

    
```
#### queryCapacityByCloudAccountId
```

        select sum(vm.CPUS)      as vcpu,
               sum(vm.MEMORY)    as memory,
               sum(vol.DISK_SUM) as storage
        from cj_cmp_vm_view vm
                 left outer join (
            select SERVICE_ACCOUNT_ID as saId, VM_DEVICE_ID as vmId, sum(ifnull(DISK_SPACE, 0)) as DISK_SUM
            from CJ_CMP_VM_VOLUME
            where IS_DELETED = 0
                <if test="memberId != 0 ">
                    and MEMBER_ID = #{memberId}
                </if>
            group by SERVICE_ACCOUNT_ID, VM_DEVICE_ID) vol on vol.saId = vm.SERVICE_ACCOUNT_ID and vol.vmId = vm.ID
        where vm.CLOUD_ACCOUNT_ID = #{cloudAccountId}
            <if test="memberId != 0 ">
                and vm.MEMBER_ID = #{memberId}
            </if>
    
```
#### queryAppTopByColumnSum
```

        SELECT 
            vmInfo.appName,
        <choose>
            <when test="column!=null and column=='cpu'">
                vmInfo.cpus
            </when>
            <when test="column!=null and column=='memory'">
                vmInfo.memoryTotal
            </when>
        </choose>
        FROM (SELECT
                  app.NAME AS appName,
                <choose>
                    <when test="column!=null and column=='cpu'">
                        sum(vm.CPUS) AS cpus
                    </when>
                    <when test="column!=null and column=='memory'">
                        sum(vm.MEMORY) AS memoryTotal
                    </when>
                </choose>
              FROM cj_cmp_vm_view vm
                       inner join CJ_CMP_APP_SYSTEM app on app.ID = vm.APP_SYSTEM_ID
              where vm.MEMBER_ID = #{memberId}
                and DATE_SUB(CURDATE(), INTERVAL #{intervalTime} MONTH ) &lt;= date(vm.CREATE_DATE)
              group by app.NAME
              order by app.NAME) AS vmInfo
              order by
                <choose>
                    <when test="column!=null and column=='cpu'">
                        vmInfo.cpus
                    </when>
                    <when test="column!=null and column=='memory'">
                        vmInfo.memoryTotal
                    </when>
                </choose>
              desc
            limit 10
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_VM_VOLUME.xml
> sql统计:复杂0个，简单12个
>
> 使用的关键字：NOW,now,concat,ceil,sum,count

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_VPC.xml
> sql统计:复杂1个，简单11个
>
> 使用的关键字：values,join,and,CONCAT,in,from,if,concat,group_concat,count,on
#### selectVpcAndVds
```

    select * from (
    select
        vpc.ID,vpc.MEMBER_ID,vpc.ENTITY_ID,
        vpc.SERVICE_ACCOUNT_ID,
        vpc.NAME,vpc.LDC_ID,vpc.LDC_TYPE,vpc.CIDR_BLOCK,
        vpc.STATUS,vpc.DESCRIPTION,
        "VPC" as cloudWebType, saccount1.TYPE as sAccountType,
        vpc.CREATE_BY,vpc.CREATE_DATE,vpc.LAST_MODIFIED_BY,vpc.LAST_MODIFIED_DATE,
        saccount1.NAME as sAccountName,adc.NAME as ldcName
    from CJ_CMP_VPC vpc
    inner join CJ_CMP_SERVICE_ACCOUNT saccount1 on
    vpc.SERVICE_ACCOUNT_ID = saccount1.ID and saccount1.IS_DELETED=0
    left join CJ_CMP_ALIYUN_DC adc on adc.ID = vpc.LDC_ID and adc.IS_DELETED=0
    left join CJ_CMP_CLOUD_ACCOUNT_DC cdc on cdc.SERVICE_ACCOUNT_ID = vpc.SERVICE_ACCOUNT_ID and cdc.LDC_ID = vpc.LDC_ID and cdc.IS_DELETED = 0
    left join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED = 0
    <where>
      <choose>
        <when test="memberId != 0">
          and ca.MEMBER_ID = #{memberId}
        </when>
        <otherwise>
          and ca.SCOPE = 'public'
        </otherwise>
      </choose>
      <if test="serviceAccountId != 'ALL'">
        and vpc.SERVICE_ACCOUNT_ID = #{serviceAccountId}
      </if>
      <if test="ldcType != 'ALL' and ldcType != '' and ldcType != null">
        and saccount1.DATACENTER_TYPE = #{ldcType}
      </if>
      <if test="cloudAccountId != 'ALL'">
        and vpc.LDC_ID in (
        select cadc.LDC_ID from  CJ_CMP_CLOUD_ACCOUNT_DC cadc where cadc.CLOUD_ACCOUNT_ID = #{cloudAccountId} and cadc.IS_DELETED=0
        )
      </if>
      <if test="ldcId != 'ALL'" >
        and vpc.LDC_ID = #{ldcId}
      </if>
      <if test="queryValue != null" >
        <if test="queryValue != ''" >
          <choose>
            <when test="queryKey == 'ALL'" >
              and (
              vpc.NAME like CONCAT('%',#{queryValue},'%')
              OR vpc.CIDR_BLOCK like CONCAT('%',#{queryValue},'%')
              OR vpc.ENTITY_ID like CONCAT('%',#{queryValue},'%')
              )
            </when>
            <otherwise>
              <if test="queryKey == 'ENTITY_ID'" >
                and vpc.ENTITY_ID like CONCAT('%',#{queryValue},'%')
              </if>
              <if test="queryKey == 'NAME'" >
                and vpc.NAME like CONCAT('%',#{queryValue},'%')
              </if>
              <if test="queryKey == 'CIDR_BLOCK'" >
                and vpc.CIDR_BLOCK like CONCAT('%',#{queryValue},'%')
              </if>
            </otherwise>
          </choose>
        </if>
      </if>
    </where>
    union all
      select * from (select
      vds.ID,vds.MEMBER_ID,vds.ENTITY_ID,
      vds.SERVICE_ACCOUNT_ID,
      if(vds.TYPE = 'VSS',concat(vds.NAME, if(group_concat(vmHost.IP) is null, '', concat('[', group_concat(vmHost.IP), ']'))),vds.NAME) as NAME,
      vds.LDC_ID,vds.LDC_TYPE, "" as CIDR_BLOCK,
      vds.STATUS,vds.DESCRIPTION,
      vds.TYPE as cloudWebType, saccount2.TYPE as sAccountType,
      vds.CREATE_BY,vds.CREATE_DATE,vds.LAST_MODIFIED_BY,vds.LAST_MODIFIED_DATE,
      saccount2.NAME as sAccountName,vdc.NAME as ldcName
    from CJ_CMP_VDS vds
    inner join CJ_CMP_SERVICE_ACCOUNT saccount2 on vds.SERVICE_ACCOUNT_ID = saccount2.ID and saccount2.IS_DELETED=0
    left join CJ_CMP_VMWARE_DC vdc on vdc.ID = vds.LDC_ID  and vdc.IS_DELETED=0
    left join CJ_CMP_VDS_X_HOST vdsRel on vds.ID = vdsRel.VDS_ID
    left join CJ_CMP_VMWARE_HOST vmHost on vdsRel.HOST_ID = vmHost.ID
    left join CJ_CMP_CLOUD_ACCOUNT_DC cdc on cdc.SERVICE_ACCOUNT_ID = vds.SERVICE_ACCOUNT_ID and cdc.LDC_ID = vds.LDC_ID and cdc.IS_DELETED = 0
    left join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED = 0
    <where>
      <choose>
        <when test="memberId != 0">
          and ca.MEMBER_ID = #{memberId}
        </when>
        <otherwise>
          and ca.SCOPE = 'public'
        </otherwise>
      </choose>
      <if test="serviceAccountId != 'ALL'" >
        and vds.SERVICE_ACCOUNT_ID = #{serviceAccountId}
      </if>
    <if test="ldcType != 'ALL' and ldcType != '' and ldcType != null">
      and saccount2.DATACENTER_TYPE = #{ldcType}
    </if>
      <if test="cloudAccountId != 'ALL'" >
        and vds.LDC_ID in (
        select cadc.LDC_ID from  CJ_CMP_CLOUD_ACCOUNT_DC cadc where cadc.CLOUD_ACCOUNT_ID = #{cloudAccountId} and cadc.IS_DELETED=0
        )
      </if>
      <if test="ldcId != 'ALL'" >
        and vds.LDC_ID = #{ldcId}
      </if>
      </where>
      group by vds.ID
      ) t where 1 = 1
      <if test="queryValue != null" >
        <if test="queryValue != ''" >
          <choose>
            <when test="queryKey == 'ALL'" >
              and (
              t.NAME like CONCAT('%',#{queryValue},'%')
              OR t.ENTITY_ID like CONCAT('%',#{queryValue},'%')
              )
            </when>
            <otherwise>
              <if test="queryKey == 'ENTITY_ID'" >
                and t.ENTITY_ID like CONCAT('%',#{queryValue},'%')
              </if>
              <if test="queryKey == 'NAME'" >
                and t.NAME like CONCAT('%',#{queryValue},'%')
              </if>
            </otherwise>
          </choose>
        </if>
      </if>
    union all
      select * from (select
      vds.ID,vds.MEMBER_ID,vds.ENTITY_ID,
      vds.SERVICE_ACCOUNT_ID,
      if(vds.TYPE = 'VSS',concat(vds.NAME, if(group_concat(vmHost.IP) is null, '', concat('[', group_concat(vmHost.IP), ']'))),vds.NAME) as NAME,
      vds.LDC_ID,fcsa.DATACENTER_TYPE, '' as CIDR_BLOCK,
      '',vds.SHORT_DESCRIPTION,
      vds.TYPE as cloudWebType, fcsa.TYPE as sAccountType,
      vds.CREATE_BY,vds.CREATE_DATE,vds.LAST_MODIFIED_BY,vds.LAST_MODIFIED_DATE,
      fcsa.NAME as sAccountName,vdc.NAME as ldcName
    from CJ_CMP_FUSION_COMPUTE_VDS vds
    inner join CJ_CMP_SERVICE_ACCOUNT fcsa on vds.SERVICE_ACCOUNT_ID = fcsa.ID and fcsa.IS_DELETED=0 and vds.IS_DELETED=0
    left join CJ_CMP_FUSION_COMPUTE_DC vdc on vdc.ID = vds.LDC_ID  and vdc.IS_DELETED=0
    left join CJ_CMP_FUSION_COMPUTE_VDS_X_HOST vdsRel on vds.ID = vdsRel.VDS_ID
    left join CJ_CMP_FUSION_COMPUTE_HOST vmHost on vdsRel.HOST_ID = vmHost.ID
    left join CJ_CMP_CLOUD_ACCOUNT_DC cdc on cdc.SERVICE_ACCOUNT_ID = vds.SERVICE_ACCOUNT_ID and cdc.LDC_ID = vds.LDC_ID and cdc.IS_DELETED = 0
    left join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = cdc.CLOUD_ACCOUNT_ID and ca.IS_DELETED = 0
    where 1 = 1
    <choose>
      <when test="memberId != 0">
        and ca.MEMBER_ID = #{memberId}
      </when>
      <otherwise>
        and ca.SCOPE = 'public'
      </otherwise>
    </choose>
      <if test="serviceAccountId != 'ALL'" >
        and vds.SERVICE_ACCOUNT_ID = #{serviceAccountId}
      </if>
    <if test="ldcType != 'ALL' and ldcType != '' and ldcType != null">
      and fcsa.DATACENTER_TYPE = #{ldcType}
    </if>
      <if test="cloudAccountId != 'ALL'" >
        and vds.LDC_ID in (
        select cadc.LDC_ID from  CJ_CMP_CLOUD_ACCOUNT_DC cadc where cadc.CLOUD_ACCOUNT_ID = #{cloudAccountId} and cadc.IS_DELETED=0
        )
      </if>
      <if test="ldcId != 'ALL'" >
        and vds.LDC_ID = #{ldcId}
      </if>
      group by vds.ID) t where 1 = 1
      <if test="queryValue != null" >
        <if test="queryValue != ''" >
          <choose>
            <when test="queryKey == 'ALL'" >
              and (
              t.NAME like CONCAT('%',#{queryValue},'%')
              OR t.ENTITY_ID like CONCAT('%',#{queryValue},'%')
              )
            </when>
            <otherwise>
              <if test="queryKey == 'ENTITY_ID'" >
                and t.ENTITY_ID like CONCAT('%',#{queryValue},'%')
              </if>
              <if test="queryKey == 'NAME'" >
                and t.NAME like CONCAT('%',#{queryValue},'%')
              </if>
            </otherwise>
          </choose>
        </if>
      </if>
      union all
        select fvpc.ID,fvpc.MEMBER_ID,fvpc.ENTITY_ID,fvpc.SERVICE_ACCOUNT_ID,fvpc.NAME,fvpc.LDC_ID,fcdc.LDC_TYPE as ldcType,fvpc.CIDR as CIDR_BLOCK,null as STATUS,
          null as DESCRIPTION,'VPC' as cloudWebType,fsa.TYPE as sAccountType,fvpc.CREATE_BY,fvpc.CREATE_DATE,fvpc.LAST_MODIFIED_BY,fvpc.LAST_MODIFIED_DATE,
          fsa.NAME as sAccountName,fdc.NAME as ldcName
        from CJ_CMP_SERVICE_ACCOUNT fsa
        inner join CJ_CMP_FUSION_CLOUD_DC fdc on fdc.SERVICE_ACCOUNT_ID=fsa.ID and fsa.IS_DELETED=0 and fdc.IS_DELETED=0
        left join CJ_CMP_CLOUD_ACCOUNT_DC fcdc on (fcdc.SERVICE_ACCOUNT_ID=fsa.ID or fcdc.SERVICE_ACCOUNT_ID = fsa.PARENT_ID) and fcdc.LDC_ID=fdc.ID and fcdc.IS_DELETED=0
        inner join CJ_CMP_CLOUD_ACCOUNT fca on fcdc.CLOUD_ACCOUNT_ID=fca.ID and fca.IS_DELETED=0
        inner join CJ_CMP_FUSION_CLOUD_VPC fvpc on fvpc.LDC_ID=fdc.ID and fvpc.IS_DELETED=0
        <where>
          <choose>
            <when test="memberId != 0">
              and fca.MEMBER_ID = #{memberId}
            </when>
            <otherwise>
              and fca.SCOPE = 'public'
            </otherwise>
          </choose>
        <if test="serviceAccountId != 'ALL'" >
          and (fsa.ID = #{serviceAccountId} or fsa.PARENT_ID = #{serviceAccountId})
        </if>
        <if test="ldcType != 'ALL' and ldcType != '' and ldcType != null">
          and fsa.DATACENTER_TYPE = #{ldcType}
        </if>
        <if test="cloudAccountId != 'ALL'" >
          and fca.ID= #{cloudAccountId}
        </if>
        <if test="ldcId != 'ALL'" >
          and fvpc.LDC_ID = #{ldcId}
        </if>
        <if test="queryValue != null and queryValue != ''" >
            <if test="queryKey == 'ALL'" >
              and ( fvpc.NAME like CONCAT('%',#{queryValue},'%') OR fvpc.ENTITY_ID like CONCAT('%',#{queryValue},'%') )
            </if>
            <if test="queryKey == 'ENTITY_ID'" >
              and fvpc.ENTITY_ID like CONCAT('%',#{queryValue},'%')
            </if>
            <if test="queryKey == 'NAME'" >
              and fvpc.NAME like CONCAT('%',#{queryValue},'%')
            </if>
        </if>
        </where>
    union all
    select
    con.ID,con.MEMBER_ID,con.ENTITY_ID,
    con.SERVICE_ACCOUNT_ID,
    con.NAME,con.LDC_ID, cadc1.LDC_TYPE ldcType, "" as CIDR_BLOCK,
    con.STATUS,con.DESCRIPTION,
    "VPC" as cloudWebType, saccount2.TYPE as sAccountType,
    con.CREATE_BY,con.CREATE_DATE,con.LAST_MODIFIED_BY,con.LAST_MODIFIED_DATE,
    saccount2.NAME as sAccountName, cod.NAME as ldcName
    from CJ_CMP_CLOUDOS_NETWORK con
    inner join CJ_CMP_SERVICE_ACCOUNT saccount2 on con.SERVICE_ACCOUNT_ID = saccount2.ID and saccount2.IS_DELETED=0
    left join CJ_CMP_CLOUD_ACCOUNT_DC cadc1 on cadc1.SERVICE_ACCOUNT_ID = saccount2.ID and cadc1.LDC_ID = con.LDC_ID and cadc1.IS_DELETED=0
    left join CJ_CMP_CLOUDOS_DC cod on cod.ID = con.LDC_ID and cod.IS_DELETED=0
    left join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = cadc1.CLOUD_ACCOUNT_ID and ca.IS_DELETED = 0
    where con.IS_DELETED=0
    <choose>
      <when test="memberId != 0">
        and ca.MEMBER_ID = #{memberId}
      </when>
      <otherwise>
        and ca.SCOPE = 'public'
      </otherwise>
    </choose>
    <if test="serviceAccountId != 'ALL'" >
      and con.SERVICE_ACCOUNT_ID = #{serviceAccountId}
    </if>
    <if test="ldcType != 'ALL' and ldcType != '' and ldcType != null">
      and saccount2.DATACENTER_TYPE = #{ldcType}
    </if>
    <if test="cloudAccountId != 'ALL'" >
      and con.LDC_ID in (
      select cadc.LDC_ID from  CJ_CMP_CLOUD_ACCOUNT_DC cadc where cadc.CLOUD_ACCOUNT_ID = #{cloudAccountId} and cadc.IS_DELETED=0
      )
    </if>
    <if test="ldcId != 'ALL'" >
      and con.LDC_ID = #{ldcId}
    </if>
    <if test="queryValue != null" >
      <if test="queryValue != ''" >
        <choose>
          <when test="queryKey == 'ALL'" >
            and (
            con.NAME like CONCAT('%',#{queryValue},'%')
            OR con.ENTITY_ID like CONCAT('%',#{queryValue},'%')
            )
          </when>
          <otherwise>
            <if test="queryKey == 'ENTITY_ID'" >
              and con.ENTITY_ID like CONCAT('%',#{queryValue},'%')
            </if>
            <if test="queryKey == 'NAME'" >
              and con.NAME like CONCAT('%',#{queryValue},'%')
            </if>
          </otherwise>
        </choose>
      </if>

    </if>
    union all
    select
    region.ID,region.MEMBER_ID,region.ENTITY_ID,
    region.SERVICE_ACCOUNT_ID,
    region.NAME, null as ldcId, "cloudboot" as ldcType, "" as cidrBlock, "available" as status,
    region.DESCRIPTION, "boot交换机" as cloudWebType, saTable.TYPE as sAccountType,
    region.CREATE_BY,region.CREATE_DATE,region.LAST_MODIFIED_BY,region.LAST_MODIFIED_DATE,
    saTable.NAME as sAccountName, null as ldcName
    from CJ_CMDB_CI_SYS_REGION region
    inner join
    (
    SELECT DISTINCT
    sa.ID, sa.TYPE, sa.NAME
    FROM
    CJ_CMP_CLOUD_ACCOUNT ca
    INNER JOIN CJ_CMP_CLOUD_ACCOUNT_DC cdc ON ca.ID = cdc.CLOUD_ACCOUNT_ID
    AND ca.IS_DELETED = 0
    AND cdc.IS_DELETED = 0
    INNER JOIN CJ_CMDB_CI_PHYSICAL_DATACENTER dc ON cdc.LDC_ID = dc.ID
    AND dc.SERVICE_ACCOUNT_ID = cdc.SERVICE_ACCOUNT_ID
    AND dc.IS_DELETED = 0
    INNER JOIN CJ_CMP_SERVICE_ACCOUNT sa ON dc.SERVICE_ACCOUNT_ID = sa.ID
    AND sa.IS_DELETED = 0
    <where>
      <choose>
        <when test="memberId != 0">
          and ca.MEMBER_ID = #{memberId}
        </when>
        <otherwise>
          and ca.SCOPE = 'public'
        </otherwise>
      </choose>
      <if test="cloudAccountId != 'ALL'"> and ca.ID=#{cloudAccountId}</if>
      <if test="serviceAccountId != 'ALL'"> and cdc.SERVICE_ACCOUNT_ID=#{serviceAccountId}</if>
      <if test="ldcType != 'ALL' and ldcType != '' and ldcType != null">
        and sa.DATACENTER_TYPE = #{ldcType}
      </if>
    </where>
    ) saTable ON region.SERVICE_ACCOUNT_ID = saTable.ID
    <where>
    region.IS_DELETED = 0
    <if test="queryValue != null" >
      <if test="queryValue != ''" >
        <choose>
          <when test="queryKey == 'ALL'" >
            and (
            region.NAME like CONCAT('%',#{queryValue},'%')
            OR region.ENTITY_ID like CONCAT('%',#{queryValue},'%')
            )
          </when>
          <otherwise>
            <if test="queryKey == 'ENTITY_ID'" >
              and region.ENTITY_ID like CONCAT('%',#{queryValue},'%')
            </if>
            <if test="queryKey == 'NAME'" >
              and region.NAME like CONCAT('%',#{queryValue},'%')
            </if>
          </otherwise>
        </choose>
      </if>
    </if>
    </where>
    union all
    select
    qvpc.ID,qvpc.MEMBER_ID,qvpc.ENTITY_ID,
    qvpc.SERVICE_ACCOUNT_ID,
    qvpc.NAME,qvpc.LDC_ID, cadc1.LDC_TYPE ldcType, "" as CIDR_BLOCK,
    qvpc.RUN_STATUS as STATUS,qvpc.DESCRIPTION,
    "VPC" as cloudWebType, saccount2.TYPE as sAccountType,
    qvpc.CREATE_BY,qvpc.CREATE_DATE,qvpc.LAST_MODIFIED_BY,qvpc.LAST_MODIFIED_DATE,
    saccount2.NAME as sAccountName, qdc.NAME as ldcName
    from CJ_CMDB_CI_QINGCLOUD_VPC qvpc
    inner join CJ_CMP_SERVICE_ACCOUNT saccount2 on qvpc.SERVICE_ACCOUNT_ID = saccount2.ID and qvpc.IS_DELETED=0
    left join CJ_CMP_CLOUD_ACCOUNT_DC cadc1 on cadc1.SERVICE_ACCOUNT_ID = saccount2.ID and cadc1.LDC_ID = qvpc.LDC_ID  and cadc1.IS_DELETED=0
    left join CJ_CMDB_CI_QINGCLOUD_DATACENTER qdc on qdc.ID = qvpc.LDC_ID and qdc.IS_DELETED=0
    left join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = cadc1.CLOUD_ACCOUNT_ID and ca.IS_DELETED = 0
    where 1 = 1
    and qvpc.IS_DELETED=0
    <choose>
      <when test="memberId != 0">
        and ca.MEMBER_ID = #{memberId}
      </when>
      <otherwise>
        and ca.SCOPE = 'public'
      </otherwise>
    </choose>
    <if test="serviceAccountId != 'ALL'" >
      and qvpc.SERVICE_ACCOUNT_ID = #{serviceAccountId}
    </if>
    <if test="ldcType != 'ALL' and ldcType != '' and ldcType != null">
      and saccount2.DATACENTER_TYPE = #{ldcType}
    </if>
    <if test="cloudAccountId != 'ALL'" >
      and qvpc.LDC_ID in (
      select cadc.LDC_ID from  CJ_CMP_CLOUD_ACCOUNT_DC cadc where cadc.CLOUD_ACCOUNT_ID = #{cloudAccountId}  and cadc.IS_DELETED=0
      )
    </if>
    <if test="ldcId != 'ALL'" >
      and qvpc.LDC_ID = #{ldcId}
    </if>
    <if test="queryValue != null" >
      <if test="queryValue != ''" >
        <choose>
          <when test="queryKey == 'ALL'" >
            and (
            qvpc.NAME like CONCAT('%',#{queryValue},'%')
            OR qvpc.ENTITY_ID like CONCAT('%',#{queryValue},'%')
            )
          </when>
          <otherwise>
            <if test="queryKey == 'ENTITY_ID'" >
              and qvpc.ENTITY_ID like CONCAT('%',#{queryValue},'%')
            </if>
            <if test="queryKey == 'NAME'" >
              and qvpc.NAME like CONCAT('%',#{queryValue},'%')
            </if>
          </otherwise>
        </choose>
      </if>

    </if>
    ) as vpc_vds_network
  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_VPC_SUBNET.xml
> sql统计:复杂0个，简单14个
>
> 使用的关键字：ISNULL,CONCAT,count,and,from,in,values,IF

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_WEB_ACCESS_CONFIG.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：NOW,CJ_CMP_WEB_ACCESS_CONFIG,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_WEB_ACCESS_LOG.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：NOW,CJ_CMP_WEB_ACCESS_LOG,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CMP_WEB_ACCESS_URL.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：CJ_CMP_WEB_ACCESS_URL,values,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CPG_BIZ_API.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CPG_BIZ_API,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CPG_BIZ_INST.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：now,CJ_CPG_BIZ_INST,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CPG_BIZ_MODEL.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：count,concat,CJ_CPG_BIZ_MODEL,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CPG_BIZ_STAGE.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CPG_BIZ_STAGE,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CPG_BIZ_STATE.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CPG_BIZ_STATE,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CPG_RELATION_LIST.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：values,CJ_CPG_RELATION_LIST

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_CPG_TASK.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CPG_TASK,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_IMPORT_LOG.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：CJ_IMPORT_LOG,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_IMPORT_LOG_RECORD.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：count,and,CJ_IMPORT_LOG_RECORD,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_INCIDENT.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：NOW,CJ_INCIDENT,values,concat,and,in

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_INCIDENT_X_USER.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：now,CJ_INCIDENT_X_USER,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_ASSET.xml
> sql统计:复杂0个，简单38个
>
> 使用的关键字：count,exists,CJ_PAM_ASSET,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_ASSET_OFFLINE.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：concat,size,CJ_PAM_ASSET_OFFLINE,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_ASSET_OFFLINE_UNIT.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：NOW,CJ_PAM_ASSET_OFFLINE_UNIT,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_ASSET_SHIFT.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：values,NOW,CONCAT,CJ_PAM_ASSET_SHIFT

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_ASSET_SHIFT_UNIT.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：values,NOW,CJ_PAM_ASSET_SHIFT_UNIT

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_ASSET_STAGE_RESULT.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：now,from,CJ_PAM_ASSET_STAGE_RESULT,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_BATCH.xml
> sql统计:复杂0个，简单12个
>
> 使用的关键字：concat,CJ_PAM_BATCH,values,size,AND

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_BATCH_X_ASSET.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：CJ_PAM_BATCH_X_ASSET,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_CATEGORY.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：concat,CJ_PAM_CATEGORY,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_CLOUD_ACCOUNT_X_PM_MODEL.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：NOW,CJ_PAM_CLOUD_ACCOUNT_X_PM_MODEL,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_EXPANSION_ENTRY.xml
> sql统计:复杂0个，简单13个
>
> 使用的关键字：concat,from,sum,NOW,CJ_PAM_EXPANSION_ENTRY,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_EXPANSION_ENTRY_X_ASSET.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：CJ_PAM_EXPANSION_ENTRY_X_ASSET,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_HARDWARE_TEMPLATE.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：concat,CJ_PAM_HARDWARE_TEMPLATE,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_MODEL_CONFIGURATION.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：concat,CJ_PAM_MODEL_CONFIGURATION,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_NETWORK_WIRING.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：values,CJ_PAM_NETWORK_WIRING

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_OS_TEMPLATE.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：CJ_PAM_OS_TEMPLATE,values,concat

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_PARTS_CPU.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：values,CJ_PAM_PARTS_CPU

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_PARTS_DISK.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：CJ_PAM_PARTS_DISK,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_PARTS_FAN.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：CJ_PAM_PARTS_FAN,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_PARTS_HBA.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：CJ_PAM_PARTS_HBA,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_PARTS_MEMORY.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：CJ_PAM_PARTS_MEMORY,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_PARTS_NIC.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：CJ_PAM_PARTS_NIC,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_PARTS_POWER.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：CJ_PAM_PARTS_POWER,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_PARTS_RAID.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：CJ_PAM_PARTS_RAID,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_PM_MODEL_X_SPEC_CPU.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：values,now,CJ_PAM_PM_MODEL_X_SPEC_CPU

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_PM_MODEL_X_SPEC_DISK.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：now,CJ_PAM_PM_MODEL_X_SPEC_DISK,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_PM_MODEL_X_SPEC_GPU.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：now,CJ_PAM_PM_MODEL_X_SPEC_GPU,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_PM_MODEL_X_SPEC_MEMORY.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：now,CJ_PAM_PM_MODEL_X_SPEC_MEMORY,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_PRODUCT.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：concat,CJ_PAM_PRODUCT,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_PRODUCTION_BATCH.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：now,CJ_PAM_PRODUCTION_BATCH,values,NOW,concat,size

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_PRODUCTION_SUB_BATCH.xml
> sql统计:复杂0个，简单16个
>
> 使用的关键字：values,NOW,from,count,sum,now,CJ_PAM_PRODUCTION_SUB_BATCH

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_PRODUCTION_SUB_X_ASSET.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：now,CJ_PAM_PRODUCTION_SUB_X_ASSET,values,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_PRODUCT_COMPONENT.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：CJ_PAM_PRODUCT_COMPONENT,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_PURCHASE.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：concat,now,CJ_PAM_PURCHASE,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_PURCHASE_CONFIGURATION.xml
> sql统计:复杂0个，简单12个
>
> 使用的关键字：now,CJ_PAM_PURCHASE_CONFIGURATION,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_PURCHASE_CONFIGURATION_X_SPEC_CPU.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：now,CJ_PAM_PURCHASE_CONFIGURATION_X_SPEC_CPU,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_PURCHASE_CONFIGURATION_X_SPEC_DISK.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：now,CJ_PAM_PURCHASE_CONFIGURATION_X_SPEC_DISK,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_PURCHASE_CONFIGURATION_X_SPEC_GPU.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：values,now,CJ_PAM_PURCHASE_CONFIGURATION_X_SPEC_GPU

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_PURCHASE_CONFIGURATION_X_SPEC_HBA.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：now,CJ_PAM_PURCHASE_CONFIGURATION_X_SPEC_HBA,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_PURCHASE_CONFIGURATION_X_SPEC_MEMORY.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：now,CJ_PAM_PURCHASE_CONFIGURATION_X_SPEC_MEMORY,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_PURCHASE_CONFIGURATION_X_SPEC_NIC.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：now,CJ_PAM_PURCHASE_CONFIGURATION_X_SPEC_NIC,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_PURCHASE_CONFIGURATION_X_SPEC_RAID.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：now,CJ_PAM_PURCHASE_CONFIGURATION_X_SPEC_RAID,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_PURCHASE_ENTRY_X_ASSET.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：CJ_PAM_PURCHASE_ENTRY_X_ASSET

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_PURCHASE_X_PM_MODEL.xml
> sql统计:复杂0个，简单12个
>
> 使用的关键字：values,in,now,CJ_PAM_PURCHASE_X_PM_MODEL

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_RACK_UNIT.xml
> sql统计:复杂0个，简单14个
>
> 使用的关键字：concat,now,IN,CJ_PAM_RACK_UNIT,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_RESOURCE_POOL_EXPANSION.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：NOW,CJ_PAM_RESOURCE_POOL_EXPANSION,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_RESOURCE_POOL_NODE_CONFIG.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：CJ_PAM_RESOURCE_POOL_NODE_CONFIG,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_RESOURCE_POOL_PLAN.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：concat,and,or,now,CJ_PAM_RESOURCE_POOL_PLAN,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_RESOURCE_POOL_PLAN_NODE.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：CJ_PAM_RESOURCE_POOL_PLAN_NODE,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_RESOURCE_POOL_SOURCE.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：concat,CJ_PAM_RESOURCE_POOL_SOURCE,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_RESOURCE_POOL_X_PRODUCT.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：values,NOW,CJ_PAM_RESOURCE_POOL_X_PRODUCT

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_SPEC_CPU.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：values,concat,now,CJ_PAM_SPEC_CPU

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_SPEC_DISK.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：values,concat,now,CJ_PAM_SPEC_DISK

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_SPEC_GPU.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：now,CJ_PAM_SPEC_GPU,values,concat

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_SPEC_HBA.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：now,CJ_PAM_SPEC_HBA,values,concat

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_SPEC_MEMORY.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：concat,now,CJ_PAM_SPEC_MEMORY,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_SPEC_NIC.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：values,concat,now,CJ_PAM_SPEC_NIC

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_SPEC_RAID.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：CJ_PAM_SPEC_RAID,values,concat,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_PAM_TASK_JOB.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_PAM_TASK_JOB,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_SYS_DIC.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：in,now,CJ_SYS_DIC,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_SYS_DISPLAY_NAME_CONFIG.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：NOW,CJ_SYS_DISPLAY_NAME_CONFIG,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_SYS_OPER_LOG.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：and,CJ_SYS_OPER_LOG,VALUES,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_SYS_PARAM.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：now,CJ_SYS_PARAM,values,size

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_SYS_REPORT_CONFIG.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：now,CJ_SYS_REPORT_CONFIG,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_SYS_REPORT_GROUP.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：now,CJ_SYS_REPORT_GROUP,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CJ_SYS_SCREEN.xml
> sql统计:复杂4个，简单4个
>
> 使用的关键字：COUNT,ifnull,concat,date_format,curdate,from,count,FROM,ON,SUM,IF,on,ISNULL
#### queryHostNumberTrendByRecentYear
```

        SELECT #{cloudType} as cloudType,
        (
            SELECT ifnull(count(DISTINCT ENTITY_ID), 0) FROM
        CJ_CMP_HOST_DAY_REPORT  report WHERE report.STAT_TIME like concat(date_format(curdate(), '%Y-%m') ,'-%')
        AND MEMBER_ID IN
        <foreach item="item" index="index" collection="memberIds" open="(" separator="," close=")">
            #{item}
        </foreach>
            ) AS `total`,
        time.datetime,
        COUNT(DISTINCT report.ENTITY_ID) as num
        FROM (
        <include refid="Time_List"/>
        ) time
        LEFT JOIN CJ_CMP_HOST_DAY_REPORT report
        ON (report.STAT_TIME like concat(time.datetime,'-%')
        AND MEMBER_ID IN
        <foreach item="item" index="index" collection="memberIds" open="(" separator="," close=")">
            #{item}
        </foreach>)
        GROUP BY time.datetime;
    
```
#### queryCloudNativeClusterTrend
```

        SELECT
        #{cloudType} AS cloudNativeType,
        (SELECT ifnull(count(DISTINCT CLUSTER_ID), 0) FROM CJ_CMP_KUBERNETES_NODE_DAY_REPORT) AS `count`,
        time.datetime,
        COUNT(DISTINCT node.CLUSTER_ID) as num
        FROM (
        <include refid="Time_List"/>
        ) time
        LEFT JOIN CJ_CMP_KUBERNETES_NODE_DAY_REPORT node
        ON (node.STAT_TIME like concat(time.datetime,'-%'))
        GROUP BY time.datetime;
    
```
#### queryCloudNativePodTrend
```

        SELECT
        #{cloudType} AS cloudNativeType,
        (
        SELECT ifnull(count(DISTINCT pod.ENTITY_ID), 0)
        FROM CJ_CMP_KUBERNETES_NODE_DAY_REPORT node
        LEFT JOIN CJ_CMP_KUBERNETES_POD pod on (node.ID = pod.NODE_ID)
        ) AS `count`,
        time.datetime AS datetime,
        COUNT(DISTINCT pod.ENTITY_ID) AS num
        FROM (
        <include refid="Time_List"/>
        ) time
        LEFT JOIN CJ_CMP_KUBERNETES_NODE_DAY_REPORT node
        ON (node.STAT_TIME like concat(time.datetime, '-%'))
        LEFT JOIN CJ_CMP_KUBERNETES_POD pod on (node.ID = pod.NODE_ID)
        GROUP BY time.datetime;
    
```
#### queryCloudNativeSystemTrend
```

        SELECT
        #{cloudType} AS cloudNativeType,
        (SELECT ifnull(count(DISTINCT node.APP_SYSTEM_ID), 0)
        FROM CJ_CMP_KUBERNETES_NODE node
        WHERE node.IS_DELETED = 0
        ) AS `count`,
        time.datetime AS datetime,
        COUNT(DISTINCT node.APP_SYSTEM_ID) as num
        FROM (
        <include refid="Time_List"/>
        ) time
        LEFT JOIN CJ_CMP_KUBERNETES_NODE_DAY_REPORT node_re
        ON (node_re.STAT_TIME like concat(time.datetime, '-%'))
        LEFT JOIN CJ_CMP_KUBERNETES_NODE node
        ON (node.ID = node_re.ID)
        GROUP BY time.datetime;
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CidrBlockXBlockMapper.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：count,now,and,CJ_CMP_CIDR_BLOCK_X_BLOCK,VALUES,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CidrRelRulerMapper.xml
> sql统计:复杂0个，简单0个
>
> 使用的关键字：

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CloudAccountSyncResultItemMapper.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CMP_CLOUD_ACCOUNT_SYNC_RESULT_ITEM,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CloudAccountSyncResultMapper.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CMP_CLOUD_ACCOUNT_SYNC_RESULT,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CloudAccountSyncTaskMapper.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：count,from,CJ_CMP_CLOUD_ACCOUNT_SYNC_TASK,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CloudBillMapper.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：FROM,SUM,CAST,DECIMAL

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CloudContainerMapper.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：on,where,or,and,CONCAT

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CloudProductTypeMapper.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CloudosPerformanceMetricMapper.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：CJ_CMP_CLOUDOS_PERFORMANCE_METRIC,VALUES,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/ClusterDayReportMapper.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：CJ_CMP_CLUSTER_DAY_REPORT,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CmpCloudEnvMapper.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：concat,CJ_CMP_CLOUD_ENV,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/CmpElasticResourceGroupMapper.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CMP_ELASTIC_RESOURCE_GROUP,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/ContainerResourceDayReport.xml
> sql统计:复杂6个，简单0个
>
> 使用的关键字：count,DATE,ifnull
#### getTKEClusterTotal
```

        SELECT
        ifnull(count( DISTINCT ENTITY_ID, SERVICE_ACCOUNT_ID ),0) as num
        FROM
        CJ_CMDB_CI_TKE_CLUSTER_DAY_REPORT
        WHERE
        STAT_TIME = DATE(#{statTime})
        <if test="memberId != 0">
            and MEMBER_ID = #{memberId}
        </if>
        and
        IS_DELETED = 0
    
```
#### getFusionCCEClusterTotal
```

        SELECT
        ifnull(count( DISTINCT ENTITY_ID, SERVICE_ACCOUNT_ID ),0) as num
        FROM
        CJ_CMP_FUSION_CCE_CLUSTER_DAY_REPORT
        WHERE
        STAT_TIME = DATE(#{statTime})
        <if test="memberId != 0">
            and MEMBER_ID = #{memberId}
        </if>
        and
        IS_DELETED = 0
    
```
#### getKubernetesNodeTotal
```

        SELECT
        ifnull(count( DISTINCT ENTITY_ID, SERVICE_ACCOUNT_ID ),0) as num
        FROM
        CJ_CMP_KUBERNETES_NODE_DAY_REPORT
        WHERE
        STAT_TIME = DATE(#{statTime})
        <if test="memberId != 0">
            and MEMBER_ID = #{memberId}
        </if>
        and
        IS_DELETED = 0
    
```
#### getKubernetesDeploymentTotal
```

        SELECT
        ifnull(count( DISTINCT ENTITY_ID, SERVICE_ACCOUNT_ID ),0) as num
        FROM
        CJ_CMP_KUBERNETES_DEPLOYMENT_DAY_REPORT
        WHERE
        STAT_TIME = DATE(#{statTime})
        <if test="memberId != 0">
            and MEMBER_ID = #{memberId}
        </if>
        and
        IS_DELETED = 0
    
```
#### getKubernetesStatefulSetTotal
```

        SELECT
        ifnull(count( DISTINCT ENTITY_ID, SERVICE_ACCOUNT_ID ),0) as num
        FROM
        CJ_CMP_KUBERNETES_STATEFUL_SET_DAY_REPORT
        WHERE
        STAT_TIME = DATE(#{statTime})
        <if test="memberId != 0">
            and MEMBER_ID = #{memberId}
        </if>
        and
        IS_DELETED = 0
    
```
#### getKubernetesDaemonSetTotal
```

        SELECT
        ifnull(count( DISTINCT ENTITY_ID, SERVICE_ACCOUNT_ID ),0) as num
        FROM
        CJ_CMP_KUBERNETES_DAEMON_SET_DAY_REPORT
        WHERE
        STAT_TIME = DATE(#{statTime})
        <if test="memberId != 0">
            and MEMBER_ID = #{memberId}
        </if>
        and
        IS_DELETED = 0
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/EnvInstanceDOMapper.xml
> sql统计:复杂0个，简单17个
>
> 使用的关键字：IN,from,and,CONCAT,count,size,COUNT,CJ_CMP_SERVICE_INSTANCE,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/EnvInstanceResourceDOMapper.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：from

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/EnvUnitJobMapper.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：CJ_CMP_ENV_UNIT_JOB,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/HostDayReportMapper.xml
> sql统计:复杂8个，简单7个
>
> 使用的关键字：in,size,DATE,values,count,from,and,CJ_CMP_HOST_DAY_REPORT,sum,round,ifnull,max,DATE_FORMAT,group_concat,FROM
#### statVmwareHostBycaId
```

    select count(*) as hostSum,sum(CPUS) as cpuSum, sum(CPUS) * 3 as vCpuSum, round(sum(MEMORY_SUM/1024)) as memSum
    from (
           select
             host.ENTITY_ID,
             host.SERVICE_ACCOUNT_ID,
             max(CPUS)       as CPUS,
             max(MEMORY_SUM) as MEMORY_SUM
           from CJ_CMP_HOST_DAY_REPORT host
           left join CJ_CMP_HOST_REL_DAY_REPORT rel on rel.STAT_TIME = host.STAT_TIME and rel.HOST_ID = host.ID and rel.TYPE = host.TYPE
           where host.TYPE = 'vmware' and host.STAT_TIME = #{endTime} and host.MEMBER_ID = #{memberId}
                 and rel.CLOUD_ACCOUNT_ID = #{cloudAccountId}
           group by host.ENTITY_ID,host.SERVICE_ACCOUNT_ID
         ) host;
  
```
#### statFusionCloudHostBycaId
```

    select
      count(*)                      as hostSum,
      sum(CPUS)                     as cpuSum,
      sum(VIRTUAL_CPU_TOTAL)        as vCpuSum,
      round(sum(MEMORY_SUM / 1024)) as memSum
    from (
           select
             host.ENTITY_ID,
             host.SERVICE_ACCOUNT_ID,
             max(CPUS)              as CPUS,
             max(VIRTUAL_CPU_TOTAL) as VIRTUAL_CPU_TOTAL,
             max(MEMORY_SUM)        as MEMORY_SUM
           from CJ_CMP_HOST_DAY_REPORT host
           left join CJ_CMP_HOST_REL_DAY_REPORT rel
               on rel.STAT_TIME = host.STAT_TIME and rel.HOST_ID = host.ID and rel.TYPE = host.TYPE
           where host.TYPE = 'fusionCloud' and host.STAT_TIME = #{endTime} and host.MEMBER_ID = #{memberId}
                 and rel.CLOUD_ACCOUNT_ID = #{cloudAccountId}
           group by host.ENTITY_ID,host.SERVICE_ACCOUNT_ID
         ) host;
  
```
#### statVmwareHostCpuList
```

    select
    host.ID                            as id,
    group_concat(distinct host.NAME)   as hostName,
    group_concat(distinct sa.NAME)     as serviceAccountName,
    group_concat(distinct ca.NAME)     as poolName,
    max(host.CPUS)     as cpuSum,
    max(host.CPUS) * 3 as vCpuSum
    from CJ_CMP_HOST_DAY_REPORT host
    left join CJ_CMP_HOST_REL_DAY_REPORT rel on rel.STAT_TIME = host.STAT_TIME and rel.HOST_ID = host.ID and rel.TYPE = host.TYPE
    join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID = host.SERVICE_ACCOUNT_ID
    join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = rel.CLOUD_ACCOUNT_ID
    where host.TYPE = 'vmware' and host.STAT_TIME = #{endTime} and host.MEMBER_ID = #{memberId}
    and host.ENTITY_ID is not null and host.SERVICE_ACCOUNT_ID is not null
    <if test="condition != null and condition != ''">
      and (host.NAME = #{condition} or sa.NAME = #{condition} or ca.NAME = #{condition})
    </if>
    group by host.ID
  
```
#### statFusioncloudHostCpuList
```

    select
    host.ID                          as id,
    group_concat(distinct host.NAME) as hostName,
    group_concat(distinct sa.NAME)   as serviceAccountName,
    group_concat(distinct ca.NAME)   as poolName,
    max(host.CPUS)                   as cpuSum,
    max(host.VIRTUAL_CPU_TOTAL)      as vCpuSum
    from CJ_CMP_HOST_DAY_REPORT host
    left join CJ_CMP_HOST_REL_DAY_REPORT rel on rel.STAT_TIME = host.STAT_TIME and rel.HOST_ID = host.ID and rel.TYPE = host.TYPE
    left join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID = host.SERVICE_ACCOUNT_ID
    left join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = rel.CLOUD_ACCOUNT_ID
    where host.TYPE = 'fusioncloud' and host.STAT_TIME = #{endTime}  and host.MEMBER_ID = #{memberId}
    and host.ENTITY_ID is not null and host.SERVICE_ACCOUNT_ID is not null
    <if test="condition != null and condition != ''">
      and (host.NAME = #{condition} or sa.NAME = #{condition} or ca.NAME = #{condition})
    </if>
    group by host.ID
  
```
#### statVmwareHostMemList
```

    select
    host.ID                            as id,
    group_concat(distinct host.NAME)   as hostName,
    group_concat(distinct sa.NAME)     as serviceAccountName,
    group_concat(distinct ca.NAME)     as poolName,
    round(max(host.MEMORY_SUM / 1024)) as memSum
    from CJ_CMP_HOST_DAY_REPORT host
    left join CJ_CMP_HOST_REL_DAY_REPORT rel on rel.STAT_TIME = host.STAT_TIME and rel.HOST_ID = host.ID and rel.TYPE = host.TYPE
    join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID = host.SERVICE_ACCOUNT_ID
    join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = rel.CLOUD_ACCOUNT_ID
    where host.TYPE = 'vmware' and host.STAT_TIME = #{endTime} and host.MEMBER_ID = #{memberId}
    and host.ENTITY_ID is not null and host.SERVICE_ACCOUNT_ID is not null
    <if test="condition != null and condition != ''">
      and (host.NAME = #{condition} or sa.NAME = #{condition} or ca.NAME = #{condition})
    </if>
    group by host.ID
  
```
#### statFusionCloudHostMemList
```

    select
    host.ID                            as id,
    group_concat(distinct host.NAME)   as hostName,
    group_concat(distinct sa.NAME)     as serviceAccountName,
    group_concat(distinct ca.NAME)     as poolName,
    round(max(host.MEMORY_SUM / 1024)) as memSum
    from CJ_CMP_HOST_DAY_REPORT host
    left join CJ_CMP_HOST_REL_DAY_REPORT rel on rel.STAT_TIME = host.STAT_TIME and rel.HOST_ID = host.ID and rel.TYPE = host.TYPE
    left join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID = host.SERVICE_ACCOUNT_ID
    left join CJ_CMP_CLOUD_ACCOUNT ca on ca.ID = rel.CLOUD_ACCOUNT_ID
    where host.TYPE = 'fusioncloud' and host.STAT_TIME = #{endTime} and host.MEMBER_ID = #{memberId}
    and host.ENTITY_ID is not null and host.SERVICE_ACCOUNT_ID is not null
    <if test="condition != null and condition != ''">
      and (host.NAME = #{condition} or sa.NAME = #{condition} or ca.NAME = #{condition})
    </if>
    group by host.ID
  
```
#### groupBySaAndTime
```

    SELECT
    ifnull(count(DISTINCT ENTITY_ID, SERVICE_ACCOUNT_ID), 0) AS num,
    DATE_FORMAT(host.STAT_TIME, #{dateFormat}) AS days
    FROM (SELECT
    report.STAT_TIME,
    report.TYPE,
    ENTITY_ID,
    report.SERVICE_ACCOUNT_ID
    FROM CJ_CMP_HOST_DAY_REPORT report
    inner join CJ_CMP_CLOUD_ACCOUNT_DC cdc on report.LDC_ID = cdc.LDC_ID and report.SERVICE_ACCOUNT_ID = cdc.SERVICE_ACCOUNT_ID and cdc.IS_DELETED = 0
    inner join CJ_CMP_CLOUD_ACCOUNT ca on cdc.CLOUD_ACCOUNT_ID = ca.ID and ca.IS_DELETED = 0
    <choose>
      <when test="memberId != 0">
        and ca.MEMBER_ID = #{memberId}
      </when>
      <otherwise>
        and ca.SCOPE = 'public'
      </otherwise>
    </choose>
    WHERE report.SERVICE_ACCOUNT_ID in (select ID from CJ_CMP_SERVICE_ACCOUNT where IS_DELETED = 0)
    GROUP BY STAT_TIME, TYPE, ENTITY_ID, SERVICE_ACCOUNT_ID) host
    <where>
      <if test="serviceAccountId != null and serviceAccountId != ''">
        and host.SERVICE_ACCOUNT_ID = #{serviceAccountId}
      </if>
      <if test="type != null and type != ''">
        and host.TYPE=#{type}
      </if>
      <if test="startTime != null and endTime != null ">
        and (host.STAT_TIME &gt;= DATE(#{startTime}) AND host.STAT_TIME &lt;= DATE(#{endTime}))
      </if>
    </where>
    GROUP BY days
    ORDER BY days asc
  
```
#### getTotalBySaAndTime
```

    SELECT
        ifnull(count( DISTINCT report.ENTITY_ID, report.SERVICE_ACCOUNT_ID ), 0) as num
    FROM
    CJ_CMP_HOST_DAY_REPORT report
    INNER JOIN CJ_CMP_SERVICE_ACCOUNT sa ON sa.ID = report.SERVICE_ACCOUNT_ID
    INNER JOIN CJ_CMP_CLOUD_ACCOUNT_DC cdc on report.LDC_ID = cdc.LDC_ID and report.SERVICE_ACCOUNT_ID = cdc.SERVICE_ACCOUNT_ID and cdc.IS_DELETED = 0
    INNER JOIN CJ_CMP_CLOUD_ACCOUNT ca on cdc.CLOUD_ACCOUNT_ID = ca.ID and ca.IS_DELETED = 0
    <choose>
      <when test="memberId != 0">
        and ca.MEMBER_ID = #{memberId}
      </when>
      <otherwise>
        and ca.SCOPE = 'public'
      </otherwise>
    </choose>
    AND sa.IS_DELETED = 0
    WHERE
    STAT_TIME = DATE(#{statTime})
  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/HostRelDayReportMapper.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：CJ_CMP_HOST_REL_DAY_REPORT,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/INSPECTION_HOST_CHECK_RECORD.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/INSPECTION_JOB.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：CJ_INSPECTION_JOB,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/INSPECTION_JOB_RECORD.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：CJ_INSPECTION_JOB_RECORD,CONCAT,IFNULL,JOIN,max,JSON_EXTRACT,now,values,FROM

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/INSPECTION_RULE.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：concat

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/INSPECTION_RULE_CHECK_RECORD.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：CJ_INSPECTION_RULE_CHECK_RECORD,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/INSPECTION_RULE_GROUP.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：count,concat

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/ImageConfigMapper.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：now,CJ_CMP_IMAGE_CONFIG,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/IpRelMapper.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：NOW,CJ_CMP_IP_REL,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/KubernetesClusterMapper.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：and,CONCAT

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/KubernetesContainerMapper.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/KubernetesDaemonSetMapper.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：and,now,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/KubernetesDeploymentMapper.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：and,now,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/KubernetesNamespaceMapper.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：now,NOW,CONCAT,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/KubernetesNodeMapper.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：and,CONCAT,now,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/KubernetesOwnerReferenceMapper.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/KubernetesPersistentVolumeClaimMapper.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/KubernetesPersistentVolumeMapper.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/KubernetesPodMapper.xml
> sql统计:复杂2个，简单7个
>
> 使用的关键字：NOW,in,and,coalesce,CONCAT,now
#### list
```

        select
        pod.ID as ID ,
        pod.MEMBER_ID as MEMBER_ID,
        pod.SERVICE_ACCOUNT_ID as SERVICE_ACCOUNT_ID,
        pod.CLOUD_ACCOUNT_ID as CLOUD_ACCOUNT_ID,
        pod.LDC_ID as LDC_ID,
        pod.SERVICE_ACCOUNT_TYPE as SERVICE_ACCOUNT_TYPE,
        pod.OWNED_BY as OWNED_BY,
        pod.ENTITY_ID as ENTITY_ID,
        pod.NAME as NAME,
        pod.OWNER as OWNER,
        coalesce(deployment.NAME, statefulSet.NAME, daemonSet.NAME) as workloadName,
        coalesce(deployment.USED_FOR, statefulSet.USED_FOR, daemonSet.USED_FOR) as usedFor,
        coalesce(deployment.REMARK, statefulSet.REMARK, daemonSet.REMARK) as remark,
        coalesce(deployment.APP_SYSTEM_ID, statefulSet.APP_SYSTEM_ID, daemonSet.APP_SYSTEM_ID) as appSystemId,
        pod.CLOUD_ACCOUNT as CLOUD_ACCOUNT,
        pod.DEPARTMENT as DEPARTMENT,
        pod.IP as IP,
        pod.NODE_ID as NODE_ID,
        pod.NAMESPACE_ID as NAMESPACE_ID,
        pod.CLUSTER_ID as CLUSTER_ID,
        pod.CREATE_DATE as CREATE_DATE,
        pod.CREATE_BY as CREATE_BY,
        pod.STATUS as STATUS,
        pod.NAMESPACE_NAME as NAMESPACE,
        pod.CLUSTER_NAME as CLUSTER,
        pod.NODE_NAME as NODE
        from CJ_CMP_POD_VIEW pod
        inner join CJ_CMP_KUBERNETES_OWNER_REFERENCE rel on pod.ENTITY_ID = rel.RESOURCE_ENTITY_ID and pod.SERVICE_ACCOUNT_ID = rel.SERVICE_ACCOUNT_ID and rel.RESOURCE_TYPE = 'Pod' and rel.IS_DELETED = 0 and rel.OWNER_TYPE in ('ReplicaSet', 'StatefulSet', 'DaemonSet', 'Deployment')
        left join CJ_CMP_KUBERNETES_REPLICA_SET replicaSet on replicaSet.ENTITY_ID = rel.OWNER_ENTITY_ID and rel.SERVICE_ACCOUNT_ID = replicaSet.SERVICE_ACCOUNT_ID and rel.OWNER_TYPE = 'ReplicaSet' and replicaSet.IS_DELETED = 0
        left join CJ_CMP_KUBERNETES_OWNER_REFERENCE rel1 on replicaSet.ENTITY_ID = rel1.RESOURCE_ENTITY_ID and replicaSet.SERVICE_ACCOUNT_ID = rel1.SERVICE_ACCOUNT_ID and  rel1.RESOURCE_TYPE ='ReplicaSet' and rel1.IS_DELETED = 0
        left join CJ_CMP_KUBERNETES_DEPLOYMENT deployment on deployment.ENTITY_ID = rel1.OWNER_ENTITY_ID and rel1.SERVICE_ACCOUNT_ID = deployment.SERVICE_ACCOUNT_ID and rel1.OWNER_TYPE = 'Deployment' and deployment.IS_DELETED = 0
        left join CJ_CMP_KUBERNETES_STATEFUL_SET statefulSet on statefulSet.ENTITY_ID = rel.OWNER_ENTITY_ID and rel.SERVICE_ACCOUNT_ID = statefulSet.SERVICE_ACCOUNT_ID and rel.OWNER_TYPE = 'StatefulSet' and statefulSet.IS_DELETED = 0
        left join CJ_CMP_KUBERNETES_DAEMON_SET daemonSet on daemonSet.ENTITY_ID = rel.OWNER_ENTITY_ID  and rel.SERVICE_ACCOUNT_ID = daemonSet.SERVICE_ACCOUNT_ID and rel.OWNER_TYPE = 'DaemonSet' and daemonSet.IS_DELETED = 0
        where pod.MEMBER_ID = #{memberId} and pod.ENTITY_ID is not null and (pod.NAMESPACE_NAME != 'kube-system' or pod.NAMESPACE_NAME is null)
        <if test="userIds != null and userIds.size > 0 ">
            and ( pod.OWNED_BY in
            <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
            <if test="departmentList != null and departmentList.size != 0">
                or pod.DEPARTMENT_ID in
                <foreach collection="departmentList" item="department" open="(" close=")" separator=",">#{department}
                </foreach>
            </if>
            )
        </if>
        <if test="name != null and name != ''">
            and pod.NAME like CONCAT('%',#{name},'%')
        </if>
        <if test="ip != null and ip != ''">
            and pod.IP like CONCAT('%',#{ip},'%')
        </if>
        <if test="namespace != null and namespace != ''">
            and pod.NAMESPACE_NAME like CONCAT('%',#{namespace},'%')
        </if>
        <if test="owner != null">
            and pod.OWNER like CONCAT('%',#{owner},'%')
        </if>
        <if test="node != null and node != ''">
            and pod.NODE_NAME like CONCAT('%',#{node},'%')
        </if>
        <if test="cloudAccountId != null">
            and pod.CLOUD_ACCOUNT_ID =#{cloudAccountId}
        </if>
        <if test="ldcId != null">
            and pod.LDC_ID = #{ldcId}
        </if>
        <if test="searchKey != null and searchKey != ''">
            and (pod.NAME like CONCAT('%',#{searchKey},'%') or pod.IP like CONCAT('%',#{searchKey},'%') or
            pod.NAMESPACE_NAME like CONCAT('%',#{searchKey},'%')
            or pod.OWNER like CONCAT('%',#{searchKey},'%') or pod.NODE_NAME like CONCAT('%',#{searchKey},'%'))
        </if>
        order by pod.CREATE_DATE, pod.ID
    
```
#### queryDetailByIdAndType
```

        select
        pod.ID as ID ,
        pod.MEMBER_ID as MEMBER_ID,
        pod.SERVICE_ACCOUNT_ID as SERVICE_ACCOUNT_ID,
        pod.SERVICE_ACCOUNT_TYPE as SERVICE_ACCOUNT_TYPE,
        pod.OWNED_BY as OWNED_BY,
        pod.ENTITY_ID as ENTITY_ID,
        pod.NAME as NAME,
        pod.OWNER as OWNER,
        coalesce(deployment.NAME, statefulSet.NAME, daemonSet.NAME) as workloadName,
        coalesce(deployment.USED_FOR, statefulSet.USED_FOR, daemonSet.USED_FOR) as usedFor,
        coalesce(deployment.REMARK, statefulSet.REMARK, daemonSet.REMARK) as remark,
        coalesce(deployment.APP_SYSTEM_ID, statefulSet.APP_SYSTEM_ID, daemonSet.APP_SYSTEM_ID) as appSystemId,
        pod.CLOUD_ACCOUNT as CLOUD_ACCOUNT,
        pod.DEPARTMENT as DEPARTMENT,
        pod.IP as IP,
        pod.NODE_ID as NODE_ID,
        pod.NAMESPACE_ID as NAMESPACE_ID,
        pod.CLUSTER_ID as CLUSTER_ID,
        pod.CREATE_DATE as CREATE_DATE,
        pod.CREATE_BY as CREATE_BY,
        pod.STATUS as STATUS,
        pod.NAMESPACE_NAME as NAMESPACE,
        pod.CLUSTER_NAME as CLUSTER,
        pod.NODE_NAME as NODE
        from CJ_CMP_POD_VIEW pod
        inner join CJ_CMP_KUBERNETES_OWNER_REFERENCE rel on pod.ENTITY_ID = rel.RESOURCE_ENTITY_ID and pod.SERVICE_ACCOUNT_ID = rel.SERVICE_ACCOUNT_ID and rel.RESOURCE_TYPE = 'Pod' and rel.IS_DELETED = 0 and rel.OWNER_TYPE in ('ReplicaSet', 'StatefulSet', 'DaemonSet', 'Deployment')
        left join CJ_CMP_KUBERNETES_REPLICA_SET replicaSet on replicaSet.ENTITY_ID = rel.OWNER_ENTITY_ID and rel.SERVICE_ACCOUNT_ID = replicaSet.SERVICE_ACCOUNT_ID and rel.OWNER_TYPE = 'ReplicaSet' and replicaSet.IS_DELETED = 0
        left join CJ_CMP_KUBERNETES_OWNER_REFERENCE rel1 on replicaSet.ENTITY_ID = rel1.RESOURCE_ENTITY_ID and replicaSet.SERVICE_ACCOUNT_ID = rel1.SERVICE_ACCOUNT_ID and  rel1.RESOURCE_TYPE ='ReplicaSet' and rel1.IS_DELETED = 0
        left join CJ_CMP_KUBERNETES_DEPLOYMENT deployment on deployment.ENTITY_ID = rel1.OWNER_ENTITY_ID and rel1.SERVICE_ACCOUNT_ID = deployment.SERVICE_ACCOUNT_ID and rel1.OWNER_TYPE = 'Deployment' and deployment.IS_DELETED = 0
        left join CJ_CMP_KUBERNETES_STATEFUL_SET statefulSet on statefulSet.ENTITY_ID = rel.OWNER_ENTITY_ID and rel.SERVICE_ACCOUNT_ID = statefulSet.SERVICE_ACCOUNT_ID and rel.OWNER_TYPE = 'StatefulSet' and statefulSet.IS_DELETED = 0
        left join CJ_CMP_KUBERNETES_DAEMON_SET daemonSet on daemonSet.ENTITY_ID = rel.OWNER_ENTITY_ID  and rel.SERVICE_ACCOUNT_ID = daemonSet.SERVICE_ACCOUNT_ID and rel.OWNER_TYPE = 'DaemonSet' and daemonSet.IS_DELETED = 0
        where pod.ID = #{id} and pod.SERVICE_ACCOUNT_TYPE = #{type} and pod.MEMBER_ID = #{memberId}
        <if test="userIds != null and userIds.size > 0 ">
            and ( pod.OWNED_BY in
            <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=",">#{ownedBy}</foreach>
            <if test="departmentList != null and departmentList.size != 0">
                or pod.DEPARTMENT_ID in
                <foreach collection="departmentList" item="department" open="(" close=")" separator=",">#{department}
                </foreach>
            </if>
            )
        </if>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/KubernetesPodVolumeMapper.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/KubernetesProjectViewMapper.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：CONCAT,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/KubernetesReplicaSetMapper.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/KubernetesStatefulSetMapper.xml
> sql统计:复杂0个，简单5个
>
> 使用的关键字：and,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/KubernetesWorkloadMapper.xml
> sql统计:复杂0个，简单14个
>
> 使用的关键字：and,CONCAT,or

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/LogicSegmentMapper.xml
> sql统计:复杂0个，简单10个
>
> 使用的关键字：in,CONCAT,NOW,now,CJ_CMP_LOGIC_SEGMENT,VALUES

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/LogicSegmentXAppSystemMapper.xml
> sql统计:复杂1个，简单9个
>
> 使用的关键字：now,count,ifnull,join,and,CONCAT,CJ_CMP_LOGIC_SEGMENT_X_APP_SYSTEM,values
#### countLogicSegmentAllRelAppSystem
```

        SELECT ifnull(count(DISTINCT rel.LOGIC_SEGMENT_ID), 0)
        FROM CJ_CMP_LOGIC_SEGMENT_X_APP_SYSTEM rel
        inner JOIN CJ_CMP_APP_SYSTEM instance ON rel.APP_SYSTEM_ID = instance.ID AND instance.IS_DELETED = 0
        WHERE rel.ACTIVE =1 and rel.MEMBER_ID = #{memberId} and rel.LOGIC_SEGMENT_ID in <foreach collection="logicSegmentIds" item="logicId" open="(" close=")" separator=",">#{logicId}</foreach>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/ModuleMapper.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：CJ_CPG_MODULE,values,concat,count

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/ModuleVersionMapper.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：count,CJ_CPG_MODULE_VERSION,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/OracleOvmDcMapper.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/OracleOvmHostMapper.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：and,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/OracleOvmRepositoryMapper.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：and,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/OracleOvmVmMapper.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：NOW,and,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/PmDayReportMapper.xml
> sql统计:复杂2个，简单1个
>
> 使用的关键字：ifnull,count,FROM,and,DATE_FORMAT,in,DATE,CJ_CMP_PM_DAY_REPORT,values
#### groupBySaAndTime
```

    SELECT
    ifnull(count(DISTINCT ENTITY_ID, SERVICE_ACCOUNT_ID), 0)  AS num,
    DATE_FORMAT(pm.STAT_TIME, #{dateFormat}) AS days
    FROM (SELECT
    STAT_TIME,
    ENTITY_ID,
    SERVICE_ACCOUNT_ID
    FROM CJ_CMP_PM_DAY_REPORT
    WHERE SERVICE_ACCOUNT_ID in (select ID from CJ_CMP_SERVICE_ACCOUNT where IS_DELETED = 0)
    <if test="memberId != 0">
      and MEMBER_ID = #{memberId}
    </if>
    GROUP BY STAT_TIME, ENTITY_ID, SERVICE_ACCOUNT_ID) pm
    <where>
      <if test="serviceAccountId != null and serviceAccountId != '' ">
        and pm.SERVICE_ACCOUNT_ID = #{serviceAccountId}
      </if>
      <if test="startTime != null and endTime != null ">
        and (pm.STAT_TIME &gt;= DATE(#{startTime}) AND pm.STAT_TIME &lt;= DATE(#{endTime}))
      </if>
    </where>
    GROUP BY days
    ORDER BY days asc
  
```
#### getTotalBySaAndTime
```

    SELECT
        ifnull(count( DISTINCT ENTITY_ID, SERVICE_ACCOUNT_ID ),0) as num
    FROM
        CJ_CMP_PM_DAY_REPORT report
    INNER JOIN CJ_CMP_SERVICE_ACCOUNT sa ON sa.ID = report.SERVICE_ACCOUNT_ID
    AND sa.IS_DELETED = 0
    WHERE
      STAT_TIME = DATE(#{statTime})
      <if test="memberId != 0">
        and report.MEMBER_ID = #{memberId}
        <if test="userIds != null and userIds.size >0 ">
          and  report.OWNED_BY in <foreach collection="userIds" item="ownedBy" open="(" close=")" separator=","> #{ownedBy}</foreach>
          <if test="departmentList != null and departmentList.size != 0">
            or report.DEPT_ID in <foreach collection="departmentList" item="department" open="(" close=")" separator=",">#{department}</foreach>
          </if>
        </if>
      </if>
  
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/PmModelMapper.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：concat,now,CJ_PAM_PM_MODEL,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/PolicyExportMapper.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/QingCloudHostMapper.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/QingcloudPerformanceMetricMapper.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：CJ_CMP_QINGCLOUD_PERFORMANCE_METRIC,VALUES,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/RESOURCE_REPORT.xml
> sql统计:复杂5个，简单0个
>
> 使用的关键字：replace,and,join,count,ceil,sum,in,length,ifnull,round,group_concat
#### cloudAccountCpuStat
```

        select ca.ID as cloudAccountId,ca.NAME as name,ca.DATACENTER_TYPE as datacenterType,clu.serviceAccounts,h.hosts,clu.clusters,h.cpus,h.vcpuTotal,
        ifnull(vm.vcpuUsed,0) as vcpuUsed,h.vcpuTotal-ifnull(vm.vcpuUsed,0) as vcpuRemaining,ifnull(case when vm.vcpuUsed &gt;= 0 and h.vcpuTotal &gt; 0 then round(vm.vcpuUsed*100/h.vcpuTotal,1) end,0) as vcpuUsage
        from CJ_CMP_CLOUD_ACCOUNT_DAY_REPORT ca
        inner join (select ldc.CLOUD_ACCOUNT_ID,count(clu.ID)+count(az.ID) as clusters,group_concat(distinct sa.NAME) serviceAccounts from CJ_CMP_LDC_DAY_REPORT ldc
          inner join CJ_CMP_SERVICE_ACCOUNT_DAY_REPORT sa on ldc.STAT_TIME=#{statTime} and sa.STAT_TIME=#{statTime} and sa.ID=ldc.SERVICE_ACCOUNT_ID
          left outer join CJ_CMP_CLUSTER_DAY_REPORT clu on clu.STAT_TIME=#{statTime} and ldc.LDC_TYPE='vmware' and clu.LDC_ID=ldc.LDC_ID
          left outer join CJ_CMP_CLOUD_AZ_DAY_REPORT az on az.STAT_TIME=#{statTime} and ldc.SERVICE_ACCOUNT_ID=az.SERVICE_ACCOUNT_ID and ldc.LDC_ID=az.LDC_ID
          where ldc.STAT_TIME=#{statTime}  group by ldc.CLOUD_ACCOUNT_ID) clu on clu.CLOUD_ACCOUNT_ID=ca.ID and ca.STAT_TIME=#{statTime}
        left outer join (select hr.CLOUD_ACCOUNT_ID,count(*) as hosts,sum(ifnull(hd.CPUS,0)) as cpus,
          sum(ifnull(hd.VIRTUAL_CPU_TOTAL,ifnull(hd.CPUS*3,0))) as vcpuTotal
          from CJ_CMP_HOST_DAY_REPORT hd,CJ_CMP_HOST_REL_DAY_REPORT hr where hd.STAT_TIME=#{statTime} and hr.STAT_TIME=#{statTime}
          and hr.HOST_ID=hd.ID and hr.TYPE=hd.TYPE group by hr.CLOUD_ACCOUNT_ID) h on h.CLOUD_ACCOUNT_ID=ca.ID and ca.DATACENTER_TYPE in('vmware','fusionCloud')
        left outer join (select CLOUD_ACCOUNT_ID,sum(ifnull(vm.CPUS,0)) vcpuUsed from CJ_CMP_VM_DAY_REPORT vm where vm.STAT_TIME=#{statTime} and vm.MEMBER_ID=#{memberId}
            group by CLOUD_ACCOUNT_ID) vm on vm.CLOUD_ACCOUNT_ID=ca.ID
        where ca.MEMBER_ID=#{parentMemberId}
        <if test="datacenterType != null and datacenterType != '' ">
            and ca.DATACENTER_TYPE = #{datacenterType}
        </if>
        <if test="cloudAccountName != null and cloudAccountName != '' ">
            and ca.NAME like #{cloudAccountName}
        </if>
        order by vcpuUsage desc
    
```
#### cloudAccountMemoryStat
```

        select ca.ID as cloudAccountId,ca.NAME as name,ca.DATACENTER_TYPE as datacenterType,clu.serviceAccounts,
          h.hosts,clu.clusters,ceil(h.memoryTotal /1024) as memoryTotal,ceil(ifnull(vm.memoryUsed,0)/1024) as memoryUsed,ceil((h.memoryTotal-ifnull(vm.memoryUsed,0)) /1024) as memoryRemaining,
          case when vm.memoryUsed &gt;= 0 and h.memoryTotal &gt; 0 then round(vm.memoryUsed*100/h.memoryTotal,1) end as memoryUsage
        from CJ_CMP_CLOUD_ACCOUNT_DAY_REPORT ca
        inner join (select ldc.CLOUD_ACCOUNT_ID,count(clu.ID)+count(az.ID) as clusters,group_concat(distinct sa.NAME) serviceAccounts from CJ_CMP_LDC_DAY_REPORT ldc
          inner join CJ_CMP_SERVICE_ACCOUNT_DAY_REPORT sa on ldc.STAT_TIME=#{statTime} and sa.STAT_TIME=#{statTime} and sa.ID=ldc.SERVICE_ACCOUNT_ID
          left outer join CJ_CMP_CLUSTER_DAY_REPORT clu on clu.STAT_TIME=#{statTime} and ldc.LDC_TYPE='vmware' and clu.LDC_ID=ldc.LDC_ID
          left outer join CJ_CMP_CLOUD_AZ_DAY_REPORT az on az.STAT_TIME=#{statTime} and ldc.SERVICE_ACCOUNT_ID=az.SERVICE_ACCOUNT_ID and ldc.LDC_ID=az.LDC_ID
          where ldc.STAT_TIME=#{statTime}  group by ldc.CLOUD_ACCOUNT_ID) clu on clu.CLOUD_ACCOUNT_ID=ca.ID and ca.STAT_TIME=#{statTime}
        left outer join (select hr.CLOUD_ACCOUNT_ID,count(*) as hosts,
          count(DISTINCT ifnull(hd.CLUSTER_ID,hd.ZONE_ID)) as clusters,sum(ifnull(hd.MEMORY_SUM,0)) as memoryTotal
          from CJ_CMP_HOST_DAY_REPORT hd,CJ_CMP_HOST_REL_DAY_REPORT hr where hd.STAT_TIME=#{statTime} and hr.STAT_TIME=#{statTime} 
          and hr.HOST_ID=hd.ID and hr.TYPE=hd.TYPE group by hr.CLOUD_ACCOUNT_ID) h on ca.STAT_TIME=#{statTime} and h.CLOUD_ACCOUNT_ID=ca.ID and ca.DATACENTER_TYPE in('vmware','fusionCloud')
        left outer join (select CLOUD_ACCOUNT_ID,sum(ifnull(vm.MEMORY,0)) memoryUsed from CJ_CMP_VM_DAY_REPORT vm where vm.STAT_TIME=#{statTime} and vm.MEMBER_ID=#{memberId}
            group by CLOUD_ACCOUNT_ID) vm on vm.CLOUD_ACCOUNT_ID=ca.ID
        where ca.MEMBER_ID=#{parentMemberId}
        <if test="datacenterType != null and datacenterType != '' ">
            and ca.DATACENTER_TYPE = #{datacenterType}
        </if>
        <if test="cloudAccountName != null and cloudAccountName != '' ">
            and ca.NAME like #{cloudAccountName}
        </if>
        order by memoryUsage desc
    
```
#### cloudAccountIpTotalStat
```

       select ca.ID as id,ca.NAME,ca.DATACENTER_TYPE,group_concat(distinct sa.NAME) as serviceAccounts,count(distinct cidr.ID) cidrTotal,count(distinct ip.ID) ipTotal,
         count(distinct case when ip.STATUS='unused' then ip.ID end) as ipAvailable,count(distinct case when ip.STATUS='unused' then null else ip.ID end) as ipUsed
         from CJ_CMP_CLOUD_ACCOUNT ca
         left outer join CJ_CMP_CLOUD_ACCOUNT_DC cdc on cdc.CLOUD_ACCOUNT_ID=ca.ID and cdc.IS_DELETED=0
         left outer join CJ_CMP_SERVICE_ACCOUNT sa on sa.ID=cdc.SERVICE_ACCOUNT_ID and sa.IS_DELETED=0
         left outer join CJ_CMP_VDS vds on vds.LDC_ID=cdc.LDC_ID and vds.SERVICE_ACCOUNT_ID=cdc.SERVICE_ACCOUNT_ID
         left outer join CJ_CMP_VDS_PORTGROUP pg on pg.VDS_ID=vds.ID
         left outer join CJ_CMP_FUSION_CLOUD_NETWORK_SUBNET subnet on subnet.LDC_ID=cdc.LDC_ID and subnet.SERVICE_ACCOUNT_ID=cdc.SERVICE_ACCOUNT_ID
         left outer join CJ_CMP_CIDR_BLOCK_X_NETWORK cx on cx.SERVICE_ACCOUNT_ID=cdc.SERVICE_ACCOUNT_ID and cx.NETWORK_ID=ifnull(pg.ID,subnet.ID)
         left outer join CJ_CMP_CIDR_BLOCK cidr on cidr.ID=cx.CIDR_BLOCK_ID and cidr.IP_VERSION='IPv4'
         left outer join CJ_CMP_IP_POOL ip on ip.CIDR_BLOCK_ID=cidr.ID
        where ca.DATACENTER_TYPE in('vmware','fusionCloud') and ca.MEMBER_ID=#{memberId} and ca.IS_DELETED=0
        <if test="datacenterType != null and datacenterType != '' ">
            and ca.DATACENTER_TYPE = #{datacenterType}
        </if>
        <if test="cloudAccountName != null and cloudAccountName != '' ">
            and ca.NAME like #{cloudAccountName}
        </if>
         group by ca.ID
    
```
#### cloudAccountAppStat
```

       select app.ID,app.NAME,app.CODE,count(*) as vmTotal,sum(ifnull(vm.CPUS,0)) as cpuTotal,ceil(sum(ifnull(vm.MEMORY,0))/1024) as memoryTotal,ceil(sum(ifnull(vm.DISK_SUM,0))) as diskTotal,
       sum(ifnull(length(ifnull(vm.IP,''))-length(replace(ifnull(vm.IP,''),',',''))+1,0)) ipTotal
         from CJ_CMP_APP_SYSTEM_DAY_REPORT app,CJ_CMP_VM_DAY_REPORT vm where vm.STAT_TIME=#{statTime} and app.STAT_TIME=#{statTime} and vm.APP_SYSTEM_ID=app.ID 
         and app.MEMBER_ID=#{memberId} and vm.MEMBER_ID=app.MEMBER_ID
         <if test="cloudAccountId != null">
            and vm.CLOUD_ACCOUNT_ID = #{cloudAccountId}
        </if>
       <if test="searchKey != null and searchKey != '' ">
            and (app.NAME like #{searchKey} or app.CODE like #{searchKey})
        </if>
       group by app.ID,app.NAME,app.CODE
    
```
#### cloudAccountProjectStat
```

       select proj.ID,proj.NAME,proj.CODE,count(*) as vmTotal,sum(ifnull(vm.CPUS,0)) as cpuTotal,ceil(sum(ifnull(vm.MEMORY,0))/1024) as memoryTotal,ceil(sum(ifnull(vm.DISK_SUM,0))) as diskTotal,
       sum(ifnull(length(ifnull(vm.IP,''))-length(replace(ifnull(vm.IP,''),',',''))+1,0)) ipTotal
       from CJ_CMP_PROJECT_DAY_REPORT proj,CJ_CMP_VM_DAY_REPORT vm where vm.STAT_TIME=#{statTime} and proj.STAT_TIME=#{statTime} and vm.PROJECT_ID=proj.ID
         and proj.MEMBER_ID=#{memberId} and vm.MEMBER_ID=proj.MEMBER_ID
       <if test="cloudAccountId != null">
            and vm.CLOUD_ACCOUNT_ID = #{cloudAccountId}
        </if>
       <if test="searchKey != null and searchKey != '' ">
            and (proj.NAME like #{searchKey} or proj.CODE like #{searchKey})
        </if>
       group by proj.ID,proj.NAME,proj.CODE
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/SPEC_FOR_QUOTA.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：and,in

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/SamHostGroupMapper.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：and,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/SamHostMapper.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：and,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/SamStorageFsMapper.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：and,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/SamStoragePoolMapper.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：and,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/SamTagMapper.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：and,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/SamVirtualPoolMapper.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：and,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/SendDataJobMapper.xml
> sql统计:复杂0个，简单8个
>
> 使用的关键字：CJ_CMP_SEND_DATA_JOB,values,concat,size,NOW,HEX,UNIX_TIMESTAMP,now,CONCAT

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/SendDataJobVersionMapper.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：CJ_CMP_SEND_DATA_JOB_VERSION,values,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/SendDataLogMapper.xml
> sql统计:复杂2个，简单2个
>
> 使用的关键字：CJ_CMP_SEND_DATA_LOG,values,if,concat,NOW
#### getById
```

		select log.*,job.NAME as jobName,sc.NAME as scheduleName,if(log.CREATE_BY is null,'定时任务',user.NAME) as createByUser from CJ_CMP_SEND_DATA_LOG log
		left outer join CJ_CMP_SEND_DATA_JOB job on log.JOB_ID=job.ID left outer join CJ_CMP_SEND_DATA_SCHEDULE sc on log.SCHEDULE_ID=sc.ID
		left outer join ydduc.UC_USER user on log.CREATE_BY=user.ID
		where log.ID = #{id}
	
```
#### queryList
```

		select log.*,job.NAME as jobName,sc.NAME as scheduleName,if(log.CREATE_BY is null,'定时任务',user.NAME) as createByUser from CJ_CMP_SEND_DATA_LOG log
		inner join CJ_CMP_SEND_DATA_JOB job on log.JOB_ID=job.ID left outer join CJ_CMP_SEND_DATA_SCHEDULE sc on log.SCHEDULE_ID=sc.ID
		left outer join ydduc.UC_USER user on log.CREATE_BY=user.ID
		<where><trim>
			<if test="jobId!=null"> and log.JOB_ID=#{jobId}</if>
			<if test="jobName!=null"> and job.NAME like concat('%',#{jobName},'%')</if>
			<if test="scheduleId!=null"> and log.SCHEDULE_ID=#{scheduleId}</if>
			<if test="scheduleName!=null"> and sc.NAME like concat('%',#{scheduleName},'%')</if>
			<if test="batchNo!=null"> and log.BATCH_NO=#{batchNo}</if>
			<if test="startTime!=null"> and log.START_TIME &gt;= #{startTime}</if>
			<if test="startTime2!=null"> and log.START_TIME &lt;= #{startTime2}</if>
			<if test="status!=null"> and log.STATUS=#{status}</if>
			<if test="createBy!=null"> and log.CREATE_BY=#{createBy}</if>
		</trim></where>
		order by ${sortField} ${sortType}
	
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/SendDataLogRecordMapper.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：max,NOW,CJ_CMP_SEND_DATA_LOG_RECORD,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/SendDataRecordMd5Mapper.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：now,CJ_CMP_SEND_DATA_RECORD_MD5,values,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/SendDataScheduleMapper.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：CONCAT,count,NOW,HEX,REPLACE,concat,UNIX_TIMESTAMP,now,CJ_CMP_SEND_DATA_SCHEDULE,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/ServiceInstanceIntegrationMapper.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：values,now,CJ_CMP_SERVICE_INSTANCE_INTEGRATION

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/ServiceInstanceMapper.xml
> sql统计:复杂1个，简单27个
>
> 使用的关键字：ON,VALUES,and,in,count,join,sum,now,NOW,CJ_CMP_SERVICE_INSTANCE,or,CONCAT,convert
#### list
```

        select srvInst.*
        from CJ_CMP_SERVICE_INSTANCE srvInst
        <if test="(envInstanceSource != null and envInstanceSource != '') or (envInstanceSourceId != null and envInstanceSourceId != '')">
            join CJ_CMP_APP_INSTANCE appInst on srvInst.APP_INST_ID = appInst.ID and appInst.IS_DELETED = 0
        </if>
        <if test="envInstanceSource != null and envInstanceSource != ''">
            and appInst.SOURCE = #{envInstanceSource}
        </if>
        <if test="envInstanceSourceId != null and envInstanceSourceId != ''">
            and appInst.SOURCE_ID = #{envInstanceSourceId}
        </if>
        where srvInst.IS_DELETED = 0 and srvInst.MEMBER_ID = #{memberId}
        <if test="status != null and status != ''"> and srvInst.STATUS=#{status}</if>
        <if test="status == null or status == ''"> and srvInst.STATUS !='archived'</if>
        <if test="keyword != null and keyword != ''" >
          <choose>
            <when test="queryType != null and queryType == 'name'" >
                and srvInst.`NAME` like CONCAT('%',#{keyword},'%')
            </when>
            <when test="queryType != null and queryType == 'type'" >
                and srvInst.`TYPE` like CONCAT('%',#{keyword},'%')
            </when>
            <when test="queryType != null and queryType == 'status'" >
                and srvInst.STATUS like CONCAT('%',#{keyword},'%')
            </when>
            <when test="queryType != null and queryType == 'entityId'" >
                and srvInst.ENTITY_ID like CONCAT('%',#{keyword},'%')
            </when>
            <when test="queryType != null and queryType == 'srvNo'" >
                and srvInst.SRV_NO like CONCAT('%',#{keyword},'%')
            </when>
            <when test="queryType != null and queryType == 'description'" >
                and srvInst.TYPE like CONCAT('%',#{keyword},'%')
            </when>
          </choose>
        </if>
        <if test="appSystemId != null"> and srvInst.APP_SYSTEM_ID = #{appSystemId}</if>
        <if test="appInstId != null"> and srvInst.APP_INST_ID = #{appInstId}</if>
        <if test="userId != null"> and (srvInst.OWNED_BY=#{userId} or srvInst.APP_SYSTEM_ID in (select ID from CJ_CMP_APP_SYSTEM_X_USER where USER_ID=#{userId}))</if>
        <if test="sortField != null and sortType != ''">
            order by convert(srvInst.${sortField} USING gbk) ${sortType}
        </if>
        <if test="sortField == null or sortType == ''">
            order by srvInst.LAST_MODIFIED_DATE desc
        </if>
    
```
### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/ServiceInstanceResourceDuRelMapper.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：now,CJ_CMP_SERVICE_INSTANCE_RESOURCE,VALUES,NOW,CONCAT,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/ServiceInstanceResourcesRelMapper.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CMP_SERVICE_INSTANCE_X_RESOURCE,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/SpotEnvBackupRestoreMapper.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：CJ_CMP_SPOT_ENV_BACKUP_RESTORE,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/SpotEnvElasticGroupMapper.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：CJ_CMP_SPOT_ENV_ELASTIC_GROUP,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/SpotEnvElasticGroupResourceMapper.xml
> sql统计:复杂0个，简单9个
>
> 使用的关键字：CJ_CMP_SPOT_ENV_ELASTIC_GROUP_RESOURCE,values,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/SpotEnvInterruptMapper.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：CJ_CMP_SPOT_ENV_INTERRUPT,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/SpotEnvReqLogMapper.xml
> sql统计:复杂0个，简单7个
>
> 使用的关键字：values,CJ_CMP_SPOT_ENV_REQ_LOG

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/TagMapper.xml
> sql统计:复杂0个，简单11个
>
> 使用的关键字：concat,count,now,CJ_CMP_TAG,VALUES,from,COUNT,in

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/TagXObjectMapper.xml
> sql统计:复杂0个，简单4个
>
> 使用的关键字：CJ_CMP_TAG_X_OBJECT,VALUES,now

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/TencentCvmMapper.xml
> sql统计:复杂0个，简单15个
>
> 使用的关键字：and,now,NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/TencentDcMapper.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：NOW

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/TencentDisasterRecoverGroupMapper.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：CJ_CMP_TENCENT_DISASTER_RECOVER_GROUP,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/TencentSecurityGroupMapper.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/TencentSecurityGroupPolicyMapper.xml
> sql统计:复杂0个，简单1个
>
> 使用的关键字：

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/TencentSubnetapper.xml
> sql统计:复杂0个，简单3个
>
> 使用的关键字：IF,ISNULL,CONCAT,and

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/TencentVpcDOMapper.xml
> sql统计:复杂0个，简单6个
>
> 使用的关键字：CJ_CMP_TENCENT_VPC,values

### /Users/jiangliuhong/develop/cvs/idcos/cloud-cmp-core/cmp-core-dal/target/test-classes/META-INF/mybatis/sqlmap/VmPerformanceChartMapper.xml
> sql统计:复杂0个，简单2个
>
> 使用的关键字：DATE_FORMAT

